/*! For license information please see main.8a8cb829.js.LICENSE.txt */
(()=>{var e={936:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>a});var r={};try{!function(e,n){if(new e("q=%2B").get("q")!==n||new e({q:n}).get("q")!==n||new e([["q",n]]).get("q")!==n||"q=%0A"!==new e("q=\n").toString()||"q=+%26"!==new e({q:" &"}).toString()||"q=%25zx"!==new e({q:"%zx"}).toString())throw e;r.URLSearchParams=e}(URLSearchParams,"+")}catch(URLSearchParams){!function(e,n,t){var a=e.create,s=e.defineProperty,o=/[!'\(\)~]|%20|%00/g,i=/%(?![0-9a-fA-F]{2})/g,l=/\+/g,u={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},c={append:function(e,n){g(this._ungap,e,n)},delete:function(e){delete this._ungap[e]},get:function(e){return this.has(e)?this._ungap[e][0]:null},getAll:function(e){return this.has(e)?this._ungap[e].slice(0):[]},has:function(e){return e in this._ungap},set:function(e,t){this._ungap[e]=[n(t)]},forEach:function(e,t){var r=this;for(var a in r._ungap)r._ungap[a].forEach(s,a);function s(s){e.call(t,s,n(a),r)}},toJSON:function(){return{}},toString:function(){var e=[];for(var n in this._ungap)for(var t=h(n),r=0,a=this._ungap[n];r<a.length;r++)e.push(t+"="+h(a[r]));return e.join("&")}};for(var d in c)s(f.prototype,d,{configurable:!0,writable:!0,value:c[d]});function f(e){var n=a(null);switch(s(this,"_ungap",{value:n}),!0){case!e:break;case"string"===typeof e:"?"===e.charAt(0)&&(e=e.slice(1));for(var r=e.split("&"),o=0,i=r.length;o<i;o++){var l=(u=r[o]).indexOf("=");-1<l?g(n,m(u.slice(0,l)),m(u.slice(l+1))):u.length&&g(n,m(u),"")}break;case t(e):for(o=0,i=e.length;o<i;o++){var u;g(n,(u=e[o])[0],u[1])}break;case"forEach"in e:e.forEach(p,n);break;default:for(var c in e)g(n,c,e[c])}}function p(e,n){g(this,n,e)}function g(e,n,r){var a=t(r)?r.join(","):r;n in e?e[n].push(a):e[n]=[a]}function m(e){return decodeURIComponent(e.replace(i,"%25").replace(l," "))}function h(e){return encodeURIComponent(e).replace(o,y)}function y(e){return u[e]}r.URLSearchParams=f}(Object,String,Array.isArray)}!function(e){var n=!1;try{n=!!Symbol.iterator}catch(r){}function t(e,t){var r=[];return e.forEach(t,r),n?r[Symbol.iterator]():{next:function(){var e=r.shift();return{done:void 0===e,value:e}}}}"forEach"in e||(e.forEach=function(e,n){var t=this,r=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach((function(a){a.length&&!(a in r)&&(r[a]=t.getAll(a)).forEach((function(r){e.call(n,r,a,t)}))}))}),"keys"in e||(e.keys=function(){return t(this,(function(e,n){this.push(n)}))}),"values"in e||(e.values=function(){return t(this,(function(e,n){this.push(e)}))}),"entries"in e||(e.entries=function(){return t(this,(function(e,n){this.push([n,e])}))}),n&&!(Symbol.iterator in e)&&(e[Symbol.iterator]=e.entries),"sort"in e||(e.sort=function(){for(var e,n,t,r=this.entries(),a=r.next(),s=a.done,o=[],i=Object.create(null);!s;)n=(t=a.value)[0],o.push(n),n in i||(i[n]=[]),i[n].push(t[1]),s=(a=r.next()).done;for(o.sort(),e=0;e<o.length;e++)this.delete(o[e]);for(e=0;e<o.length;e++)n=o[e],this.append(n,i[n].shift())}),function(n){var t=n.defineProperty,r=n.getOwnPropertyDescriptor,a=function(n){var t=n.append;n.append=e.append,URLSearchParams.call(n,n._usp.search.slice(1)),n.append=t},s=function(e,n){if(!(e instanceof n))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+n.name)},o=function(o){var i,l,u=o.prototype,c=r(u,"searchParams"),d=r(u,"href"),f=r(u,"search");!c&&f&&f.set&&(l=function(n){function r(t,r){e.append.call(this,t,r),t=this.toString(),n.set.call(this._usp,t?"?"+t:"")}function a(t){e.delete.call(this,t),t=this.toString(),n.set.call(this._usp,t?"?"+t:"")}function s(t,r){e.set.call(this,t,r),t=this.toString(),n.set.call(this._usp,t?"?"+t:"")}return function(e,n){return e.append=r,e.delete=a,e.set=s,t(e,"_usp",{configurable:!0,writable:!0,value:n})}}(f),i=function(e,n){return t(e,"_searchParams",{configurable:!0,writable:!0,value:l(n,e)}),n},n.defineProperties(u,{href:{get:function(){return d.get.call(this)},set:function(e){var n=this._searchParams;d.set.call(this,e),n&&a(n)}},search:{get:function(){return f.get.call(this)},set:function(e){var n=this._searchParams;f.set.call(this,e),n&&a(n)}},searchParams:{get:function(){return s(this,o),this._searchParams||i(this,new URLSearchParams(this.search.slice(1)))},set:function(e){s(this,o),i(this,e)}}}))};try{o(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&o(URL)}catch(i){}}(Object)}(r.URLSearchParams.prototype);const a=r.URLSearchParams},998:(e,n)=>{"use strict";n.Z=function(e,n){if(e&&n){var t=Array.isArray(n)?n:n.split(","),r=e.name||"",a=(e.type||"").toLowerCase(),s=a.replace(/\/.*$/,"");return t.some((function(e){var n=e.trim().toLowerCase();return"."===n.charAt(0)?r.toLowerCase().endsWith(n):n.endsWith("/*")?s===n.replace(/\/.*$/,""):a===n}))}return!0}},588:(e,n,t)=>{"use strict";t.r(n),t.d(n,{createBrowserHistory:()=>x,createHashHistory:()=>F,createLocation:()=>b,createMemoryHistory:()=>N,createPath:()=>y,locationsAreEqual:()=>v,parsePath:()=>h});var r=t(462);function a(e){return"/"===e.charAt(0)}function s(e,n){for(var t=n,r=t+1,a=e.length;r<a;t+=1,r+=1)e[t]=e[r];e.pop()}const o=function(e,n){void 0===n&&(n="");var t,r=e&&e.split("/")||[],o=n&&n.split("/")||[],i=e&&a(e),l=n&&a(n),u=i||l;if(e&&a(e)?o=r:r.length&&(o.pop(),o=o.concat(r)),!o.length)return"/";if(o.length){var c=o[o.length-1];t="."===c||".."===c||""===c}else t=!1;for(var d=0,f=o.length;f>=0;f--){var p=o[f];"."===p?s(o,f):".."===p?(s(o,f),d++):d&&(s(o,f),d--)}if(!u)for(;d--;d)o.unshift("..");!u||""===o[0]||o[0]&&a(o[0])||o.unshift("");var g=o.join("/");return t&&"/"!==g.substr(-1)&&(g+="/"),g};function i(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}const l=function e(n,t){if(n===t)return!0;if(null==n||null==t)return!1;if(Array.isArray(n))return Array.isArray(t)&&n.length===t.length&&n.every((function(n,r){return e(n,t[r])}));if("object"===typeof n||"object"===typeof t){var r=i(n),a=i(t);return r!==n||a!==t?e(r,a):Object.keys(Object.assign({},n,t)).every((function(r){return e(n[r],t[r])}))}return!1};var u=!0,c="Invariant failed";function d(e,n){if(!e){if(u)throw new Error(c);var t="function"===typeof n?n():n,r=t?"".concat(c,": ").concat(t):c;throw new Error(r)}}function f(e){return"/"===e.charAt(0)?e:"/"+e}function p(e){return"/"===e.charAt(0)?e.substr(1):e}function g(e,n){return function(e,n){return 0===e.toLowerCase().indexOf(n.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(n.length))}(e,n)?e.substr(n.length):e}function m(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function h(e){var n=e||"/",t="",r="",a=n.indexOf("#");-1!==a&&(r=n.substr(a),n=n.substr(0,a));var s=n.indexOf("?");return-1!==s&&(t=n.substr(s),n=n.substr(0,s)),{pathname:n,search:"?"===t?"":t,hash:"#"===r?"":r}}function y(e){var n=e.pathname,t=e.search,r=e.hash,a=n||"/";return t&&"?"!==t&&(a+="?"===t.charAt(0)?t:"?"+t),r&&"#"!==r&&(a+="#"===r.charAt(0)?r:"#"+r),a}function b(e,n,t,a){var s;"string"===typeof e?(s=h(e)).state=n:(void 0===(s=(0,r.Z)({},e)).pathname&&(s.pathname=""),s.search?"?"!==s.search.charAt(0)&&(s.search="?"+s.search):s.search="",s.hash?"#"!==s.hash.charAt(0)&&(s.hash="#"+s.hash):s.hash="",void 0!==n&&void 0===s.state&&(s.state=n));try{s.pathname=decodeURI(s.pathname)}catch(i){throw i instanceof URIError?new URIError('Pathname "'+s.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):i}return t&&(s.key=t),a?s.pathname?"/"!==s.pathname.charAt(0)&&(s.pathname=o(s.pathname,a.pathname)):s.pathname=a.pathname:s.pathname||(s.pathname="/"),s}function v(e,n){return e.pathname===n.pathname&&e.search===n.search&&e.hash===n.hash&&e.key===n.key&&l(e.state,n.state)}function S(){var e=null;var n=[];return{setPrompt:function(n){return e=n,function(){e===n&&(e=null)}},confirmTransitionTo:function(n,t,r,a){if(null!=e){var s="function"===typeof e?e(n,t):e;"string"===typeof s?"function"===typeof r?r(s,a):a(!0):a(!1!==s)}else a(!0)},appendListener:function(e){var t=!0;function r(){t&&e.apply(void 0,arguments)}return n.push(r),function(){t=!1,n=n.filter((function(e){return e!==r}))}},notifyListeners:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.forEach((function(e){return e.apply(void 0,t)}))}}}var w=!("undefined"===typeof window||!window.document||!window.document.createElement);function _(e,n){n(window.confirm(e))}var k="popstate",I="hashchange";function T(){try{return window.history.state||{}}catch(e){return{}}}function x(e){void 0===e&&(e={}),w||d(!1);var n=window.history,t=function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}(),a=!(-1===window.navigator.userAgent.indexOf("Trident")),s=e,o=s.forceRefresh,i=void 0!==o&&o,l=s.getUserConfirmation,u=void 0===l?_:l,c=s.keyLength,p=void 0===c?6:c,h=e.basename?m(f(e.basename)):"";function v(e){var n=e||{},t=n.key,r=n.state,a=window.location,s=a.pathname+a.search+a.hash;return h&&(s=g(s,h)),b(s,r,t)}function x(){return Math.random().toString(36).substr(2,p)}var O=S();function C(e){(0,r.Z)(z,e),z.length=n.length,O.notifyListeners(z.location,z.action)}function M(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||F(v(e.state))}function E(){F(v(T()))}var A=!1;function F(e){if(A)A=!1,C();else{O.confirmTransitionTo(e,"POP",u,(function(n){n?C({action:"POP",location:e}):function(e){var n=z.location,t=N.indexOf(n.key);-1===t&&(t=0);var r=N.indexOf(e.key);-1===r&&(r=0);var a=t-r;a&&(A=!0,L(a))}(e)}))}}var P=v(T()),N=[P.key];function R(e){return h+y(e)}function L(e){n.go(e)}var D=0;function U(e){1===(D+=e)&&1===e?(window.addEventListener(k,M),a&&window.addEventListener(I,E)):0===D&&(window.removeEventListener(k,M),a&&window.removeEventListener(I,E))}var j=!1;var z={length:n.length,action:"POP",location:P,createHref:R,push:function(e,r){var a="PUSH",s=b(e,r,x(),z.location);O.confirmTransitionTo(s,a,u,(function(e){if(e){var r=R(s),o=s.key,l=s.state;if(t)if(n.pushState({key:o,state:l},null,r),i)window.location.href=r;else{var u=N.indexOf(z.location.key),c=N.slice(0,u+1);c.push(s.key),N=c,C({action:a,location:s})}else window.location.href=r}}))},replace:function(e,r){var a="REPLACE",s=b(e,r,x(),z.location);O.confirmTransitionTo(s,a,u,(function(e){if(e){var r=R(s),o=s.key,l=s.state;if(t)if(n.replaceState({key:o,state:l},null,r),i)window.location.replace(r);else{var u=N.indexOf(z.location.key);-1!==u&&(N[u]=s.key),C({action:a,location:s})}else window.location.replace(r)}}))},go:L,goBack:function(){L(-1)},goForward:function(){L(1)},block:function(e){void 0===e&&(e=!1);var n=O.setPrompt(e);return j||(U(1),j=!0),function(){return j&&(j=!1,U(-1)),n()}},listen:function(e){var n=O.appendListener(e);return U(1),function(){U(-1),n()}}};return z}var O="hashchange",C={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+p(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:p,decodePath:f},slash:{encodePath:f,decodePath:f}};function M(e){var n=e.indexOf("#");return-1===n?e:e.slice(0,n)}function E(){var e=window.location.href,n=e.indexOf("#");return-1===n?"":e.substring(n+1)}function A(e){window.location.replace(M(window.location.href)+"#"+e)}function F(e){void 0===e&&(e={}),w||d(!1);var n=window.history,t=(window.navigator.userAgent.indexOf("Firefox"),e),a=t.getUserConfirmation,s=void 0===a?_:a,o=t.hashType,i=void 0===o?"slash":o,l=e.basename?m(f(e.basename)):"",u=C[i],c=u.encodePath,p=u.decodePath;function h(){var e=p(E());return l&&(e=g(e,l)),b(e)}var v=S();function k(e){(0,r.Z)(z,e),z.length=n.length,v.notifyListeners(z.location,z.action)}var I=!1,T=null;function x(){var e,n,t=E(),r=c(t);if(t!==r)A(r);else{var a=h(),o=z.location;if(!I&&(n=a,(e=o).pathname===n.pathname&&e.search===n.search&&e.hash===n.hash))return;if(T===y(a))return;T=null,function(e){if(I)I=!1,k();else{var n="POP";v.confirmTransitionTo(e,n,s,(function(t){t?k({action:n,location:e}):function(e){var n=z.location,t=R.lastIndexOf(y(n));-1===t&&(t=0);var r=R.lastIndexOf(y(e));-1===r&&(r=0);var a=t-r;a&&(I=!0,L(a))}(e)}))}}(a)}}var F=E(),P=c(F);F!==P&&A(P);var N=h(),R=[y(N)];function L(e){n.go(e)}var D=0;function U(e){1===(D+=e)&&1===e?window.addEventListener(O,x):0===D&&window.removeEventListener(O,x)}var j=!1;var z={length:n.length,action:"POP",location:N,createHref:function(e){var n=document.querySelector("base"),t="";return n&&n.getAttribute("href")&&(t=M(window.location.href)),t+"#"+c(l+y(e))},push:function(e,n){var t="PUSH",r=b(e,void 0,void 0,z.location);v.confirmTransitionTo(r,t,s,(function(e){if(e){var n=y(r),a=c(l+n);if(E()!==a){T=n,function(e){window.location.hash=e}(a);var s=R.lastIndexOf(y(z.location)),o=R.slice(0,s+1);o.push(n),R=o,k({action:t,location:r})}else k()}}))},replace:function(e,n){var t="REPLACE",r=b(e,void 0,void 0,z.location);v.confirmTransitionTo(r,t,s,(function(e){if(e){var n=y(r),a=c(l+n);E()!==a&&(T=n,A(a));var s=R.indexOf(y(z.location));-1!==s&&(R[s]=n),k({action:t,location:r})}}))},go:L,goBack:function(){L(-1)},goForward:function(){L(1)},block:function(e){void 0===e&&(e=!1);var n=v.setPrompt(e);return j||(U(1),j=!0),function(){return j&&(j=!1,U(-1)),n()}},listen:function(e){var n=v.appendListener(e);return U(1),function(){U(-1),n()}}};return z}function P(e,n,t){return Math.min(Math.max(e,n),t)}function N(e){void 0===e&&(e={});var n=e,t=n.getUserConfirmation,a=n.initialEntries,s=void 0===a?["/"]:a,o=n.initialIndex,i=void 0===o?0:o,l=n.keyLength,u=void 0===l?6:l,c=S();function d(e){(0,r.Z)(v,e),v.length=v.entries.length,c.notifyListeners(v.location,v.action)}function f(){return Math.random().toString(36).substr(2,u)}var p=P(i,0,s.length-1),g=s.map((function(e){return b(e,void 0,"string"===typeof e?f():e.key||f())})),m=y;function h(e){var n=P(v.index+e,0,v.entries.length-1),r=v.entries[n];c.confirmTransitionTo(r,"POP",t,(function(e){e?d({action:"POP",location:r,index:n}):d()}))}var v={length:g.length,action:"POP",location:g[p],index:p,entries:g,createHref:m,push:function(e,n){var r="PUSH",a=b(e,n,f(),v.location);c.confirmTransitionTo(a,r,t,(function(e){if(e){var n=v.index+1,t=v.entries.slice(0);t.length>n?t.splice(n,t.length-n,a):t.push(a),d({action:r,location:a,index:n,entries:t})}}))},replace:function(e,n){var r="REPLACE",a=b(e,n,f(),v.location);c.confirmTransitionTo(a,r,t,(function(e){e&&(v.entries[v.index]=a,d({action:r,location:a}))}))},go:h,goBack:function(){h(-1)},goForward:function(){h(1)},canGo:function(e){var n=v.index+e;return n>=0&&n<v.entries.length},block:function(e){return void 0===e&&(e=!1),c.setPrompt(e)},listen:function(e){return c.appendListener(e)}};return v}},110:(e,n,t)=>{"use strict";var r=t(309),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},i={};function l(e){return r.isMemo(e)?o:i[e.$$typeof]||a}i[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i[r.Memo]=o;var u=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,g=Object.prototype;e.exports=function e(n,t,r){if("string"!==typeof t){if(g){var a=p(t);a&&a!==g&&e(n,a,r)}var o=c(t);d&&(o=o.concat(d(t)));for(var i=l(n),m=l(t),h=0;h<o.length;++h){var y=o[h];if(!s[y]&&(!r||!r[y])&&(!m||!m[y])&&(!i||!i[y])){var b=f(t,y);try{u(n,y,b)}catch(v){}}}}return n}},746:(e,n)=>{"use strict";var t="function"===typeof Symbol&&Symbol.for,r=t?Symbol.for("react.element"):60103,a=t?Symbol.for("react.portal"):60106,s=t?Symbol.for("react.fragment"):60107,o=t?Symbol.for("react.strict_mode"):60108,i=t?Symbol.for("react.profiler"):60114,l=t?Symbol.for("react.provider"):60109,u=t?Symbol.for("react.context"):60110,c=t?Symbol.for("react.async_mode"):60111,d=t?Symbol.for("react.concurrent_mode"):60111,f=t?Symbol.for("react.forward_ref"):60112,p=t?Symbol.for("react.suspense"):60113,g=t?Symbol.for("react.suspense_list"):60120,m=t?Symbol.for("react.memo"):60115,h=t?Symbol.for("react.lazy"):60116,y=t?Symbol.for("react.block"):60121,b=t?Symbol.for("react.fundamental"):60117,v=t?Symbol.for("react.responder"):60118,S=t?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var n=e.$$typeof;switch(n){case r:switch(e=e.type){case c:case d:case s:case i:case o:case p:return e;default:switch(e=e&&e.$$typeof){case u:case f:case h:case m:case l:return e;default:return n}}case a:return n}}}function _(e){return w(e)===d}n.AsyncMode=c,n.ConcurrentMode=d,n.ContextConsumer=u,n.ContextProvider=l,n.Element=r,n.ForwardRef=f,n.Fragment=s,n.Lazy=h,n.Memo=m,n.Portal=a,n.Profiler=i,n.StrictMode=o,n.Suspense=p,n.isAsyncMode=function(e){return _(e)||w(e)===c},n.isConcurrentMode=_,n.isContextConsumer=function(e){return w(e)===u},n.isContextProvider=function(e){return w(e)===l},n.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},n.isForwardRef=function(e){return w(e)===f},n.isFragment=function(e){return w(e)===s},n.isLazy=function(e){return w(e)===h},n.isMemo=function(e){return w(e)===m},n.isPortal=function(e){return w(e)===a},n.isProfiler=function(e){return w(e)===i},n.isStrictMode=function(e){return w(e)===o},n.isSuspense=function(e){return w(e)===p},n.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===s||e===d||e===i||e===o||e===p||e===g||"object"===typeof e&&null!==e&&(e.$$typeof===h||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===f||e.$$typeof===b||e.$$typeof===v||e.$$typeof===S||e.$$typeof===y)},n.typeOf=w},309:(e,n,t)=>{"use strict";e.exports=t(746)},481:e=>{"use strict";e.exports=function(e,n){return n||(n={}),e?(e=String(e.__esModule?e.default:e),n.hash&&(e+=n.hash),n.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},888:(e,n,t)=>{"use strict";var r=t(47);function a(){}function s(){}s.resetWarningCache=a,e.exports=function(){function e(e,n,t,a,s,o){if(o!==r){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function n(){return e}e.isRequired=e;var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:s,resetWarningCache:a};return t.PropTypes=t,t}},7:(e,n,t)=>{e.exports=t(888)()},47:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},463:(e,n,t)=>{"use strict";var r=t(791),a=t(296);function s(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,t=1;t<arguments.length;t++)n+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,i={};function l(e,n){u(e,n),u(e+"Capture",n)}function u(e,n){for(i[e]=n,e=0;e<n.length;e++)o.add(n[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function m(e,n,t,r,a,s,o){this.acceptsBooleans=2===n||3===n||4===n,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=t,this.propertyName=e,this.type=n,this.sanitizeURL=s,this.removeEmptyString=o}var h={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){h[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var n=e[0];h[n]=new m(n,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){h[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){h[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){h[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){h[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){h[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){h[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){h[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function v(e,n,t,r){var a=h.hasOwnProperty(n)?h[n]:null;(null!==a?0!==a.type:r||!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&(function(e,n,t,r){if(null===n||"undefined"===typeof n||function(e,n,t,r){if(null!==t&&0===t.type)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==t?!t.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,n,t,r))return!0;if(r)return!1;if(null!==t)switch(t.type){case 3:return!n;case 4:return!1===n;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}(n,t,a,r)&&(t=null),r||null===a?function(e){return!!d.call(g,e)||!d.call(p,e)&&(f.test(e)?g[e]=!0:(p[e]=!0,!1))}(n)&&(null===t?e.removeAttribute(n):e.setAttribute(n,""+t)):a.mustUseProperty?e[a.propertyName]=null===t?3!==a.type&&"":t:(n=a.attributeName,r=a.attributeNamespace,null===t?e.removeAttribute(n):(t=3===(a=a.type)||4===a&&!0===t?"":""+t,r?e.setAttributeNS(r,n,t):e.setAttribute(n,t))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var n=e.replace(y,b);h[n]=new m(n,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var n=e.replace(y,b);h[n]=new m(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var n=e.replace(y,b);h[n]=new m(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){h[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),h.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){h[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var S=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),O=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),F=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var L,D=Object.assign;function U(e){if(void 0===L)try{throw Error()}catch(t){var n=t.stack.trim().match(/\n( *(at )?)/);L=n&&n[1]||""}return"\n"+L+e}var j=!1;function z(e,n){if(!e||j)return"";j=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(u){var r=u}Reflect.construct(e,[],n)}else{try{n.call()}catch(u){r=u}e.call(n.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var a=u.stack.split("\n"),s=r.stack.split("\n"),o=a.length-1,i=s.length-1;1<=o&&0<=i&&a[o]!==s[i];)i--;for(;1<=o&&0<=i;o--,i--)if(a[o]!==s[i]){if(1!==o||1!==i)do{if(o--,0>--i||a[o]!==s[i]){var l="\n"+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=i);break}}}finally{j=!1,Error.prepareStackTrace=t}return(e=e?e.displayName||e.name:"")?U(e):""}function B(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case _:return"Portal";case T:return"Profiler";case I:return"StrictMode";case M:return"Suspense";case E:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case O:return(e.displayName||"Context")+".Consumer";case x:return(e._context.displayName||"Context")+".Provider";case C:var n=e.render;return(e=e.displayName)||(e=""!==(e=n.displayName||n.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(n=e.displayName||null)?n:V(e.type)||"Memo";case F:n=e._payload,e=e._init;try{return V(e(n))}catch(t){}}return null}function G(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=n.render).displayName||e.name||"",n.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(n);case 8:return n===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof n)return n.displayName||n.name||null;if("string"===typeof n)return n}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function $(e){var n=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===n||"radio"===n)}function H(e){e._valueTracker||(e._valueTracker=function(e){var n=$(e)?"checked":"value",t=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),r=""+e[n];if(!e.hasOwnProperty(n)&&"undefined"!==typeof t&&"function"===typeof t.get&&"function"===typeof t.set){var a=t.get,s=t.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,n,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}(e))}function K(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var t=n.getValue(),r="";return e&&(r=$(e)?e.checked?"true":"false":e.value),(e=r)!==t&&(n.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(n){return e.body}}function Y(e,n){var t=n.checked;return D({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=t?t:e._wrapperState.initialChecked})}function X(e,n){var t=null==n.defaultValue?"":n.defaultValue,r=null!=n.checked?n.checked:n.defaultChecked;t=W(null!=n.value?n.value:t),e._wrapperState={initialChecked:r,initialValue:t,controlled:"checkbox"===n.type||"radio"===n.type?null!=n.checked:null!=n.value}}function J(e,n){null!=(n=n.checked)&&v(e,"checked",n,!1)}function Q(e,n){J(e,n);var t=W(n.value),r=n.type;if(null!=t)"number"===r?(0===t&&""===e.value||e.value!=t)&&(e.value=""+t):e.value!==""+t&&(e.value=""+t);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");n.hasOwnProperty("value")?ee(e,n.type,t):n.hasOwnProperty("defaultValue")&&ee(e,n.type,W(n.defaultValue)),null==n.checked&&null!=n.defaultChecked&&(e.defaultChecked=!!n.defaultChecked)}function Z(e,n,t){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var r=n.type;if(!("submit"!==r&&"reset"!==r||void 0!==n.value&&null!==n.value))return;n=""+e._wrapperState.initialValue,t||n===e.value||(e.value=n),e.defaultValue=n}""!==(t=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==t&&(e.name=t)}function ee(e,n,t){"number"===n&&q(e.ownerDocument)===e||(null==t?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+t&&(e.defaultValue=""+t))}var ne=Array.isArray;function te(e,n,t,r){if(e=e.options,n){n={};for(var a=0;a<t.length;a++)n["$"+t[a]]=!0;for(t=0;t<e.length;t++)a=n.hasOwnProperty("$"+e[t].value),e[t].selected!==a&&(e[t].selected=a),a&&r&&(e[t].defaultSelected=!0)}else{for(t=""+W(t),n=null,a=0;a<e.length;a++){if(e[a].value===t)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==n||e[a].disabled||(n=e[a])}null!==n&&(n.selected=!0)}}function re(e,n){if(null!=n.dangerouslySetInnerHTML)throw Error(s(91));return D({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,n){var t=n.value;if(null==t){if(t=n.children,n=n.defaultValue,null!=t){if(null!=n)throw Error(s(92));if(ne(t)){if(1<t.length)throw Error(s(93));t=t[0]}n=t}null==n&&(n=""),t=n}e._wrapperState={initialValue:W(t)}}function se(e,n){var t=W(n.value),r=W(n.defaultValue);null!=t&&((t=""+t)!==e.value&&(e.value=t),null==n.defaultValue&&e.defaultValue!==t&&(e.defaultValue=t)),null!=r&&(e.defaultValue=""+r)}function oe(e){var n=e.textContent;n===e._wrapperState.initialValue&&""!==n&&null!==n&&(e.value=n)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,n){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(n):"http://www.w3.org/2000/svg"===e&&"foreignObject"===n?"http://www.w3.org/1999/xhtml":e}var ue,ce,de=(ce=function(e,n){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=n;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,n,t,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,n)}))}:ce);function fe(e,n){if(n){var t=e.firstChild;if(t&&t===e.lastChild&&3===t.nodeType)return void(t.nodeValue=n)}e.textContent=n}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function me(e,n,t){return null==n||"boolean"===typeof n||""===n?"":t||"number"!==typeof n||0===n||pe.hasOwnProperty(e)&&pe[e]?(""+n).trim():n+"px"}function he(e,n){for(var t in e=e.style,n)if(n.hasOwnProperty(t)){var r=0===t.indexOf("--"),a=me(t,n[t],r);"float"===t&&(t="cssFloat"),r?e.setProperty(t,a):e[t]=a}}Object.keys(pe).forEach((function(e){ge.forEach((function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),pe[n]=pe[e]}))}));var ye=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,n){if(n){if(ye[e]&&(null!=n.children||null!=n.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=n.dangerouslySetInnerHTML){if(null!=n.children)throw Error(s(60));if("object"!==typeof n.dangerouslySetInnerHTML||!("__html"in n.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=n.style&&"object"!==typeof n.style)throw Error(s(62))}}function ve(e,n){if(-1===e.indexOf("-"))return"string"===typeof n.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Se=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,ke=null,Ie=null;function Te(e){if(e=va(e)){if("function"!==typeof _e)throw Error(s(280));var n=e.stateNode;n&&(n=wa(n),_e(e.stateNode,e.type,n))}}function xe(e){ke?Ie?Ie.push(e):Ie=[e]:ke=e}function Oe(){if(ke){var e=ke,n=Ie;if(Ie=ke=null,Te(e),n)for(e=0;e<n.length;e++)Te(n[e])}}function Ce(e,n){return e(n)}function Me(){}var Ee=!1;function Ae(e,n,t){if(Ee)return e(n,t);Ee=!0;try{return Ce(e,n,t)}finally{Ee=!1,(null!==ke||null!==Ie)&&(Me(),Oe())}}function Fe(e,n){var t=e.stateNode;if(null===t)return null;var r=wa(t);if(null===r)return null;t=r[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(t&&"function"!==typeof t)throw Error(s(231,n,typeof t));return t}var Pe=!1;if(c)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(ce){Pe=!1}function Re(e,n,t,r,a,s,o,i,l){var u=Array.prototype.slice.call(arguments,3);try{n.apply(t,u)}catch(c){this.onError(c)}}var Le=!1,De=null,Ue=!1,je=null,ze={onError:function(e){Le=!0,De=e}};function Be(e,n,t,r,a,s,o,i,l){Le=!1,De=null,Re.apply(ze,arguments)}function Ve(e){var n=e,t=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do{0!==(4098&(n=e).flags)&&(t=n.return),e=n.return}while(e)}return 3===n.tag?t:null}function Ge(e){if(13===e.tag){var n=e.memoizedState;if(null===n&&(null!==(e=e.alternate)&&(n=e.memoizedState)),null!==n)return n.dehydrated}return null}function We(e){if(Ve(e)!==e)throw Error(s(188))}function $e(e){return null!==(e=function(e){var n=e.alternate;if(!n){if(null===(n=Ve(e)))throw Error(s(188));return n!==e?null:e}for(var t=e,r=n;;){var a=t.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){t=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===t)return We(a),e;if(o===r)return We(a),n;o=o.sibling}throw Error(s(188))}if(t.return!==r.return)t=a,r=o;else{for(var i=!1,l=a.child;l;){if(l===t){i=!0,t=a,r=o;break}if(l===r){i=!0,r=a,t=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===t){i=!0,t=o,r=a;break}if(l===r){i=!0,r=o,t=a;break}l=l.sibling}if(!i)throw Error(s(189))}}if(t.alternate!==r)throw Error(s(190))}if(3!==t.tag)throw Error(s(188));return t.stateNode.current===t?e:n}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var n=He(e);if(null!==n)return n;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,qe=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Xe=a.unstable_requestPaint,Je=a.unstable_now,Qe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,en=a.unstable_UserBlockingPriority,nn=a.unstable_NormalPriority,tn=a.unstable_LowPriority,rn=a.unstable_IdlePriority,an=null,sn=null;var on=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ln(e)/un|0)|0},ln=Math.log,un=Math.LN2;var cn=64,dn=4194304;function fn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pn(e,n){var t=e.pendingLanes;if(0===t)return 0;var r=0,a=e.suspendedLanes,s=e.pingedLanes,o=268435455&t;if(0!==o){var i=o&~a;0!==i?r=fn(i):0!==(s&=o)&&(r=fn(s))}else 0!==(o=t&~a)?r=fn(o):0!==s&&(r=fn(s));if(0===r)return 0;if(0!==n&&n!==r&&0===(n&a)&&((a=r&-r)>=(s=n&-n)||16===a&&0!==(4194240&s)))return n;if(0!==(4&r)&&(r|=16&t),0!==(n=e.entangledLanes))for(e=e.entanglements,n&=r;0<n;)a=1<<(t=31-on(n)),r|=e[t],n&=~a;return r}function gn(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;default:return-1}}function mn(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function hn(){var e=cn;return 0===(4194240&(cn<<=1))&&(cn=64),e}function yn(e){for(var n=[],t=0;31>t;t++)n.push(e);return n}function bn(e,n,t){e.pendingLanes|=n,536870912!==n&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[n=31-on(n)]=t}function vn(e,n){var t=e.entangledLanes|=n;for(e=e.entanglements;t;){var r=31-on(t),a=1<<r;a&n|e[r]&n&&(e[r]|=n),t&=~a}}var Sn=0;function wn(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _n,kn,In,Tn,xn,On=!1,Cn=[],Mn=null,En=null,An=null,Fn=new Map,Pn=new Map,Nn=[],Rn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ln(e,n){switch(e){case"focusin":case"focusout":Mn=null;break;case"dragenter":case"dragleave":En=null;break;case"mouseover":case"mouseout":An=null;break;case"pointerover":case"pointerout":Fn.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pn.delete(n.pointerId)}}function Dn(e,n,t,r,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:n,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},null!==n&&(null!==(n=va(n))&&kn(n)),e):(e.eventSystemFlags|=r,n=e.targetContainers,null!==a&&-1===n.indexOf(a)&&n.push(a),e)}function Un(e){var n=ba(e.target);if(null!==n){var t=Ve(n);if(null!==t)if(13===(n=t.tag)){if(null!==(n=Ge(t)))return e.blockedOn=n,void xn(e.priority,(function(){In(t)}))}else if(3===n&&t.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===t.tag?t.stateNode.containerInfo:null)}e.blockedOn=null}function jn(e){if(null!==e.blockedOn)return!1;for(var n=e.targetContainers;0<n.length;){var t=Xn(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(null!==t)return null!==(n=va(t))&&kn(n),e.blockedOn=t,!1;var r=new(t=e.nativeEvent).constructor(t.type,t);Se=r,t.target.dispatchEvent(r),Se=null,n.shift()}return!0}function zn(e,n,t){jn(e)&&t.delete(n)}function Bn(){On=!1,null!==Mn&&jn(Mn)&&(Mn=null),null!==En&&jn(En)&&(En=null),null!==An&&jn(An)&&(An=null),Fn.forEach(zn),Pn.forEach(zn)}function Vn(e,n){e.blockedOn===n&&(e.blockedOn=null,On||(On=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Bn)))}function Gn(e){function n(n){return Vn(n,e)}if(0<Cn.length){Vn(Cn[0],e);for(var t=1;t<Cn.length;t++){var r=Cn[t];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Mn&&Vn(Mn,e),null!==En&&Vn(En,e),null!==An&&Vn(An,e),Fn.forEach(n),Pn.forEach(n),t=0;t<Nn.length;t++)(r=Nn[t]).blockedOn===e&&(r.blockedOn=null);for(;0<Nn.length&&null===(t=Nn[0]).blockedOn;)Un(t),null===t.blockedOn&&Nn.shift()}var Wn=S.ReactCurrentBatchConfig,$n=!0;function Hn(e,n,t,r){var a=Sn,s=Wn.transition;Wn.transition=null;try{Sn=1,qn(e,n,t,r)}finally{Sn=a,Wn.transition=s}}function Kn(e,n,t,r){var a=Sn,s=Wn.transition;Wn.transition=null;try{Sn=4,qn(e,n,t,r)}finally{Sn=a,Wn.transition=s}}function qn(e,n,t,r){if($n){var a=Xn(e,n,t,r);if(null===a)Wr(e,n,r,Yn,t),Ln(e,r);else if(function(e,n,t,r,a){switch(n){case"focusin":return Mn=Dn(Mn,e,n,t,r,a),!0;case"dragenter":return En=Dn(En,e,n,t,r,a),!0;case"mouseover":return An=Dn(An,e,n,t,r,a),!0;case"pointerover":var s=a.pointerId;return Fn.set(s,Dn(Fn.get(s)||null,e,n,t,r,a)),!0;case"gotpointercapture":return s=a.pointerId,Pn.set(s,Dn(Pn.get(s)||null,e,n,t,r,a)),!0}return!1}(a,e,n,t,r))r.stopPropagation();else if(Ln(e,r),4&n&&-1<Rn.indexOf(e)){for(;null!==a;){var s=va(a);if(null!==s&&_n(s),null===(s=Xn(e,n,t,r))&&Wr(e,n,r,Yn,t),s===a)break;a=s}null!==a&&r.stopPropagation()}else Wr(e,n,r,null,t)}}var Yn=null;function Xn(e,n,t,r){if(Yn=null,null!==(e=ba(e=we(r))))if(null===(n=Ve(e)))e=null;else if(13===(t=n.tag)){if(null!==(e=Ge(n)))return e;e=null}else if(3===t){if(n.stateNode.current.memoizedState.isDehydrated)return 3===n.tag?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Yn=e,null}function Jn(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case en:return 4;case nn:case tn:return 16;case rn:return 536870912;default:return 16}default:return 16}}var Qn=null,Zn=null,et=null;function nt(){if(et)return et;var e,n,t=Zn,r=t.length,a="value"in Qn?Qn.value:Qn.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[s-n];n++);return et=a.slice(e,1<n?1-n:void 0)}function tt(e){var n=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===n&&(e=13):e=n,10===e&&(e=13),32<=e||13===e?e:0}function rt(){return!0}function at(){return!1}function st(e){function n(n,t,r,a,s){for(var o in this._reactName=n,this._targetInst=r,this.type=t,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?rt:at,this.isPropagationStopped=at,this}return D(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rt)},persist:function(){},isPersistent:rt}),n}var ot,it,lt,ut={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ct=st(ut),dt=D({},ut,{view:0,detail:0}),ft=st(dt),pt=D({},dt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tt,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==lt&&(lt&&"mousemove"===e.type?(ot=e.screenX-lt.screenX,it=e.screenY-lt.screenY):it=ot=0,lt=e),ot)},movementY:function(e){return"movementY"in e?e.movementY:it}}),gt=st(pt),mt=st(D({},pt,{dataTransfer:0})),ht=st(D({},dt,{relatedTarget:0})),yt=st(D({},ut,{animationName:0,elapsedTime:0,pseudoElement:0})),bt=D({},ut,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vt=st(bt),St=st(D({},ut,{data:0})),wt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_t={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function It(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):!!(e=kt[e])&&!!n[e]}function Tt(){return It}var xt=D({},dt,{key:function(e){if(e.key){var n=wt[e.key]||e.key;if("Unidentified"!==n)return n}return"keypress"===e.type?13===(e=tt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_t[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tt,charCode:function(e){return"keypress"===e.type?tt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ot=st(xt),Ct=st(D({},pt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mt=st(D({},dt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tt})),Et=st(D({},ut,{propertyName:0,elapsedTime:0,pseudoElement:0})),At=D({},pt,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ft=st(At),Pt=[9,13,27,32],Nt=c&&"CompositionEvent"in window,Rt=null;c&&"documentMode"in document&&(Rt=document.documentMode);var Lt=c&&"TextEvent"in window&&!Rt,Dt=c&&(!Nt||Rt&&8<Rt&&11>=Rt),Ut=String.fromCharCode(32),jt=!1;function zt(e,n){switch(e){case"keyup":return-1!==Pt.indexOf(n.keyCode);case"keydown":return 229!==n.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bt(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vt=!1;var Gt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wt(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===n?!!Gt[e.type]:"textarea"===n}function $t(e,n,t,r){xe(r),0<(n=Hr(n,"onChange")).length&&(t=new ct("onChange","change",null,t,r),e.push({event:t,listeners:n}))}var Ht=null,Kt=null;function qt(e){Ur(e,0)}function Yt(e){if(K(Sa(e)))return e}function Xt(e,n){if("change"===e)return n}var Jt=!1;if(c){var Qt;if(c){var Zt="oninput"in document;if(!Zt){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zt="function"===typeof er.oninput}Qt=Zt}else Qt=!1;Jt=Qt&&(!document.documentMode||9<document.documentMode)}function nr(){Ht&&(Ht.detachEvent("onpropertychange",tr),Kt=Ht=null)}function tr(e){if("value"===e.propertyName&&Yt(Kt)){var n=[];$t(n,Kt,e,we(e)),Ae(qt,n)}}function rr(e,n,t){"focusin"===e?(nr(),Kt=t,(Ht=n).attachEvent("onpropertychange",tr)):"focusout"===e&&nr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yt(Kt)}function sr(e,n){if("click"===e)return Yt(n)}function or(e,n){if("input"===e||"change"===e)return Yt(n)}var ir="function"===typeof Object.is?Object.is:function(e,n){return e===n&&(0!==e||1/e===1/n)||e!==e&&n!==n};function lr(e,n){if(ir(e,n))return!0;if("object"!==typeof e||null===e||"object"!==typeof n||null===n)return!1;var t=Object.keys(e),r=Object.keys(n);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var a=t[r];if(!d.call(n,a)||!ir(e[a],n[a]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,n){var t,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(t=e+r.textContent.length,e<=n&&t>=n)return{node:r,offset:n-e};e=t}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,n){return!(!e||!n)&&(e===n||(!e||3!==e.nodeType)&&(n&&3===n.nodeType?dr(e,n.parentNode):"contains"in e?e.contains(n):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(n))))}function fr(){for(var e=window,n=q();n instanceof e.HTMLIFrameElement;){try{var t="string"===typeof n.contentWindow.location.href}catch(r){t=!1}if(!t)break;n=q((e=n.contentWindow).document)}return n}function pr(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&("input"===n&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===n||"true"===e.contentEditable)}function gr(e){var n=fr(),t=e.focusedElem,r=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&dr(t.ownerDocument.documentElement,t)){if(null!==r&&pr(t))if(n=r.start,void 0===(e=r.end)&&(e=n),"selectionStart"in t)t.selectionStart=n,t.selectionEnd=Math.min(e,t.value.length);else if((e=(n=t.ownerDocument||document)&&n.defaultView||window).getSelection){e=e.getSelection();var a=t.textContent.length,s=Math.min(r.start,a);r=void 0===r.end?s:Math.min(r.end,a),!e.extend&&s>r&&(a=r,r=s,s=a),a=cr(t,s);var o=cr(t,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((n=n.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),s>r?(e.addRange(n),e.extend(o.node,o.offset)):(n.setEnd(o.node,o.offset),e.addRange(n)))}for(n=[],e=t;e=e.parentNode;)1===e.nodeType&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof t.focus&&t.focus(),t=0;t<n.length;t++)(e=n[t]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,hr=null,yr=null,br=null,vr=!1;function Sr(e,n,t){var r=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;vr||null==hr||hr!==q(r)||("selectionStart"in(r=hr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&lr(br,r)||(br=r,0<(r=Hr(yr,"onSelect")).length&&(n=new ct("onSelect","select",null,n,t),e.push({event:n,listeners:r}),n.target=hr)))}function wr(e,n){var t={};return t[e.toLowerCase()]=n.toLowerCase(),t["Webkit"+e]="webkit"+n,t["Moz"+e]="moz"+n,t}var _r={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},kr={},Ir={};function Tr(e){if(kr[e])return kr[e];if(!_r[e])return e;var n,t=_r[e];for(n in t)if(t.hasOwnProperty(n)&&n in Ir)return kr[e]=t[n];return e}c&&(Ir=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var xr=Tr("animationend"),Or=Tr("animationiteration"),Cr=Tr("animationstart"),Mr=Tr("transitionend"),Er=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fr(e,n){Er.set(e,n),l(n,[e])}for(var Pr=0;Pr<Ar.length;Pr++){var Nr=Ar[Pr];Fr(Nr.toLowerCase(),"on"+(Nr[0].toUpperCase()+Nr.slice(1)))}Fr(xr,"onAnimationEnd"),Fr(Or,"onAnimationIteration"),Fr(Cr,"onAnimationStart"),Fr("dblclick","onDoubleClick"),Fr("focusin","onFocus"),Fr("focusout","onBlur"),Fr(Mr,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Dr(e,n,t){var r=e.type||"unknown-event";e.currentTarget=t,function(e,n,t,r,a,o,i,l,u){if(Be.apply(this,arguments),Le){if(!Le)throw Error(s(198));var c=De;Le=!1,De=null,Ue||(Ue=!0,je=c)}}(r,n,void 0,e),e.currentTarget=null}function Ur(e,n){n=0!==(4&n);for(var t=0;t<e.length;t++){var r=e[t],a=r.event;r=r.listeners;e:{var s=void 0;if(n)for(var o=r.length-1;0<=o;o--){var i=r[o],l=i.instance,u=i.currentTarget;if(i=i.listener,l!==s&&a.isPropagationStopped())break e;Dr(a,i,u),s=l}else for(o=0;o<r.length;o++){if(l=(i=r[o]).instance,u=i.currentTarget,i=i.listener,l!==s&&a.isPropagationStopped())break e;Dr(a,i,u),s=l}}}if(Ue)throw e=je,Ue=!1,je=null,e}function jr(e,n){var t=n[ma];void 0===t&&(t=n[ma]=new Set);var r=e+"__bubble";t.has(r)||(Gr(n,e,2,!1),t.add(r))}function zr(e,n,t){var r=0;n&&(r|=4),Gr(t,e,r,n)}var Br="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Br]){e[Br]=!0,o.forEach((function(n){"selectionchange"!==n&&(Lr.has(n)||zr(n,!1,e),zr(n,!0,e))}));var n=9===e.nodeType?e:e.ownerDocument;null===n||n[Br]||(n[Br]=!0,zr("selectionchange",!1,n))}}function Gr(e,n,t,r){switch(Jn(n)){case 1:var a=Hn;break;case 4:a=Kn;break;default:a=qn}t=a.bind(null,n,t,e),a=void 0,!Pe||"touchstart"!==n&&"touchmove"!==n&&"wheel"!==n||(a=!0),r?void 0!==a?e.addEventListener(n,t,{capture:!0,passive:a}):e.addEventListener(n,t,!0):void 0!==a?e.addEventListener(n,t,{passive:a}):e.addEventListener(n,t,!1)}function Wr(e,n,t,r,a){var s=r;if(0===(1&n)&&0===(2&n)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var i=r.stateNode.containerInfo;if(i===a||8===i.nodeType&&i.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;o=o.return}for(;null!==i;){if(null===(o=ba(i)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}i=i.parentNode}}r=r.return}Ae((function(){var r=s,a=we(t),o=[];e:{var i=Er.get(e);if(void 0!==i){var l=ct,u=e;switch(e){case"keypress":if(0===tt(t))break e;case"keydown":case"keyup":l=Ot;break;case"focusin":u="focus",l=ht;break;case"focusout":u="blur",l=ht;break;case"beforeblur":case"afterblur":l=ht;break;case"click":if(2===t.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=gt;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mt;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Mt;break;case xr:case Or:case Cr:l=yt;break;case Mr:l=Et;break;case"scroll":l=ft;break;case"wheel":l=Ft;break;case"copy":case"cut":case"paste":l=vt;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ct}var c=0!==(4&n),d=!c&&"scroll"===e,f=c?null!==i?i+"Capture":null:i;c=[];for(var p,g=r;null!==g;){var m=(p=g).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==f&&(null!=(m=Fe(g,f))&&c.push($r(g,m,p)))),d)break;g=g.return}0<c.length&&(i=new l(i,u,null,t,a),o.push({event:i,listeners:c}))}}if(0===(7&n)){if(l="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||t===Se||!(u=t.relatedTarget||t.fromElement)||!ba(u)&&!u[ga])&&(l||i)&&(i=a.window===a?a:(i=a.ownerDocument)?i.defaultView||i.parentWindow:window,l?(l=r,null!==(u=(u=t.relatedTarget||t.toElement)?ba(u):null)&&(u!==(d=Ve(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=gt,m="onMouseLeave",f="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(c=Ct,m="onPointerLeave",f="onPointerEnter",g="pointer"),d=null==l?i:Sa(l),p=null==u?i:Sa(u),(i=new c(m,g+"leave",l,t,a)).target=d,i.relatedTarget=p,m=null,ba(a)===r&&((c=new c(f,g+"enter",u,t,a)).target=p,c.relatedTarget=d,m=c),d=m,l&&u)e:{for(f=u,g=0,p=c=l;p;p=Kr(p))g++;for(p=0,m=f;m;m=Kr(m))p++;for(;0<g-p;)c=Kr(c),g--;for(;0<p-g;)f=Kr(f),p--;for(;g--;){if(c===f||null!==f&&c===f.alternate)break e;c=Kr(c),f=Kr(f)}c=null}else c=null;null!==l&&qr(o,i,l,c,!1),null!==u&&null!==d&&qr(o,d,u,c,!0)}if("select"===(l=(i=r?Sa(r):window).nodeName&&i.nodeName.toLowerCase())||"input"===l&&"file"===i.type)var h=Xt;else if(Wt(i))if(Jt)h=or;else{h=ar;var y=rr}else(l=i.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(h=sr);switch(h&&(h=h(e,r))?$t(o,h,t,a):(y&&y(e,i,r),"focusout"===e&&(y=i._wrapperState)&&y.controlled&&"number"===i.type&&ee(i,"number",i.value)),y=r?Sa(r):window,e){case"focusin":(Wt(y)||"true"===y.contentEditable)&&(hr=y,yr=r,br=null);break;case"focusout":br=yr=hr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,Sr(o,t,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":Sr(o,t,a)}var b;if(Nt)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Vt?zt(e,t)&&(v="onCompositionEnd"):"keydown"===e&&229===t.keyCode&&(v="onCompositionStart");v&&(Dt&&"ko"!==t.locale&&(Vt||"onCompositionStart"!==v?"onCompositionEnd"===v&&Vt&&(b=nt()):(Zn="value"in(Qn=a)?Qn.value:Qn.textContent,Vt=!0)),0<(y=Hr(r,v)).length&&(v=new St(v,e,null,t,a),o.push({event:v,listeners:y}),b?v.data=b:null!==(b=Bt(t))&&(v.data=b))),(b=Lt?function(e,n){switch(e){case"compositionend":return Bt(n);case"keypress":return 32!==n.which?null:(jt=!0,Ut);case"textInput":return(e=n.data)===Ut&&jt?null:e;default:return null}}(e,t):function(e,n){if(Vt)return"compositionend"===e||!Nt&&zt(e,n)?(e=nt(),et=Zn=Qn=null,Vt=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Dt&&"ko"!==n.locale?null:n.data}}(e,t))&&(0<(r=Hr(r,"onBeforeInput")).length&&(a=new St("onBeforeInput","beforeinput",null,t,a),o.push({event:a,listeners:r}),a.data=b))}Ur(o,n)}))}function $r(e,n,t){return{instance:e,listener:n,currentTarget:t}}function Hr(e,n){for(var t=n+"Capture",r=[];null!==e;){var a=e,s=a.stateNode;5===a.tag&&null!==s&&(a=s,null!=(s=Fe(e,t))&&r.unshift($r(e,s,a)),null!=(s=Fe(e,n))&&r.push($r(e,s,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qr(e,n,t,r,a){for(var s=n._reactName,o=[];null!==t&&t!==r;){var i=t,l=i.alternate,u=i.stateNode;if(null!==l&&l===r)break;5===i.tag&&null!==u&&(i=u,a?null!=(l=Fe(t,s))&&o.unshift($r(t,l,i)):a||null!=(l=Fe(t,s))&&o.push($r(t,l,i))),t=t.return}0!==o.length&&e.push({event:n,listeners:o})}var Yr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Xr,"")}function Qr(e,n,t){if(n=Jr(n),Jr(e)!==n&&t)throw Error(s(425))}function Zr(){}var ea=null,na=null;function ta(e,n){return"textarea"===e||"noscript"===e||"string"===typeof n.children||"number"===typeof n.children||"object"===typeof n.dangerouslySetInnerHTML&&null!==n.dangerouslySetInnerHTML&&null!=n.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,sa="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sa?function(e){return sa.resolve(null).then(e).catch(ia)}:ra;function ia(e){setTimeout((function(){throw e}))}function la(e,n){var t=n,r=0;do{var a=t.nextSibling;if(e.removeChild(t),a&&8===a.nodeType)if("/$"===(t=a.data)){if(0===r)return e.removeChild(a),void Gn(n);r--}else"$"!==t&&"$?"!==t&&"$!"!==t||r++;t=a}while(t);Gn(n)}function ua(e){for(;null!=e;e=e.nextSibling){var n=e.nodeType;if(1===n||3===n)break;if(8===n){if("$"===(n=e.data)||"$!"===n||"$?"===n)break;if("/$"===n)return null}}return e}function ca(e){e=e.previousSibling;for(var n=0;e;){if(8===e.nodeType){var t=e.data;if("$"===t||"$!"===t||"$?"===t){if(0===n)return e;n--}else"/$"===t&&n++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),fa="__reactFiber$"+da,pa="__reactProps$"+da,ga="__reactContainer$"+da,ma="__reactEvents$"+da,ha="__reactListeners$"+da,ya="__reactHandles$"+da;function ba(e){var n=e[fa];if(n)return n;for(var t=e.parentNode;t;){if(n=t[ga]||t[fa]){if(t=n.alternate,null!==n.child||null!==t&&null!==t.child)for(e=ca(e);null!==e;){if(t=e[fa])return t;e=ca(e)}return n}t=(e=t).parentNode}return null}function va(e){return!(e=e[fa]||e[ga])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Sa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wa(e){return e[pa]||null}var _a=[],ka=-1;function Ia(e){return{current:e}}function Ta(e){0>ka||(e.current=_a[ka],_a[ka]=null,ka--)}function xa(e,n){ka++,_a[ka]=e.current,e.current=n}var Oa={},Ca=Ia(Oa),Ma=Ia(!1),Ea=Oa;function Aa(e,n){var t=e.type.contextTypes;if(!t)return Oa;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===n)return r.__reactInternalMemoizedMaskedChildContext;var a,s={};for(a in t)s[a]=n[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),s}function Fa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pa(){Ta(Ma),Ta(Ca)}function Na(e,n,t){if(Ca.current!==Oa)throw Error(s(168));xa(Ca,n),xa(Ma,t)}function Ra(e,n,t){var r=e.stateNode;if(n=n.childContextTypes,"function"!==typeof r.getChildContext)return t;for(var a in r=r.getChildContext())if(!(a in n))throw Error(s(108,G(e)||"Unknown",a));return D({},t,r)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Oa,Ea=Ca.current,xa(Ca,e),xa(Ma,Ma.current),!0}function Da(e,n,t){var r=e.stateNode;if(!r)throw Error(s(169));t?(e=Ra(e,n,Ea),r.__reactInternalMemoizedMergedChildContext=e,Ta(Ma),Ta(Ca),xa(Ca,e)):Ta(Ma),xa(Ma,t)}var Ua=null,ja=!1,za=!1;function Ba(e){null===Ua?Ua=[e]:Ua.push(e)}function Va(){if(!za&&null!==Ua){za=!0;var e=0,n=Sn;try{var t=Ua;for(Sn=1;e<t.length;e++){var r=t[e];do{r=r(!0)}while(null!==r)}Ua=null,ja=!1}catch(a){throw null!==Ua&&(Ua=Ua.slice(e+1)),Ke(Ze,Va),a}finally{Sn=n,za=!1}}return null}var Ga=[],Wa=0,$a=null,Ha=0,Ka=[],qa=0,Ya=null,Xa=1,Ja="";function Qa(e,n){Ga[Wa++]=Ha,Ga[Wa++]=$a,$a=e,Ha=n}function Za(e,n,t){Ka[qa++]=Xa,Ka[qa++]=Ja,Ka[qa++]=Ya,Ya=e;var r=Xa;e=Ja;var a=32-on(r)-1;r&=~(1<<a),t+=1;var s=32-on(n)+a;if(30<s){var o=a-a%5;s=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Xa=1<<32-on(n)+a|t<<a|r,Ja=s+e}else Xa=1<<s|t<<a|r,Ja=e}function es(e){null!==e.return&&(Qa(e,1),Za(e,1,0))}function ns(e){for(;e===$a;)$a=Ga[--Wa],Ga[Wa]=null,Ha=Ga[--Wa],Ga[Wa]=null;for(;e===Ya;)Ya=Ka[--qa],Ka[qa]=null,Ja=Ka[--qa],Ka[qa]=null,Xa=Ka[--qa],Ka[qa]=null}var ts=null,rs=null,as=!1,ss=null;function os(e,n){var t=Fu(5,null,null,0);t.elementType="DELETED",t.stateNode=n,t.return=e,null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)}function is(e,n){switch(e.tag){case 5:var t=e.type;return null!==(n=1!==n.nodeType||t.toLowerCase()!==n.nodeName.toLowerCase()?null:n)&&(e.stateNode=n,ts=e,rs=ua(n.firstChild),!0);case 6:return null!==(n=""===e.pendingProps||3!==n.nodeType?null:n)&&(e.stateNode=n,ts=e,rs=null,!0);case 13:return null!==(n=8!==n.nodeType?null:n)&&(t=null!==Ya?{id:Xa,overflow:Ja}:null,e.memoizedState={dehydrated:n,treeContext:t,retryLane:1073741824},(t=Fu(18,null,null,0)).stateNode=n,t.return=e,e.child=t,ts=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(as){var n=rs;if(n){var t=n;if(!is(e,n)){if(ls(e))throw Error(s(418));n=ua(t.nextSibling);var r=ts;n&&is(e,n)?os(r,t):(e.flags=-4097&e.flags|2,as=!1,ts=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,as=!1,ts=e}}}function cs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ts=e}function ds(e){if(e!==ts)return!1;if(!as)return cs(e),as=!0,!1;var n;if((n=3!==e.tag)&&!(n=5!==e.tag)&&(n="head"!==(n=e.type)&&"body"!==n&&!ta(e.type,e.memoizedProps)),n&&(n=rs)){if(ls(e))throw fs(),Error(s(418));for(;n;)os(e,n),n=ua(n.nextSibling)}if(cs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType){var t=e.data;if("/$"===t){if(0===n){rs=ua(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++}e=e.nextSibling}rs=null}}else rs=ts?ua(e.stateNode.nextSibling):null;return!0}function fs(){for(var e=rs;e;)e=ua(e.nextSibling)}function ps(){rs=ts=null,as=!1}function gs(e){null===ss?ss=[e]:ss.push(e)}var ms=S.ReactCurrentBatchConfig;function hs(e,n){if(e&&e.defaultProps){for(var t in n=D({},n),e=e.defaultProps)void 0===n[t]&&(n[t]=e[t]);return n}return n}var ys=Ia(null),bs=null,vs=null,Ss=null;function ws(){Ss=vs=bs=null}function _s(e){var n=ys.current;Ta(ys),e._currentValue=n}function ks(e,n,t){for(;null!==e;){var r=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,null!==r&&(r.childLanes|=n)):null!==r&&(r.childLanes&n)!==n&&(r.childLanes|=n),e===t)break;e=e.return}}function Is(e,n){bs=e,Ss=vs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&n)&&(Si=!0),e.firstContext=null)}function Ts(e){var n=e._currentValue;if(Ss!==e)if(e={context:e,memoizedValue:n,next:null},null===vs){if(null===bs)throw Error(s(308));vs=e,bs.dependencies={lanes:0,firstContext:e}}else vs=vs.next=e;return n}var xs=null;function Os(e){null===xs?xs=[e]:xs.push(e)}function Cs(e,n,t,r){var a=n.interleaved;return null===a?(t.next=t,Os(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ms(e,r)}function Ms(e,n){e.lanes|=n;var t=e.alternate;for(null!==t&&(t.lanes|=n),t=e,e=e.return;null!==e;)e.childLanes|=n,null!==(t=e.alternate)&&(t.childLanes|=n),t=e,e=e.return;return 3===t.tag?t.stateNode:null}var Es=!1;function As(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ps(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Ns(e,n,t){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Ml)){var a=r.pending;return null===a?n.next=n:(n.next=a.next,a.next=n),r.pending=n,Ms(e,t)}return null===(a=r.interleaved)?(n.next=n,Os(r)):(n.next=a.next,a.next=n),r.interleaved=n,Ms(e,t)}function Rs(e,n,t){if(null!==(n=n.updateQueue)&&(n=n.shared,0!==(4194240&t))){var r=n.lanes;t|=r&=e.pendingLanes,n.lanes=t,vn(e,t)}}function Ls(e,n){var t=e.updateQueue,r=e.alternate;if(null!==r&&t===(r=r.updateQueue)){var a=null,s=null;if(null!==(t=t.firstBaseUpdate)){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};null===s?a=s=o:s=s.next=o,t=t.next}while(null!==t);null===s?a=s=n:s=s.next=n}else a=s=n;return t={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=t)}null===(e=t.lastBaseUpdate)?t.firstBaseUpdate=n:e.next=n,t.lastBaseUpdate=n}function Ds(e,n,t,r){var a=e.updateQueue;Es=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var l=i,u=l.next;l.next=null,null===o?s=u:o.next=u,o=l;var c=e.alternate;null!==c&&((i=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===i?c.firstBaseUpdate=u:i.next=u,c.lastBaseUpdate=l))}if(null!==s){var d=a.baseState;for(o=0,c=u=l=null,i=s;;){var f=i.lane,p=i.eventTime;if((r&f)===f){null!==c&&(c=c.next={eventTime:p,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var g=e,m=i;switch(f=n,p=t,m.tag){case 1:if("function"===typeof(g=m.payload)){d=g.call(p,d,f);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(f="function"===typeof(g=m.payload)?g.call(p,d,f):g)||void 0===f)break e;d=D({},d,f);break e;case 2:Es=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(f=a.effects)?a.effects=[i]:f.push(i))}else p={eventTime:p,lane:f,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===c?(u=c=p,l=d):c=c.next=p,o|=f;if(null===(i=i.next)){if(null===(i=a.shared.pending))break;i=(f=i).next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}if(null===c&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=c,null!==(n=a.shared.interleaved)){a=n;do{o|=a.lane,a=a.next}while(a!==n)}else null===s&&(a.shared.lanes=0);Dl|=o,e.lanes=o,e.memoizedState=d}}function Us(e,n,t){if(e=n.effects,n.effects=null,null!==e)for(n=0;n<e.length;n++){var r=e[n],a=r.callback;if(null!==a){if(r.callback=null,r=t,"function"!==typeof a)throw Error(s(191,a));a.call(r)}}}var js=(new r.Component).refs;function zs(e,n,t,r){t=null===(t=t(r,n=e.memoizedState))||void 0===t?n:D({},n,t),e.memoizedState=t,0===e.lanes&&(e.updateQueue.baseState=t)}var Bs={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,n,t){e=e._reactInternals;var r=nu(),a=tu(e),s=Ps(r,a);s.payload=n,void 0!==t&&null!==t&&(s.callback=t),null!==(n=Ns(e,s,a))&&(ru(n,e,a,r),Rs(n,e,a))},enqueueReplaceState:function(e,n,t){e=e._reactInternals;var r=nu(),a=tu(e),s=Ps(r,a);s.tag=1,s.payload=n,void 0!==t&&null!==t&&(s.callback=t),null!==(n=Ns(e,s,a))&&(ru(n,e,a,r),Rs(n,e,a))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var t=nu(),r=tu(e),a=Ps(t,r);a.tag=2,void 0!==n&&null!==n&&(a.callback=n),null!==(n=Ns(e,a,r))&&(ru(n,e,r,t),Rs(n,e,r))}};function Vs(e,n,t,r,a,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!n.prototype||!n.prototype.isPureReactComponent||(!lr(t,r)||!lr(a,s))}function Gs(e,n,t){var r=!1,a=Oa,s=n.contextType;return"object"===typeof s&&null!==s?s=Ts(s):(a=Fa(n)?Ea:Ca.current,s=(r=null!==(r=n.contextTypes)&&void 0!==r)?Aa(e,a):Oa),n=new n(t,s),e.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,n.updater=Bs,e.stateNode=n,n._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),n}function Ws(e,n,t,r){e=n.state,"function"===typeof n.componentWillReceiveProps&&n.componentWillReceiveProps(t,r),"function"===typeof n.UNSAFE_componentWillReceiveProps&&n.UNSAFE_componentWillReceiveProps(t,r),n.state!==e&&Bs.enqueueReplaceState(n,n.state,null)}function $s(e,n,t,r){var a=e.stateNode;a.props=t,a.state=e.memoizedState,a.refs=js,As(e);var s=n.contextType;"object"===typeof s&&null!==s?a.context=Ts(s):(s=Fa(n)?Ea:Ca.current,a.context=Aa(e,s)),a.state=e.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(zs(e,n,s,t),a.state=e.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(n=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),n!==a.state&&Bs.enqueueReplaceState(a,a.state,null),Ds(e,t,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function Hs(e,n,t){if(null!==(e=t.ref)&&"function"!==typeof e&&"object"!==typeof e){if(t._owner){if(t=t._owner){if(1!==t.tag)throw Error(s(309));var r=t.stateNode}if(!r)throw Error(s(147,e));var a=r,o=""+e;return null!==n&&null!==n.ref&&"function"===typeof n.ref&&n.ref._stringRef===o?n.ref:(n=function(e){var n=a.refs;n===js&&(n=a.refs={}),null===e?delete n[o]:n[o]=e},n._stringRef=o,n)}if("string"!==typeof e)throw Error(s(284));if(!t._owner)throw Error(s(290,e))}return e}function Ks(e,n){throw e=Object.prototype.toString.call(n),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function qs(e){return(0,e._init)(e._payload)}function Ys(e){function n(n,t){if(e){var r=n.deletions;null===r?(n.deletions=[t],n.flags|=16):r.push(t)}}function t(t,r){if(!e)return null;for(;null!==r;)n(t,r),r=r.sibling;return null}function r(e,n){for(e=new Map;null!==n;)null!==n.key?e.set(n.key,n):e.set(n.index,n),n=n.sibling;return e}function a(e,n){return(e=Nu(e,n)).index=0,e.sibling=null,e}function o(n,t,r){return n.index=r,e?null!==(r=n.alternate)?(r=r.index)<t?(n.flags|=2,t):r:(n.flags|=2,t):(n.flags|=1048576,t)}function i(n){return e&&null===n.alternate&&(n.flags|=2),n}function l(e,n,t,r){return null===n||6!==n.tag?((n=Uu(t,e.mode,r)).return=e,n):((n=a(n,t)).return=e,n)}function u(e,n,t,r){var s=t.type;return s===k?d(e,n,t.props.children,r,t.key):null!==n&&(n.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===F&&qs(s)===n.type)?((r=a(n,t.props)).ref=Hs(e,n,t),r.return=e,r):((r=Ru(t.type,t.key,t.props,null,e.mode,r)).ref=Hs(e,n,t),r.return=e,r)}function c(e,n,t,r){return null===n||4!==n.tag||n.stateNode.containerInfo!==t.containerInfo||n.stateNode.implementation!==t.implementation?((n=ju(t,e.mode,r)).return=e,n):((n=a(n,t.children||[])).return=e,n)}function d(e,n,t,r,s){return null===n||7!==n.tag?((n=Lu(t,e.mode,r,s)).return=e,n):((n=a(n,t)).return=e,n)}function f(e,n,t){if("string"===typeof n&&""!==n||"number"===typeof n)return(n=Uu(""+n,e.mode,t)).return=e,n;if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return(t=Ru(n.type,n.key,n.props,null,e.mode,t)).ref=Hs(e,null,n),t.return=e,t;case _:return(n=ju(n,e.mode,t)).return=e,n;case F:return f(e,(0,n._init)(n._payload),t)}if(ne(n)||R(n))return(n=Lu(n,e.mode,t,null)).return=e,n;Ks(e,n)}return null}function p(e,n,t,r){var a=null!==n?n.key:null;if("string"===typeof t&&""!==t||"number"===typeof t)return null!==a?null:l(e,n,""+t,r);if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return t.key===a?u(e,n,t,r):null;case _:return t.key===a?c(e,n,t,r):null;case F:return p(e,n,(a=t._init)(t._payload),r)}if(ne(t)||R(t))return null!==a?null:d(e,n,t,r,null);Ks(e,t)}return null}function g(e,n,t,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(n,e=e.get(t)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return u(n,e=e.get(null===r.key?t:r.key)||null,r,a);case _:return c(n,e=e.get(null===r.key?t:r.key)||null,r,a);case F:return g(e,n,t,(0,r._init)(r._payload),a)}if(ne(r)||R(r))return d(n,e=e.get(t)||null,r,a,null);Ks(n,r)}return null}function m(a,s,i,l){for(var u=null,c=null,d=s,m=s=0,h=null;null!==d&&m<i.length;m++){d.index>m?(h=d,d=null):h=d.sibling;var y=p(a,d,i[m],l);if(null===y){null===d&&(d=h);break}e&&d&&null===y.alternate&&n(a,d),s=o(y,s,m),null===c?u=y:c.sibling=y,c=y,d=h}if(m===i.length)return t(a,d),as&&Qa(a,m),u;if(null===d){for(;m<i.length;m++)null!==(d=f(a,i[m],l))&&(s=o(d,s,m),null===c?u=d:c.sibling=d,c=d);return as&&Qa(a,m),u}for(d=r(a,d);m<i.length;m++)null!==(h=g(d,a,m,i[m],l))&&(e&&null!==h.alternate&&d.delete(null===h.key?m:h.key),s=o(h,s,m),null===c?u=h:c.sibling=h,c=h);return e&&d.forEach((function(e){return n(a,e)})),as&&Qa(a,m),u}function h(a,i,l,u){var c=R(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var d=c=null,m=i,h=i=0,y=null,b=l.next();null!==m&&!b.done;h++,b=l.next()){m.index>h?(y=m,m=null):y=m.sibling;var v=p(a,m,b.value,u);if(null===v){null===m&&(m=y);break}e&&m&&null===v.alternate&&n(a,m),i=o(v,i,h),null===d?c=v:d.sibling=v,d=v,m=y}if(b.done)return t(a,m),as&&Qa(a,h),c;if(null===m){for(;!b.done;h++,b=l.next())null!==(b=f(a,b.value,u))&&(i=o(b,i,h),null===d?c=b:d.sibling=b,d=b);return as&&Qa(a,h),c}for(m=r(a,m);!b.done;h++,b=l.next())null!==(b=g(m,a,h,b.value,u))&&(e&&null!==b.alternate&&m.delete(null===b.key?h:b.key),i=o(b,i,h),null===d?c=b:d.sibling=b,d=b);return e&&m.forEach((function(e){return n(a,e)})),as&&Qa(a,h),c}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===k&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var u=o.key,c=s;null!==c;){if(c.key===u){if((u=o.type)===k){if(7===c.tag){t(r,c.sibling),(s=a(c,o.props.children)).return=r,r=s;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===F&&qs(u)===c.type){t(r,c.sibling),(s=a(c,o.props)).ref=Hs(r,c,o),s.return=r,r=s;break e}t(r,c);break}n(r,c),c=c.sibling}o.type===k?((s=Lu(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Ru(o.type,o.key,o.props,null,r.mode,l)).ref=Hs(r,s,o),l.return=r,r=l)}return i(r);case _:e:{for(c=o.key;null!==s;){if(s.key===c){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){t(r,s.sibling),(s=a(s,o.children||[])).return=r,r=s;break e}t(r,s);break}n(r,s),s=s.sibling}(s=ju(o,r.mode,l)).return=r,r=s}return i(r);case F:return e(r,s,(c=o._init)(o._payload),l)}if(ne(o))return m(r,s,o,l);if(R(o))return h(r,s,o,l);Ks(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(t(r,s.sibling),(s=a(s,o)).return=r,r=s):(t(r,s),(s=Uu(o,r.mode,l)).return=r,r=s),i(r)):t(r,s)}}var Xs=Ys(!0),Js=Ys(!1),Qs={},Zs=Ia(Qs),eo=Ia(Qs),no=Ia(Qs);function to(e){if(e===Qs)throw Error(s(174));return e}function ro(e,n){switch(xa(no,n),xa(eo,e),xa(Zs,Qs),e=n.nodeType){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:le(null,"");break;default:n=le(n=(e=8===e?n.parentNode:n).namespaceURI||null,e=e.tagName)}Ta(Zs),xa(Zs,n)}function ao(){Ta(Zs),Ta(eo),Ta(no)}function so(e){to(no.current);var n=to(Zs.current),t=le(n,e.type);n!==t&&(xa(eo,e),xa(Zs,t))}function oo(e){eo.current===e&&(Ta(Zs),Ta(eo))}var io=Ia(0);function lo(e){for(var n=e;null!==n;){if(13===n.tag){var t=n.memoizedState;if(null!==t&&(null===(t=t.dehydrated)||"$?"===t.data||"$!"===t.data))return n}else if(19===n.tag&&void 0!==n.memoizedProps.revealOrder){if(0!==(128&n.flags))return n}else if(null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var uo=[];function co(){for(var e=0;e<uo.length;e++)uo[e]._workInProgressVersionPrimary=null;uo.length=0}var fo=S.ReactCurrentDispatcher,po=S.ReactCurrentBatchConfig,go=0,mo=null,ho=null,yo=null,bo=!1,vo=!1,So=0,wo=0;function _o(){throw Error(s(321))}function ko(e,n){if(null===n)return!1;for(var t=0;t<n.length&&t<e.length;t++)if(!ir(e[t],n[t]))return!1;return!0}function Io(e,n,t,r,a,o){if(go=o,mo=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,fo.current=null===e||null===e.memoizedState?ii:li,e=t(r,a),vo){o=0;do{if(vo=!1,So=0,25<=o)throw Error(s(301));o+=1,yo=ho=null,n.updateQueue=null,fo.current=ui,e=t(r,a)}while(vo)}if(fo.current=oi,n=null!==ho&&null!==ho.next,go=0,yo=ho=mo=null,bo=!1,n)throw Error(s(300));return e}function To(){var e=0!==So;return So=0,e}function xo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yo?mo.memoizedState=yo=e:yo=yo.next=e,yo}function Oo(){if(null===ho){var e=mo.alternate;e=null!==e?e.memoizedState:null}else e=ho.next;var n=null===yo?mo.memoizedState:yo.next;if(null!==n)yo=n,ho=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ho=e).memoizedState,baseState:ho.baseState,baseQueue:ho.baseQueue,queue:ho.queue,next:null},null===yo?mo.memoizedState=yo=e:yo=yo.next=e}return yo}function Co(e,n){return"function"===typeof n?n(e):n}function Mo(e){var n=Oo(),t=n.queue;if(null===t)throw Error(s(311));t.lastRenderedReducer=e;var r=ho,a=r.baseQueue,o=t.pending;if(null!==o){if(null!==a){var i=a.next;a.next=o.next,o.next=i}r.baseQueue=a=o,t.pending=null}if(null!==a){o=a.next,r=r.baseState;var l=i=null,u=null,c=o;do{var d=c.lane;if((go&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=f,i=r):u=u.next=f,mo.lanes|=d,Dl|=d}c=c.next}while(null!==c&&c!==o);null===u?i=r:u.next=l,ir(r,n.memoizedState)||(Si=!0),n.memoizedState=r,n.baseState=i,n.baseQueue=u,t.lastRenderedState=r}if(null!==(e=t.interleaved)){a=e;do{o=a.lane,mo.lanes|=o,Dl|=o,a=a.next}while(a!==e)}else null===a&&(t.lanes=0);return[n.memoizedState,t.dispatch]}function Eo(e){var n=Oo(),t=n.queue;if(null===t)throw Error(s(311));t.lastRenderedReducer=e;var r=t.dispatch,a=t.pending,o=n.memoizedState;if(null!==a){t.pending=null;var i=a=a.next;do{o=e(o,i.action),i=i.next}while(i!==a);ir(o,n.memoizedState)||(Si=!0),n.memoizedState=o,null===n.baseQueue&&(n.baseState=o),t.lastRenderedState=o}return[o,r]}function Ao(){}function Fo(e,n){var t=mo,r=Oo(),a=n(),o=!ir(r.memoizedState,a);if(o&&(r.memoizedState=a,Si=!0),r=r.queue,Wo(Ro.bind(null,t,r,e),[e]),r.getSnapshot!==n||o||null!==yo&&1&yo.memoizedState.tag){if(t.flags|=2048,jo(9,No.bind(null,t,r,a,n),void 0,null),null===El)throw Error(s(349));0!==(30&go)||Po(t,n,a)}return a}function Po(e,n,t){e.flags|=16384,e={getSnapshot:n,value:t},null===(n=mo.updateQueue)?(n={lastEffect:null,stores:null},mo.updateQueue=n,n.stores=[e]):null===(t=n.stores)?n.stores=[e]:t.push(e)}function No(e,n,t,r){n.value=t,n.getSnapshot=r,Lo(n)&&Do(e)}function Ro(e,n,t){return t((function(){Lo(n)&&Do(e)}))}function Lo(e){var n=e.getSnapshot;e=e.value;try{var t=n();return!ir(e,t)}catch(r){return!0}}function Do(e){var n=Ms(e,1);null!==n&&ru(n,e,1,-1)}function Uo(e){var n=xo();return"function"===typeof e&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},n.queue=e,e=e.dispatch=ti.bind(null,mo,e),[n.memoizedState,e]}function jo(e,n,t,r){return e={tag:e,create:n,destroy:t,deps:r,next:null},null===(n=mo.updateQueue)?(n={lastEffect:null,stores:null},mo.updateQueue=n,n.lastEffect=e.next=e):null===(t=n.lastEffect)?n.lastEffect=e.next=e:(r=t.next,t.next=e,e.next=r,n.lastEffect=e),e}function zo(){return Oo().memoizedState}function Bo(e,n,t,r){var a=xo();mo.flags|=e,a.memoizedState=jo(1|n,t,void 0,void 0===r?null:r)}function Vo(e,n,t,r){var a=Oo();r=void 0===r?null:r;var s=void 0;if(null!==ho){var o=ho.memoizedState;if(s=o.destroy,null!==r&&ko(r,o.deps))return void(a.memoizedState=jo(n,t,s,r))}mo.flags|=e,a.memoizedState=jo(1|n,t,s,r)}function Go(e,n){return Bo(8390656,8,e,n)}function Wo(e,n){return Vo(2048,8,e,n)}function $o(e,n){return Vo(4,2,e,n)}function Ho(e,n){return Vo(4,4,e,n)}function Ko(e,n){return"function"===typeof n?(e=e(),n(e),function(){n(null)}):null!==n&&void 0!==n?(e=e(),n.current=e,function(){n.current=null}):void 0}function qo(e,n,t){return t=null!==t&&void 0!==t?t.concat([e]):null,Vo(4,4,Ko.bind(null,n,e),t)}function Yo(){}function Xo(e,n){var t=Oo();n=void 0===n?null:n;var r=t.memoizedState;return null!==r&&null!==n&&ko(n,r[1])?r[0]:(t.memoizedState=[e,n],e)}function Jo(e,n){var t=Oo();n=void 0===n?null:n;var r=t.memoizedState;return null!==r&&null!==n&&ko(n,r[1])?r[0]:(e=e(),t.memoizedState=[e,n],e)}function Qo(e,n,t){return 0===(21&go)?(e.baseState&&(e.baseState=!1,Si=!0),e.memoizedState=t):(ir(t,n)||(t=hn(),mo.lanes|=t,Dl|=t,e.baseState=!0),n)}function Zo(e,n){var t=Sn;Sn=0!==t&&4>t?t:4,e(!0);var r=po.transition;po.transition={};try{e(!1),n()}finally{Sn=t,po.transition=r}}function ei(){return Oo().memoizedState}function ni(e,n,t){var r=tu(e);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},ri(e))ai(n,t);else if(null!==(t=Cs(e,n,t,r))){ru(t,e,r,nu()),si(t,n,r)}}function ti(e,n,t){var r=tu(e),a={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(ri(e))ai(n,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=n.lastRenderedReducer))try{var o=n.lastRenderedState,i=s(o,t);if(a.hasEagerState=!0,a.eagerState=i,ir(i,o)){var l=n.interleaved;return null===l?(a.next=a,Os(n)):(a.next=l.next,l.next=a),void(n.interleaved=a)}}catch(u){}null!==(t=Cs(e,n,a,r))&&(ru(t,e,r,a=nu()),si(t,n,r))}}function ri(e){var n=e.alternate;return e===mo||null!==n&&n===mo}function ai(e,n){vo=bo=!0;var t=e.pending;null===t?n.next=n:(n.next=t.next,t.next=n),e.pending=n}function si(e,n,t){if(0!==(4194240&t)){var r=n.lanes;t|=r&=e.pendingLanes,n.lanes=t,vn(e,t)}}var oi={readContext:Ts,useCallback:_o,useContext:_o,useEffect:_o,useImperativeHandle:_o,useInsertionEffect:_o,useLayoutEffect:_o,useMemo:_o,useReducer:_o,useRef:_o,useState:_o,useDebugValue:_o,useDeferredValue:_o,useTransition:_o,useMutableSource:_o,useSyncExternalStore:_o,useId:_o,unstable_isNewReconciler:!1},ii={readContext:Ts,useCallback:function(e,n){return xo().memoizedState=[e,void 0===n?null:n],e},useContext:Ts,useEffect:Go,useImperativeHandle:function(e,n,t){return t=null!==t&&void 0!==t?t.concat([e]):null,Bo(4194308,4,Ko.bind(null,n,e),t)},useLayoutEffect:function(e,n){return Bo(4194308,4,e,n)},useInsertionEffect:function(e,n){return Bo(4,2,e,n)},useMemo:function(e,n){var t=xo();return n=void 0===n?null:n,e=e(),t.memoizedState=[e,n],e},useReducer:function(e,n,t){var r=xo();return n=void 0!==t?t(n):n,r.memoizedState=r.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},r.queue=e,e=e.dispatch=ni.bind(null,mo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},xo().memoizedState=e},useState:Uo,useDebugValue:Yo,useDeferredValue:function(e){return xo().memoizedState=e},useTransition:function(){var e=Uo(!1),n=e[0];return e=Zo.bind(null,e[1]),xo().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,t){var r=mo,a=xo();if(as){if(void 0===t)throw Error(s(407));t=t()}else{if(t=n(),null===El)throw Error(s(349));0!==(30&go)||Po(r,n,t)}a.memoizedState=t;var o={value:t,getSnapshot:n};return a.queue=o,Go(Ro.bind(null,r,o,e),[e]),r.flags|=2048,jo(9,No.bind(null,r,o,t,n),void 0,null),t},useId:function(){var e=xo(),n=El.identifierPrefix;if(as){var t=Ja;n=":"+n+"R"+(t=(Xa&~(1<<32-on(Xa)-1)).toString(32)+t),0<(t=So++)&&(n+="H"+t.toString(32)),n+=":"}else n=":"+n+"r"+(t=wo++).toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},li={readContext:Ts,useCallback:Xo,useContext:Ts,useEffect:Wo,useImperativeHandle:qo,useInsertionEffect:$o,useLayoutEffect:Ho,useMemo:Jo,useReducer:Mo,useRef:zo,useState:function(){return Mo(Co)},useDebugValue:Yo,useDeferredValue:function(e){return Qo(Oo(),ho.memoizedState,e)},useTransition:function(){return[Mo(Co)[0],Oo().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Fo,useId:ei,unstable_isNewReconciler:!1},ui={readContext:Ts,useCallback:Xo,useContext:Ts,useEffect:Wo,useImperativeHandle:qo,useInsertionEffect:$o,useLayoutEffect:Ho,useMemo:Jo,useReducer:Eo,useRef:zo,useState:function(){return Eo(Co)},useDebugValue:Yo,useDeferredValue:function(e){var n=Oo();return null===ho?n.memoizedState=e:Qo(n,ho.memoizedState,e)},useTransition:function(){return[Eo(Co)[0],Oo().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Fo,useId:ei,unstable_isNewReconciler:!1};function ci(e,n){try{var t="",r=n;do{t+=B(r),r=r.return}while(r);var a=t}catch(s){a="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:n,stack:a,digest:null}}function di(e,n,t){return{value:e,source:null,stack:null!=t?t:null,digest:null!=n?n:null}}function fi(e,n){try{console.error(n.value)}catch(t){setTimeout((function(){throw t}))}}var pi="function"===typeof WeakMap?WeakMap:Map;function gi(e,n,t){(t=Ps(-1,t)).tag=3,t.payload={element:null};var r=n.value;return t.callback=function(){$l||($l=!0,Hl=r),fi(0,n)},t}function mi(e,n,t){(t=Ps(-1,t)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=n.value;t.payload=function(){return r(a)},t.callback=function(){fi(0,n)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(t.callback=function(){fi(0,n),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})}),t}function hi(e,n,t){var r=e.pingCache;if(null===r){r=e.pingCache=new pi;var a=new Set;r.set(n,a)}else void 0===(a=r.get(n))&&(a=new Set,r.set(n,a));a.has(t)||(a.add(t),e=xu.bind(null,e,n,t),n.then(e,e))}function yi(e){do{var n;if((n=13===e.tag)&&(n=null===(n=e.memoizedState)||null!==n.dehydrated),n)return e;e=e.return}while(null!==e);return null}function bi(e,n,t,r,a){return 0===(1&e.mode)?(e===n?e.flags|=65536:(e.flags|=128,t.flags|=131072,t.flags&=-52805,1===t.tag&&(null===t.alternate?t.tag=17:((n=Ps(-1,1)).tag=2,Ns(t,n,1))),t.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var vi=S.ReactCurrentOwner,Si=!1;function wi(e,n,t,r){n.child=null===e?Js(n,null,t,r):Xs(n,e.child,t,r)}function _i(e,n,t,r,a){t=t.render;var s=n.ref;return Is(n,a),r=Io(e,n,t,r,s,a),t=To(),null===e||Si?(as&&t&&es(n),n.flags|=1,wi(e,n,r,a),n.child):(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~a,$i(e,n,a))}function ki(e,n,t,r,a){if(null===e){var s=t.type;return"function"!==typeof s||Pu(s)||void 0!==s.defaultProps||null!==t.compare||void 0!==t.defaultProps?((e=Ru(t.type,null,r,n,n.mode,a)).ref=n.ref,e.return=n,n.child=e):(n.tag=15,n.type=s,Ii(e,n,s,r,a))}if(s=e.child,0===(e.lanes&a)){var o=s.memoizedProps;if((t=null!==(t=t.compare)?t:lr)(o,r)&&e.ref===n.ref)return $i(e,n,a)}return n.flags|=1,(e=Nu(s,r)).ref=n.ref,e.return=n,n.child=e}function Ii(e,n,t,r,a){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===n.ref){if(Si=!1,n.pendingProps=r=s,0===(e.lanes&a))return n.lanes=e.lanes,$i(e,n,a);0!==(131072&e.flags)&&(Si=!0)}}return Oi(e,n,t,r,a)}function Ti(e,n,t){var r=n.pendingProps,a=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&n.mode))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},xa(Nl,Pl),Pl|=t;else{if(0===(1073741824&t))return e=null!==s?s.baseLanes|t:t,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,xa(Nl,Pl),Pl|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:t,xa(Nl,Pl),Pl|=r}else null!==s?(r=s.baseLanes|t,n.memoizedState=null):r=t,xa(Nl,Pl),Pl|=r;return wi(e,n,a,t),n.child}function xi(e,n){var t=n.ref;(null===e&&null!==t||null!==e&&e.ref!==t)&&(n.flags|=512,n.flags|=2097152)}function Oi(e,n,t,r,a){var s=Fa(t)?Ea:Ca.current;return s=Aa(n,s),Is(n,a),t=Io(e,n,t,r,s,a),r=To(),null===e||Si?(as&&r&&es(n),n.flags|=1,wi(e,n,t,a),n.child):(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~a,$i(e,n,a))}function Ci(e,n,t,r,a){if(Fa(t)){var s=!0;La(n)}else s=!1;if(Is(n,a),null===n.stateNode)Wi(e,n),Gs(n,t,r),$s(n,t,r,a),r=!0;else if(null===e){var o=n.stateNode,i=n.memoizedProps;o.props=i;var l=o.context,u=t.contextType;"object"===typeof u&&null!==u?u=Ts(u):u=Aa(n,u=Fa(t)?Ea:Ca.current);var c=t.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==r||l!==u)&&Ws(n,o,r,u),Es=!1;var f=n.memoizedState;o.state=f,Ds(n,r,o,a),l=n.memoizedState,i!==r||f!==l||Ma.current||Es?("function"===typeof c&&(zs(n,t,c,r),l=n.memoizedState),(i=Es||Vs(n,t,i,r,f,l,u))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(n.flags|=4194308)):("function"===typeof o.componentDidMount&&(n.flags|=4194308),n.memoizedProps=r,n.memoizedState=l),o.props=r,o.state=l,o.context=u,r=i):("function"===typeof o.componentDidMount&&(n.flags|=4194308),r=!1)}else{o=n.stateNode,Fs(e,n),i=n.memoizedProps,u=n.type===n.elementType?i:hs(n.type,i),o.props=u,d=n.pendingProps,f=o.context,"object"===typeof(l=t.contextType)&&null!==l?l=Ts(l):l=Aa(n,l=Fa(t)?Ea:Ca.current);var p=t.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==d||f!==l)&&Ws(n,o,r,l),Es=!1,f=n.memoizedState,o.state=f,Ds(n,r,o,a);var g=n.memoizedState;i!==d||f!==g||Ma.current||Es?("function"===typeof p&&(zs(n,t,p,r),g=n.memoizedState),(u=Es||Vs(n,t,u,r,f,g,l)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,g,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,g,l)),"function"===typeof o.componentDidUpdate&&(n.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(n.flags|=1024)):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&f===e.memoizedState||(n.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&f===e.memoizedState||(n.flags|=1024),n.memoizedProps=r,n.memoizedState=g),o.props=r,o.state=g,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&f===e.memoizedState||(n.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&f===e.memoizedState||(n.flags|=1024),r=!1)}return Mi(e,n,t,r,s,a)}function Mi(e,n,t,r,a,s){xi(e,n);var o=0!==(128&n.flags);if(!r&&!o)return a&&Da(n,t,!1),$i(e,n,s);r=n.stateNode,vi.current=n;var i=o&&"function"!==typeof t.getDerivedStateFromError?null:r.render();return n.flags|=1,null!==e&&o?(n.child=Xs(n,e.child,null,s),n.child=Xs(n,null,i,s)):wi(e,n,i,s),n.memoizedState=r.state,a&&Da(n,t,!0),n.child}function Ei(e){var n=e.stateNode;n.pendingContext?Na(0,n.pendingContext,n.pendingContext!==n.context):n.context&&Na(0,n.context,!1),ro(e,n.containerInfo)}function Ai(e,n,t,r,a){return ps(),gs(a),n.flags|=256,wi(e,n,t,r),n.child}var Fi,Pi,Ni,Ri,Li={dehydrated:null,treeContext:null,retryLane:0};function Di(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ui(e,n,t){var r,a=n.pendingProps,o=io.current,i=!1,l=0!==(128&n.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(i=!0,n.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),xa(io,1&o),null===e)return us(n),null!==(e=n.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&n.mode)?n.lanes=1:"$!"===e.data?n.lanes=8:n.lanes=1073741824,null):(l=a.children,e=a.fallback,i?(a=n.mode,i=n.child,l={mode:"hidden",children:l},0===(1&a)&&null!==i?(i.childLanes=0,i.pendingProps=l):i=Du(l,a,0,null),e=Lu(e,a,t,null),i.return=n,e.return=n,i.sibling=e,n.child=i,n.child.memoizedState=Di(t),n.memoizedState=Li,e):ji(n,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,n,t,r,a,o,i){if(t)return 256&n.flags?(n.flags&=-257,zi(e,n,i,r=di(Error(s(422))))):null!==n.memoizedState?(n.child=e.child,n.flags|=128,null):(o=r.fallback,a=n.mode,r=Du({mode:"visible",children:r.children},a,0,null),(o=Lu(o,a,i,null)).flags|=2,r.return=n,o.return=n,r.sibling=o,n.child=r,0!==(1&n.mode)&&Xs(n,e.child,null,i),n.child.memoizedState=Di(i),n.memoizedState=Li,o);if(0===(1&n.mode))return zi(e,n,i,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,zi(e,n,i,r=di(o=Error(s(419)),r,void 0))}if(l=0!==(i&e.childLanes),Si||l){if(null!==(r=El)){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|i))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ms(e,a),ru(r,e,a,-1))}return hu(),zi(e,n,i,r=di(Error(s(421))))}return"$?"===a.data?(n.flags|=128,n.child=e.child,n=Cu.bind(null,e),a._reactRetry=n,null):(e=o.treeContext,rs=ua(a.nextSibling),ts=n,as=!0,ss=null,null!==e&&(Ka[qa++]=Xa,Ka[qa++]=Ja,Ka[qa++]=Ya,Xa=e.id,Ja=e.overflow,Ya=n),n=ji(n,r.children),n.flags|=4096,n)}(e,n,l,a,r,o,t);if(i){i=a.fallback,l=n.mode,r=(o=e.child).sibling;var u={mode:"hidden",children:a.children};return 0===(1&l)&&n.child!==o?((a=n.child).childLanes=0,a.pendingProps=u,n.deletions=null):(a=Nu(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==r?i=Nu(r,i):(i=Lu(i,l,t,null)).flags|=2,i.return=n,a.return=n,a.sibling=i,n.child=a,a=i,i=n.child,l=null===(l=e.child.memoizedState)?Di(t):{baseLanes:l.baseLanes|t,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~t,n.memoizedState=Li,a}return e=(i=e.child).sibling,a=Nu(i,{mode:"visible",children:a.children}),0===(1&n.mode)&&(a.lanes=t),a.return=n,a.sibling=null,null!==e&&(null===(t=n.deletions)?(n.deletions=[e],n.flags|=16):t.push(e)),n.child=a,n.memoizedState=null,a}function ji(e,n){return(n=Du({mode:"visible",children:n},e.mode,0,null)).return=e,e.child=n}function zi(e,n,t,r){return null!==r&&gs(r),Xs(n,e.child,null,t),(e=ji(n,n.pendingProps.children)).flags|=2,n.memoizedState=null,e}function Bi(e,n,t){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n),ks(e.return,n,t)}function Vi(e,n,t,r,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:a}:(s.isBackwards=n,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=a)}function Gi(e,n,t){var r=n.pendingProps,a=r.revealOrder,s=r.tail;if(wi(e,n,r.children,t),0!==(2&(r=io.current)))r=1&r|2,n.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=n.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bi(e,t,n);else if(19===e.tag)Bi(e,t,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(xa(io,r),0===(1&n.mode))n.memoizedState=null;else switch(a){case"forwards":for(t=n.child,a=null;null!==t;)null!==(e=t.alternate)&&null===lo(e)&&(a=t),t=t.sibling;null===(t=a)?(a=n.child,n.child=null):(a=t.sibling,t.sibling=null),Vi(n,!1,a,t,s);break;case"backwards":for(t=null,a=n.child,n.child=null;null!==a;){if(null!==(e=a.alternate)&&null===lo(e)){n.child=a;break}e=a.sibling,a.sibling=t,t=a,a=e}Vi(n,!0,t,null,s);break;case"together":Vi(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Wi(e,n){0===(1&n.mode)&&null!==e&&(e.alternate=null,n.alternate=null,n.flags|=2)}function $i(e,n,t){if(null!==e&&(n.dependencies=e.dependencies),Dl|=n.lanes,0===(t&n.childLanes))return null;if(null!==e&&n.child!==e.child)throw Error(s(153));if(null!==n.child){for(t=Nu(e=n.child,e.pendingProps),n.child=t,t.return=n;null!==e.sibling;)e=e.sibling,(t=t.sibling=Nu(e,e.pendingProps)).return=n;t.sibling=null}return n.child}function Hi(e,n){if(!as)switch(e.tailMode){case"hidden":n=e.tail;for(var t=null;null!==n;)null!==n.alternate&&(t=n),n=n.sibling;null===t?e.tail=null:t.sibling=null;break;case"collapsed":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?n||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ki(e){var n=null!==e.alternate&&e.alternate.child===e.child,t=0,r=0;if(n)for(var a=e.child;null!==a;)t|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)t|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=t,n}function qi(e,n,t){var r=n.pendingProps;switch(ns(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ki(n),null;case 1:case 17:return Fa(n.type)&&Pa(),Ki(n),null;case 3:return r=n.stateNode,ao(),Ta(Ma),Ta(Ca),co(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(n)?n.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&n.flags)||(n.flags|=1024,null!==ss&&(iu(ss),ss=null))),Pi(e,n),Ki(n),null;case 5:oo(n);var a=to(no.current);if(t=n.type,null!==e&&null!=n.stateNode)Ni(e,n,t,r,a),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!r){if(null===n.stateNode)throw Error(s(166));return Ki(n),null}if(e=to(Zs.current),ds(n)){r=n.stateNode,t=n.type;var o=n.memoizedProps;switch(r[fa]=n,r[pa]=o,e=0!==(1&n.mode),t){case"dialog":jr("cancel",r),jr("close",r);break;case"iframe":case"object":case"embed":jr("load",r);break;case"video":case"audio":for(a=0;a<Rr.length;a++)jr(Rr[a],r);break;case"source":jr("error",r);break;case"img":case"image":case"link":jr("error",r),jr("load",r);break;case"details":jr("toggle",r);break;case"input":X(r,o),jr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},jr("invalid",r);break;case"textarea":ae(r,o),jr("invalid",r)}for(var l in be(t,o),a=null,o)if(o.hasOwnProperty(l)){var u=o[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,u,e),a=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,u,e),a=["children",""+u]):i.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&jr("scroll",r)}switch(t){case"input":H(r),Z(r,o,!0);break;case"textarea":H(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=a,n.updateQueue=r,null!==r&&(n.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(t)),"http://www.w3.org/1999/xhtml"===e?"script"===t?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(t,{is:r.is}):(e=l.createElement(t),"select"===t&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,t),e[fa]=n,e[pa]=r,Fi(e,n,!1,!1),n.stateNode=e;e:{switch(l=ve(t,r),t){case"dialog":jr("cancel",e),jr("close",e),a=r;break;case"iframe":case"object":case"embed":jr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Rr.length;a++)jr(Rr[a],e);a=r;break;case"source":jr("error",e),a=r;break;case"img":case"image":case"link":jr("error",e),jr("load",e),a=r;break;case"details":jr("toggle",e),a=r;break;case"input":X(e,r),a=Y(e,r),jr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=D({},r,{value:void 0}),jr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),jr("invalid",e)}for(o in be(t,a),u=a)if(u.hasOwnProperty(o)){var c=u[o];"style"===o?he(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===o?"string"===typeof c?("textarea"!==t||""!==c)&&fe(e,c):"number"===typeof c&&fe(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(i.hasOwnProperty(o)?null!=c&&"onScroll"===o&&jr("scroll",e):null!=c&&v(e,o,c,l))}switch(t){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?te(e,!!r.multiple,o,!1):null!=r.defaultValue&&te(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(n.flags|=4)}null!==n.ref&&(n.flags|=512,n.flags|=2097152)}return Ki(n),null;case 6:if(e&&null!=n.stateNode)Ri(e,n,e.memoizedProps,r);else{if("string"!==typeof r&&null===n.stateNode)throw Error(s(166));if(t=to(no.current),to(Zs.current),ds(n)){if(r=n.stateNode,t=n.memoizedProps,r[fa]=n,(o=r.nodeValue!==t)&&null!==(e=ts))switch(e.tag){case 3:Qr(r.nodeValue,t,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,t,0!==(1&e.mode))}o&&(n.flags|=4)}else(r=(9===t.nodeType?t:t.ownerDocument).createTextNode(r))[fa]=n,n.stateNode=r}return Ki(n),null;case 13:if(Ta(io),r=n.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(as&&null!==rs&&0!==(1&n.mode)&&0===(128&n.flags))fs(),ps(),n.flags|=98560,o=!1;else if(o=ds(n),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=n.memoizedState)?o.dehydrated:null))throw Error(s(317));o[fa]=n}else ps(),0===(128&n.flags)&&(n.memoizedState=null),n.flags|=4;Ki(n),o=!1}else null!==ss&&(iu(ss),ss=null),o=!0;if(!o)return 65536&n.flags?n:null}return 0!==(128&n.flags)?(n.lanes=t,n):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(n.child.flags|=8192,0!==(1&n.mode)&&(null===e||0!==(1&io.current)?0===Rl&&(Rl=3):hu())),null!==n.updateQueue&&(n.flags|=4),Ki(n),null);case 4:return ao(),Pi(e,n),null===e&&Vr(n.stateNode.containerInfo),Ki(n),null;case 10:return _s(n.type._context),Ki(n),null;case 19:if(Ta(io),null===(o=n.memoizedState))return Ki(n),null;if(r=0!==(128&n.flags),null===(l=o.rendering))if(r)Hi(o,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=n.child;null!==e;){if(null!==(l=lo(e))){for(n.flags|=128,Hi(o,!1),null!==(r=l.updateQueue)&&(n.updateQueue=r,n.flags|=4),n.subtreeFlags=0,r=t,t=n.child;null!==t;)e=r,(o=t).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),t=t.sibling;return xa(io,1&io.current|2),n.child}e=e.sibling}null!==o.tail&&Je()>Gl&&(n.flags|=128,r=!0,Hi(o,!1),n.lanes=4194304)}else{if(!r)if(null!==(e=lo(l))){if(n.flags|=128,r=!0,null!==(t=e.updateQueue)&&(n.updateQueue=t,n.flags|=4),Hi(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!as)return Ki(n),null}else 2*Je()-o.renderingStartTime>Gl&&1073741824!==t&&(n.flags|=128,r=!0,Hi(o,!1),n.lanes=4194304);o.isBackwards?(l.sibling=n.child,n.child=l):(null!==(t=o.last)?t.sibling=l:n.child=l,o.last=l)}return null!==o.tail?(n=o.tail,o.rendering=n,o.tail=n.sibling,o.renderingStartTime=Je(),n.sibling=null,t=io.current,xa(io,r?1&t|2:1&t),n):(Ki(n),null);case 22:case 23:return fu(),r=null!==n.memoizedState,null!==e&&null!==e.memoizedState!==r&&(n.flags|=8192),r&&0!==(1&n.mode)?0!==(1073741824&Pl)&&(Ki(n),6&n.subtreeFlags&&(n.flags|=8192)):Ki(n),null;case 24:case 25:return null}throw Error(s(156,n.tag))}function Yi(e,n){switch(ns(n),n.tag){case 1:return Fa(n.type)&&Pa(),65536&(e=n.flags)?(n.flags=-65537&e|128,n):null;case 3:return ao(),Ta(Ma),Ta(Ca),co(),0!==(65536&(e=n.flags))&&0===(128&e)?(n.flags=-65537&e|128,n):null;case 5:return oo(n),null;case 13:if(Ta(io),null!==(e=n.memoizedState)&&null!==e.dehydrated){if(null===n.alternate)throw Error(s(340));ps()}return 65536&(e=n.flags)?(n.flags=-65537&e|128,n):null;case 19:return Ta(io),null;case 4:return ao(),null;case 10:return _s(n.type._context),null;case 22:case 23:return fu(),null;default:return null}}Fi=function(e,n){for(var t=n.child;null!==t;){if(5===t.tag||6===t.tag)e.appendChild(t.stateNode);else if(4!==t.tag&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===n)break;for(;null===t.sibling;){if(null===t.return||t.return===n)return;t=t.return}t.sibling.return=t.return,t=t.sibling}},Pi=function(){},Ni=function(e,n,t,r){var a=e.memoizedProps;if(a!==r){e=n.stateNode,to(Zs.current);var s,o=null;switch(t){case"input":a=Y(e,a),r=Y(e,r),o=[];break;case"select":a=D({},a,{value:void 0}),r=D({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(c in be(t,r),t=null,a)if(!r.hasOwnProperty(c)&&a.hasOwnProperty(c)&&null!=a[c])if("style"===c){var l=a[c];for(s in l)l.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(i.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=a?a[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(t||(t={}),t[s]=u[s])}else t||(o||(o=[]),o.push(c,t)),t=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(o=o||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(i.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&jr("scroll",e),o||l===u||(o=[])):(o=o||[]).push(c,u))}t&&(o=o||[]).push("style",t);var c=o;(n.updateQueue=c)&&(n.flags|=4)}},Ri=function(e,n,t,r){t!==r&&(n.flags|=4)};var Xi=!1,Ji=!1,Qi="function"===typeof WeakSet?WeakSet:Set,Zi=null;function el(e,n){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(r){Tu(e,n,r)}else t.current=null}function nl(e,n,t){try{t()}catch(r){Tu(e,n,r)}}var tl=!1;function rl(e,n,t){var r=n.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,void 0!==s&&nl(n,t,s)}a=a.next}while(a!==r)}}function al(e,n){if(null!==(n=null!==(n=n.updateQueue)?n.lastEffect:null)){var t=n=n.next;do{if((t.tag&e)===e){var r=t.create;t.destroy=r()}t=t.next}while(t!==n)}}function sl(e){var n=e.ref;if(null!==n){var t=e.stateNode;e.tag,e=t,"function"===typeof n?n(e):n.current=e}}function ol(e){var n=e.alternate;null!==n&&(e.alternate=null,ol(n)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(n=e.stateNode)&&(delete n[fa],delete n[pa],delete n[ma],delete n[ha],delete n[ya])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ul(e,n,t){var r=e.tag;if(5===r||6===r)e=e.stateNode,n?8===t.nodeType?t.parentNode.insertBefore(e,n):t.insertBefore(e,n):(8===t.nodeType?(n=t.parentNode).insertBefore(e,t):(n=t).appendChild(e),null!==(t=t._reactRootContainer)&&void 0!==t||null!==n.onclick||(n.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ul(e,n,t),e=e.sibling;null!==e;)ul(e,n,t),e=e.sibling}function cl(e,n,t){var r=e.tag;if(5===r||6===r)e=e.stateNode,n?t.insertBefore(e,n):t.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,n,t),e=e.sibling;null!==e;)cl(e,n,t),e=e.sibling}var dl=null,fl=!1;function pl(e,n,t){for(t=t.child;null!==t;)gl(e,n,t),t=t.sibling}function gl(e,n,t){if(sn&&"function"===typeof sn.onCommitFiberUnmount)try{sn.onCommitFiberUnmount(an,t)}catch(i){}switch(t.tag){case 5:Ji||el(t,n);case 6:var r=dl,a=fl;dl=null,pl(e,n,t),fl=a,null!==(dl=r)&&(fl?(e=dl,t=t.stateNode,8===e.nodeType?e.parentNode.removeChild(t):e.removeChild(t)):dl.removeChild(t.stateNode));break;case 18:null!==dl&&(fl?(e=dl,t=t.stateNode,8===e.nodeType?la(e.parentNode,t):1===e.nodeType&&la(e,t),Gn(e)):la(dl,t.stateNode));break;case 4:r=dl,a=fl,dl=t.stateNode.containerInfo,fl=!0,pl(e,n,t),dl=r,fl=a;break;case 0:case 11:case 14:case 15:if(!Ji&&(null!==(r=t.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var s=a,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&nl(t,n,o),a=a.next}while(a!==r)}pl(e,n,t);break;case 1:if(!Ji&&(el(t,n),"function"===typeof(r=t.stateNode).componentWillUnmount))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(i){Tu(t,n,i)}pl(e,n,t);break;case 21:pl(e,n,t);break;case 22:1&t.mode?(Ji=(r=Ji)||null!==t.memoizedState,pl(e,n,t),Ji=r):pl(e,n,t);break;default:pl(e,n,t)}}function ml(e){var n=e.updateQueue;if(null!==n){e.updateQueue=null;var t=e.stateNode;null===t&&(t=e.stateNode=new Qi),n.forEach((function(n){var r=Mu.bind(null,e,n);t.has(n)||(t.add(n),n.then(r,r))}))}}function hl(e,n){var t=n.deletions;if(null!==t)for(var r=0;r<t.length;r++){var a=t[r];try{var o=e,i=n,l=i;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,fl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,fl=!0;break e}l=l.return}if(null===dl)throw Error(s(160));gl(o,i,a),dl=null,fl=!1;var u=a.alternate;null!==u&&(u.return=null),a.return=null}catch(c){Tu(a,n,c)}}if(12854&n.subtreeFlags)for(n=n.child;null!==n;)yl(n,e),n=n.sibling}function yl(e,n){var t=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hl(n,e),bl(e),4&r){try{rl(3,e,e.return),al(3,e)}catch(h){Tu(e,e.return,h)}try{rl(5,e,e.return)}catch(h){Tu(e,e.return,h)}}break;case 1:hl(n,e),bl(e),512&r&&null!==t&&el(t,t.return);break;case 5:if(hl(n,e),bl(e),512&r&&null!==t&&el(t,t.return),32&e.flags){var a=e.stateNode;try{fe(a,"")}catch(h){Tu(e,e.return,h)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,i=null!==t?t.memoizedProps:o,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(a,o),ve(l,i);var c=ve(l,o);for(i=0;i<u.length;i+=2){var d=u[i],f=u[i+1];"style"===d?he(a,f):"dangerouslySetInnerHTML"===d?de(a,f):"children"===d?fe(a,f):v(a,d,f,c)}switch(l){case"input":Q(a,o);break;case"textarea":se(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var g=o.value;null!=g?te(a,!!o.multiple,g,!1):p!==!!o.multiple&&(null!=o.defaultValue?te(a,!!o.multiple,o.defaultValue,!0):te(a,!!o.multiple,o.multiple?[]:"",!1))}a[pa]=o}catch(h){Tu(e,e.return,h)}}break;case 6:if(hl(n,e),bl(e),4&r){if(null===e.stateNode)throw Error(s(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(h){Tu(e,e.return,h)}}break;case 3:if(hl(n,e),bl(e),4&r&&null!==t&&t.memoizedState.isDehydrated)try{Gn(n.containerInfo)}catch(h){Tu(e,e.return,h)}break;case 4:default:hl(n,e),bl(e);break;case 13:hl(n,e),bl(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Vl=Je())),4&r&&ml(e);break;case 22:if(d=null!==t&&null!==t.memoizedState,1&e.mode?(Ji=(c=Ji)||d,hl(n,e),Ji=c):hl(n,e),bl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for(Zi=e,d=e.child;null!==d;){for(f=Zi=d;null!==Zi;){switch(g=(p=Zi).child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:el(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,t=p.return;try{n=r,m.props=n.memoizedProps,m.state=n.memoizedState,m.componentWillUnmount()}catch(h){Tu(r,t,h)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){_l(f);continue}}null!==g?(g.return=p,Zi=g):_l(f)}d=d.sibling}e:for(d=null,f=e;;){if(5===f.tag){if(null===d){d=f;try{a=f.stateNode,c?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=f.stateNode,i=void 0!==(u=f.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",i))}catch(h){Tu(e,e.return,h)}}}else if(6===f.tag){if(null===d)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(h){Tu(e,e.return,h)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:hl(n,e),bl(e),4&r&&ml(e);case 21:}}function bl(e){var n=e.flags;if(2&n){try{e:{for(var t=e.return;null!==t;){if(il(t)){var r=t;break e}t=t.return}throw Error(s(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(fe(a,""),r.flags&=-33),cl(e,ll(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;ul(e,ll(e),o);break;default:throw Error(s(161))}}catch(i){Tu(e,e.return,i)}e.flags&=-3}4096&n&&(e.flags&=-4097)}function vl(e,n,t){Zi=e,Sl(e,n,t)}function Sl(e,n,t){for(var r=0!==(1&e.mode);null!==Zi;){var a=Zi,s=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Xi;if(!o){var i=a.alternate,l=null!==i&&null!==i.memoizedState||Ji;i=Xi;var u=Ji;if(Xi=o,(Ji=l)&&!u)for(Zi=a;null!==Zi;)l=(o=Zi).child,22===o.tag&&null!==o.memoizedState?kl(a):null!==l?(l.return=o,Zi=l):kl(a);for(;null!==s;)Zi=s,Sl(s,n,t),s=s.sibling;Zi=a,Xi=i,Ji=u}wl(e)}else 0!==(8772&a.subtreeFlags)&&null!==s?(s.return=a,Zi=s):wl(e)}}function wl(e){for(;null!==Zi;){var n=Zi;if(0!==(8772&n.flags)){var t=n.alternate;try{if(0!==(8772&n.flags))switch(n.tag){case 0:case 11:case 15:Ji||al(5,n);break;case 1:var r=n.stateNode;if(4&n.flags&&!Ji)if(null===t)r.componentDidMount();else{var a=n.elementType===n.type?t.memoizedProps:hs(n.type,t.memoizedProps);r.componentDidUpdate(a,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=n.updateQueue;null!==o&&Us(n,o,r);break;case 3:var i=n.updateQueue;if(null!==i){if(t=null,null!==n.child)switch(n.child.tag){case 5:case 1:t=n.child.stateNode}Us(n,i,t)}break;case 5:var l=n.stateNode;if(null===t&&4&n.flags){t=l;var u=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&t.focus();break;case"img":u.src&&(t.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===n.memoizedState){var c=n.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var f=d.dehydrated;null!==f&&Gn(f)}}}break;default:throw Error(s(163))}Ji||512&n.flags&&sl(n)}catch(p){Tu(n,n.return,p)}}if(n===e){Zi=null;break}if(null!==(t=n.sibling)){t.return=n.return,Zi=t;break}Zi=n.return}}function _l(e){for(;null!==Zi;){var n=Zi;if(n===e){Zi=null;break}var t=n.sibling;if(null!==t){t.return=n.return,Zi=t;break}Zi=n.return}}function kl(e){for(;null!==Zi;){var n=Zi;try{switch(n.tag){case 0:case 11:case 15:var t=n.return;try{al(4,n)}catch(l){Tu(n,t,l)}break;case 1:var r=n.stateNode;if("function"===typeof r.componentDidMount){var a=n.return;try{r.componentDidMount()}catch(l){Tu(n,a,l)}}var s=n.return;try{sl(n)}catch(l){Tu(n,s,l)}break;case 5:var o=n.return;try{sl(n)}catch(l){Tu(n,o,l)}}}catch(l){Tu(n,n.return,l)}if(n===e){Zi=null;break}var i=n.sibling;if(null!==i){i.return=n.return,Zi=i;break}Zi=n.return}}var Il,Tl=Math.ceil,xl=S.ReactCurrentDispatcher,Ol=S.ReactCurrentOwner,Cl=S.ReactCurrentBatchConfig,Ml=0,El=null,Al=null,Fl=0,Pl=0,Nl=Ia(0),Rl=0,Ll=null,Dl=0,Ul=0,jl=0,zl=null,Bl=null,Vl=0,Gl=1/0,Wl=null,$l=!1,Hl=null,Kl=null,ql=!1,Yl=null,Xl=0,Jl=0,Ql=null,Zl=-1,eu=0;function nu(){return 0!==(6&Ml)?Je():-1!==Zl?Zl:Zl=Je()}function tu(e){return 0===(1&e.mode)?1:0!==(2&Ml)&&0!==Fl?Fl&-Fl:null!==ms.transition?(0===eu&&(eu=hn()),eu):0!==(e=Sn)?e:e=void 0===(e=window.event)?16:Jn(e.type)}function ru(e,n,t,r){if(50<Jl)throw Jl=0,Ql=null,Error(s(185));bn(e,t,r),0!==(2&Ml)&&e===El||(e===El&&(0===(2&Ml)&&(Ul|=t),4===Rl&&lu(e,Fl)),au(e,r),1===t&&0===Ml&&0===(1&n.mode)&&(Gl=Je()+500,ja&&Va()))}function au(e,n){var t=e.callbackNode;!function(e,n){for(var t=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-on(s),i=1<<o,l=a[o];-1===l?0!==(i&t)&&0===(i&r)||(a[o]=gn(i,n)):l<=n&&(e.expiredLanes|=i),s&=~i}}(e,n);var r=pn(e,e===El?Fl:0);if(0===r)null!==t&&qe(t),e.callbackNode=null,e.callbackPriority=0;else if(n=r&-r,e.callbackPriority!==n){if(null!=t&&qe(t),1===n)0===e.tag?function(e){ja=!0,Ba(e)}(uu.bind(null,e)):Ba(uu.bind(null,e)),oa((function(){0===(6&Ml)&&Va()})),t=null;else{switch(wn(r)){case 1:t=Ze;break;case 4:t=en;break;case 16:default:t=nn;break;case 536870912:t=rn}t=Eu(t,su.bind(null,e))}e.callbackPriority=n,e.callbackNode=t}}function su(e,n){if(Zl=-1,eu=0,0!==(6&Ml))throw Error(s(327));var t=e.callbackNode;if(ku()&&e.callbackNode!==t)return null;var r=pn(e,e===El?Fl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||n)n=yu(e,r);else{n=r;var a=Ml;Ml|=2;var o=mu();for(El===e&&Fl===n||(Wl=null,Gl=Je()+500,pu(e,n));;)try{vu();break}catch(l){gu(e,l)}ws(),xl.current=o,Ml=a,null!==Al?n=0:(El=null,Fl=0,n=Rl)}if(0!==n){if(2===n&&(0!==(a=mn(e))&&(r=a,n=ou(e,a))),1===n)throw t=Ll,pu(e,0),lu(e,r),au(e,Je()),t;if(6===n)lu(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var n=e;;){if(16384&n.flags){var t=n.updateQueue;if(null!==t&&null!==(t=t.stores))for(var r=0;r<t.length;r++){var a=t[r],s=a.getSnapshot;a=a.value;try{if(!ir(s(),a))return!1}catch(i){return!1}}}if(t=n.child,16384&n.subtreeFlags&&null!==t)t.return=n,n=t;else{if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}(a)&&(2===(n=yu(e,r))&&(0!==(o=mn(e))&&(r=o,n=ou(e,o))),1===n))throw t=Ll,pu(e,0),lu(e,r),au(e,Je()),t;switch(e.finishedWork=a,e.finishedLanes=r,n){case 0:case 1:throw Error(s(345));case 2:case 5:_u(e,Bl,Wl);break;case 3:if(lu(e,r),(130023424&r)===r&&10<(n=Vl+500-Je())){if(0!==pn(e,0))break;if(((a=e.suspendedLanes)&r)!==r){nu(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(_u.bind(null,e,Bl,Wl),n);break}_u(e,Bl,Wl);break;case 4:if(lu(e,r),(4194240&r)===r)break;for(n=e.eventTimes,a=-1;0<r;){var i=31-on(r);o=1<<i,(i=n[i])>a&&(a=i),r&=~o}if(r=a,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tl(r/1960))-r)){e.timeoutHandle=ra(_u.bind(null,e,Bl,Wl),r);break}_u(e,Bl,Wl);break;default:throw Error(s(329))}}}return au(e,Je()),e.callbackNode===t?su.bind(null,e):null}function ou(e,n){var t=zl;return e.current.memoizedState.isDehydrated&&(pu(e,n).flags|=256),2!==(e=yu(e,n))&&(n=Bl,Bl=t,null!==n&&iu(n)),e}function iu(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function lu(e,n){for(n&=~jl,n&=~Ul,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var t=31-on(n),r=1<<t;e[t]=-1,n&=~r}}function uu(e){if(0!==(6&Ml))throw Error(s(327));ku();var n=pn(e,0);if(0===(1&n))return au(e,Je()),null;var t=yu(e,n);if(0!==e.tag&&2===t){var r=mn(e);0!==r&&(n=r,t=ou(e,r))}if(1===t)throw t=Ll,pu(e,0),lu(e,n),au(e,Je()),t;if(6===t)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,_u(e,Bl,Wl),au(e,Je()),null}function cu(e,n){var t=Ml;Ml|=1;try{return e(n)}finally{0===(Ml=t)&&(Gl=Je()+500,ja&&Va())}}function du(e){null!==Yl&&0===Yl.tag&&0===(6&Ml)&&ku();var n=Ml;Ml|=1;var t=Cl.transition,r=Sn;try{if(Cl.transition=null,Sn=1,e)return e()}finally{Sn=r,Cl.transition=t,0===(6&(Ml=n))&&Va()}}function fu(){Pl=Nl.current,Ta(Nl)}function pu(e,n){e.finishedWork=null,e.finishedLanes=0;var t=e.timeoutHandle;if(-1!==t&&(e.timeoutHandle=-1,aa(t)),null!==Al)for(t=Al.return;null!==t;){var r=t;switch(ns(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Pa();break;case 3:ao(),Ta(Ma),Ta(Ca),co();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Ta(io);break;case 10:_s(r.type._context);break;case 22:case 23:fu()}t=t.return}if(El=e,Al=e=Nu(e.current,null),Fl=Pl=n,Rl=0,Ll=null,jl=Ul=Dl=0,Bl=zl=null,null!==xs){for(n=0;n<xs.length;n++)if(null!==(r=(t=xs[n]).interleaved)){t.interleaved=null;var a=r.next,s=t.pending;if(null!==s){var o=s.next;s.next=a,r.next=o}t.pending=r}xs=null}return e}function gu(e,n){for(;;){var t=Al;try{if(ws(),fo.current=oi,bo){for(var r=mo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}bo=!1}if(go=0,yo=ho=mo=null,vo=!1,So=0,Ol.current=null,null===t||null===t.return){Rl=1,Ll=n,Al=null;break}e:{var o=e,i=t.return,l=t,u=n;if(n=Fl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,d=l,f=d.tag;if(0===(1&d.mode)&&(0===f||11===f||15===f)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=yi(i);if(null!==g){g.flags&=-257,bi(g,i,l,0,n),1&g.mode&&hi(o,c,n),u=c;var m=(n=g).updateQueue;if(null===m){var h=new Set;h.add(u),n.updateQueue=h}else m.add(u);break e}if(0===(1&n)){hi(o,c,n),hu();break e}u=Error(s(426))}else if(as&&1&l.mode){var y=yi(i);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),bi(y,i,l,0,n),gs(ci(u,l));break e}}o=u=ci(u,l),4!==Rl&&(Rl=2),null===zl?zl=[o]:zl.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,n&=-n,o.lanes|=n,Ls(o,gi(0,u,n));break e;case 1:l=u;var b=o.type,v=o.stateNode;if(0===(128&o.flags)&&("function"===typeof b.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===Kl||!Kl.has(v)))){o.flags|=65536,n&=-n,o.lanes|=n,Ls(o,mi(o,l,n));break e}}o=o.return}while(null!==o)}wu(t)}catch(S){n=S,Al===t&&null!==t&&(Al=t=t.return);continue}break}}function mu(){var e=xl.current;return xl.current=oi,null===e?oi:e}function hu(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===El||0===(268435455&Dl)&&0===(268435455&Ul)||lu(El,Fl)}function yu(e,n){var t=Ml;Ml|=2;var r=mu();for(El===e&&Fl===n||(Wl=null,pu(e,n));;)try{bu();break}catch(a){gu(e,a)}if(ws(),Ml=t,xl.current=r,null!==Al)throw Error(s(261));return El=null,Fl=0,Rl}function bu(){for(;null!==Al;)Su(Al)}function vu(){for(;null!==Al&&!Ye();)Su(Al)}function Su(e){var n=Il(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===n?wu(e):Al=n,Ol.current=null}function wu(e){var n=e;do{var t=n.alternate;if(e=n.return,0===(32768&n.flags)){if(null!==(t=qi(t,n,Pl)))return void(Al=t)}else{if(null!==(t=Yi(t,n)))return t.flags&=32767,void(Al=t);if(null===e)return Rl=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(n=n.sibling))return void(Al=n);Al=n=e}while(null!==n);0===Rl&&(Rl=5)}function _u(e,n,t){var r=Sn,a=Cl.transition;try{Cl.transition=null,Sn=1,function(e,n,t,r){do{ku()}while(null!==Yl);if(0!==(6&Ml))throw Error(s(327));t=e.finishedWork;var a=e.finishedLanes;if(null===t)return null;if(e.finishedWork=null,e.finishedLanes=0,t===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=t.lanes|t.childLanes;if(function(e,n){var t=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<t;){var a=31-on(t),s=1<<a;n[a]=0,r[a]=-1,e[a]=-1,t&=~s}}(e,o),e===El&&(Al=El=null,Fl=0),0===(2064&t.subtreeFlags)&&0===(2064&t.flags)||ql||(ql=!0,Eu(nn,(function(){return ku(),null}))),o=0!==(15990&t.flags),0!==(15990&t.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var i=Sn;Sn=1;var l=Ml;Ml|=4,Ol.current=null,function(e,n){if(ea=$n,pr(e=fr())){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(t=(t=e.ownerDocument)&&t.defaultView||window).getSelection&&t.getSelection();if(r&&0!==r.rangeCount){t=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{t.nodeType,o.nodeType}catch(w){t=null;break e}var i=0,l=-1,u=-1,c=0,d=0,f=e,p=null;n:for(;;){for(var g;f!==t||0!==a&&3!==f.nodeType||(l=i+a),f!==o||0!==r&&3!==f.nodeType||(u=i+r),3===f.nodeType&&(i+=f.nodeValue.length),null!==(g=f.firstChild);)p=f,f=g;for(;;){if(f===e)break n;if(p===t&&++c===a&&(l=i),p===o&&++d===r&&(u=i),null!==(g=f.nextSibling))break;p=(f=p).parentNode}f=g}t=-1===l||-1===u?null:{start:l,end:u}}else t=null}t=t||{start:0,end:0}}else t=null;for(na={focusedElem:e,selectionRange:t},$n=!1,Zi=n;null!==Zi;)if(e=(n=Zi).child,0!==(1028&n.subtreeFlags)&&null!==e)e.return=n,Zi=e;else for(;null!==Zi;){n=Zi;try{var m=n.alternate;if(0!==(1024&n.flags))switch(n.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var h=m.memoizedProps,y=m.memoizedState,b=n.stateNode,v=b.getSnapshotBeforeUpdate(n.elementType===n.type?h:hs(n.type,h),y);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var S=n.stateNode.containerInfo;1===S.nodeType?S.textContent="":9===S.nodeType&&S.documentElement&&S.removeChild(S.documentElement);break;default:throw Error(s(163))}}catch(w){Tu(n,n.return,w)}if(null!==(e=n.sibling)){e.return=n.return,Zi=e;break}Zi=n.return}m=tl,tl=!1}(e,t),yl(t,e),gr(na),$n=!!ea,na=ea=null,e.current=t,vl(t,e,a),Xe(),Ml=l,Sn=i,Cl.transition=o}else e.current=t;if(ql&&(ql=!1,Yl=e,Xl=a),o=e.pendingLanes,0===o&&(Kl=null),function(e){if(sn&&"function"===typeof sn.onCommitFiberRoot)try{sn.onCommitFiberRoot(an,e,void 0,128===(128&e.current.flags))}catch(n){}}(t.stateNode),au(e,Je()),null!==n)for(r=e.onRecoverableError,t=0;t<n.length;t++)a=n[t],r(a.value,{componentStack:a.stack,digest:a.digest});if($l)throw $l=!1,e=Hl,Hl=null,e;0!==(1&Xl)&&0!==e.tag&&ku(),o=e.pendingLanes,0!==(1&o)?e===Ql?Jl++:(Jl=0,Ql=e):Jl=0,Va()}(e,n,t,r)}finally{Cl.transition=a,Sn=r}return null}function ku(){if(null!==Yl){var e=wn(Xl),n=Cl.transition,t=Sn;try{if(Cl.transition=null,Sn=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Xl=0,0!==(6&Ml))throw Error(s(331));var a=Ml;for(Ml|=4,Zi=e.current;null!==Zi;){var o=Zi,i=o.child;if(0!==(16&Zi.flags)){var l=o.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Zi=c;null!==Zi;){var d=Zi;switch(d.tag){case 0:case 11:case 15:rl(8,d,o)}var f=d.child;if(null!==f)f.return=d,Zi=f;else for(;null!==Zi;){var p=(d=Zi).sibling,g=d.return;if(ol(d),d===c){Zi=null;break}if(null!==p){p.return=g,Zi=p;break}Zi=g}}}var m=o.alternate;if(null!==m){var h=m.child;if(null!==h){m.child=null;do{var y=h.sibling;h.sibling=null,h=y}while(null!==h)}}Zi=o}}if(0!==(2064&o.subtreeFlags)&&null!==i)i.return=o,Zi=i;else e:for(;null!==Zi;){if(0!==(2048&(o=Zi).flags))switch(o.tag){case 0:case 11:case 15:rl(9,o,o.return)}var b=o.sibling;if(null!==b){b.return=o.return,Zi=b;break e}Zi=o.return}}var v=e.current;for(Zi=v;null!==Zi;){var S=(i=Zi).child;if(0!==(2064&i.subtreeFlags)&&null!==S)S.return=i,Zi=S;else e:for(i=v;null!==Zi;){if(0!==(2048&(l=Zi).flags))try{switch(l.tag){case 0:case 11:case 15:al(9,l)}}catch(_){Tu(l,l.return,_)}if(l===i){Zi=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Zi=w;break e}Zi=l.return}}if(Ml=a,Va(),sn&&"function"===typeof sn.onPostCommitFiberRoot)try{sn.onPostCommitFiberRoot(an,e)}catch(_){}r=!0}return r}finally{Sn=t,Cl.transition=n}}return!1}function Iu(e,n,t){e=Ns(e,n=gi(0,n=ci(t,n),1),1),n=nu(),null!==e&&(bn(e,1,n),au(e,n))}function Tu(e,n,t){if(3===e.tag)Iu(e,e,t);else for(;null!==n;){if(3===n.tag){Iu(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){n=Ns(n,e=mi(n,e=ci(t,e),1),1),e=nu(),null!==n&&(bn(n,1,e),au(n,e));break}}n=n.return}}function xu(e,n,t){var r=e.pingCache;null!==r&&r.delete(n),n=nu(),e.pingedLanes|=e.suspendedLanes&t,El===e&&(Fl&t)===t&&(4===Rl||3===Rl&&(130023424&Fl)===Fl&&500>Je()-Vl?pu(e,0):jl|=t),au(e,n)}function Ou(e,n){0===n&&(0===(1&e.mode)?n=1:(n=dn,0===(130023424&(dn<<=1))&&(dn=4194304)));var t=nu();null!==(e=Ms(e,n))&&(bn(e,n,t),au(e,t))}function Cu(e){var n=e.memoizedState,t=0;null!==n&&(t=n.retryLane),Ou(e,t)}function Mu(e,n){var t=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(t=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(n),Ou(e,t)}function Eu(e,n){return Ke(e,n)}function Au(e,n,t,r){this.tag=e,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fu(e,n,t,r){return new Au(e,n,t,r)}function Pu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nu(e,n){var t=e.alternate;return null===t?((t=Fu(e.tag,n,e.key,e.mode)).elementType=e.elementType,t.type=e.type,t.stateNode=e.stateNode,t.alternate=e,e.alternate=t):(t.pendingProps=n,t.type=e.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=14680064&e.flags,t.childLanes=e.childLanes,t.lanes=e.lanes,t.child=e.child,t.memoizedProps=e.memoizedProps,t.memoizedState=e.memoizedState,t.updateQueue=e.updateQueue,n=e.dependencies,t.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext},t.sibling=e.sibling,t.index=e.index,t.ref=e.ref,t}function Ru(e,n,t,r,a,o){var i=2;if(r=e,"function"===typeof e)Pu(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case k:return Lu(t.children,a,o,n);case I:i=8,a|=8;break;case T:return(e=Fu(12,t,n,2|a)).elementType=T,e.lanes=o,e;case M:return(e=Fu(13,t,n,a)).elementType=M,e.lanes=o,e;case E:return(e=Fu(19,t,n,a)).elementType=E,e.lanes=o,e;case P:return Du(t,a,o,n);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case x:i=10;break e;case O:i=9;break e;case C:i=11;break e;case A:i=14;break e;case F:i=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(n=Fu(i,t,n,a)).elementType=e,n.type=r,n.lanes=o,n}function Lu(e,n,t,r){return(e=Fu(7,e,r,n)).lanes=t,e}function Du(e,n,t,r){return(e=Fu(22,e,r,n)).elementType=P,e.lanes=t,e.stateNode={isHidden:!1},e}function Uu(e,n,t){return(e=Fu(6,e,null,n)).lanes=t,e}function ju(e,n,t){return(n=Fu(4,null!==e.children?e.children:[],e.key,n)).lanes=t,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function zu(e,n,t,r,a){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yn(0),this.expirationTimes=yn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yn(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bu(e,n,t,r,a,s,o,i,l){return e=new zu(e,n,t,i,l),1===n?(n=1,!0===s&&(n|=8)):n=0,s=Fu(3,null,null,n),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},As(s),e}function Vu(e){if(!e)return Oa;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Fa(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(null!==n);throw Error(s(171))}if(1===e.tag){var t=e.type;if(Fa(t))return Ra(e,t,n)}return n}function Gu(e,n,t,r,a,s,o,i,l){return(e=Bu(t,r,!0,e,0,s,0,i,l)).context=Vu(null),t=e.current,(s=Ps(r=nu(),a=tu(t))).callback=void 0!==n&&null!==n?n:null,Ns(t,s,a),e.current.lanes=a,bn(e,a,r),au(e,r),e}function Wu(e,n,t,r){var a=n.current,s=nu(),o=tu(a);return t=Vu(t),null===n.context?n.context=t:n.pendingContext=t,(n=Ps(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(n.callback=r),null!==(e=Ns(a,n,o))&&(ru(e,a,o,s),Rs(e,a,o)),o}function $u(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hu(e,n){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var t=e.retryLane;e.retryLane=0!==t&&t<n?t:n}}function Ku(e,n){Hu(e,n),(e=e.alternate)&&Hu(e,n)}Il=function(e,n,t){if(null!==e)if(e.memoizedProps!==n.pendingProps||Ma.current)Si=!0;else{if(0===(e.lanes&t)&&0===(128&n.flags))return Si=!1,function(e,n,t){switch(n.tag){case 3:Ei(n),ps();break;case 5:so(n);break;case 1:Fa(n.type)&&La(n);break;case 4:ro(n,n.stateNode.containerInfo);break;case 10:var r=n.type._context,a=n.memoizedProps.value;xa(ys,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=n.memoizedState))return null!==r.dehydrated?(xa(io,1&io.current),n.flags|=128,null):0!==(t&n.child.childLanes)?Ui(e,n,t):(xa(io,1&io.current),null!==(e=$i(e,n,t))?e.sibling:null);xa(io,1&io.current);break;case 19:if(r=0!==(t&n.childLanes),0!==(128&e.flags)){if(r)return Gi(e,n,t);n.flags|=128}if(null!==(a=n.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),xa(io,io.current),r)break;return null;case 22:case 23:return n.lanes=0,Ti(e,n,t)}return $i(e,n,t)}(e,n,t);Si=0!==(131072&e.flags)}else Si=!1,as&&0!==(1048576&n.flags)&&Za(n,Ha,n.index);switch(n.lanes=0,n.tag){case 2:var r=n.type;Wi(e,n),e=n.pendingProps;var a=Aa(n,Ca.current);Is(n,t),a=Io(null,n,r,e,a,t);var o=To();return n.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Fa(r)?(o=!0,La(n)):o=!1,n.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,As(n),a.updater=Bs,n.stateNode=a,a._reactInternals=n,$s(n,r,e,t),n=Mi(null,n,r,!0,o,t)):(n.tag=0,as&&o&&es(n),wi(null,n,a,t),n=n.child),n;case 16:r=n.elementType;e:{switch(Wi(e,n),e=n.pendingProps,r=(a=r._init)(r._payload),n.type=r,a=n.tag=function(e){if("function"===typeof e)return Pu(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===A)return 14}return 2}(r),e=hs(r,e),a){case 0:n=Oi(null,n,r,e,t);break e;case 1:n=Ci(null,n,r,e,t);break e;case 11:n=_i(null,n,r,e,t);break e;case 14:n=ki(null,n,r,hs(r.type,e),t);break e}throw Error(s(306,r,""))}return n;case 0:return r=n.type,a=n.pendingProps,Oi(e,n,r,a=n.elementType===r?a:hs(r,a),t);case 1:return r=n.type,a=n.pendingProps,Ci(e,n,r,a=n.elementType===r?a:hs(r,a),t);case 3:e:{if(Ei(n),null===e)throw Error(s(387));r=n.pendingProps,a=(o=n.memoizedState).element,Fs(e,n),Ds(n,r,null,t);var i=n.memoizedState;if(r=i.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},n.updateQueue.baseState=o,n.memoizedState=o,256&n.flags){n=Ai(e,n,r,t,a=ci(Error(s(423)),n));break e}if(r!==a){n=Ai(e,n,r,t,a=ci(Error(s(424)),n));break e}for(rs=ua(n.stateNode.containerInfo.firstChild),ts=n,as=!0,ss=null,t=Js(n,null,r,t),n.child=t;t;)t.flags=-3&t.flags|4096,t=t.sibling}else{if(ps(),r===a){n=$i(e,n,t);break e}wi(e,n,r,t)}n=n.child}return n;case 5:return so(n),null===e&&us(n),r=n.type,a=n.pendingProps,o=null!==e?e.memoizedProps:null,i=a.children,ta(r,a)?i=null:null!==o&&ta(r,o)&&(n.flags|=32),xi(e,n),wi(e,n,i,t),n.child;case 6:return null===e&&us(n),null;case 13:return Ui(e,n,t);case 4:return ro(n,n.stateNode.containerInfo),r=n.pendingProps,null===e?n.child=Xs(n,null,r,t):wi(e,n,r,t),n.child;case 11:return r=n.type,a=n.pendingProps,_i(e,n,r,a=n.elementType===r?a:hs(r,a),t);case 7:return wi(e,n,n.pendingProps,t),n.child;case 8:case 12:return wi(e,n,n.pendingProps.children,t),n.child;case 10:e:{if(r=n.type._context,a=n.pendingProps,o=n.memoizedProps,i=a.value,xa(ys,r._currentValue),r._currentValue=i,null!==o)if(ir(o.value,i)){if(o.children===a.children&&!Ma.current){n=$i(e,n,t);break e}}else for(null!==(o=n.child)&&(o.return=n);null!==o;){var l=o.dependencies;if(null!==l){i=o.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===o.tag){(u=Ps(-1,t&-t)).tag=2;var c=o.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}o.lanes|=t,null!==(u=o.alternate)&&(u.lanes|=t),ks(o.return,t,n),l.lanes|=t;break}u=u.next}}else if(10===o.tag)i=o.type===n.type?null:o.child;else if(18===o.tag){if(null===(i=o.return))throw Error(s(341));i.lanes|=t,null!==(l=i.alternate)&&(l.lanes|=t),ks(i,t,n),i=o.sibling}else i=o.child;if(null!==i)i.return=o;else for(i=o;null!==i;){if(i===n){i=null;break}if(null!==(o=i.sibling)){o.return=i.return,i=o;break}i=i.return}o=i}wi(e,n,a.children,t),n=n.child}return n;case 9:return a=n.type,r=n.pendingProps.children,Is(n,t),r=r(a=Ts(a)),n.flags|=1,wi(e,n,r,t),n.child;case 14:return a=hs(r=n.type,n.pendingProps),ki(e,n,r,a=hs(r.type,a),t);case 15:return Ii(e,n,n.type,n.pendingProps,t);case 17:return r=n.type,a=n.pendingProps,a=n.elementType===r?a:hs(r,a),Wi(e,n),n.tag=1,Fa(r)?(e=!0,La(n)):e=!1,Is(n,t),Gs(n,r,a),$s(n,r,a,t),Mi(null,n,r,!0,e,t);case 19:return Gi(e,n,t);case 22:return Ti(e,n,t)}throw Error(s(156,n.tag))};var qu="function"===typeof reportError?reportError:function(e){console.error(e)};function Yu(e){this._internalRoot=e}function Xu(e){this._internalRoot=e}function Ju(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zu(){}function ec(e,n,t,r,a){var s=t._reactRootContainer;if(s){var o=s;if("function"===typeof a){var i=a;a=function(){var e=$u(o);i.call(e)}}Wu(n,o,e,a)}else o=function(e,n,t,r,a){if(a){if("function"===typeof r){var s=r;r=function(){var e=$u(o);s.call(e)}}var o=Gu(n,r,e,0,null,!1,0,"",Zu);return e._reactRootContainer=o,e[ga]=o.current,Vr(8===e.nodeType?e.parentNode:e),du(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var i=r;r=function(){var e=$u(l);i.call(e)}}var l=Bu(e,0,!1,null,0,!1,0,"",Zu);return e._reactRootContainer=l,e[ga]=l.current,Vr(8===e.nodeType?e.parentNode:e),du((function(){Wu(n,l,t,r)})),l}(t,n,e,a,r);return $u(o)}Xu.prototype.render=Yu.prototype.render=function(e){var n=this._internalRoot;if(null===n)throw Error(s(409));Wu(e,n,null,null)},Xu.prototype.unmount=Yu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var n=e.containerInfo;du((function(){Wu(null,e,null,null)})),n[ga]=null}},Xu.prototype.unstable_scheduleHydration=function(e){if(e){var n=Tn();e={blockedOn:null,target:e,priority:n};for(var t=0;t<Nn.length&&0!==n&&n<Nn[t].priority;t++);Nn.splice(t,0,e),0===t&&Un(e)}},_n=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var t=fn(n.pendingLanes);0!==t&&(vn(n,1|t),au(n,Je()),0===(6&Ml)&&(Gl=Je()+500,Va()))}break;case 13:du((function(){var n=Ms(e,1);if(null!==n){var t=nu();ru(n,e,1,t)}})),Ku(e,1)}},kn=function(e){if(13===e.tag){var n=Ms(e,134217728);if(null!==n)ru(n,e,134217728,nu());Ku(e,134217728)}},In=function(e){if(13===e.tag){var n=tu(e),t=Ms(e,n);if(null!==t)ru(t,e,n,nu());Ku(e,n)}},Tn=function(){return Sn},xn=function(e,n){var t=Sn;try{return Sn=e,n()}finally{Sn=t}},_e=function(e,n,t){switch(n){case"input":if(Q(e,t),n=t.name,"radio"===t.type&&null!=n){for(t=e;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<t.length;n++){var r=t[n];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(s(90));K(r),Q(r,a)}}}break;case"textarea":se(e,t);break;case"select":null!=(n=t.value)&&te(e,!!t.multiple,n,!1)}},Ce=cu,Me=du;var nc={usingClientEntryPoint:!1,Events:[va,Sa,wa,xe,Oe,cu]},tc={findFiberByHostInstance:ba,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rc={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=$e(e))?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ac=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ac.isDisabled&&ac.supportsFiber)try{an=ac.inject(rc),sn=ac}catch(ce){}}n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nc,n.createPortal=function(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ju(n))throw Error(s(200));return function(e,n,t){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:n,implementation:t}}(e,n,null,t)},n.createRoot=function(e,n){if(!Ju(e))throw Error(s(299));var t=!1,r="",a=qu;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(t=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),n=Bu(e,1,!1,null,0,t,0,r,a),e[ga]=n.current,Vr(8===e.nodeType?e.parentNode:e),new Yu(n)},n.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var n=e._reactInternals;if(void 0===n){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=$e(n))?null:e.stateNode},n.flushSync=function(e){return du(e)},n.hydrate=function(e,n,t){if(!Qu(n))throw Error(s(200));return ec(null,e,n,!0,t)},n.hydrateRoot=function(e,n,t){if(!Ju(e))throw Error(s(405));var r=null!=t&&t.hydratedSources||null,a=!1,o="",i=qu;if(null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(a=!0),void 0!==t.identifierPrefix&&(o=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),n=Gu(n,null,e,1,null!=t?t:null,a,0,o,i),e[ga]=n.current,Vr(e),r)for(e=0;e<r.length;e++)a=(a=(t=r[e])._getVersion)(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,a]:n.mutableSourceEagerHydrationData.push(t,a);return new Xu(n)},n.render=function(e,n,t){if(!Qu(n))throw Error(s(200));return ec(null,e,n,!1,t)},n.unmountComponentAtNode=function(e){if(!Qu(e))throw Error(s(40));return!!e._reactRootContainer&&(du((function(){ec(null,null,e,!1,(function(){e._reactRootContainer=null,e[ga]=null}))})),!0)},n.unstable_batchedUpdates=cu,n.unstable_renderSubtreeIntoContainer=function(e,n,t,r){if(!Qu(t))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return ec(e,n,t,!1,r)},n.version="18.2.0-next-9e3b772b8-20220608"},250:(e,n,t)=>{"use strict";var r=t(164);n.createRoot=r.createRoot,n.hydrateRoot=r.hydrateRoot},164:(e,n,t)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}(),e.exports=t(463)},372:(e,n)=>{"use strict";var t,r=Symbol.for("react.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),h=Symbol.for("react.offscreen");function y(e){if("object"===typeof e&&null!==e){var n=e.$$typeof;switch(n){case r:switch(e=e.type){case s:case i:case o:case f:case p:return e;default:switch(e=e&&e.$$typeof){case c:case u:case d:case m:case g:case l:return e;default:return n}}case a:return n}}}t=Symbol.for("react.module.reference"),n.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===s||e===i||e===o||e===f||e===p||e===h||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===l||e.$$typeof===u||e.$$typeof===d||e.$$typeof===t||void 0!==e.getModuleId)},n.typeOf=y},441:(e,n,t)=>{"use strict";e.exports=t(372)},374:(e,n,t)=>{"use strict";var r=t(791),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,n,t){var r,s={},u=null,c=null;for(r in void 0!==t&&(u=""+t),void 0!==n.key&&(u=""+n.key),void 0!==n.ref&&(c=n.ref),n)o.call(n,r)&&!l.hasOwnProperty(r)&&(s[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===s[r]&&(s[r]=n[r]);return{$$typeof:a,type:e,key:u,ref:c,props:s,_owner:i.current}}n.Fragment=s,n.jsx=u,n.jsxs=u},117:(e,n)=>{"use strict";var t=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,h={};function y(e,n,t){this.props=e,this.context=n,this.refs=h,this.updater=t||g}function b(){}function v(e,n,t){this.props=e,this.context=n,this.refs=h,this.updater=t||g}y.prototype.isReactComponent={},y.prototype.setState=function(e,n){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var S=v.prototype=new b;S.constructor=v,m(S,y.prototype),S.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,k={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function T(e,n,r){var a,s={},o=null,i=null;if(null!=n)for(a in void 0!==n.ref&&(i=n.ref),void 0!==n.key&&(o=""+n.key),n)_.call(n,a)&&!I.hasOwnProperty(a)&&(s[a]=n[a]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===s[a]&&(s[a]=l[a]);return{$$typeof:t,type:e,key:o,ref:i,props:s,_owner:k.current}}function x(e){return"object"===typeof e&&null!==e&&e.$$typeof===t}var O=/\/+/g;function C(e,n){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return n[e]}))}(""+e.key):n.toString(36)}function M(e,n,a,s,o){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l=!1;if(null===e)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case t:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+C(l,0):s,w(o)?(a="",null!=e&&(a=e.replace(O,"$&/")+"/"),M(o,n,a,"",(function(e){return e}))):null!=o&&(x(o)&&(o=function(e,n){return{$$typeof:t,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(O,"$&/")+"/")+e)),n.push(o)),1;if(l=0,s=""===s?".":s+":",w(e))for(var u=0;u<e.length;u++){var c=s+C(i=e[u],u);l+=M(i,n,a,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(i=e.next()).done;)l+=M(i=i.value,n,a,c=s+C(i,u++),o);else if("object"===i)throw n=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return l}function E(e,n,t){if(null==e)return e;var r=[],a=0;return M(e,r,"","",(function(e){return n.call(t,e,a++)})),r}function A(e){if(-1===e._status){var n=e._result;(n=n()).then((function(n){0!==e._status&&-1!==e._status||(e._status=1,e._result=n)}),(function(n){0!==e._status&&-1!==e._status||(e._status=2,e._result=n)})),-1===e._status&&(e._status=0,e._result=n)}if(1===e._status)return e._result.default;throw e._result}var F={current:null},P={transition:null},N={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:P,ReactCurrentOwner:k};n.Children={map:E,forEach:function(e,n,t){E(e,(function(){n.apply(this,arguments)}),t)},count:function(e){var n=0;return E(e,(function(){n++})),n},toArray:function(e){return E(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},n.Component=y,n.Fragment=a,n.Profiler=o,n.PureComponent=v,n.StrictMode=s,n.Suspense=c,n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,n.cloneElement=function(e,n,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),s=e.key,o=e.ref,i=e._owner;if(null!=n){if(void 0!==n.ref&&(o=n.ref,i=k.current),void 0!==n.key&&(s=""+n.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in n)_.call(n,u)&&!I.hasOwnProperty(u)&&(a[u]=void 0===n[u]&&void 0!==l?l[u]:n[u])}var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];a.children=l}return{$$typeof:t,type:e.type,key:s,ref:o,props:a,_owner:i}},n.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},n.createElement=T,n.createFactory=function(e){var n=T.bind(null,e);return n.type=e,n},n.createRef=function(){return{current:null}},n.forwardRef=function(e){return{$$typeof:u,render:e}},n.isValidElement=x,n.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:A}},n.memo=function(e,n){return{$$typeof:d,type:e,compare:void 0===n?null:n}},n.startTransition=function(e){var n=P.transition;P.transition={};try{e()}finally{P.transition=n}},n.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},n.useCallback=function(e,n){return F.current.useCallback(e,n)},n.useContext=function(e){return F.current.useContext(e)},n.useDebugValue=function(){},n.useDeferredValue=function(e){return F.current.useDeferredValue(e)},n.useEffect=function(e,n){return F.current.useEffect(e,n)},n.useId=function(){return F.current.useId()},n.useImperativeHandle=function(e,n,t){return F.current.useImperativeHandle(e,n,t)},n.useInsertionEffect=function(e,n){return F.current.useInsertionEffect(e,n)},n.useLayoutEffect=function(e,n){return F.current.useLayoutEffect(e,n)},n.useMemo=function(e,n){return F.current.useMemo(e,n)},n.useReducer=function(e,n,t){return F.current.useReducer(e,n,t)},n.useRef=function(e){return F.current.useRef(e)},n.useState=function(e){return F.current.useState(e)},n.useSyncExternalStore=function(e,n,t){return F.current.useSyncExternalStore(e,n,t)},n.useTransition=function(){return F.current.useTransition()},n.version="18.2.0"},791:(e,n,t)=>{"use strict";e.exports=t(117)},184:(e,n,t)=>{"use strict";e.exports=t(374)},457:(e,n,t)=>{"use strict";n.Z=void 0;var r,a=t(588),s=(r=t(936))&&r.__esModule?r:{default:r};function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e){var n,t=e.store,r=e.params,o=e.replaceState,i=e.initialTruth,l=e.history,u=void 0===l?(0,a.createBrowserHistory)():l,c=t.dispatch,d=!1,f=!1;function p(e){return Object.hasOwnProperty.call(e,"location")?e.location:Object.hasOwnProperty.call(e,"getCurrentLocation")?e.getCurrentLocation():void 0}function g(e){var n=new s.default(e.search),t={};return Object.keys(r).forEach((function(e){var a=r[e],s=a.defaultValue,o=a.stringToValue,i=void 0===o?function(e){return e}:o,l=n.get(e),u=null===l?s:i(l);t[e]=u})),t}function m(e){if(void 0!==e.location&&(e=e.location),!d){var a=t.getState(),s=g(e),o=[];Object.keys(s).forEach((function(e){var t=s[e];if(void 0===n||n[e]!==t){var i=r[e],l=i.selector,u=i.action;l(a)!==t&&o.push(u(t))}})),n=s,f=!0,o.forEach((function(e){c(e)})),f=!1,h({replaceState:!0})}}function h(e){var a=e.replaceState;if(!f){var o=t.getState(),i=p(u),l=new s.default(i.search);Object.keys(r).forEach((function(e){var t=r[e],a=t.selector,s=t.defaultValue,i=t.valueToString,u=void 0===i?function(e){return"".concat(e)}:i,c=a(o);c===s?l.delete(e):l.set(e,u(c)),n[e]=c}));var c="?".concat(l);if(c!==(i.search||"?")){d=!0;var g={pathname:i.pathname,search:c,hash:i.hash,state:i.state};a?u.replace(g):u.push(g),d=!1}}}var y=u.listen(m),b=t.subscribe((function(){return h({replaceState:o})}));return"location"===i?m(p(u)):n=g(p(u)),"store"===i&&h({replaceState:!0}),function(){y(),b()}}l.enhancer=function(e){return function(n){return function(t,r,a){var s=n(t,r,a);return l(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(t,!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({store:s},e)),s}}};var u=l;n.Z=u},813:(e,n)=>{"use strict";function t(e,n){var t=e.length;e.push(n);e:for(;0<t;){var r=t-1>>>1,a=e[r];if(!(0<s(a,n)))break e;e[r]=n,e[t]=a,t=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var n=e[0],t=e.pop();if(t!==n){e[0]=t;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var i=2*(r+1)-1,l=e[i],u=i+1,c=e[u];if(0>s(l,t))u<a&&0>s(c,l)?(e[r]=c,e[u]=t,r=u):(e[r]=l,e[i]=t,r=i);else{if(!(u<a&&0>s(c,t)))break e;e[r]=c,e[u]=t,r=u}}}return n}function s(e,n){var t=e.sortIndex-n.sortIndex;return 0!==t?t:e.id-n.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;n.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();n.unstable_now=function(){return i.now()-l}}var u=[],c=[],d=1,f=null,p=3,g=!1,m=!1,h=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function S(e){for(var n=r(c);null!==n;){if(null===n.callback)a(c);else{if(!(n.startTime<=e))break;a(c),n.sortIndex=n.expirationTime,t(u,n)}n=r(c)}}function w(e){if(h=!1,S(e),!m)if(null!==r(u))m=!0,P(_);else{var n=r(c);null!==n&&N(w,n.startTime-e)}}function _(e,t){m=!1,h&&(h=!1,b(x),x=-1),g=!0;var s=p;try{for(S(t),f=r(u);null!==f&&(!(f.expirationTime>t)||e&&!M());){var o=f.callback;if("function"===typeof o){f.callback=null,p=f.priorityLevel;var i=o(f.expirationTime<=t);t=n.unstable_now(),"function"===typeof i?f.callback=i:f===r(u)&&a(u),S(t)}else a(u);f=r(u)}if(null!==f)var l=!0;else{var d=r(c);null!==d&&N(w,d.startTime-t),l=!1}return l}finally{f=null,p=s,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,I=!1,T=null,x=-1,O=5,C=-1;function M(){return!(n.unstable_now()-C<O)}function E(){if(null!==T){var e=n.unstable_now();C=e;var t=!0;try{t=T(!0,e)}finally{t?k():(I=!1,T=null)}}else I=!1}if("function"===typeof v)k=function(){v(E)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,F=A.port2;A.port1.onmessage=E,k=function(){F.postMessage(null)}}else k=function(){y(E,0)};function P(e){T=e,I||(I=!0,k())}function N(e,t){x=y((function(){e(n.unstable_now())}),t)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(e){e.callback=null},n.unstable_continueExecution=function(){m||g||(m=!0,P(_))},n.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<e?Math.floor(1e3/e):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return r(u)},n.unstable_next=function(e){switch(p){case 1:case 2:case 3:var n=3;break;default:n=p}var t=p;p=n;try{return e()}finally{p=t}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(e,n){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var t=p;p=e;try{return n()}finally{p=t}},n.unstable_scheduleCallback=function(e,a,s){var o=n.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:s,expirationTime:i=s+i,sortIndex:-1},s>o?(e.sortIndex=s,t(c,e),null===r(u)&&e===r(c)&&(h?(b(x),x=-1):h=!0,N(w,s-o))):(e.sortIndex=i,t(u,e),m||g||(m=!0,P(_))),e},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(e){var n=p;return function(){var t=p;p=n;try{return e.apply(this,arguments)}finally{p=t}}}},296:(e,n,t)=>{"use strict";e.exports=t(813)},613:e=>{e.exports=function(e,n,t,r){var a=t?t.call(r,e,n):void 0;if(void 0!==a)return!!a;if(e===n)return!0;if("object"!==typeof e||!e||"object"!==typeof n||!n)return!1;var s=Object.keys(e),o=Object.keys(n);if(s.length!==o.length)return!1;for(var i=Object.prototype.hasOwnProperty.bind(n),l=0;l<s.length;l++){var u=s[l];if(!i(u))return!1;var c=e[u],d=n[u];if(!1===(a=t?t.call(r,c,d,u):void 0)||void 0===a&&c!==d)return!1}return!0}},561:(e,n,t)=>{"use strict";var r=t(791);var a="function"===typeof Object.is?Object.is:function(e,n){return e===n&&(0!==e||1/e===1/n)||e!==e&&n!==n},s=r.useState,o=r.useEffect,i=r.useLayoutEffect,l=r.useDebugValue;function u(e){var n=e.getSnapshot;e=e.value;try{var t=n();return!a(e,t)}catch(r){return!0}}var c="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,n){return n()}:function(e,n){var t=n(),r=s({inst:{value:t,getSnapshot:n}}),a=r[0].inst,c=r[1];return i((function(){a.value=t,a.getSnapshot=n,u(a)&&c({inst:a})}),[e,t,n]),o((function(){return u(a)&&c({inst:a}),e((function(){u(a)&&c({inst:a})}))}),[e]),l(t),t};n.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:c},595:(e,n,t)=>{"use strict";var r=t(791),a=t(248);var s="function"===typeof Object.is?Object.is:function(e,n){return e===n&&(0!==e||1/e===1/n)||e!==e&&n!==n},o=a.useSyncExternalStore,i=r.useRef,l=r.useEffect,u=r.useMemo,c=r.useDebugValue;n.useSyncExternalStoreWithSelector=function(e,n,t,r,a){var d=i(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;d=u((function(){function e(e){if(!l){if(l=!0,o=e,e=r(e),void 0!==a&&f.hasValue){var n=f.value;if(a(n,e))return i=n}return i=e}if(n=i,s(o,e))return n;var t=r(e);return void 0!==a&&a(n,t)?n:(o=e,i=t)}var o,i,l=!1,u=void 0===t?null:t;return[function(){return e(n())},null===u?void 0:function(){return e(u())}]}),[n,t,r,a]);var p=o(e,d[0],d[1]);return l((function(){f.hasValue=!0,f.value=p}),[p]),c(p),p}},248:(e,n,t)=>{"use strict";e.exports=t(561)},327:(e,n,t)=>{"use strict";e.exports=t(595)},494:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfEAAABTCAYAAACPkT4sAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAABGRJREFUeJzt3b2LpWcdxvHrPjsYk0IlWARTpFhlTmwkWmhnLIyBWDwklYhV8K1KlZkJmGYRnBlsgghGgoJJBAvjIyiolfGlFDW+7BxICgNbicKKLyjJ3P4FSnafM3PPL/v59PM71zzDme9wmmmbHPQs87396eThhTeG+9K8+7FV2o+W3Gjpn9ubNk9va9NZOJzXP23Jh0fvWKqlf3xv2vxw9I7/52i+9+WkXx69Y6me1fsOpj++NHrHWTqedx/qaT8YvWOpnrx4MJ3cP3rHWTuc1z9uyQOjdyzV0h7Zm66+sOTGaltjAIDzJeIAUJSIA0BRIg4ARYk4ABQl4gBQlIgDQFEiDgBFiTgAFCXiAFCUiANAUSIOAEWJOAAUJeIAUJSIA0BRO6MHJMnh/N6PrHL6niU3ruWt33hq+s1r29rE//TvpH9r9IjXk1dHbzh77a/J6XfHbljd19IfOZ7XH7rZCz25vj+dfGebqy6onyV9M3JAS/vg8bz+zLIb/ZePT5s/bGvTBfVa0r85dkK7fJr+0eN5/c4lVy5ExFc5fbQnn1xy4878/fkkIn7GWvLPvWmz6JcEb1S/tj/4WR/O6ydbcqUvutJeSXIrRPzZ/WnzzMgBR/P6zz15etmV1WNJ3tQR78l/Dga/t47n9SeSfHvZe8vH6QBQlogDQFEiDgBFiTgAFCXiAFCUiANAUSIOAEWJOAAUJeIAUJSIA0BRIg4ARYk4ABQl4gBQlIgDQFEiDgBFXYj/J04dPXnb4bz7q9E7WvLY/rT5xegdZ+zdo591S+4a+frFfOFw3v384A2vnCYPLjmwk7y6rTGcPRHnRl1qae8fPaKlv330hnNw+0V41rxh97S0e0YO6MmLT0wnw//I5vz4OB0AihJxAChKxAGgKBEHgKJEHACKEnEAKErEAaAoEQeAokQcAIoScQAoSsQBoCgRB4CiRBwAihJxACjKvyLlRr3e0387ekSS66MHnIN/9fSrIwe0tLuSvGvkhkL+1NP/MnJAS9uMfH3On4hzQ1ryt/1p84HRO24RLx8MftaH8/rJllwZuaGQLx5Mm2dGj+DW4uN0AChKxAGgKBEHgKJEHACKEnEAKErEAaAoEQeAokQcAIoScQAoSsQBoCgRB4CiRBwAihJxAChKxAGgKBEHgKJ2WvLZJQdO095xNO9+fcmNnv77lrZox23Z+fLRvHvp5jfk+tJnkfSfL/v6i68ndyz9eW/DafKVJ6bN70bvOFvt7vHPut2X5EpLv3azF3r69S0OgsVa8pbR762eXO7J11bJr5fc2dmbThZ9I8fzvQ/3tKMlN3r6p/ank+eW3Dic1/9I2h0LTvxkbzp5fMmGW8RtSfv06BGX0r+f5E0e8X7n+Gfd07N6dH+6+tLYHbBVO+PfW8kq7at709UXlt0AAEoScQAoSsQBoCgRB4CiRBwAihJxAChKxAGgKBEHgKJEHACKEnEAKErEAaAoEQeAokQcAIoScQAoSsQBoKj/ApGS0l+mZnzQAAAAAElFTkSuQmCC"},462:(e,n,t)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},r.apply(this,arguments)}t.d(n,{Z:()=>r})}},n={};function t(r){var a=n[r];if(void 0!==a)return a.exports;var s=n[r]={exports:{}};return e[r](s,s.exports,t),s.exports}t.m=e,t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.f={},t.e=e=>Promise.all(Object.keys(t.f).reduce(((n,r)=>(t.f[r](e,n),n)),[])),t.u=e=>"static/js/"+e+".4f652202.chunk.js",t.miniCssF=e=>{},t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={},n="webpd_website:";t.l=(r,a,s,o)=>{if(e[r])e[r].push(a);else{var i,l;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==n+s){i=d;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,t.nc&&i.setAttribute("nonce",t.nc),i.setAttribute("data-webpack",n+s),i.src=r),e[r]=[a];var f=(n,t)=>{i.onerror=i.onload=null,clearTimeout(p);var a=e[r];if(delete e[r],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((e=>e(t))),n)return n(t)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=f.bind(null,i.onerror),i.onload=f.bind(null,i.onload),l&&document.head.appendChild(i)}}})(),t.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.p="./",(()=>{t.b=document.baseURI||self.location.href;var e={179:0};t.f.j=(n,r)=>{var a=t.o(e,n)?e[n]:void 0;if(0!==a)if(a)r.push(a[2]);else{var s=new Promise(((t,r)=>a=e[n]=[t,r]));r.push(a[2]=s);var o=t.p+t.u(n),i=new Error;t.l(o,(r=>{if(t.o(e,n)&&(0!==(a=e[n])&&(e[n]=void 0),a)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;i.message="Loading chunk "+n+" failed.\n("+s+": "+o+")",i.name="ChunkLoadError",i.type=s,i.request=o,a[1](i)}}),"chunk-"+n,n)}};var n=(n,r)=>{var a,s,o=r[0],i=r[1],l=r[2],u=0;if(o.some((n=>0!==e[n]))){for(a in i)t.o(i,a)&&(t.m[a]=i[a]);if(l)l(t)}for(n&&n(r);u<o.length;u++)s=o[u],t.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkwebpd_website=self.webpackChunkwebpd_website||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))})(),t.nc=void 0,(()=>{"use strict";var e=t(791),n=t(250);function r(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}var a=t(441),s=t(613),o=t.n(s);const i=function(e){function n(e,r,l,u,f){for(var p,g,m,h,S,_=0,k=0,I=0,T=0,x=0,F=0,N=m=p=0,L=0,D=0,U=0,j=0,z=l.length,B=z-1,V="",G="",W="",$="";L<z;){if(g=l.charCodeAt(L),L===B&&0!==k+T+I+_&&(0!==k&&(g=47===k?10:47),T=I=_=0,z++,B++),0===k+T+I+_){if(L===B&&(0<D&&(V=V.replace(d,"")),0<V.trim().length)){switch(g){case 32:case 9:case 59:case 13:case 10:break;default:V+=l.charAt(L)}g=59}switch(g){case 123:for(p=(V=V.trim()).charCodeAt(0),m=1,j=++L;L<z;){switch(g=l.charCodeAt(L)){case 123:m++;break;case 125:m--;break;case 47:switch(g=l.charCodeAt(L+1)){case 42:case 47:e:{for(N=L+1;N<B;++N)switch(l.charCodeAt(N)){case 47:if(42===g&&42===l.charCodeAt(N-1)&&L+2!==N){L=N+1;break e}break;case 10:if(47===g){L=N+1;break e}}L=N}}break;case 91:g++;case 40:g++;case 34:case 39:for(;L++<B&&l.charCodeAt(L)!==g;);}if(0===m)break;L++}if(m=l.substring(j,L),0===p&&(p=(V=V.replace(c,"").trim()).charCodeAt(0)),64===p){switch(0<D&&(V=V.replace(d,"")),g=V.charCodeAt(1)){case 100:case 109:case 115:case 45:D=r;break;default:D=A}if(j=(m=n(r,D,m,g,f+1)).length,0<P&&(S=i(3,m,D=t(A,V,U),r,C,O,j,g,f,u),V=D.join(""),void 0!==S&&0===(j=(m=S.trim()).length)&&(g=0,m="")),0<j)switch(g){case 115:V=V.replace(w,o);case 100:case 109:case 45:m=V+"{"+m+"}";break;case 107:m=(V=V.replace(y,"$1 $2"))+"{"+m+"}",m=1===E||2===E&&s("@"+m,3)?"@-webkit-"+m+"@"+m:"@"+m;break;default:m=V+m,112===u&&(G+=m,m="")}else m=""}else m=n(r,t(r,V,U),m,u,f+1);W+=m,m=U=D=N=p=0,V="",g=l.charCodeAt(++L);break;case 125:case 59:if(1<(j=(V=(0<D?V.replace(d,""):V).trim()).length))switch(0===N&&(p=V.charCodeAt(0),45===p||96<p&&123>p)&&(j=(V=V.replace(" ",":")).length),0<P&&void 0!==(S=i(1,V,r,e,C,O,G.length,u,f,u))&&0===(j=(V=S.trim()).length)&&(V="\0\0"),p=V.charCodeAt(0),g=V.charCodeAt(1),p){case 0:break;case 64:if(105===g||99===g){$+=V+l.charAt(L);break}default:58!==V.charCodeAt(j-1)&&(G+=a(V,p,g,V.charCodeAt(2)))}U=D=N=p=0,V="",g=l.charCodeAt(++L)}}switch(g){case 13:case 10:47===k?k=0:0===1+p&&107!==u&&0<V.length&&(D=1,V+="\0"),0<P*R&&i(0,V,r,e,C,O,G.length,u,f,u),O=1,C++;break;case 59:case 125:if(0===k+T+I+_){O++;break}default:switch(O++,h=l.charAt(L),g){case 9:case 32:if(0===T+_+k)switch(x){case 44:case 58:case 9:case 32:h="";break;default:32!==g&&(h=" ")}break;case 0:h="\\0";break;case 12:h="\\f";break;case 11:h="\\v";break;case 38:0===T+k+_&&(D=U=1,h="\f"+h);break;case 108:if(0===T+k+_+M&&0<N)switch(L-N){case 2:112===x&&58===l.charCodeAt(L-3)&&(M=x);case 8:111===F&&(M=F)}break;case 58:0===T+k+_&&(N=L);break;case 44:0===k+I+T+_&&(D=1,h+="\r");break;case 34:case 39:0===k&&(T=T===g?0:0===T?g:T);break;case 91:0===T+k+I&&_++;break;case 93:0===T+k+I&&_--;break;case 41:0===T+k+_&&I--;break;case 40:if(0===T+k+_){if(0===p)if(2*x+3*F===533);else p=1;I++}break;case 64:0===k+I+T+_+N+m&&(m=1);break;case 42:case 47:if(!(0<T+_+I))switch(k){case 0:switch(2*g+3*l.charCodeAt(L+1)){case 235:k=47;break;case 220:j=L,k=42}break;case 42:47===g&&42===x&&j+2!==L&&(33===l.charCodeAt(j+2)&&(G+=l.substring(j,L+1)),h="",k=0)}}0===k&&(V+=h)}F=x,x=g,L++}if(0<(j=G.length)){if(D=r,0<P&&(void 0!==(S=i(2,G,D,e,C,O,j,u,f,u))&&0===(G=S).length))return $+G+W;if(G=D.join(",")+"{"+G+"}",0!==E*M){switch(2!==E||s(G,2)||(M=0),M){case 111:G=G.replace(v,":-moz-$1")+G;break;case 112:G=G.replace(b,"::-webkit-input-$1")+G.replace(b,"::-moz-$1")+G.replace(b,":-ms-input-$1")+G}M=0}}return $+G+W}function t(e,n,t){var a=n.trim().split(m);n=a;var s=a.length,o=e.length;switch(o){case 0:case 1:var i=0;for(e=0===o?"":e[0]+" ";i<s;++i)n[i]=r(e,n[i],t).trim();break;default:var l=i=0;for(n=[];i<s;++i)for(var u=0;u<o;++u)n[l++]=r(e[u]+" ",a[i],t).trim()}return n}function r(e,n,t){var r=n.charCodeAt(0);switch(33>r&&(r=(n=n.trim()).charCodeAt(0)),r){case 38:return n.replace(h,"$1"+e.trim());case 58:return e.trim()+n.replace(h,"$1"+e.trim());default:if(0<1*t&&0<n.indexOf("\f"))return n.replace(h,(58===e.charCodeAt(0)?"":"$1")+e.trim())}return e+n}function a(e,n,t,r){var o=e+";",i=2*n+3*t+4*r;if(944===i){e=o.indexOf(":",9)+1;var l=o.substring(e,o.length-1).trim();return l=o.substring(0,e).trim()+l+";",1===E||2===E&&s(l,1)?"-webkit-"+l+l:l}if(0===E||2===E&&!s(o,1))return o;switch(i){case 1015:return 97===o.charCodeAt(10)?"-webkit-"+o+o:o;case 951:return 116===o.charCodeAt(3)?"-webkit-"+o+o:o;case 963:return 110===o.charCodeAt(5)?"-webkit-"+o+o:o;case 1009:if(100!==o.charCodeAt(4))break;case 969:case 942:return"-webkit-"+o+o;case 978:return"-webkit-"+o+"-moz-"+o+o;case 1019:case 983:return"-webkit-"+o+"-moz-"+o+"-ms-"+o+o;case 883:if(45===o.charCodeAt(8))return"-webkit-"+o+o;if(0<o.indexOf("image-set(",11))return o.replace(x,"$1-webkit-$2")+o;break;case 932:if(45===o.charCodeAt(4))switch(o.charCodeAt(5)){case 103:return"-webkit-box-"+o.replace("-grow","")+"-webkit-"+o+"-ms-"+o.replace("grow","positive")+o;case 115:return"-webkit-"+o+"-ms-"+o.replace("shrink","negative")+o;case 98:return"-webkit-"+o+"-ms-"+o.replace("basis","preferred-size")+o}return"-webkit-"+o+"-ms-"+o+o;case 964:return"-webkit-"+o+"-ms-flex-"+o+o;case 1023:if(99!==o.charCodeAt(8))break;return"-webkit-box-pack"+(l=o.substring(o.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+o+"-ms-flex-pack"+l+o;case 1005:return p.test(o)?o.replace(f,":-webkit-")+o.replace(f,":-moz-")+o:o;case 1e3:switch(n=(l=o.substring(13).trim()).indexOf("-")+1,l.charCodeAt(0)+l.charCodeAt(n)){case 226:l=o.replace(S,"tb");break;case 232:l=o.replace(S,"tb-rl");break;case 220:l=o.replace(S,"lr");break;default:return o}return"-webkit-"+o+"-ms-"+l+o;case 1017:if(-1===o.indexOf("sticky",9))break;case 975:switch(n=(o=e).length-10,i=(l=(33===o.charCodeAt(n)?o.substring(0,n):o).substring(e.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|l.charCodeAt(7))){case 203:if(111>l.charCodeAt(8))break;case 115:o=o.replace(l,"-webkit-"+l)+";"+o;break;case 207:case 102:o=o.replace(l,"-webkit-"+(102<i?"inline-":"")+"box")+";"+o.replace(l,"-webkit-"+l)+";"+o.replace(l,"-ms-"+l+"box")+";"+o}return o+";";case 938:if(45===o.charCodeAt(5))switch(o.charCodeAt(6)){case 105:return l=o.replace("-items",""),"-webkit-"+o+"-webkit-box-"+l+"-ms-flex-"+l+o;case 115:return"-webkit-"+o+"-ms-flex-item-"+o.replace(k,"")+o;default:return"-webkit-"+o+"-ms-flex-line-pack"+o.replace("align-content","").replace(k,"")+o}break;case 973:case 989:if(45!==o.charCodeAt(3)||122===o.charCodeAt(4))break;case 931:case 953:if(!0===T.test(e))return 115===(l=e.substring(e.indexOf(":")+1)).charCodeAt(0)?a(e.replace("stretch","fill-available"),n,t,r).replace(":fill-available",":stretch"):o.replace(l,"-webkit-"+l)+o.replace(l,"-moz-"+l.replace("fill-",""))+o;break;case 962:if(o="-webkit-"+o+(102===o.charCodeAt(5)?"-ms-"+o:"")+o,211===t+r&&105===o.charCodeAt(13)&&0<o.indexOf("transform",10))return o.substring(0,o.indexOf(";",27)+1).replace(g,"$1-webkit-$2")+o}return o}function s(e,n){var t=e.indexOf(1===n?":":"{"),r=e.substring(0,3!==n?t:10);return t=e.substring(t+1,e.length-1),N(2!==n?r:r.replace(I,"$1"),t,n)}function o(e,n){var t=a(n,n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2));return t!==n+";"?t.replace(_," or ($1)").substring(4):"("+n+")"}function i(e,n,t,r,a,s,o,i,l,c){for(var d,f=0,p=n;f<P;++f)switch(d=F[f].call(u,e,p,t,r,a,s,o,i,l,c)){case void 0:case!1:case!0:case null:break;default:p=d}if(p!==n)return p}function l(e){return void 0!==(e=e.prefix)&&(N=null,e?"function"!==typeof e?E=1:(E=2,N=e):E=0),l}function u(e,t){var r=e;if(33>r.charCodeAt(0)&&(r=r.trim()),r=[r],0<P){var a=i(-1,t,r,r,C,O,0,0,0,0);void 0!==a&&"string"===typeof a&&(t=a)}var s=n(A,r,t,0,0);return 0<P&&(void 0!==(a=i(-2,s,r,r,C,O,s.length,0,0,0))&&(s=a)),"",M=0,O=C=1,s}var c=/^\0+/g,d=/[\0\r\f]/g,f=/: */g,p=/zoo|gra/,g=/([,: ])(transform)/g,m=/,\r+?/g,h=/([\t\r\n ])*\f?&/g,y=/@(k\w+)\s*(\S*)\s*/,b=/::(place)/g,v=/:(read-only)/g,S=/[svh]\w+-[tblr]{2}/,w=/\(\s*(.*)\s*\)/g,_=/([\s\S]*?);/g,k=/-self|flex-/g,I=/[^]*?(:[rp][el]a[\w-]+)[^]*/,T=/stretch|:\s*\w+\-(?:conte|avail)/,x=/([^-])(image-set\()/,O=1,C=1,M=0,E=1,A=[],F=[],P=0,N=null,R=0;return u.use=function e(n){switch(n){case void 0:case null:P=F.length=0;break;default:if("function"===typeof n)F[P++]=n;else if("object"===typeof n)for(var t=0,r=n.length;t<r;++t)e(n[t]);else R=0|!!n}return e},u.set=l,void 0!==e&&l(e),u};const l={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function u(e){var n=Object.create(null);return function(t){return void 0===n[t]&&(n[t]=e(t)),n[t]}}var c=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,d=u((function(e){return c.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),f=t(110),p=t.n(f);function g(){return(g=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var m=function(e,n){for(var t=[e[0]],r=0,a=n.length;r<a;r+=1)t.push(n[r],e[r+1]);return t},h=function(e){return null!==e&&"object"==typeof e&&"[object Object]"===(e.toString?e.toString():Object.prototype.toString.call(e))&&!(0,a.typeOf)(e)},y=Object.freeze([]),b=Object.freeze({});function v(e){return"function"==typeof e}function S(e){return e.displayName||e.name||"Component"}function w(e){return e&&"string"==typeof e.styledComponentId}var _="undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_ATTR||{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_ATTR)||"data-styled",k="undefined"!=typeof window&&"HTMLElement"in window,I=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&(void 0!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY?"false"!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY:void 0!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&("false"!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY))),T={};function x(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];throw new Error("An error occurred. See https://git.io/JUIaE#"+e+" for more information."+(t.length>0?" Args: "+t.join(", "):""))}var O=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}var n=e.prototype;return n.indexOfGroup=function(e){for(var n=0,t=0;t<e;t++)n+=this.groupSizes[t];return n},n.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var t=this.groupSizes,r=t.length,a=r;e>=a;)(a<<=1)<0&&x(16,""+e);this.groupSizes=new Uint32Array(a),this.groupSizes.set(t),this.length=a;for(var s=r;s<a;s++)this.groupSizes[s]=0}for(var o=this.indexOfGroup(e+1),i=0,l=n.length;i<l;i++)this.tag.insertRule(o,n[i])&&(this.groupSizes[e]++,o++)},n.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],t=this.indexOfGroup(e),r=t+n;this.groupSizes[e]=0;for(var a=t;a<r;a++)this.tag.deleteRule(t)}},n.getGroup=function(e){var n="";if(e>=this.length||0===this.groupSizes[e])return n;for(var t=this.groupSizes[e],r=this.indexOfGroup(e),a=r+t,s=r;s<a;s++)n+=this.tag.getRule(s)+"/*!sc*/\n";return n},e}(),C=new Map,M=new Map,E=1,A=function(e){if(C.has(e))return C.get(e);for(;M.has(E);)E++;var n=E++;return C.set(e,n),M.set(n,e),n},F=function(e){return M.get(e)},P=function(e,n){n>=E&&(E=n+1),C.set(e,n),M.set(n,e)},N="style["+_+'][data-styled-version="5.3.11"]',R=new RegExp("^"+_+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),L=function(e,n,t){for(var r,a=t.split(","),s=0,o=a.length;s<o;s++)(r=a[s])&&e.registerName(n,r)},D=function(e,n){for(var t=(n.textContent||"").split("/*!sc*/\n"),r=[],a=0,s=t.length;a<s;a++){var o=t[a].trim();if(o){var i=o.match(R);if(i){var l=0|parseInt(i[1],10),u=i[2];0!==l&&(P(u,l),L(e,u,i[3]),e.getTag().insertRules(l,r)),r.length=0}else r.push(o)}}},U=function(){return t.nc},j=function(e){var n=document.head,t=e||n,r=document.createElement("style"),a=function(e){for(var n=e.childNodes,t=n.length;t>=0;t--){var r=n[t];if(r&&1===r.nodeType&&r.hasAttribute(_))return r}}(t),s=void 0!==a?a.nextSibling:null;r.setAttribute(_,"active"),r.setAttribute("data-styled-version","5.3.11");var o=U();return o&&r.setAttribute("nonce",o),t.insertBefore(r,s),r},z=function(){function e(e){var n=this.element=j(e);n.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var n=document.styleSheets,t=0,r=n.length;t<r;t++){var a=n[t];if(a.ownerNode===e)return a}x(17)}(n),this.length=0}var n=e.prototype;return n.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch(e){return!1}},n.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},n.getRule=function(e){var n=this.sheet.cssRules[e];return void 0!==n&&"string"==typeof n.cssText?n.cssText:""},e}(),B=function(){function e(e){var n=this.element=j(e);this.nodes=n.childNodes,this.length=0}var n=e.prototype;return n.insertRule=function(e,n){if(e<=this.length&&e>=0){var t=document.createTextNode(n),r=this.nodes[e];return this.element.insertBefore(t,r||null),this.length++,!0}return!1},n.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},n.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),V=function(){function e(e){this.rules=[],this.length=0}var n=e.prototype;return n.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},n.deleteRule=function(e){this.rules.splice(e,1),this.length--},n.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),G=k,W={isServer:!k,useCSSOMInjection:!I},$=function(){function e(e,n,t){void 0===e&&(e=b),void 0===n&&(n={}),this.options=g({},W,{},e),this.gs=n,this.names=new Map(t),this.server=!!e.isServer,!this.server&&k&&G&&(G=!1,function(e){for(var n=document.querySelectorAll(N),t=0,r=n.length;t<r;t++){var a=n[t];a&&"active"!==a.getAttribute(_)&&(D(e,a),a.parentNode&&a.parentNode.removeChild(a))}}(this))}e.registerId=function(e){return A(e)};var n=e.prototype;return n.reconstructWithOptions=function(n,t){return void 0===t&&(t=!0),new e(g({},this.options,{},n),this.gs,t&&this.names||void 0)},n.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},n.getTag=function(){return this.tag||(this.tag=(t=(n=this.options).isServer,r=n.useCSSOMInjection,a=n.target,e=t?new V(a):r?new z(a):new B(a),new O(e)));var e,n,t,r,a},n.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},n.registerName=function(e,n){if(A(e),this.names.has(e))this.names.get(e).add(n);else{var t=new Set;t.add(n),this.names.set(e,t)}},n.insertRules=function(e,n,t){this.registerName(e,n),this.getTag().insertRules(A(e),t)},n.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},n.clearRules=function(e){this.getTag().clearGroup(A(e)),this.clearNames(e)},n.clearTag=function(){this.tag=void 0},n.toString=function(){return function(e){for(var n=e.getTag(),t=n.length,r="",a=0;a<t;a++){var s=F(a);if(void 0!==s){var o=e.names.get(s),i=n.getGroup(a);if(o&&i&&o.size){var l=_+".g"+a+'[id="'+s+'"]',u="";void 0!==o&&o.forEach((function(e){e.length>0&&(u+=e+",")})),r+=""+i+l+'{content:"'+u+'"}/*!sc*/\n'}}}return r}(this)},e}(),H=/(a)(d)/gi,K=function(e){return String.fromCharCode(e+(e>25?39:97))};function q(e){var n,t="";for(n=Math.abs(e);n>52;n=n/52|0)t=K(n%52)+t;return(K(n%52)+t).replace(H,"$1-$2")}var Y=function(e,n){for(var t=n.length;t;)e=33*e^n.charCodeAt(--t);return e},X=function(e){return Y(5381,e)};function J(e){for(var n=0;n<e.length;n+=1){var t=e[n];if(v(t)&&!w(t))return!1}return!0}var Q=X("5.3.11"),Z=function(){function e(e,n,t){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===t||t.isStatic)&&J(e),this.componentId=n,this.baseHash=Y(Q,n),this.baseStyle=t,$.registerId(n)}return e.prototype.generateAndInjectStyles=function(e,n,t){var r=this.componentId,a=[];if(this.baseStyle&&a.push(this.baseStyle.generateAndInjectStyles(e,n,t)),this.isStatic&&!t.hash)if(this.staticRulesId&&n.hasNameForId(r,this.staticRulesId))a.push(this.staticRulesId);else{var s=ye(this.rules,e,n,t).join(""),o=q(Y(this.baseHash,s)>>>0);if(!n.hasNameForId(r,o)){var i=t(s,"."+o,void 0,r);n.insertRules(r,o,i)}a.push(o),this.staticRulesId=o}else{for(var l=this.rules.length,u=Y(this.baseHash,t.hash),c="",d=0;d<l;d++){var f=this.rules[d];if("string"==typeof f)c+=f;else if(f){var p=ye(f,e,n,t),g=Array.isArray(p)?p.join(""):p;u=Y(u,g+d),c+=g}}if(c){var m=q(u>>>0);if(!n.hasNameForId(r,m)){var h=t(c,"."+m,void 0,r);n.insertRules(r,m,h)}a.push(m)}}return a.join(" ")},e}(),ee=/^\s*\/\/.*$/gm,ne=[":","[",".","#"];function te(e){var n,t,r,a,s=void 0===e?b:e,o=s.options,l=void 0===o?b:o,u=s.plugins,c=void 0===u?y:u,d=new i(l),f=[],p=function(e){function n(n){if(n)try{e(n+"}")}catch(e){}}return function(t,r,a,s,o,i,l,u,c,d){switch(t){case 1:if(0===c&&64===r.charCodeAt(0))return e(r+";"),"";break;case 2:if(0===u)return r+"/*|*/";break;case 3:switch(u){case 102:case 112:return e(a[0]+r),"";default:return r+(0===d?"/*|*/":"")}case-2:r.split("/*|*/}").forEach(n)}}}((function(e){f.push(e)})),g=function(e,r,s){return 0===r&&-1!==ne.indexOf(s[t.length])||s.match(a)?e:"."+n};function m(e,s,o,i){void 0===i&&(i="&");var l=e.replace(ee,""),u=s&&o?o+" "+s+" { "+l+" }":l;return n=i,t=s,r=new RegExp("\\"+t+"\\b","g"),a=new RegExp("(\\"+t+"\\b){2,}"),d(o||!s?"":s,u)}return d.use([].concat(c,[function(e,n,a){2===e&&a.length&&a[0].lastIndexOf(t)>0&&(a[0]=a[0].replace(r,g))},p,function(e){if(-2===e){var n=f;return f=[],n}}])),m.hash=c.length?c.reduce((function(e,n){return n.name||x(15),Y(e,n.name)}),5381).toString():"",m}var re=e.createContext(),ae=(re.Consumer,e.createContext()),se=(ae.Consumer,new $),oe=te();function ie(){return(0,e.useContext)(re)||se}function le(){return(0,e.useContext)(ae)||oe}function ue(n){var t=(0,e.useState)(n.stylisPlugins),r=t[0],a=t[1],s=ie(),i=(0,e.useMemo)((function(){var e=s;return n.sheet?e=n.sheet:n.target&&(e=e.reconstructWithOptions({target:n.target},!1)),n.disableCSSOMInjection&&(e=e.reconstructWithOptions({useCSSOMInjection:!1})),e}),[n.disableCSSOMInjection,n.sheet,n.target]),l=(0,e.useMemo)((function(){return te({options:{prefix:!n.disableVendorPrefixes},plugins:r})}),[n.disableVendorPrefixes,r]);return(0,e.useEffect)((function(){o()(r,n.stylisPlugins)||a(n.stylisPlugins)}),[n.stylisPlugins]),e.createElement(re.Provider,{value:i},e.createElement(ae.Provider,{value:l},n.children))}var ce=function(){function e(e,n){var t=this;this.inject=function(e,n){void 0===n&&(n=oe);var r=t.name+n.hash;e.hasNameForId(t.id,r)||e.insertRules(t.id,r,n(t.rules,r,"@keyframes"))},this.toString=function(){return x(12,String(t.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=n}return e.prototype.getName=function(e){return void 0===e&&(e=oe),this.name+e.hash},e}(),de=/([A-Z])/,fe=/([A-Z])/g,pe=/^ms-/,ge=function(e){return"-"+e.toLowerCase()};function me(e){return de.test(e)?e.replace(fe,ge).replace(pe,"-ms-"):e}var he=function(e){return null==e||!1===e||""===e};function ye(e,n,t,r){if(Array.isArray(e)){for(var a,s=[],o=0,i=e.length;o<i;o+=1)""!==(a=ye(e[o],n,t,r))&&(Array.isArray(a)?s.push.apply(s,a):s.push(a));return s}return he(e)?"":w(e)?"."+e.styledComponentId:v(e)?"function"!=typeof(u=e)||u.prototype&&u.prototype.isReactComponent||!n?e:ye(e(n),n,t,r):e instanceof ce?t?(e.inject(t,r),e.getName(r)):e:h(e)?function e(n,t){var r,a,s=[];for(var o in n)n.hasOwnProperty(o)&&!he(n[o])&&(Array.isArray(n[o])&&n[o].isCss||v(n[o])?s.push(me(o)+":",n[o],";"):h(n[o])?s.push.apply(s,e(n[o],o)):s.push(me(o)+": "+(r=o,(null==(a=n[o])||"boolean"==typeof a||""===a?"":"number"!=typeof a||0===a||r in l||r.startsWith("--")?String(a).trim():a+"px")+";")));return t?[t+" {"].concat(s,["}"]):s}(e):e.toString();var u}var be=function(e){return Array.isArray(e)&&(e.isCss=!0),e};function ve(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return v(e)||h(e)?be(ye(m(y,[e].concat(t)))):0===t.length&&1===e.length&&"string"==typeof e[0]?e:be(ye(m(e,t)))}new Set;var Se=function(e,n,t){return void 0===t&&(t=b),e.theme!==t.theme&&e.theme||n||t.theme},we=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,_e=/(^-|-$)/g;function ke(e){return e.replace(we,"-").replace(_e,"")}var Ie=function(e){return q(X(e)>>>0)};function Te(e){return"string"==typeof e&&!0}var xe=function(e){return"function"==typeof e||"object"==typeof e&&null!==e&&!Array.isArray(e)},Oe=function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e};function Ce(e,n,t){var r=e[t];xe(n)&&xe(r)?Me(r,n):e[t]=n}function Me(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];for(var a=0,s=t;a<s.length;a++){var o=s[a];if(xe(o))for(var i in o)Oe(i)&&Ce(e,o[i],i)}return e}var Ee=e.createContext();Ee.Consumer;var Ae={};function Fe(n,t,r){var a=w(n),s=!Te(n),o=t.attrs,i=void 0===o?y:o,l=t.componentId,u=void 0===l?function(e,n){var t="string"!=typeof e?"sc":ke(e);Ae[t]=(Ae[t]||0)+1;var r=t+"-"+Ie("5.3.11"+t+Ae[t]);return n?n+"-"+r:r}(t.displayName,t.parentComponentId):l,c=t.displayName,f=void 0===c?function(e){return Te(e)?"styled."+e:"Styled("+S(e)+")"}(n):c,m=t.displayName&&t.componentId?ke(t.displayName)+"-"+t.componentId:t.componentId||u,h=a&&n.attrs?Array.prototype.concat(n.attrs,i).filter(Boolean):i,_=t.shouldForwardProp;a&&n.shouldForwardProp&&(_=t.shouldForwardProp?function(e,r,a){return n.shouldForwardProp(e,r,a)&&t.shouldForwardProp(e,r,a)}:n.shouldForwardProp);var k,I=new Z(r,m,a?n.componentStyle:void 0),T=I.isStatic&&0===i.length,x=function(n,t){return function(n,t,r,a){var s=n.attrs,o=n.componentStyle,i=n.defaultProps,l=n.foldedComponentIds,u=n.shouldForwardProp,c=n.styledComponentId,f=n.target,p=function(e,n,t){void 0===e&&(e=b);var r=g({},n,{theme:e}),a={};return t.forEach((function(e){var n,t,s,o=e;for(n in v(o)&&(o=o(r)),o)r[n]=a[n]="className"===n?(t=a[n],s=o[n],t&&s?t+" "+s:t||s):o[n]})),[r,a]}(Se(t,(0,e.useContext)(Ee),i)||b,t,s),m=p[0],h=p[1],y=function(e,n,t,r){var a=ie(),s=le();return n?e.generateAndInjectStyles(b,a,s):e.generateAndInjectStyles(t,a,s)}(o,a,m),S=r,w=h.$as||t.$as||h.as||t.as||f,_=Te(w),k=h!==t?g({},t,{},h):t,I={};for(var T in k)"$"!==T[0]&&"as"!==T&&("forwardedAs"===T?I.as=k[T]:(u?u(T,d,w):!_||d(T))&&(I[T]=k[T]));return t.style&&h.style!==t.style&&(I.style=g({},t.style,{},h.style)),I.className=Array.prototype.concat(l,c,y!==c?y:null,t.className,h.className).filter(Boolean).join(" "),I.ref=S,(0,e.createElement)(w,I)}(k,n,t,T)};return x.displayName=f,(k=e.forwardRef(x)).attrs=h,k.componentStyle=I,k.displayName=f,k.shouldForwardProp=_,k.foldedComponentIds=a?Array.prototype.concat(n.foldedComponentIds,n.styledComponentId):y,k.styledComponentId=m,k.target=a?n.target:n,k.withComponent=function(e){var n=t.componentId,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(t,["componentId"]),s=n&&n+"-"+(Te(e)?e:ke(S(e)));return Fe(e,g({},a,{attrs:h,componentId:s}),r)},Object.defineProperty(k,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(e){this._foldedDefaultProps=a?Me({},n.defaultProps,e):e}}),Object.defineProperty(k,"toString",{value:function(){return"."+k.styledComponentId}}),s&&p()(k,n,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),k}var Pe=function(e){return function e(n,t,r){if(void 0===r&&(r=b),!(0,a.isValidElementType)(t))return x(1,String(t));var s=function(){return n(t,r,ve.apply(void 0,arguments))};return s.withConfig=function(a){return e(n,t,g({},r,{},a))},s.attrs=function(a){return e(n,t,g({},r,{attrs:Array.prototype.concat(r.attrs,a).filter(Boolean)}))},s}(Fe,e)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach((function(e){Pe[e]=Pe(e)}));var Ne=function(){function e(e,n){this.rules=e,this.componentId=n,this.isStatic=J(e),$.registerId(this.componentId+1)}var n=e.prototype;return n.createStyles=function(e,n,t,r){var a=r(ye(this.rules,n,t,r).join(""),""),s=this.componentId+e;t.insertRules(s,s,a)},n.removeStyles=function(e,n){n.clearRules(this.componentId+e)},n.renderStyles=function(e,n,t,r){e>2&&$.registerId(this.componentId+e),this.removeStyles(e,t),this.createStyles(e,n,t,r)},e}();!function(){function n(){var n=this;this._emitSheetCSS=function(){var e=n.instance.toString();if(!e)return"";var t=U();return"<style "+[t&&'nonce="'+t+'"',_+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+e+"</style>"},this.getStyleTags=function(){return n.sealed?x(2):n._emitSheetCSS()},this.getStyleElement=function(){var t;if(n.sealed)return x(2);var r=((t={})[_]="",t["data-styled-version"]="5.3.11",t.dangerouslySetInnerHTML={__html:n.instance.toString()},t),a=U();return a&&(r.nonce=a),[e.createElement("style",g({},r,{key:"sc-0-0"}))]},this.seal=function(){n.sealed=!0},this.instance=new $({isServer:!0}),this.sealed=!1}var t=n.prototype;t.collectStyles=function(n){return this.sealed?x(2):e.createElement(ue,{sheet:this.instance},n)},t.interleaveWithNodeStream=function(e){return x(3)}}();const Re=Pe,Le=(e=>{const n=[],t=10;switch(e%2){case 0:for(let e=0;e<t;e++){const r=0,a=180+60*(t-e)/t,s=100+150*e/t;n.push("rgba(".concat(Math.round(r),", ").concat(Math.round(a),", ").concat(Math.round(s),")"))}break;case 1:for(let e=0;e<t;e++){const r=160+95*e/t,a=80+100*(t-e)/t,s=0;n.push("rgba(".concat(Math.round(r),", ").concat(Math.round(s),", ").concat(Math.round(a),")"))}}return{colors:n,counter:0,next(){return n[this.counter++%n.length]}}})(1);Le.counter=5;const De={devices:{desktop:{fontSize:20},mobile:{fontSize:16,maxWidth:600}},dimensions:{maxContentWidth:"900px"},fonts:{title:"Silkscreen",default:"Rajdhani"},fontSizes:{h1:"300%",h2:"140%"},colors:{bg1:"#333333",bg1p5:"#222222",bg2:"#1a1a1a",bg3:"#444444",fg1:"#d1d1d1",fg1p5:"#a1a1a1",fg2:"#555555",colorScheme:Le},spacings:{space1:"1rem",space2:"2rem",space0p1:"0.25rem"},controls:{gridSize:50},zIndexes:{closeButton:2,spinner:3}};var Ue,je,ze,Be,Ve,Ge,We,$e,He,Ke,qe,Ye,Xe,Je,Qe,Ze=t(184);const en=Re.h2(Ue||(Ue=r(["\n    font-family: ",";\n    font-size: 140%;\n    color: ",";\n    margin: 0;\n    padding: 0;\n"])),De.fonts.title,De.colors.colorScheme.next()),nn=Re.h3(je||(je=r(["\n    text-transform: uppercase;\n    font-weight: bold;\n    font-family: ",";\n    margin: 0;\n    padding: 0;\n"])),De.fonts.title),tn=Re.div(ze||(ze=r(["\n    background-color: ",";\n    margin: "," auto 0 auto;\n    padding: ",";\n    width: 100%;\n    max-width: ",";\n"])),De.colors.bg2,De.spacings.space1,De.spacings.space1,De.dimensions.maxContentWidth),rn="\n    border: none;\n    cursor: pointer;\n    background-color: ".concat(De.colors.bg3,";\n"),an="\n    font-family: ".concat(De.fonts.title,";\n"),sn=Re.button(Be||(Be=r(["\n    ","\n"])),rn),on=Re(sn)(Ve||(Ve=r(["\n    ","\n    background-color: ",";\n"])),an,(()=>De.colors.colorScheme.next())),ln=Re.select(Ge||(Ge=r(["\n    border: none;\n    background-color: ",";\n    cursor: pointer;\n"])),De.colors.bg1p5),un=Re.span(We||(We=r(["\n    position: absolute;\n    bottom: ",";\n    right: ",";\n    color: ",";\n"])),De.spacings.space0p1,De.spacings.space0p1,De.colors.fg1p5),cn=e=>{let{filename:n}=e;const t=n.split("/").slice(-1)[0]||null;return(0,Ze.jsx)(un,{children:t})},dn=Re.span($e||($e=r(["\n    position: absolute;\n    bottom: ",";\n    left: ",";\n    color: ",";\n"])),De.spacings.space0p1,De.spacings.space0p1,De.colors.fg1p5),fn="\n    height: 20vh;\n    max-height: 10em;\n    user-select: none;\n",pn=Re.span(He||(He=r(["\n    font-size: 120%;\n    font-weight: bold;\n    color: ",";\n    min-width: 1.5em;\n    @media (max-width: ","px) {\n        text-align: center;\n    }\n"])),De.colors.fg2,De.devices.mobile.maxWidth),gn=Re.div(Ke||(Ke=r(["\n    color: ",";\n    ::before {\n        content: '\u2192 ';\n    }\n    a {\n        color: ",";\n    }\n"])),De.colors.fg2,De.colors.fg2),mn=Re(tn)(qe||(qe=r(["\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: center;\n"]))),hn=Re.div(Ye||(Ye=r(["\n    min-width: 6.5rem;\n    transform: translateX(-20%);\n"]))),yn=Re.div(Xe||(Xe=r(["\n    flex: auto;\n"]))),bn=Re.div(Je||(Je=r(["\n    font-family: ",";\n    color: ",";\n"])),De.fonts.title,De.colors.colorScheme.next()),vn=Re.div(Qe||(Qe=r(["\n& > * {\n    font-size: 90%;\n    margin-right: ",";\n    &:last-child {\n        margin-right: 0;\n    }\n}\n"])),De.spacings.space0p1);var Sn,wn,_n;const kn=Re.div(Sn||(Sn=r(["\n    position: relative;\n    background-color: ",";\n"])),De.colors.bg1p5),In=Re.pre(wn||(wn=r(["\n    ","\n    letter-spacing: 0.1em;\n    overflow: auto;\n    margin: 0;\n    padding: 0;\n    opacity: 0.3;\n"])),fn),Tn=Re(vn)(_n||(_n=r(["\n    position: absolute;\n    top: calc(",");\n    right: calc(",");\n"])),De.spacings.space0p1,De.spacings.space0p1),xn=e=>{let{pd:n,filename:t,extraButtons:r}=e;return(0,Ze.jsxs)(kn,{children:[(0,Ze.jsx)(In,{children:n}),t?(0,Ze.jsx)(cn,{filename:t}):null,r?(0,Ze.jsx)(Tn,{children:r}):null]})},On=(e,n,t)=>{const r=new Blob([n],{type:t});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(r,e);else{const n=window.document.createElement("a");n.href=window.URL.createObjectURL(r),n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},Cn="array",Mn="bit",En="bits",An="byte",Fn="bytes",Pn="",Nn="exponent",Rn="function",Ln="iec",Dn="Invalid number",Un="Invalid rounding method",jn="jedec",zn="object",Bn=".",Vn="round",Gn="s",Wn="si",$n="kbit",Hn="kB",Kn=" ",qn="string",Yn="0",Xn={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function Jn(e){let{bits:n=!1,pad:t=!1,base:r=-1,round:a=2,locale:s=Pn,localeOptions:o={},separator:i=Pn,spacer:l=Kn,symbols:u={},standard:c=Pn,output:d=qn,fullform:f=!1,fullforms:p=[],exponent:g=-1,roundingMethod:m=Vn,precision:h=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},y=g,b=Number(e),v=[],S=0,w=Pn;c===Wn?(r=10,c=jn):c===Ln||c===jn?r=2:2===r?c=Ln:(r=10,c=jn);const _=10===r?1e3:1024,k=!0===f,I=b<0,T=Math[m];if("bigint"!==typeof e&&isNaN(e))throw new TypeError(Dn);if(typeof T!==Rn)throw new TypeError(Un);if(I&&(b=-b),(-1===y||isNaN(y))&&(y=Math.floor(Math.log(b)/Math.log(_)),y<0&&(y=0)),y>8&&(h>0&&(h+=8-y),y=8),d===Nn)return y;if(0===b)v[0]=0,w=v[1]=Xn.symbol[c][n?En:Fn][y];else{S=b/(2===r?Math.pow(2,10*y):Math.pow(1e3,y)),n&&(S*=8,S>=_&&y<8&&(S/=_,y++));const e=Math.pow(10,y>0?a:0);v[0]=T(S*e)/e,v[0]===_&&y<8&&-1===g&&(v[0]=1,y++),w=v[1]=10===r&&1===y?n?$n:Hn:Xn.symbol[c][n?En:Fn][y]}if(I&&(v[0]=-v[0]),h>0&&(v[0]=v[0].toPrecision(h)),v[1]=u[v[1]]||v[1],!0===s?v[0]=v[0].toLocaleString():s.length>0?v[0]=v[0].toLocaleString(s,o):i.length>0&&(v[0]=v[0].toString().replace(Bn,i)),t&&!1===Number.isInteger(v[0])&&a>0){const e=i||Bn,n=v[0].toString().split(e),t=n[1]||Pn,r=t.length,s=a-r;v[0]="".concat(n[0]).concat(e).concat(t.padEnd(r+s,Yn))}return k&&(v[1]=p[y]?p[y]:Xn.fullform[c][y]+(n?Mn:An)+(1===v[0]?Pn:Gn)),d===Cn?v:d===zn?{value:v[0],symbol:v[1],exponent:y,unit:w}:v.join(l)}var Qn,Zn,et;const nt=["\u2591","\u2592","\u2593","\u2594","\u2599","\u259a","\u259b","\u259c","\u259d","\u259e","\u259f"],tt=Re.div(Qn||(Qn=r(["\n    position: relative;\n"]))),rt=Re.div(Zn||(Zn=r(["\n    ","\n    word-break: break-all;\n    overflow: hidden;\n    opacity: 0.1;\n    text-align: justify;\n"])),fn),at=Re(vn)(et||(et=r(["\n    position: absolute;\n    top: calc(",");\n    right: calc(",");\n"])),De.spacings.space0p1,De.spacings.space0p1),st=n=>{let{wasm:t,filename:r,showDownloadButton:a,showFileSize:s,extraButtons:o}=n;if(a){const e=()=>{On(r,t,"application/wasm")};o=[...o||[],(0,Ze.jsx)(sn,{onClick:e,children:"download"},"download")]}const i=(0,e.useMemo)((()=>Array.from(new Uint8Array(t))),[t]),l=Jn(t.byteLength);return(0,Ze.jsxs)(tt,{children:[r?(0,Ze.jsx)(cn,{filename:r}):null,s?(0,Ze.jsx)(dn,{children:l}):null,(0,Ze.jsx)(rt,{children:i.slice(0,1e3).map(((e,n)=>(0,Ze.jsxs)("span",{children:[nt[e%nt.length]," "]},n)))}),o?(0,Ze.jsx)(at,{children:o}):null]})};var ot,it,lt,ut,ct,dt,ft;const pt=e=>{const n=Math.floor(function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return Math.floor(e*Math.pow(10,n))/Math.pow(10,n)}(e,2));return"".concat(n.toString().padStart(3,"0"))},gt=Re.div(ot||(ot=r(["\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: center;\n    @media (max-width: ","px) {\n        flex-direction: column-reverse;\n        align-items: flex-end;\n    }\n"])),De.devices.mobile.maxWidth),mt=Re.div(it||(it=r(["\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    min-width: 4em;\n    margin: 0 ",";\n    font-size: ",";\n    @media (max-width: ","px) {\n        font-size: 120%;\n    }\n    & > span {\n        font-size: 100%;\n    }\n    & > span:nth-child(1) {\n        text-align: right;\n    }\n    & > span:nth-child(2) {\n        text-align: center;\n    }\n"])),De.spacings.space1,De.fontSizes.h2,De.devices.mobile.maxWidth),ht=Re.div(lt||(lt=r(["\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: center;\n    flex: auto;\n    margin-right: ",";\n    @media (max-width: ","px) {\n        align-self: stretch;\n        margin-right: 0;\n    }\n    @media (max-width: 400px) {\n        font-size: 50%;\n    }\n\n"])),De.spacings.space1,De.devices.mobile.maxWidth),yt=Re(on)(ut||(ut=r(["\n    min-width: 4.5em;\n    align-self: stretch;\n    @media (max-width: 700px) {\n        font-size: 80%;\n    }\n"]))),bt=Re.div(ct||(ct=r(["\n    display: flex;\n    flex-direction: row;\n    align-self: stretch;\n"]))),vt=Re(on)(dt||(dt=r(["\n    min-width: 3em;\n    @media (max-width: 700px) {\n        font-size: 80%;\n    }\n"]))),St=Re(vn)(ft||(ft=r(["\n    align-self: stretch;\n    display: flex;\n    align-items: stretch;\n    @media (max-width: ","px) {\n        justify-content: flex-end;\n        margin-bottom: ",";\n    }\n"])),De.devices.mobile.maxWidth,De.spacings.space1),wt=n=>{let{wav:t,showDownloadButton:r,extraButtons:a}=n;const[s,o]=(0,e.useState)(!1),[,i]=(0,e.useState)(0),l=(0,e.useMemo)((()=>{const e=new Audio(URL.createObjectURL(new Blob([t],{type:"audio/wav"})));return e.onplay=()=>{o(!0)},e.onpause=()=>{o(!1)},e.onended=()=>{o(!1)},e}),[t]);(0,e.useEffect)((()=>{if(!s)return;const e=setInterval((()=>{i(l.currentTime)}),100);return()=>clearInterval(e)}),[s]);return(0,Ze.jsxs)(gt,{children:[(0,Ze.jsxs)(ht,{children:[s?(0,Ze.jsx)(yt,{onClick:()=>{l.paused&&o(!1),l.pause()},children:"Pause"}):(0,Ze.jsx)(yt,{onClick:()=>{l.paused||o(!0),l.play()},children:"Play"}),(0,Ze.jsxs)(mt,{children:[(0,Ze.jsx)("span",{children:pt(l.currentTime)}),(0,Ze.jsx)("span",{children:"/"}),(0,Ze.jsx)("span",{children:isNaN(l.duration)?pt(0):pt(l.duration)})]}),(0,Ze.jsxs)(bt,{children:[(0,Ze.jsx)(vt,{onClick:()=>{l.volume=Math.max(l.volume-.1,0)},children:"-"}),(0,Ze.jsx)(vt,{onClick:()=>{l.volume=Math.min(l.volume+.1,1)},children:"+"})]})]}),(0,Ze.jsxs)(St,{children:[a||null,r?(0,Ze.jsx)(sn,{onClick:()=>{On("audio.webpd.wav",t,"audio/wav")},children:"download"}):null]})]})},_t=e=>{let{format:n,artefacts:t,filename:r,showDownloadButton:a,extraButtons:s}=e;switch(n){case"pd":return t.pd?(0,Ze.jsx)(xn,{pd:t.pd,filename:r,extraButtons:s}):null;case"wasm":return t.wasm?(0,Ze.jsx)(st,{wasm:t.wasm,filename:r||"patch.wasm",showDownloadButton:a,extraButtons:s,showFileSize:!0}):null;case"wav":return t.wav?(0,Ze.jsx)(wt,{wav:t.wav,showDownloadButton:a,extraButtons:s}):null}return null};function kt(e){for(var n=arguments.length,t=Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(t.length?" "+t.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function It(e){return!!e&&!!e[pr]}function Tt(e){var n;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var n=Object.getPrototypeOf(e);if(null===n)return!0;var t=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;return t===Object||"function"==typeof t&&Function.toString.call(t)===gr}(e)||Array.isArray(e)||!!e[fr]||!!(null===(n=e.constructor)||void 0===n?void 0:n[fr])||Ft(e)||Pt(e))}function xt(e,n,t){void 0===t&&(t=!1),0===Ot(e)?(t?Object.keys:mr)(e).forEach((function(r){t&&"symbol"==typeof r||n(r,e[r],e)})):e.forEach((function(t,r){return n(r,t,e)}))}function Ot(e){var n=e[pr];return n?n.i>3?n.i-4:n.i:Array.isArray(e)?1:Ft(e)?2:Pt(e)?3:0}function Ct(e,n){return 2===Ot(e)?e.has(n):Object.prototype.hasOwnProperty.call(e,n)}function Mt(e,n){return 2===Ot(e)?e.get(n):e[n]}function Et(e,n,t){var r=Ot(e);2===r?e.set(n,t):3===r?e.add(t):e[n]=t}function At(e,n){return e===n?0!==e||1/e==1/n:e!=e&&n!=n}function Ft(e){return lr&&e instanceof Map}function Pt(e){return ur&&e instanceof Set}function Nt(e){return e.o||e.t}function Rt(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var n=hr(e);delete n[pr];for(var t=mr(n),r=0;r<t.length;r++){var a=t[r],s=n[a];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(n[a]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[a]})}return Object.create(Object.getPrototypeOf(e),n)}function Lt(e,n){return void 0===n&&(n=!1),Ut(e)||It(e)||!Tt(e)||(Ot(e)>1&&(e.set=e.add=e.clear=e.delete=Dt),Object.freeze(e),n&&xt(e,(function(e,n){return Lt(n,!0)}),!0)),e}function Dt(){kt(2)}function Ut(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function jt(e){var n=yr[e];return n||kt(18,e),n}function zt(e,n){yr[e]||(yr[e]=n)}function Bt(){return or}function Vt(e,n){n&&(jt("Patches"),e.u=[],e.s=[],e.v=n)}function Gt(e){Wt(e),e.p.forEach(Ht),e.p=null}function Wt(e){e===or&&(or=e.l)}function $t(e){return or={p:[],l:or,h:e,m:!0,_:0}}function Ht(e){var n=e[pr];0===n.i||1===n.i?n.j():n.g=!0}function Kt(e,n){n._=n.p.length;var t=n.p[0],r=void 0!==e&&e!==t;return n.h.O||jt("ES5").S(n,e,r),r?(t[pr].P&&(Gt(n),kt(4)),Tt(e)&&(e=qt(n,e),n.l||Xt(n,e)),n.u&&jt("Patches").M(t[pr].t,e,n.u,n.s)):e=qt(n,t,[]),Gt(n),n.u&&n.v(n.u,n.s),e!==dr?e:void 0}function qt(e,n,t){if(Ut(n))return n;var r=n[pr];if(!r)return xt(n,(function(a,s){return Yt(e,r,n,a,s,t)}),!0),n;if(r.A!==e)return n;if(!r.P)return Xt(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var a=4===r.i||5===r.i?r.o=Rt(r.k):r.o,s=a,o=!1;3===r.i&&(s=new Set(a),a.clear(),o=!0),xt(s,(function(n,s){return Yt(e,r,a,n,s,t,o)})),Xt(e,a,!1),t&&e.u&&jt("Patches").N(r,t,e.u,e.s)}return r.o}function Yt(e,n,t,r,a,s,o){if(It(a)){var i=qt(e,a,s&&n&&3!==n.i&&!Ct(n.R,r)?s.concat(r):void 0);if(Et(t,r,i),!It(i))return;e.m=!1}else o&&t.add(a);if(Tt(a)&&!Ut(a)){if(!e.h.D&&e._<1)return;qt(e,a),n&&n.A.l||Xt(e,a)}}function Xt(e,n,t){void 0===t&&(t=!1),!e.l&&e.h.D&&e.m&&Lt(n,t)}function Jt(e,n){var t=e[pr];return(t?Nt(t):e)[n]}function Qt(e,n){if(n in e)for(var t=Object.getPrototypeOf(e);t;){var r=Object.getOwnPropertyDescriptor(t,n);if(r)return r;t=Object.getPrototypeOf(t)}}function Zt(e){e.P||(e.P=!0,e.l&&Zt(e.l))}function er(e){e.o||(e.o=Rt(e.t))}function nr(e,n,t){var r=Ft(n)?jt("MapSet").F(n,t):Pt(n)?jt("MapSet").T(n,t):e.O?function(e,n){var t=Array.isArray(e),r={i:t?1:0,A:n?n.A:Bt(),P:!1,I:!1,R:{},l:n,t:e,k:null,o:null,j:null,C:!1},a=r,s=br;t&&(a=[r],s=vr);var o=Proxy.revocable(a,s),i=o.revoke,l=o.proxy;return r.k=l,r.j=i,l}(n,t):jt("ES5").J(n,t);return(t?t.A:Bt()).p.push(r),r}function tr(e){return It(e)||kt(22,e),function e(n){if(!Tt(n))return n;var t,r=n[pr],a=Ot(n);if(r){if(!r.P&&(r.i<4||!jt("ES5").K(r)))return r.t;r.I=!0,t=rr(n,a),r.I=!1}else t=rr(n,a);return xt(t,(function(n,a){r&&Mt(r.t,n)===a||Et(t,n,e(a))})),3===a?new Set(t):t}(e)}function rr(e,n){switch(n){case 2:return new Map(e);case 3:return Array.from(e)}return Rt(e)}function ar(){function e(e,n){var t=a[e];return t?t.enumerable=n:a[e]=t={configurable:!0,enumerable:n,get:function(){var n=this[pr];return br.get(n,e)},set:function(n){var t=this[pr];br.set(t,e,n)}},t}function n(e){for(var n=e.length-1;n>=0;n--){var a=e[n][pr];if(!a.P)switch(a.i){case 5:r(a)&&Zt(a);break;case 4:t(a)&&Zt(a)}}}function t(e){for(var n=e.t,t=e.k,r=mr(t),a=r.length-1;a>=0;a--){var s=r[a];if(s!==pr){var o=n[s];if(void 0===o&&!Ct(n,s))return!0;var i=t[s],l=i&&i[pr];if(l?l.t!==o:!At(i,o))return!0}}var u=!!n[pr];return r.length!==mr(n).length+(u?0:1)}function r(e){var n=e.k;if(n.length!==e.t.length)return!0;var t=Object.getOwnPropertyDescriptor(n,n.length-1);if(t&&!t.get)return!0;for(var r=0;r<n.length;r++)if(!n.hasOwnProperty(r))return!0;return!1}var a={};zt("ES5",{J:function(n,t){var r=Array.isArray(n),a=function(n,t){if(n){for(var r=Array(t.length),a=0;a<t.length;a++)Object.defineProperty(r,""+a,e(a,!0));return r}var s=hr(t);delete s[pr];for(var o=mr(s),i=0;i<o.length;i++){var l=o[i];s[l]=e(l,n||!!s[l].enumerable)}return Object.create(Object.getPrototypeOf(t),s)}(r,n),s={i:r?5:4,A:t?t.A:Bt(),P:!1,I:!1,R:{},l:t,t:n,k:a,o:null,g:!1,C:!1};return Object.defineProperty(a,pr,{value:s,writable:!0}),a},S:function(e,t,a){a?It(t)&&t[pr].A===e&&n(e.p):(e.u&&function e(n){if(n&&"object"==typeof n){var t=n[pr];if(t){var a=t.t,s=t.k,o=t.R,i=t.i;if(4===i)xt(s,(function(n){n!==pr&&(void 0!==a[n]||Ct(a,n)?o[n]||e(s[n]):(o[n]=!0,Zt(t)))})),xt(a,(function(e){void 0!==s[e]||Ct(s,e)||(o[e]=!1,Zt(t))}));else if(5===i){if(r(t)&&(Zt(t),o.length=!0),s.length<a.length)for(var l=s.length;l<a.length;l++)o[l]=!1;else for(var u=a.length;u<s.length;u++)o[u]=!0;for(var c=Math.min(s.length,a.length),d=0;d<c;d++)s.hasOwnProperty(d)||(o[d]=!0),void 0===o[d]&&e(s[d])}}}}(e.p[0]),n(e.p))},K:function(e){return 4===e.i?t(e):r(e)}})}var sr,or,ir="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),lr="undefined"!=typeof Map,ur="undefined"!=typeof Set,cr="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,dr=ir?Symbol.for("immer-nothing"):((sr={})["immer-nothing"]=!0,sr),fr=ir?Symbol.for("immer-draftable"):"__$immer_draftable",pr=ir?Symbol.for("immer-state"):"__$immer_state",gr=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),mr="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,hr=Object.getOwnPropertyDescriptors||function(e){var n={};return mr(e).forEach((function(t){n[t]=Object.getOwnPropertyDescriptor(e,t)})),n},yr={},br={get:function(e,n){if(n===pr)return e;var t=Nt(e);if(!Ct(t,n))return function(e,n,t){var r,a=Qt(n,t);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.k):void 0}(e,t,n);var r=t[n];return e.I||!Tt(r)?r:r===Jt(e.t,n)?(er(e),e.o[n]=nr(e.A.h,r,e)):r},has:function(e,n){return n in Nt(e)},ownKeys:function(e){return Reflect.ownKeys(Nt(e))},set:function(e,n,t){var r=Qt(Nt(e),n);if(null==r?void 0:r.set)return r.set.call(e.k,t),!0;if(!e.P){var a=Jt(Nt(e),n),s=null==a?void 0:a[pr];if(s&&s.t===t)return e.o[n]=t,e.R[n]=!1,!0;if(At(t,a)&&(void 0!==t||Ct(e.t,n)))return!0;er(e),Zt(e)}return e.o[n]===t&&(void 0!==t||n in e.o)||Number.isNaN(t)&&Number.isNaN(e.o[n])||(e.o[n]=t,e.R[n]=!0),!0},deleteProperty:function(e,n){return void 0!==Jt(e.t,n)||n in e.t?(e.R[n]=!1,er(e),Zt(e)):delete e.R[n],e.o&&delete e.o[n],!0},getOwnPropertyDescriptor:function(e,n){var t=Nt(e),r=Reflect.getOwnPropertyDescriptor(t,n);return r?{writable:!0,configurable:1!==e.i||"length"!==n,enumerable:r.enumerable,value:t[n]}:r},defineProperty:function(){kt(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){kt(12)}},vr={};xt(br,(function(e,n){vr[e]=function(){return arguments[0]=arguments[0][0],n.apply(this,arguments)}})),vr.deleteProperty=function(e,n){return vr.set.call(this,e,n,void 0)},vr.set=function(e,n,t){return br.set.call(this,e[0],n,t,e[0])};var Sr=function(){function e(e){var n=this;this.O=cr,this.D=!0,this.produce=function(e,t,r){if("function"==typeof e&&"function"!=typeof t){var a=t;t=e;var s=n;return function(e){var n=this;void 0===e&&(e=a);for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return s.produce(e,(function(e){var r;return(r=t).call.apply(r,[n,e].concat(o))}))}}var o;if("function"!=typeof t&&kt(6),void 0!==r&&"function"!=typeof r&&kt(7),Tt(e)){var i=$t(n),l=nr(n,e,void 0),u=!0;try{o=t(l),u=!1}finally{u?Gt(i):Wt(i)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return Vt(i,r),Kt(e,i)}),(function(e){throw Gt(i),e})):(Vt(i,r),Kt(o,i))}if(!e||"object"!=typeof e){if(void 0===(o=t(e))&&(o=e),o===dr&&(o=void 0),n.D&&Lt(o,!0),r){var c=[],d=[];jt("Patches").M(e,o,c,d),r(c,d)}return o}kt(21,e)},this.produceWithPatches=function(e,t){if("function"==typeof e)return function(t){for(var r=arguments.length,a=Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return n.produceWithPatches(t,(function(n){return e.apply(void 0,[n].concat(a))}))};var r,a,s=n.produce(e,t,(function(e,n){r=e,a=n}));return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return[e,r,a]})):[s,r,a]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var n=e.prototype;return n.createDraft=function(e){Tt(e)||kt(8),It(e)&&(e=tr(e));var n=$t(this),t=nr(this,e,void 0);return t[pr].C=!0,Wt(n),t},n.finishDraft=function(e,n){var t=(e&&e[pr]).A;return Vt(t,n),Kt(void 0,t)},n.setAutoFreeze=function(e){this.D=e},n.setUseProxies=function(e){e&&!cr&&kt(20),this.O=e},n.applyPatches=function(e,n){var t;for(t=n.length-1;t>=0;t--){var r=n[t];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}t>-1&&(n=n.slice(t+1));var a=jt("Patches").$;return It(e)?a(e,n):this.produce(e,(function(e){return a(e,n)}))},e}(),wr=new Sr,_r=wr.produce;wr.produceWithPatches.bind(wr),wr.setAutoFreeze.bind(wr),wr.setUseProxies.bind(wr),wr.applyPatches.bind(wr),wr.createDraft.bind(wr),wr.finishDraft.bind(wr);const kr=_r;function Ir(e){return Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ir(e)}function Tr(e){var n=function(e,n){if("object"!=Ir(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=Ir(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==Ir(n)?n:String(n)}function xr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Or(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?xr(Object(t),!0).forEach((function(n){var r,a,s;r=e,a=n,s=t[n],(a=Tr(a))in r?Object.defineProperty(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Cr(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var Mr="function"===typeof Symbol&&Symbol.observable||"@@observable",Er=function(){return Math.random().toString(36).substring(7).split("").join(".")},Ar={INIT:"@@redux/INIT"+Er(),REPLACE:"@@redux/REPLACE"+Er(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Er()}};function Fr(e){if("object"!==typeof e||null===e)return!1;for(var n=e;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}function Pr(e,n,t){var r;if("function"===typeof n&&"function"===typeof t||"function"===typeof t&&"function"===typeof arguments[3])throw new Error(Cr(0));if("function"===typeof n&&"undefined"===typeof t&&(t=n,n=void 0),"undefined"!==typeof t){if("function"!==typeof t)throw new Error(Cr(1));return t(Pr)(e,n)}if("function"!==typeof e)throw new Error(Cr(2));var a=e,s=n,o=[],i=o,l=!1;function u(){i===o&&(i=o.slice())}function c(){if(l)throw new Error(Cr(3));return s}function d(e){if("function"!==typeof e)throw new Error(Cr(4));if(l)throw new Error(Cr(5));var n=!0;return u(),i.push(e),function(){if(n){if(l)throw new Error(Cr(6));n=!1,u();var t=i.indexOf(e);i.splice(t,1),o=null}}}function f(e){if(!Fr(e))throw new Error(Cr(7));if("undefined"===typeof e.type)throw new Error(Cr(8));if(l)throw new Error(Cr(9));try{l=!0,s=a(s,e)}finally{l=!1}for(var n=o=i,t=0;t<n.length;t++){(0,n[t])()}return e}return f({type:Ar.INIT}),(r={dispatch:f,subscribe:d,getState:c,replaceReducer:function(e){if("function"!==typeof e)throw new Error(Cr(10));a=e,f({type:Ar.REPLACE})}})[Mr]=function(){var e,n=d;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(Cr(11));function t(){e.next&&e.next(c())}return t(),{unsubscribe:n(t)}}})[Mr]=function(){return this},e},r}function Nr(e){for(var n=Object.keys(e),t={},r=0;r<n.length;r++){var a=n[r];0,"function"===typeof e[a]&&(t[a]=e[a])}var s,o=Object.keys(t);try{!function(e){Object.keys(e).forEach((function(n){var t=e[n];if("undefined"===typeof t(void 0,{type:Ar.INIT}))throw new Error(Cr(12));if("undefined"===typeof t(void 0,{type:Ar.PROBE_UNKNOWN_ACTION()}))throw new Error(Cr(13))}))}(t)}catch(i){s=i}return function(e,n){if(void 0===e&&(e={}),s)throw s;for(var r=!1,a={},i=0;i<o.length;i++){var l=o[i],u=t[l],c=e[l],d=u(c,n);if("undefined"===typeof d){n&&n.type;throw new Error(Cr(14))}a[l]=d,r=r||d!==c}return(r=r||o.length!==Object.keys(e).length)?a:e}}function Rr(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return 0===n.length?function(e){return e}:1===n.length?n[0]:n.reduce((function(e,n){return function(){return e(n.apply(void 0,arguments))}}))}function Lr(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return function(e){return function(){var t=e.apply(void 0,arguments),r=function(){throw new Error(Cr(15))},a={getState:t.getState,dispatch:function(){return r.apply(void 0,arguments)}},s=n.map((function(e){return e(a)}));return r=Rr.apply(void 0,s)(t.dispatch),Or(Or({},t),{},{dispatch:r})}}}function Dr(e){return function(n){var t=n.dispatch,r=n.getState;return function(n){return function(a){return"function"===typeof a?a(t,r,e):n(a)}}}}var Ur=Dr();Ur.withExtraArgument=Dr;const jr=Ur;var zr=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},e(n,t)};return function(n,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Br=function(e,n){var t,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=n.call(e,o)}catch(i){s=[6,i],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},Vr=function(e,n){for(var t=0,r=n.length,a=e.length;t<r;t++,a++)e[a]=n[t];return e},Gr=Object.defineProperty,Wr=Object.defineProperties,$r=Object.getOwnPropertyDescriptors,Hr=Object.getOwnPropertySymbols,Kr=Object.prototype.hasOwnProperty,qr=Object.prototype.propertyIsEnumerable,Yr=function(e,n,t){return n in e?Gr(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t},Xr=function(e,n){for(var t in n||(n={}))Kr.call(n,t)&&Yr(e,t,n[t]);if(Hr)for(var r=0,a=Hr(n);r<a.length;r++){t=a[r];qr.call(n,t)&&Yr(e,t,n[t])}return e},Jr=function(e,n){return Wr(e,$r(n))},Qr=function(e,n,t){return new Promise((function(r,a){var s=function(e){try{i(t.next(e))}catch(n){a(n)}},o=function(e){try{i(t.throw(e))}catch(n){a(n)}},i=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(s,o)};i((t=t.apply(e,n)).next())}))},Zr="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?Rr:Rr.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function ea(e){if("object"!==typeof e||null===e)return!1;var n=Object.getPrototypeOf(e);if(null===n)return!0;for(var t=n;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return n===t}function na(e,n){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(n){var a=n.apply(void 0,t);if(!a)throw new Error("prepareAction did not return an object");return Xr(Xr({type:e,payload:a.payload},"meta"in a&&{meta:a.meta}),"error"in a&&{error:a.error})}return{type:e,payload:t[0]}}return t.toString=function(){return""+e},t.type=e,t.match=function(n){return n.type===e},t}var ta=function(e){function n(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=e.apply(this,t)||this;return Object.setPrototypeOf(a,n.prototype),a}return zr(n,e),Object.defineProperty(n,Symbol.species,{get:function(){return n},enumerable:!1,configurable:!0}),n.prototype.concat=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e.prototype.concat.apply(this,n)},n.prototype.prepend=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===e.length&&Array.isArray(e[0])?new(n.bind.apply(n,Vr([void 0],e[0].concat(this)))):new(n.bind.apply(n,Vr([void 0],e.concat(this))))},n}(Array),ra=function(e){function n(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=e.apply(this,t)||this;return Object.setPrototypeOf(a,n.prototype),a}return zr(n,e),Object.defineProperty(n,Symbol.species,{get:function(){return n},enumerable:!1,configurable:!0}),n.prototype.concat=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e.prototype.concat.apply(this,n)},n.prototype.prepend=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===e.length&&Array.isArray(e[0])?new(n.bind.apply(n,Vr([void 0],e[0].concat(this)))):new(n.bind.apply(n,Vr([void 0],e.concat(this))))},n}(Array);function aa(e){return Tt(e)?kr(e,(function(){})):e}function sa(){return function(e){return function(e){void 0===e&&(e={});var n=e.thunk,t=void 0===n||n,r=(e.immutableCheck,e.serializableCheck,e.actionCreatorCheck,new ta);t&&(!function(e){return"boolean"===typeof e}(t)?r.push(jr.withExtraArgument(t.extraArgument)):r.push(jr));0;return r}(e)}}function oa(e){var n,t={},r=[],a={addCase:function(e,n){var r="string"===typeof e?e:e.type;if(!r)throw new Error("`builder.addCase` cannot be called with an empty action type");if(r in t)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return t[r]=n,a},addMatcher:function(e,n){return r.push({matcher:e,reducer:n}),a},addDefaultCase:function(e){return n=e,a}};return e(a),[t,r,n]}function ia(e){var n=e.name;if(!n)throw new Error("`name` is a required option for createSlice");var t,r="function"==typeof e.initialState?e.initialState:aa(e.initialState),a=e.reducers||{},s=Object.keys(a),o={},i={},l={};function u(){var n="function"===typeof e.extraReducers?oa(e.extraReducers):[e.extraReducers],t=n[0],a=void 0===t?{}:t,s=n[1],o=void 0===s?[]:s,l=n[2],u=void 0===l?void 0:l,c=Xr(Xr({},a),i);return function(e,n,t,r){void 0===t&&(t=[]);var a,s="function"===typeof n?oa(n):[n,t,r],o=s[0],i=s[1],l=s[2];if(function(e){return"function"===typeof e}(e))a=function(){return aa(e())};else{var u=aa(e);a=function(){return u}}function c(e,n){void 0===e&&(e=a());var t=Vr([o[n.type]],i.filter((function(e){return(0,e.matcher)(n)})).map((function(e){return e.reducer})));return 0===t.filter((function(e){return!!e})).length&&(t=[l]),t.reduce((function(e,t){if(t){var r;if(It(e))return void 0===(r=t(e,n))?e:r;if(Tt(e))return kr(e,(function(e){return t(e,n)}));if(void 0===(r=t(e,n))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}return e}),e)}return c.getInitialState=a,c}(r,(function(e){for(var n in c)e.addCase(n,c[n]);for(var t=0,r=o;t<r.length;t++){var a=r[t];e.addMatcher(a.matcher,a.reducer)}u&&e.addDefaultCase(u)}))}return s.forEach((function(e){var t,r,s=a[e],u=n+"/"+e;"reducer"in s?(t=s.reducer,r=s.prepare):t=s,o[e]=t,i[u]=t,l[e]=r?na(u,r):na(u)})),{name:n,reducer:function(e,n){return t||(t=u()),t(e,n)},actions:l,caseReducers:o,getInitialState:function(){return t||(t=u()),t.getInitialState()}}}var la=function(e){void 0===e&&(e=21);for(var n="",t=e;t--;)n+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return n},ua=["name","message","stack","code"],ca=function(e,n){this.payload=e,this.meta=n},da=function(e,n){this.payload=e,this.meta=n},fa=function(e){if("object"===typeof e&&null!==e){for(var n={},t=0,r=ua;t<r.length;t++){var a=r[t];"string"===typeof e[a]&&(n[a]=e[a])}return n}return{message:String(e)}};!function(){function e(e,n,t){var r=na(e+"/fulfilled",(function(e,n,t,r){return{payload:e,meta:Jr(Xr({},r||{}),{arg:t,requestId:n,requestStatus:"fulfilled"})}})),a=na(e+"/pending",(function(e,n,t){return{payload:void 0,meta:Jr(Xr({},t||{}),{arg:n,requestId:e,requestStatus:"pending"})}})),s=na(e+"/rejected",(function(e,n,r,a,s){return{payload:a,error:(t&&t.serializeError||fa)(e||"Rejected"),meta:Jr(Xr({},s||{}),{arg:r,requestId:n,rejectedWithValue:!!a,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}})),o="undefined"!==typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){0},e}();return Object.assign((function(e){return function(i,l,u){var c,d=(null==t?void 0:t.idGenerator)?t.idGenerator(e):la(),f=new o;function p(e){c=e,f.abort()}var g=function(){return Qr(this,null,(function(){var o,g,m,h,y,b;return Br(this,(function(v){switch(v.label){case 0:return v.trys.push([0,4,,5]),h=null==(o=null==t?void 0:t.condition)?void 0:o.call(t,e,{getState:l,extra:u}),null===(S=h)||"object"!==typeof S||"function"!==typeof S.then?[3,2]:[4,h];case 1:h=v.sent(),v.label=2;case 2:if(!1===h||f.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return!0,y=new Promise((function(e,n){return f.signal.addEventListener("abort",(function(){return n({name:"AbortError",message:c||"Aborted"})}))})),i(a(d,e,null==(g=null==t?void 0:t.getPendingMeta)?void 0:g.call(t,{requestId:d,arg:e},{getState:l,extra:u}))),[4,Promise.race([y,Promise.resolve(n(e,{dispatch:i,getState:l,extra:u,requestId:d,signal:f.signal,abort:p,rejectWithValue:function(e,n){return new ca(e,n)},fulfillWithValue:function(e,n){return new da(e,n)}})).then((function(n){if(n instanceof ca)throw n;return n instanceof da?r(n.payload,d,e,n.meta):r(n,d,e)}))])];case 3:return m=v.sent(),[3,5];case 4:return b=v.sent(),m=b instanceof ca?s(null,d,e,b.payload,b.meta):s(b,d,e),[3,5];case 5:return t&&!t.dispatchConditionRejection&&s.match(m)&&m.meta.condition||i(m),[2,m]}var S}))}))}();return Object.assign(g,{abort:p,requestId:d,arg:e,unwrap:function(){return g.then(pa)}})}}),{pending:a,rejected:s,fulfilled:r,typePrefix:e})}e.withTypes=function(){return e}}();function pa(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}Object.assign;var ga="listenerMiddleware";na(ga+"/add"),na(ga+"/removeAll"),na(ga+"/remove");"function"===typeof queueMicrotask&&queueMicrotask.bind("undefined"!==typeof window?window:"undefined"!==typeof t.g?t.g:globalThis);var ma,ha=function(e){return function(n){setTimeout(n,e)}};"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:ha(10);ar();var ya=t(248),ba=t(327),va=t(164);let Sa=function(e){e()};const wa=()=>Sa,_a=Symbol.for("react-redux-context"),ka="undefined"!==typeof globalThis?globalThis:{};function Ia(){var n;if(!e.createContext)return{};const t=null!=(n=ka[_a])?n:ka[_a]=new Map;let r=t.get(e.createContext);return r||(r=e.createContext(null),t.set(e.createContext,r)),r}const Ta=Ia();function xa(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ta;return function(){return(0,e.useContext)(n)}}const Oa=xa();let Ca=()=>{throw new Error("uSES not initialized!")};const Ma=(e,n)=>e===n;function Ea(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ta;const t=n===Ta?Oa:xa(n);return function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{equalityFn:a=Ma,stabilityCheck:s,noopCheck:o}="function"===typeof r?{equalityFn:r}:r;const{store:i,subscription:l,getServerState:u,stabilityCheck:c,noopCheck:d}=t(),f=((0,e.useRef)(!0),(0,e.useCallback)({[n.name]:e=>n(e)}[n.name],[n,c,s])),p=Ca(l.addNestedSub,i.getState,u||i.getState,f,a);return(0,e.useDebugValue)(p),p}}const Aa=Ea();const Fa={notify(){},get:()=>[]};function Pa(e,n){let t,r=Fa,a=0,s=!1;function o(){u.onStateChange&&u.onStateChange()}function i(){a++,t||(t=n?n.addNestedSub(o):e.subscribe(o),r=function(){const e=wa();let n=null,t=null;return{clear(){n=null,t=null},notify(){e((()=>{let e=n;for(;e;)e.callback(),e=e.next}))},get(){let e=[],t=n;for(;t;)e.push(t),t=t.next;return e},subscribe(e){let r=!0,a=t={callback:e,next:null,prev:t};return a.prev?a.prev.next=a:n=a,function(){r&&null!==n&&(r=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:n=a.next)}}}}())}function l(){a--,t&&0===a&&(t(),t=void 0,r.clear(),r=Fa)}const u={addNestedSub:function(e){i();const n=r.subscribe(e);let t=!1;return()=>{t||(t=!0,n(),l())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:o,isSubscribed:function(){return s},trySubscribe:function(){s||(s=!0,i())},tryUnsubscribe:function(){s&&(s=!1,l())},getListeners:()=>r};return u}const Na=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement)?e.useLayoutEffect:e.useEffect;let Ra=null;const La=function(n){let{store:t,context:r,children:a,serverState:s,stabilityCheck:o="once",noopCheck:i="once"}=n;const l=e.useMemo((()=>{const e=Pa(t);return{store:t,subscription:e,getServerState:s?()=>s:void 0,stabilityCheck:o,noopCheck:i}}),[t,s,o,i]),u=e.useMemo((()=>t.getState()),[t]);Na((()=>{const{subscription:e}=l;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),u!==t.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}}),[l,u]);const c=r||Ta;return e.createElement(c.Provider,{value:l},a)};function Da(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ta;const n=e===Ta?Oa:xa(e);return function(){const{store:e}=n();return e}}const Ua=Da();function ja(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ta;const n=e===Ta?Ua:Da(e);return function(){return n().dispatch}}const za=ja();var Ba;(e=>{Ca=e})(ba.useSyncExternalStoreWithSelector),(e=>{Ra=e})(ya.useSyncExternalStore),Ba=va.unstable_batchedUpdates,Sa=Ba;const Va=["pd","wasm"],Ga={url:null,filepath:null,arrayBuffer:null,focusOn:"local"},Wa=ia({name:"buildInput",initialState:Ga,reducers:{setUrl:(e,n)=>{e.url=n.payload,e.focusOn="url"},fetchUrlError:(e,n)=>{},fetchUrlSuccess:(e,n)=>{e.filepath=null,e.url=n.payload.url,e.arrayBuffer=n.payload.arrayBuffer},setLocalFile:(e,n)=>{e.url=null,e.filepath=n.payload.filepath,e.arrayBuffer=n.payload.arrayBuffer,e.focusOn="local"},setFocusOn:(e,n)=>{e.focusOn=n.payload},clear:()=>Ga}}),$a=["wav","wasm"],Ha={format:null,codeTarget:"JavaScript",previewDurationSeconds:30},Ka=ia({name:"buildOutput",initialState:Ha,reducers:{setFormat:(e,n)=>{e.format=n.payload},setCodeTarget:(e,n)=>{e.codeTarget=n.payload},setPreviewDurationSeconds:(e,n)=>{e.previewDurationSeconds=n.payload},clear:()=>Ha},extraReducers(e){e.addCase(Wa.actions.setFocusOn,(e=>{e.format=null}))}});let qa=null;const Ya=/\\(\$\d+)/g,Xa=/\\\\\\,/g,Ja=/\\\\\\;/g,Qa=e=>{try{return Za(e)}catch(n){if(!(n instanceof rs))throw n}try{return ts(e)}catch(n){if(!(n instanceof rs))throw n}throw new rs("Not a valid arg ".concat(e))},Za=e=>{if(as(e))return e;if(ss(e)){const n=Number(e);if(isNaN(n))throw new rs("Not a valid number arg ".concat(e));return n}throw new rs("Not a valid number arg ".concat(e))},es=e=>{if(void 0===e)throw new rs("Received undefined");const n=parseInt(e,10);if(isNaN(n))throw new rs("Invalid int received");return n},ns=e=>{const n=Za(e);if(0===n||1===n)return n;throw new rs("Should be 0 or 1")},ts=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!ss(e))throw new rs("Not a valid string arg ".concat(e));if(null!==n&&e===n)return"";let t,r=e.replace(Xa,",").replace(Ja,";");for(;t=Ya.exec(r);)r=r.replace(t[0],t[1]);return r};class rs extends Error{}const as=e=>Number.isFinite(e),ss=e=>"string"===typeof e,os=(e,n)=>{let{tokens:t}=n;const r=ts(t[2]),a=Qa(t[3]),s=es(t[5]);return{id:e,args:[r,a,s%2],data:null,layout:{drawAs:["polygon","points","bezier"][s>>>1]}}},is=(e,n)=>{let{tokens:t}=n;const r=t[4],a=[];if("pd"!==r&&"graph"!==r&&"table"!==r)throw new Error("unknown canvasType : ".concat(r));return"pd"===r&&void 0!==t[5]&&a.push(ts(t[5])),{id:e,type:r,patchId:ts(t[1]),nodeClass:"subpatch",args:a,layout:{x:es(t[2]),y:es(t[3])}}},ls=(e,n)=>{let{tokens:t}=n;return{id:e,args:[],type:"array",nodeClass:"array",arrayId:ts(t[1])}},us=(e,n)=>{const t=n[1];let r,a="";return"obj"===t?(a=ts(n[4]),r=n.slice(5)):(a=ts(t),r=n.slice(4)),"text"===t&&(r=[n.slice(4).join(" ")]),{id:e,type:a,args:r,layout:{x:Za(n[2]),y:Za(n[3])}}},cs=e=>{let{tokens:n}=e;return{source:{nodeId:ts(n[2]),portletId:es(n[3])},sink:{nodeId:ts(n[4]),portletId:es(n[5])}}},ds=e=>{const n={...e,nodeClass:"generic"};return n.args=n.args.map(Qa),n},fs=e=>{const n=e.args,t={...e,type:e.type,nodeClass:"control"};if("floatatom"===t.type||"symbolatom"===t.type||"listbox"===t.type)t.layout={...t.layout,widthInChars:Za(n[0]),labelPos:Za(n[3]),label:ts(n[4],"-")},t.args=[Za(n[1]),Za(n[2]),ts(n[5],"-"),ts(n[6],"-")];else if("msg"===t.type)t.args=t.args.map(Qa);else if("bng"===t.type)t.layout={...t.layout,size:Za(n[0]),hold:Za(n[1]),interrupt:Za(n[2]),label:ts(n[6],"empty"),labelX:Za(n[7]),labelY:Za(n[8]),labelFont:n[9],labelFontSize:Za(n[10]),bgColor:n[11],fgColor:n[12],labelColor:n[13]},t.args=[ns(n[3]),ts(n[5],"empty"),ts(n[4],"empty")];else if("tgl"===t.type)t.layout={...t.layout,size:Za(n[0]),label:ts(n[4],"empty"),labelX:Za(n[5]),labelY:Za(n[6]),labelFont:n[7],labelFontSize:Za(n[8]),bgColor:n[9],fgColor:n[10],labelColor:n[11]},t.args=[Za(n[13]),ns(n[1]),Za(n[12]),ts(n[3],"empty"),ts(n[2],"empty")];else if("nbx"===t.type)t.layout={...t.layout,widthInChars:Za(n[0]),height:Za(n[1]),log:Za(n[4]),label:ts(n[8],"empty"),labelX:Za(n[9]),labelY:Za(n[10]),labelFont:n[11],labelFontSize:Za(n[12]),bgColor:n[13],fgColor:n[14],labelColor:n[15],logHeight:n[17]},t.args=[Za(n[2]),Za(n[3]),ns(n[5]),Za(n[16]),ts(n[7],"empty"),ts(n[6],"empty")];else if("vsl"===t.type||"hsl"===t.type){t.layout={...t.layout,width:Za(n[0]),height:Za(n[1]),log:Za(n[4]),label:ts(n[8],"empty"),labelX:Za(n[9]),labelY:Za(n[10]),labelFont:n[11],labelFontSize:Za(n[12]),bgColor:n[13],fgColor:n[14],labelColor:n[15],steadyOnClick:n[17]};const e=Za(n[2]),r=Za(n[3]),a=ns(n[4]),s=Za(n[16]),o="hsl"===t.type?t.layout.width:t.layout.height;let i=0;if(a){const n=Math.log(r/e)/(o-1);i=e*Math.exp(n*s*.01)}else i=e+(r-e)*s/(100*(o-1));t.args=[e,r,ns(n[5]),i,ts(n[7],"empty"),ts(n[6],"empty")]}else if("vradio"===t.type||"hradio"===t.type)t.layout={...t.layout,size:Za(n[0]),label:ts(n[6],"empty"),labelX:Za(n[7]),labelY:Za(n[8]),labelFont:n[9],labelFontSize:Za(n[10]),bgColor:n[11],fgColor:n[12],labelColor:n[13]},t.args=[Za(n[3]),ns(n[2]),Za(n[14]),ts(n[5],"empty"),ts(n[4],"empty"),ns(n[2])];else if("vu"===t.type)t.layout={...t.layout,width:Za(n[0]),height:Za(n[1]),label:ts(n[3],"empty"),labelX:Za(n[4]),labelY:Za(n[5]),labelFont:n[6],labelFontSize:Za(n[7]),bgColor:n[8],labelColor:n[9],log:Za(n[10])},t.args=[ts(n[2],"empty"),ts(n[11])];else{if("cnv"!==t.type)throw new Error("Unexpected control node ".concat(t.type));t.layout={...t.layout,size:Za(n[0]),width:Za(n[1]),height:Za(n[2]),label:ts(n[5],"empty"),labelX:Za(n[6]),labelY:Za(n[7]),labelFont:n[8],labelFontSize:Za(n[9]),bgColor:n[10],labelColor:n[11]},t.args=[ts(n[4],"empty"),ts(n[3],"empty"),ts(n[12])]}return t};function ps(e,n){if(n){const t=n;for(;t.length;){"f"===t.shift()&&(e.layout.width=Za(t.shift()))}}return e}const gs=/(?<comma>((?<!\\)\s*)((?<!\\\\)\\,)((?<!\\)\s*))|(?<semi>((?<!\\)\s*)((?<!\\\\)\\;)((?<!\\)\s*))|((?<!\\)\s)+|\r\n?|\n/,ms=/,(?!\\)/,hs=/(#((.|\r|\n)*?)[^\\\\])\r{0,1}\n{0,1};\r{0,1}(\n|$)/gi,ys=e=>e.split("").reverse().join("");const bs=e=>{const n=Array.from(e.matchAll(new RegExp(gs,"g"))),t=[];n.forEach(((r,a)=>{const s=0===a?0:n[a-1].index+n[a-1][0].length,o=r.index,i=e.slice(s,o);i.length&&t.push(i),r[1]?t.push(","):r[5]&&t.push(";")}));const r=n.slice(-1)[0];return r&&t.push(e.slice(r.index+r[0].length)),t},vs={floatatom:"floatatom",symbolatom:"symbolatom",listbox:"listbox",bng:"bng",tgl:"tgl",nbx:"nbx",vsl:"vsl",hsl:"hsl",vradio:"vradio",hradio:"hradio",vu:"vu",cnv:"cnv",msg:"msg"},Ss=["obj","floatatom","symbolatom","listbox","msg","text"],ws=()=>"".concat(++ws.counter);ws.counter=-1;const _s=()=>"".concat(++_s.counter);_s.counter=-1;const ks=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return t.every(((n,t)=>n===e[t]))};var Is=e=>{let n=(e=>{const n=[];hs.lastIndex=0;let t=null;for(;t=hs.exec(e);){const r=ys(t[1]).split(ms).reverse().map(ys),a=e.slice(0,t.index).split("\n").length-1;n.push({tokens:bs(r[0]),lineAfterComma:r[1]?bs(r[1]):void 0,lineIndex:a})}return n})(e);const t={pd:{rootPatchId:"0",patches:{},arrays:{}},errors:[],warnings:[],tokenizedLines:n,patchTokenizedLinesMap:{}};return Ts(t,!0),Object.keys(t.pd.patches).forEach((e=>{Os(t,e),Cs(t,e),xs(t,e),t.patchTokenizedLinesMap[e].length&&t.patchTokenizedLinesMap[e].forEach((e=>{let{tokens:n,lineIndex:r}=e;t.errors.push({message:'"'.concat(n[0]," ").concat(n[1],'" unexpected chunk'),lineIndex:r})}))})),t.errors.length?{status:1,warnings:t.warnings,errors:t.errors}:{status:0,warnings:t.warnings,pd:t.pd}};const Ts=(e,n)=>{const t=ws(),r=[];let a=null,s=null,o=-1,i=!0,l=e.tokenizedLines[0]?e.tokenizedLines[0].lineIndex:-1;for(;e.tokenizedLines.length&&i;){const{tokens:n,lineIndex:l}=e.tokenizedLines[0];ks(n,"#N","struct")||ks(n,"#X","declare")||ks(n,"#X","scalar")||ks(n,"#X","f")?(e.warnings.push({message:'"'.concat(n[0]," ").concat(n[1],'" chunk is not supported'),lineIndex:l}),e.tokenizedLines.shift()):(o++,Ms(e,l,(()=>{if(ks(n,"#N","canvas")&&0===o)a=e.tokenizedLines.shift();else if(ks(n,"#N","canvas"))Ts(e,!1);else if(ks(n,"#X","obj",n[2],n[3],"table")){const n=e.tokenizedLines.shift().tokens;e.tokenizedLines=[{tokens:["#N","canvas","0","0","100","100","(subpatch)","0"],lineIndex:l},{tokens:["#N","canvas","0","0","100","100","(subpatch)","0"],lineIndex:l},{tokens:["#X","array",ts(n[5]),n[6]||100..toString(),"float","0"],lineIndex:l},{tokens:["#X","restore","0","0","graph"],lineIndex:l},{tokens:["#X","restore",n[2],n[3],"table"],lineIndex:l},...e.tokenizedLines],Ts(e,!1)}else ks(n,"#X","coords")?s=e.tokenizedLines.shift():ks(n,"#X","restore")?(e.tokenizedLines[0].tokens=["PATCH",t,...e.tokenizedLines[0].tokens.slice(2)],i=!1):r.push(e.tokenizedLines.shift())})))}null!==a?(n&&(e.pd.rootPatchId=t),e.pd.patches[t]=((e,n,t,r)=>{const{tokens:a}=t,s=r?r.tokens:null;let o={windowX:es(a[2]),windowY:es(a[3]),windowWidth:es(a[4]),windowHeight:es(a[5])};if("undefined"!==typeof a[7]&&(o.openOnLoad=ns(a[7])),s&&"undefined"!==typeof s[8]){const e=Za(s[8]);o.graphOnParent=e>0?1:0,1===o.graphOnParent&&(o={...o,hideObjectNameAndArguments:2===e?1:0,viewportX:s[9]?es(s[9]):0,viewportY:s[10]?es(s[10]):0,viewportWidth:es(s[6]),viewportHeight:es(s[7])})}return{id:e,isRoot:n,layout:o,args:[],nodes:{},connections:[],inlets:[],outlets:[]}})(t,n,a,s),e.patchTokenizedLinesMap[t]=r):e.errors.push({message:"Parsing failed #canvas missing",lineIndex:l})},xs=(e,n)=>{const t=e.pd.patches[n],r=(e,n)=>parseFloat(e.id)-parseFloat(n.id),a=(e,n)=>e.layout.x-n.layout.x,s=Object.values(t.nodes).filter((e=>["inlet","inlet~"].includes(e.type))),o=s.every((e=>!!e.layout))?a:r;s.sort(o);const i=Object.values(t.nodes).filter((e=>["outlet","outlet~"].includes(e.type))),l=i.every((e=>!!e.layout))?a:r;i.sort(l),e.pd.patches[n]={...t,inlets:s.map((e=>e.id)),outlets:i.map((e=>e.id))}},Os=(e,n)=>{const t=e.patchTokenizedLinesMap[n],r=[];let a=null;for(;t.length;){const{tokens:n,lineIndex:s}=t[0];Ms(e,s,(()=>{if(ks(n,"#X","array"))a=os(_s(),t.shift()),e.pd.arrays[a.id]=a,r.push({tokens:["ARRAY",a.id],lineAfterComma:[],lineIndex:s});else if(ks(n,"#A")){if(!a)throw new Error("line ".concat(s,": Unsupported data chunk #A."));if(0===a.args[2])throw new Error("got array data for an array that doesn't save contents.");const e=a.data||[];a.data=e;const r=Za(n[1]);n.slice(2).forEach(((n,t)=>{const a=Za(n);Number.isFinite(a)&&(e[r+t]=a)})),t.shift()}else r.push(t.shift())}))}e.patchTokenizedLinesMap[n]=r},Cs=(e,n)=>{const t=e.pd.patches[n],r=e.patchTokenizedLinesMap[n],a=[];let s=-1;const o=()=>"".concat(++s);for(;r.length;){const{tokens:n,lineIndex:s}=r[0];Ms(e,s,(()=>{let e=null;if(ks(n,"PATCH"))e=is(o(),r.shift());else if(ks(n,"ARRAY"))e=ls(o(),r.shift());else if(Ss.some((e=>ks(n,"#X",e)))){const n=r.shift(),t=us(o(),n.tokens);Object.keys(vs).includes(t.type)?(e=fs(t),e=ps(e,n.lineAfterComma)):(e=ds(t),e=ps(e,n.lineAfterComma))}e?t.nodes[e.id]=e:ks(n,"#X","connect")?t.connections.push(cs(r.shift())):a.push(r.shift())}))}e.patchTokenizedLinesMap[n]=a},Ms=(e,n,t)=>{try{t()}catch(r){if(!(r instanceof rs))throw r;e.errors.push({message:r.message,lineIndex:n})}},Es=e=>async n=>{let t=null;try{t=await e(n)}catch(a){if(a instanceof As)return{status:1,unknownNodeType:n};throw a}const r=Is(t);return 0===r.status?{status:0,pd:r.pd,parsingWarnings:r.warnings}:{status:1,parsingErrors:r.errors,parsingWarnings:r.warnings}};class As extends Error{}const Fs=(e,n)=>{const t=e[n];if(!t)throw new Error("no artefact was generated for ".concat(n));return t},Ps=e=>(new TextDecoder).decode(e),Ns=e=>{const n=[];for(let t=0;t<e;t++)n.push(t);return n},Rs=(e,n)=>{const t={};return Object.entries(e).forEach(((e,r)=>{let[a,s]=e;t[a]=n(s,a,r)})),t},Ls=(e,n)=>{const t={};return e.forEach(((e,r)=>{const[a,s]=n(e,r);t[a]=s})),t},Ds=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];const r=n.find((e=>{let[n]=e;return n}));if(!r)throw new Error("no route found");return r[1]},Us=(e,n)=>{const t=e[n];if(t)return t;throw new Error('Node "'.concat(n,'" not found in graph'))},js=(e,n)=>{const t=e.inlets[n];if(t)return t;throw new Error('Inlet "'.concat(n,'" not found in node ').concat(e.id," of type ").concat(e.type))},zs=(e,n)=>{const t=e.outlets[n];if(t)return t;throw new Error('Outlet "'.concat(n,'" not found in node ').concat(e.id," of type ").concat(e.type))},Bs=(e,n)=>e.sinks[n]||[],Vs=(e,n)=>e.sources[n]||[],Gs=(e,n)=>n.map((n=>Us(e,n))),Ws=(e,n,t)=>{const r=[];return n.forEach((n=>$s(r,[],e,n,t))),r},$s=(e,n,t,r,a)=>{if(a&&!a(r))return;const s=[...n,r.id];Object.entries(r.sources).filter((e=>{let[n]=e;return"signal"===js(r,n).type})).forEach((r=>{let[o,i]=r;i.forEach((r=>{const o=Us(t,r.nodeId);-1===n.indexOf(o.id)&&$s(e,s,t,o,a)}))})),-1===e.indexOf(r.id)&&e.push(r.id)},Hs=(e,n)=>{const t=[];return n.forEach((n=>{Ks(t,e,n)})),t},Ks=(e,n,t)=>{-1===e.indexOf(t.id)&&(e.push(t.id),Object.entries(t.sinks).filter((e=>{let[n]=e;return"message"===zs(t,n).type})).forEach((t=>{let[r,a]=t;a.forEach((t=>{Ks(e,n,Us(n,t.nodeId))}))})))},qs=(e,n)=>{const t={};return Object.entries(e).forEach((e=>{let[r,a]=e;const s=a.filter((e=>{let{nodeId:t}=e;return n.includes(t)}));s.length&&(t[r]=s)})),t},Ys=(e,n)=>{const t={};return Object.entries(e).forEach((e=>{let[r,a]=e;const s=a.filter((e=>{let{nodeId:t}=e;return n.includes(t)}));s.length&&(t[r]=s)})),t};var Xs="0.1.0";const Js={Var:(e,n)=>"let ".concat(e.name).concat(n?" = ".concat(n):""),ConstVar:(e,n)=>"const ".concat(e.name," = ").concat(n),Func:(e,n,t)=>"function ".concat(null!==e.name?e.name:"","(").concat(e.args.map(((e,t)=>n[t]?"".concat(e.name,"=").concat(n[t]):e.name)).join(", "),") {").concat(t,"}"),Class:()=>""},Qs={Var:(e,n)=>"let ".concat(e.name,": ").concat(e.type).concat(n?" = ".concat(n):""),ConstVar:(e,n)=>"const ".concat(e.name,": ").concat(e.type," = ").concat(n),Func:(e,n,t)=>"function ".concat(null!==e.name?e.name:"","(").concat(e.args.map(((e,t)=>"".concat(e.name,": ").concat(e.type).concat(n[t]?"=".concat(n[t]):""))).join(", "),"): ").concat(e.returnType," {").concat(t,"}"),Class:e=>"class ".concat(e.name," {\n").concat(e.members.map((e=>"".concat(e.name,": ").concat(e.type))).join("\n"),"\n}")},Zs=e=>({javascript:Js,assemblyscript:Qs}[e]),eo=(e,n)=>{const t=e[n];if(!t)throw new Error("node [".concat(n,"] is not implemented"));return{dependencies:[],...t}},no=e=>{const{settings:{audio:n,io:t},variableNamesIndex:r}=e;return{libVersion:Xs,audioSettings:{...n,sampleRate:0,blockSize:0},compilation:{io:t,variableNamesIndex:{io:r.io}}}},to=e=>!("function"===typeof e),ro=(e,n,t)=>po({astType:"Var",name:n,type:e,value:void 0!==t?go(t):void 0}),ao=(e,n,t)=>po({astType:"ConstVar",name:n,type:e,value:go(t)}),so=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"void";return function(r){for(var a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];return po({astType:"Func",name:e,args:n,returnType:t,body:uo(r,...s)})}},oo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"void";return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return po({astType:"Func",name:null,args:e,returnType:n,body:uo(t,...a)})}},io=(e,n)=>po({astType:"Class",name:e,members:n}),lo=e=>({astType:"Sequence",content:co(fo(e,Ns(e.length-1).map((()=>"\n"))))}),uo=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return po({astType:"Sequence",content:co(fo(e,t))})},co=e=>{const n=e.flatMap((e=>"string"===typeof e?[e]:"number"===typeof e?[e.toString()]:null===e?[]:Array.isArray(e)?co(fo(e,Ns(e.length-1).map((()=>"\n")))):"object"===typeof e&&"Sequence"===e.astType?e.content:[e])),[t,r]=n.reduce(((e,n)=>{let[t,r]=e;return"string"===typeof n?[t,r+n]:r.length?[[...t,r,n],""]:[[...t,n],""]}),[[],""]);return r.length&&t.push(r),t},fo=(e,n)=>0===e.length?[]:e.slice(1).reduce(((e,t,r)=>e.concat([n[r],t])),[e[0]]),po=e=>({...e}),go=e=>"number"===typeof e?lo([e.toString()]):"string"===typeof e?lo([e]):e;var mo,ho,yo,bo,vo;const So=e=>{let{variableNamesIndex:{globs:n}}=e;return lo([ro("Int",n.iterFrame,"0"),ro("Int",n.frame,"0"),ro("Int",n.blockSize,"0"),ro("Float",n.sampleRate,"0"),ro("Float",n.nullSignal,"0"),so(n.nullMessageReceiver,[ro("Message","m")],"void")(mo||(mo=r([""])))])},wo=e=>{let{settings:{arrays:n}}=e;return lo(Object.entries(n).map((e=>{let[n,t]=e;return lo(['commons_setArray("'.concat(n,'", createFloatArray(').concat(t.length,"))"),'commons_getArray("'.concat(n,'").set(').concat(JSON.stringify(Array.from(t)),")")])})))},_o=e=>{let{precompilation:n}=e;return lo([n.traversals.all.map((e=>n.nodes[e].initialization))])},ko=e=>{let{settings:{io:n},variableNamesIndex:t}=e;return lo(Object.entries(n.messageReceivers).map((e=>{let[n,a]=e;return a.portletIds.map((e=>so(t.io.messageReceivers[n][e],[ro("Message","m")],"void")(ho||(ho=r(["","(m)"])),t.nodes[n].messageReceivers[e])))})))},Io=(e,n)=>{let{settings:{io:t},variableNamesIndex:r}=e;return lo(Object.entries(t.messageSenders).map((e=>{let[t,a]=e;return a.portletIds.map((e=>{const a=r.io.messageSenders[t][e];return n(a,t,e)}))})))},To=e=>{const{graph:n,precompilation:t,settings:{debug:a}}=e,s=Gs(n,t.traversals.all);return lo([s.map((e=>{const n=t.nodes[e.id];return[Object.values(n.signalOuts).map((e=>ro("Float",e,"0"))),Object.entries(n.messageReceivers).map((n=>{let[t,s]=n;return so(s.name,s.args,s.returnType)(yo||(yo=r(["\n                                ","\n                                throw new Error('[",'], id "','", inlet "',"\", unsupported message : ' + msg_display(",")",")\n                            "])),s.body,e.type,e.id,t,s.args[0].name,a?" + '\\nDEBUG : remember, you must return from message receiver'":"")}))]})),s.map((e=>Object.values(t.nodes[e.id].messageSenders).map((e=>{let{messageSenderName:n,messageReceiverNames:t}=e;return so(n,[ro("Message","m")],"void")(bo||(bo=r(["\n                    ","\n                "])),t.map((e=>"".concat(e,"(m)"))))}))))])},xo=e=>{const{variableNamesIndex:n,precompilation:t}=e,{traversals:a}=t,{globs:s}=n;return uo(vo||(vo=r(["\n        for ("," = 0; "," < ","; ","++) {\n            _commons_emitFrame(",")\n            ","\n            ","++\n        }\n    "])),s.iterFrame,s.iterFrame,s.blockSize,s.iterFrame,s.frame,a.loop.map((e=>t.nodes[e].loop)),s.frame)},Oo=(e,n,t)=>{let{precompilation:r}=e;return lo([r.dependencies.imports.map(n),r.dependencies.exports.map(t)])},Co=(e,n)=>{if("string"===typeof n)return n;if("Var"===n.astType)return e.Var(n,n.value?Co(e,n.value):void 0);if("ConstVar"===n.astType)return e.ConstVar(n,n.value?Co(e,n.value):void 0);if("Func"===n.astType)return e.Func(n,n.args.map((n=>n.value?Co(e,n.value):null)),Co(e,n.body));if("Class"===n.astType)return e.Class(n);if("Sequence"===n.astType)return n.content.map((n=>Co(e,n))).join("");throw new Error("Unexpected element in AST ".concat(n))};var Mo,Eo,Ao,Fo,Po,No,Ro,Lo,Do,Uo;const jo=(e,n)=>new Proxy(n,{get:(n,t)=>{const r=Bo(String(t));if(!n.hasOwnProperty(r)){if(["toJSON","Symbol(Symbol.toStringTag)","constructor","$$typeof","@@__IMMUTABLE_ITERABLE__@@","@@__IMMUTABLE_RECORD__@@"].includes(r))return;throw new Error('Namespace "'.concat(e,'" doesn\'t know key "').concat(String(r),'"'))}return n[r]},set:(e,n,t)=>{const r=Bo(String(n));if(e.hasOwnProperty(r))throw new Error('Key "'.concat(String(r),'" is protected and cannot be overwritten.'));return e[r]=t,t}}),zo=(e,n)=>"".concat(e.type,":").concat(e.id).concat(n?":".concat(n):""),Bo=e=>{const n=/\$(.*)/.exec(e);return n?n[1]:e},Vo=()=>jo("globs",{iterFrame:"F",frame:"FRAME",blockSize:"BLOCK_SIZE",sampleRate:"SAMPLE_RATE",output:"OUTPUT",input:"INPUT",nullMessageReceiver:"SND_TO_NULL",nullSignal:"NULL_SIGNAL"}),Go=(e,n,t,r)=>{const{graph:a,variableNamesIndex:s,settings:{debug:o}}=e,i=s.nodes[t],l=Us(a,t),u=$o(o,l);return r in i[n]||(i[n][r]={signalOuts:"".concat(u,"_OUTS_").concat(Wo(r)),messageSenders:"".concat(u,"_SNDS_").concat(Wo(r)),messageReceivers:"".concat(u,"_RCVS_").concat(Wo(r))}[n]),i[n][r]},Wo=e=>{if(!Ho.exec(e))throw new Error('Invalid variable name for code generation "'.concat(e,'"'));return e},$o=(e,n)=>{return Wo(e?"".concat((t=n.type,t.replace(/[^a-zA-Z0-9_]/g,"")),"_").concat(n.id):n.id);var t},Ho=/^[a-zA-Z0-9_]+$/;var Ko,qo,Yo,Xo,Jo,Qo,Zo,ei;const ni=e=>{let{target:n}=e;const t=[];return"assemblyscript"===n&&t.push("\n            type SkedCallback = (event: SkedEvent) => void\n            type SkedId = Int\n            type SkedMode = Int\n            type SkedEvent = string\n        "),lo([...t,ao("SkedId","SKED_ID_NULL","-1"),ao("SkedId","SKED_ID_COUNTER_INIT","1"),ao("Int","_SKED_WAIT_IN_PROGRESS","0"),ao("Int","_SKED_WAIT_OVER","1"),ao("Int","_SKED_MODE_WAIT","0"),ao("Int","_SKED_MODE_SUBSCRIBE","1"),io("SkedRequest",[ro("SkedId","id"),ro("SkedMode","mode"),ro("SkedCallback","callback")]),io("Skeduler",[ro("Map<SkedEvent, Array<SkedId>>","events"),ro("Map<SkedId, SkedRequest>","requests"),ro("boolean","isLoggingEvents"),ro("Set<SkedEvent>","eventLog"),ro("SkedId","idCounter")]),so("sked_create",[ro("boolean","isLoggingEvents")],"Skeduler")(Ko||(Ko=r(["\n            return {\n                eventLog: new Set(),\n                events: new Map(),\n                requests: new Map(),\n                idCounter: SKED_ID_COUNTER_INIT,\n                isLoggingEvents,\n            }\n        "]))),so("sked_wait",[ro("Skeduler","skeduler"),ro("SkedEvent","event"),ro("SkedCallback","callback")],"SkedId")(qo||(qo=r(['\n            if (skeduler.isLoggingEvents === false) {\n                throw new Error("Please activate skeduler\'s isLoggingEvents")\n            }\n\n            if (skeduler.eventLog.has(event)) {\n                callback(event)\n                return SKED_ID_NULL\n            } else {\n                return _sked_createRequest(skeduler, event, callback, _SKED_MODE_WAIT)\n            }\n        ']))),so("sked_wait_future",[ro("Skeduler","skeduler"),ro("SkedEvent","event"),ro("SkedCallback","callback")],"SkedId")(Yo||(Yo=r(["\n            return _sked_createRequest(skeduler, event, callback, _SKED_MODE_WAIT)\n        "]))),so("sked_subscribe",[ro("Skeduler","skeduler"),ro("SkedEvent","event"),ro("SkedCallback","callback")],"SkedId")(Xo||(Xo=r(["\n            return _sked_createRequest(skeduler, event, callback, _SKED_MODE_SUBSCRIBE)\n        "]))),so("sked_emit",[ro("Skeduler","skeduler"),ro("SkedEvent","event")],"void")(Jo||(Jo=r(["\n            if (skeduler.isLoggingEvents === true) {\n                skeduler.eventLog.add(event)\n            }\n            if (skeduler.events.has(event)) {\n                ","\n                ","\n                for (","; i < skedIds.length; i++) {\n                    if (skeduler.requests.has(skedIds[i])) {\n                        ","\n                        request.callback(event)\n                        if (request.mode === _SKED_MODE_WAIT) {\n                            skeduler.requests.delete(request.id)\n                        } else {\n                            skedIdsStaying.push(request.id)\n                        }\n                    }\n                }\n                skeduler.events.set(event, skedIdsStaying)\n            }\n        "])),ao("Array<SkedId>","skedIds","skeduler.events.get(event)"),ao("Array<SkedId>","skedIdsStaying","[]"),ro("Int","i","0"),ao("SkedRequest","request","skeduler.requests.get(skedIds[i])")),so("sked_cancel",[ro("Skeduler","skeduler"),ro("SkedId","id")],"void")(Qo||(Qo=r(["\n            skeduler.requests.delete(id)\n        "]))),so("_sked_createRequest",[ro("Skeduler","skeduler"),ro("SkedEvent","event"),ro("SkedCallback","callback"),ro("SkedMode","mode")],"SkedId")(Zo||(Zo=r(["\n            ","\n            ","\n            skeduler.requests.set(id, request)\n            if (!skeduler.events.has(event)) {\n                skeduler.events.set(event, [id])    \n            } else {\n                skeduler.events.get(event).push(id)\n            }\n            return id\n        "])),ao("SkedId","id","_sked_nextId(skeduler)"),ao("SkedRequest","request","{\n                id, \n                mode, \n                callback,\n            }")),so("_sked_nextId",[ro("Skeduler","skeduler")],"SkedId")(ei||(ei=r(["\n            return skeduler.idCounter++\n        "])))])};var ti,ri,ai,si,oi,ii,li,ui,ci,di;const fi={codeGenerator:()=>lo([ao("Skeduler","_commons_ENGINE_LOGGED_SKEDULER","sked_create(true)"),ao("Skeduler","_commons_FRAME_SKEDULER","sked_create(false)"),so("_commons_emitEngineConfigure")(ti||(ti=r(["\n            sked_emit(_commons_ENGINE_LOGGED_SKEDULER, 'configure')\n        "]))),so("_commons_emitFrame",[ro("Int","frame")],"void")(ri||(ri=r(["\n            sked_emit(_commons_FRAME_SKEDULER, frame.toString())\n        "])))]),dependencies:[ni]},pi={codeGenerator:()=>lo([ao("Map<string, FloatArray>","_commons_ARRAYS","new Map()"),ao("Skeduler","_commons_ARRAYS_SKEDULER","sked_create(false)"),so("commons_getArray",[ro("string","arrayName")],"FloatArray")(ai||(ai=r(["\n            if (!_commons_ARRAYS.has(arrayName)) {\n                throw new Error('Unknown array ' + arrayName)\n            }\n            return _commons_ARRAYS.get(arrayName)\n        "]))),so("commons_hasArray",[ro("string","arrayName")],"boolean")(si||(si=r(["\n            return _commons_ARRAYS.has(arrayName)\n        "]))),so("commons_setArray",[ro("string","arrayName"),ro("FloatArray","array")],"void")(oi||(oi=r(["\n            _commons_ARRAYS.set(arrayName, array)\n            sked_emit(_commons_ARRAYS_SKEDULER, arrayName)\n        "]))),so("commons_subscribeArrayChanges",[ro("string","arrayName"),ro("SkedCallback","callback")],"SkedId")(ii||(ii=r(["\n            const id = sked_subscribe(_commons_ARRAYS_SKEDULER, arrayName, callback)\n            if (_commons_ARRAYS.has(arrayName)) {\n                callback(arrayName)\n            }\n            return id\n        "]))),so("commons_cancelArrayChangesSubscription",[ro("SkedId","id")],"void")(li||(li=r(["\n            sked_cancel(_commons_ARRAYS_SKEDULER, id)\n        "])))]),exports:[{name:"commons_getArray"},{name:"commons_setArray"}]},gi={codeGenerator:()=>lo([so("commons_waitEngineConfigure",[ro("SkedCallback","callback")],"void")(ui||(ui=r(["\n            sked_wait(_commons_ENGINE_LOGGED_SKEDULER, 'configure', callback)\n        "])))]),dependencies:[fi]},mi={codeGenerator:()=>lo([so("commons_waitFrame",[ro("Int","frame"),ro("SkedCallback","callback")],"SkedId")(ci||(ci=r(["\n            return sked_wait_future(_commons_FRAME_SKEDULER, frame.toString(), callback)\n        "]))),so("commons_cancelWaitFrame",[ro("SkedId","id")],"void")(di||(di=r(["\n            sked_cancel(_commons_FRAME_SKEDULER, id)\n        "])))]),dependencies:[fi]};var hi,yi,bi,vi,Si,wi,_i,ki,Ii,Ti,xi,Oi,Ci,Mi;const Ei={codeGenerator:e=>{let{target:n,audioSettings:{bitDepth:t}}=e;const a=32===t?"f32":"f64",s=32===t?"Float32Array":"Float64Array",o=32===t?"getFloat32":"getFloat64",i=32===t?"setFloat32":"setFloat64",l={toInt:so("toInt",[ro("Float","v")],"Int"),toFloat:so("toFloat",[ro("Int","v")],"Float"),createFloatArray:so("createFloatArray",[ro("Int","length")],"FloatArray"),setFloatDataView:so("setFloatDataView",[ro("DataView","dataView"),ro("Int","position"),ro("Float","value")],"void"),getFloatDataView:so("getFloatDataView",[ro("DataView","dataView"),ro("Int","position")],"Float")};if("assemblyscript"===n)return lo(["\n                type FloatArray = ".concat(s,"\n                type Float = ").concat(a,"\n                type Int = ").concat("i32","\n                "),l.toInt(hi||(hi=r(["\n                    return ","(v)\n                "])),"i32"),l.toFloat(yi||(yi=r(["\n                    return ","(v)\n                "])),a),l.createFloatArray(bi||(bi=r(["\n                    return new ","(length)\n                "])),s),l.setFloatDataView(vi||(vi=r(["\n                    dataView.","(position, value)\n                "])),i),l.getFloatDataView(Si||(Si=r(["\n                    return dataView.","(position)\n                "])),o),so("x_core_createListOfArrays",[],"FloatArray[]")(wi||(wi=r(["\n                    const arrays: FloatArray[] = []\n                    return arrays\n                "]))),so("x_core_pushToListOfArrays",[ro("FloatArray[]","arrays"),ro("FloatArray","array")],"void")(_i||(_i=r(["\n                    arrays.push(array)\n                "]))),so("x_core_getListOfArraysLength",[ro("FloatArray[]","arrays")],"Int")(ki||(ki=r(["\n                    return arrays.length\n                "]))),so("x_core_getListOfArraysElem",[ro("FloatArray[]","arrays"),ro("Int","index")],"FloatArray")(Ii||(Ii=r(["\n                    return arrays[index]\n                "])))]);if("javascript"===n)return lo(["\n                const i32 = (v) => v\n                const f32 = i32\n                const f64 = i32\n                ",l.toInt(Ti||(Ti=r(["\n                    return v\n                "]))),l.toFloat(xi||(xi=r(["\n                    return v\n                "]))),l.createFloatArray(Oi||(Oi=r(["\n                    return new ","(length)\n                "])),s),l.setFloatDataView(Ci||(Ci=r(["\n                    dataView.","(position, value)\n                "])),i),l.getFloatDataView(Mi||(Mi=r(["\n                    return dataView.","(position)\n                "])),o)]);throw new Error("Unexpected target: ".concat(n))},exports:[{name:"x_core_createListOfArrays",targets:["assemblyscript"]},{name:"x_core_pushToListOfArrays",targets:["assemblyscript"]},{name:"x_core_getListOfArraysLength",targets:["assemblyscript"]},{name:"x_core_getListOfArraysElem",targets:["assemblyscript"]},{name:"createFloatArray",targets:["assemblyscript"]}]};var Ai,Fi,Pi,Ni,Ri,Li;const Di=()=>lo([io("buf_SoundBuffer",[ro("FloatArray","data"),ro("Int","length"),ro("Int","writeCursor"),ro("Int","pullAvailableLength")]),so("buf_clear",[ro("buf_SoundBuffer","buffer")],"void")(Ai||(Ai=r(["\n        buffer.data.fill(0)\n    "]))),so("buf_create",[ro("Int","length")],"buf_SoundBuffer")(Fi||(Fi=r(["\n        return {\n            data: createFloatArray(length),\n            length: length,\n            writeCursor: 0,\n            pullAvailableLength: 0,\n        }\n    "])))]),Ui={codeGenerator:()=>lo([so("buf_pushBlock",[ro("buf_SoundBuffer","buffer"),ro("FloatArray","block")],"Int")(Pi||(Pi=r(["\n            if (buffer.pullAvailableLength + block.length > buffer.length) {\n                throw new Error('buffer full')\n            }\n\n            ","\n            while (left > 0) {\n                ","\n                buffer.data.set(\n                    block.subarray(\n                        block.length - left, \n                        block.length - left + lengthToWrite\n                    ), \n                    buffer.writeCursor\n                )\n                left -= lengthToWrite\n                buffer.writeCursor = (buffer.writeCursor + lengthToWrite) % buffer.length\n                buffer.pullAvailableLength += lengthToWrite\n            }\n            return buffer.pullAvailableLength\n        "])),ro("Int","left","block.length"),ao("Int","lengthToWrite","toInt(Math.min(\n                    toFloat(buffer.length - buffer.writeCursor), \n                    toFloat(left),\n                ))")),so("buf_pullSample",[ro("buf_SoundBuffer","buffer")],"Float")(Ni||(Ni=r(["\n            if (buffer.pullAvailableLength <= 0) {\n                return 0\n            }\n            ","\n            buffer.pullAvailableLength -= 1\n            return buffer.data[readCursor >= 0 ? readCursor : buffer.length + readCursor]\n        "])),ao("Int","readCursor","buffer.writeCursor - buffer.pullAvailableLength"))]),dependencies:[Di]},ji={codeGenerator:()=>lo([so("buf_writeSample",[ro("buf_SoundBuffer","buffer"),ro("Float","value")],"void")(Ri||(Ri=r(["\n            buffer.data[buffer.writeCursor] = value\n            buffer.writeCursor = (buffer.writeCursor + 1) % buffer.length\n        "]))),so("buf_readSample",[ro("buf_SoundBuffer","buffer"),ro("Int","offset")],"Float")(Li||(Li=r(["\n            // R = (buffer.writeCursor - 1 - offset) -> ideal read position\n            // W = R % buffer.length -> wrap it so that its within buffer length bounds (but could be negative)\n            // (W + buffer.length) % buffer.length -> if W negative, (W + buffer.length) shifts it back to positive.\n            return buffer.data[(buffer.length + ((buffer.writeCursor - 1 - offset) % buffer.length)) % buffer.length]\n        "])))]),dependencies:[Di]};var zi,Bi,Vi,Gi,Wi,$i,Hi,Ki,qi,Yi,Xi,Ji,Qi,Zi,el,nl,tl,rl,al,sl,ol,il,ll,ul,cl,dl,fl,pl,gl,ml,hl,yl,bl,vl;const Sl={codeGenerator:e=>{let{target:n}=e;const t={msg_create:so("msg_create",[ro("MessageTemplate","template")],"Message"),msg_writeStringToken:so("msg_writeStringToken",[ro("Message","message"),ro("Int","tokenIndex"),ro("string","value")],"void"),msg_writeFloatToken:so("msg_writeFloatToken",[ro("Message","message"),ro("Int","tokenIndex"),ro("MessageFloatToken","value")],"void"),msg_readStringToken:so("msg_readStringToken",[ro("Message","message"),ro("Int","tokenIndex")],"string"),msg_readFloatToken:so("msg_readFloatToken",[ro("Message","message"),ro("Int","tokenIndex")],"MessageFloatToken"),msg_getLength:so("msg_getLength",[ro("Message","message")],"Int"),msg_getTokenType:so("msg_getTokenType",[ro("Message","message"),ro("Int","tokenIndex")],"Int"),msg_isStringToken:so("msg_isStringToken",[ro("Message","message"),ro("Int","tokenIndex")],"boolean"),msg_isFloatToken:so("msg_isFloatToken",[ro("Message","message"),ro("Int","tokenIndex")],"boolean"),msg_isMatching:so("msg_isMatching",[ro("Message","message"),ro("Array<MessageHeaderEntry>","tokenTypes")],"boolean"),msg_floats:so("msg_floats",[ro("Array<Float>","values")],"Message"),msg_strings:so("msg_strings",[ro("Array<string>","values")],"Message"),msg_display:so("msg_display",[ro("Message","message")],"string")};if("assemblyscript"===n)return lo(["\n                type MessageFloatToken = Float\n                type MessageCharToken = Int\n\n                type MessageTemplate = Array<Int>\n                type MessageHeaderEntry = Int\n                type MessageHeader = Int32Array\n                ",ao("MessageHeaderEntry","MSG_FLOAT_TOKEN","0"),ao("MessageHeaderEntry","MSG_STRING_TOKEN","1"),so("x_msg_create",[ro("Int32Array","templateTypedArray")],"Message")(zi||(zi=r(["\n                    const template: MessageTemplate = new Array<Int>(templateTypedArray.length)\n                    for (let i: Int = 0; i < templateTypedArray.length; i++) {\n                        template[i] = templateTypedArray[i]\n                    }\n                    return msg_create(template)\n                "]))),so("x_msg_getTokenTypes",[ro("Message","message")],"MessageHeader")(Bi||(Bi=r(["\n                    return message.tokenTypes\n                "]))),so("x_msg_createTemplate",[ro("i32","length")],"Int32Array")(Vi||(Vi=r(["\n                    return new Int32Array(length)\n                "]))),t.msg_create(Gi||(Gi=r(['\n                    let i: Int = 0\n                    let byteCount: Int = 0\n                    let tokenTypes: Array<MessageHeaderEntry> = []\n                    let tokenPositions: Array<MessageHeaderEntry> = []\n\n                    i = 0\n                    while (i < template.length) {\n                        switch(template[i]) {\n                            case MSG_FLOAT_TOKEN:\n                                byteCount += sizeof<MessageFloatToken>()\n                                tokenTypes.push(MSG_FLOAT_TOKEN)\n                                tokenPositions.push(byteCount)\n                                i += 1\n                                break\n                            case MSG_STRING_TOKEN:\n                                byteCount += sizeof<MessageCharToken>() * template[i + 1]\n                                tokenTypes.push(MSG_STRING_TOKEN)\n                                tokenPositions.push(byteCount)\n                                i += 2\n                                break\n                            default:\n                                throw new Error("unknown token type : " + template[i].toString())\n                        }\n                    }\n\n                    const tokenCount = tokenTypes.length\n                    const headerByteCount = _msg_computeHeaderLength(tokenCount) * sizeof<MessageHeaderEntry>()\n                    byteCount += headerByteCount\n\n                    const buffer = new ArrayBuffer(byteCount)\n                    const dataView = new DataView(buffer)\n                    let writePosition: Int = 0\n                    \n                    dataView.setInt32(writePosition, tokenCount)\n                    writePosition += sizeof<MessageHeaderEntry>()\n\n                    for (i = 0; i < tokenCount; i++) {\n                        dataView.setInt32(writePosition, tokenTypes[i])\n                        writePosition += sizeof<MessageHeaderEntry>()\n                    }\n\n                    dataView.setInt32(writePosition, headerByteCount)\n                    writePosition += sizeof<MessageHeaderEntry>()\n                    for (i = 0; i < tokenCount; i++) {\n                        dataView.setInt32(writePosition, headerByteCount + tokenPositions[i])\n                        writePosition += sizeof<MessageHeaderEntry>()\n                    }\n\n                    const header = _msg_unpackHeader(dataView, tokenCount)\n                    return {\n                        dataView,\n                        tokenCount,\n                        header,\n                        tokenTypes: _msg_unpackTokenTypes(header),\n                        tokenPositions: _msg_unpackTokenPositions(header),\n                    }\n                ']))),t.msg_writeStringToken(Wi||(Wi=r(["\n                    const startPosition = message.tokenPositions[tokenIndex]\n                    const endPosition = message.tokenPositions[tokenIndex + 1]\n                    const expectedStringLength: Int = (endPosition - startPosition) / sizeof<MessageCharToken>()\n                    if (value.length !== expectedStringLength) {\n                        throw new Error('Invalid string size, specified ' + expectedStringLength.toString() + ', received ' + value.length.toString())\n                    }\n\n                    for (let i = 0; i < value.length; i++) {\n                        message.dataView.setInt32(\n                            startPosition + i * sizeof<MessageCharToken>(), \n                            value.codePointAt(i)\n                        )\n                    }\n                "]))),t.msg_writeFloatToken($i||($i=r(["\n                    setFloatDataView(message.dataView, message.tokenPositions[tokenIndex], value)\n                "]))),t.msg_readStringToken(Hi||(Hi=r(["\n                    const startPosition = message.tokenPositions[tokenIndex]\n                    const endPosition = message.tokenPositions[tokenIndex + 1]\n                    const stringLength: Int = (endPosition - startPosition) / sizeof<MessageCharToken>()\n                    let value: string = ''\n                    for (let i = 0; i < stringLength; i++) {\n                        value += String.fromCodePoint(message.dataView.getInt32(startPosition + sizeof<MessageCharToken>() * i))\n                    }\n                    return value\n                "]))),t.msg_readFloatToken(Ki||(Ki=r(["\n                    return getFloatDataView(message.dataView, message.tokenPositions[tokenIndex])\n                "]))),t.msg_getLength(qi||(qi=r(["\n                    return message.tokenTypes.length\n                "]))),t.msg_getTokenType(Yi||(Yi=r(["\n                    return message.tokenTypes[tokenIndex]\n                "]))),t.msg_isStringToken(Xi||(Xi=r(["\n                    return msg_getTokenType(message, tokenIndex) === MSG_STRING_TOKEN\n                "]))),t.msg_isFloatToken(Ji||(Ji=r(["\n                    return msg_getTokenType(message, tokenIndex) === MSG_FLOAT_TOKEN\n                "]))),t.msg_isMatching(Qi||(Qi=r(["\n                    if (message.tokenTypes.length !== tokenTypes.length) {\n                        return false\n                    }\n                    for (let i: Int = 0; i < tokenTypes.length; i++) {\n                        if (message.tokenTypes[i] !== tokenTypes[i]) {\n                            return false\n                        }\n                    }\n                    return true\n                "]))),t.msg_floats(Zi||(Zi=r(["\n                    const message: Message = msg_create(values.map<MessageHeaderEntry>(v => MSG_FLOAT_TOKEN))\n                    for (let i: Int = 0; i < values.length; i++) {\n                        msg_writeFloatToken(message, i, values[i])\n                    }\n                    return message\n                "]))),t.msg_strings(el||(el=r(["\n                    const template: MessageTemplate = []\n                    for (let i: Int = 0; i < values.length; i++) {\n                        template.push(MSG_STRING_TOKEN)\n                        template.push(values[i].length)\n                    }\n                    const message: Message = msg_create(template)\n                    for (let i: Int = 0; i < values.length; i++) {\n                        msg_writeStringToken(message, i, values[i])\n                    }\n                    return message\n                "]))),t.msg_display(nl||(nl=r(["\n                    let displayArray: Array<string> = []\n                    for (let i: Int = 0; i < msg_getLength(message); i++) {\n                        if (msg_isFloatToken(message, i)) {\n                            displayArray.push(msg_readFloatToken(message, i).toString())\n                        } else {\n                            displayArray.push('\"' + msg_readStringToken(message, i) + '\"')\n                        }\n                    }\n                    return '[' + displayArray.join(', ') + ']'\n                "]))),io("Message",[ro("DataView","dataView"),ro("MessageHeader","header"),ro("MessageHeaderEntry","tokenCount"),ro("MessageHeader","tokenTypes"),ro("MessageHeader","tokenPositions")]),so("_msg_computeHeaderLength",[ro("Int","tokenCount")],"Int")(tl||(tl=r(["\n                    return 1 + tokenCount * 2 + 1\n                "]))),so("_msg_unpackTokenCount",[ro("DataView","messageDataView")],"MessageHeaderEntry")(rl||(rl=r(["\n                    return messageDataView.getInt32(0)\n                "]))),so("_msg_unpackHeader",[ro("DataView","messageDataView"),ro("MessageHeaderEntry","tokenCount")],"MessageHeader")(al||(al=r(["\n                    const headerLength = _msg_computeHeaderLength(tokenCount)\n                    // TODO : why is this `wrap` not working ?\n                    // return Int32Array.wrap(messageDataView.buffer, 0, headerLength)\n                    const messageHeader = new Int32Array(headerLength)\n                    for (let i = 0; i < headerLength; i++) {\n                        messageHeader[i] = messageDataView.getInt32(sizeof<MessageHeaderEntry>() * i)\n                    }\n                    return messageHeader\n                "],["\n                    const headerLength = _msg_computeHeaderLength(tokenCount)\n                    // TODO : why is this \\`wrap\\` not working ?\n                    // return Int32Array.wrap(messageDataView.buffer, 0, headerLength)\n                    const messageHeader = new Int32Array(headerLength)\n                    for (let i = 0; i < headerLength; i++) {\n                        messageHeader[i] = messageDataView.getInt32(sizeof<MessageHeaderEntry>() * i)\n                    }\n                    return messageHeader\n                "]))),so("_msg_unpackTokenTypes",[ro("MessageHeader","header")],"MessageHeader")(sl||(sl=r(["\n                    return header.slice(1, 1 + header[0])\n                "]))),so("_msg_unpackTokenPositions",[ro("MessageHeader","header")],"MessageHeader")(ol||(ol=r(["\n                    return header.slice(1 + header[0])\n                "])))]);if("javascript"===n)return lo([ao("string","MSG_FLOAT_TOKEN",'"number"'),ao("string","MSG_STRING_TOKEN",'"string"'),t.msg_create(il||(il=r(["\n                    const m = []\n                    let i = 0\n                    while (i < template.length) {\n                        if (template[i] === MSG_STRING_TOKEN) {\n                            m.push('')\n                            i += 2\n                        } else if (template[i] === MSG_FLOAT_TOKEN) {\n                            m.push(0)\n                            i += 1\n                        }\n                    }\n                    return m\n                "]))),t.msg_getLength(ll||(ll=r(["\n                    return message.length\n                "]))),t.msg_getTokenType(ul||(ul=r(["\n                    return typeof message[tokenIndex]\n                "]))),t.msg_isStringToken(cl||(cl=r(["\n                    return msg_getTokenType(message, tokenIndex) === 'string'\n                "]))),t.msg_isFloatToken(dl||(dl=r(["\n                    return msg_getTokenType(message, tokenIndex) === 'number'\n                "]))),t.msg_isMatching(fl||(fl=r(["\n                    return (message.length === tokenTypes.length) \n                        && message.every((v, i) => msg_getTokenType(message, i) === tokenTypes[i])\n                "]))),t.msg_writeFloatToken(pl||(pl=r(["\n                    message[tokenIndex] = value\n                "]))),t.msg_writeStringToken(gl||(gl=r(["\n                    message[tokenIndex] = value\n                "]))),t.msg_readFloatToken(ml||(ml=r(["\n                    return message[tokenIndex]\n                "]))),t.msg_readStringToken(hl||(hl=r(["\n                    return message[tokenIndex]\n                "]))),t.msg_floats(yl||(yl=r(["\n                    return values\n                "]))),t.msg_strings(bl||(bl=r(["\n                    return values\n                "]))),t.msg_display(vl||(vl=r(["\n                    return '[' + message\n                        .map(t => typeof t === 'string' ? '\"' + t + '\"' : t.toString())\n                        .join(', ') + ']'\n                "])))]);throw new Error("Unexpected target: ".concat(n))},exports:[{name:"x_msg_create",targets:["assemblyscript"]},{name:"x_msg_getTokenTypes",targets:["assemblyscript"]},{name:"x_msg_createTemplate",targets:["assemblyscript"]},{name:"msg_writeStringToken",targets:["assemblyscript"]},{name:"msg_writeFloatToken",targets:["assemblyscript"]},{name:"msg_readStringToken",targets:["assemblyscript"]},{name:"msg_readFloatToken",targets:["assemblyscript"]},{name:"MSG_FLOAT_TOKEN",targets:["assemblyscript"]},{name:"MSG_STRING_TOKEN",targets:["assemblyscript"]}]};var wl,_l,kl,Il,Tl,xl,Ol,Cl,Ml,El,Al,Fl,Pl,Nl,Rl,Ll,Dl,Ul,jl;const zl={codeGenerator:e=>{let{target:n}=e;const t=[];return"assemblyscript"===n&&t.push("\n                type fs_OperationId = Int\n                type fs_OperationStatus = Int\n                type fs_OperationCallback = (id: fs_OperationId, status: fs_OperationStatus) => void\n                type fs_OperationSoundCallback = (id: fs_OperationId, status: fs_OperationStatus, sound: FloatArray[]) => void\n                type fs_Url = string\n            "),lo([...t,ao("Int","FS_OPERATION_SUCCESS",(0).toString()),ao("Int","FS_OPERATION_FAILURE",1..toString()),ao("Set<fs_OperationId>","_FS_OPERATIONS_IDS","new Set()"),ao("Map<fs_OperationId, fs_OperationCallback>","_FS_OPERATIONS_CALLBACKS","new Map()"),ao("Map<fs_OperationId, fs_OperationSoundCallback>","_FS_OPERATIONS_SOUND_CALLBACKS","new Map()"),ro("Int","_FS_OPERATION_COUNTER","1"),io("fs_SoundInfo",[ro("Int","channelCount"),ro("Int","sampleRate"),ro("Int","bitDepth"),ro("string","encodingFormat"),ro("string","endianness"),ro("string","extraOptions")]),so("fs_soundInfoToMessage",[ro("fs_SoundInfo","soundInfo")],"Message")(wl||(wl=r(["\n                ","\n                msg_writeFloatToken(info, 0, toFloat(soundInfo.channelCount))\n                msg_writeFloatToken(info, 1, toFloat(soundInfo.sampleRate))\n                msg_writeFloatToken(info, 2, toFloat(soundInfo.bitDepth))\n                msg_writeStringToken(info, 3, soundInfo.encodingFormat)\n                msg_writeStringToken(info, 4, soundInfo.endianness)\n                msg_writeStringToken(info, 5, soundInfo.extraOptions)\n                return info\n            "])),ao("Message","info","msg_create([\n                    MSG_FLOAT_TOKEN,\n                    MSG_FLOAT_TOKEN,\n                    MSG_FLOAT_TOKEN,\n                    MSG_STRING_TOKEN,\n                    soundInfo.encodingFormat.length,\n                    MSG_STRING_TOKEN,\n                    soundInfo.endianness.length,\n                    MSG_STRING_TOKEN,\n                    soundInfo.extraOptions.length\n                ])")),so("_fs_assertOperationExists",[ro("fs_OperationId","id"),ro("string","operationName")],"void")(_l||(_l=r(["\n                if (!_FS_OPERATIONS_IDS.has(id)) {\n                    throw new Error(operationName + ' operation unknown : ' + id.toString())\n                }\n            "]))),so("_fs_createOperationId",[],"fs_OperationId")(kl||(kl=r(["\n                ","\n                _FS_OPERATIONS_IDS.add(id)\n                return id\n            "])),ao("fs_OperationId","id","_FS_OPERATION_COUNTER++"))])},dependencies:[Sl]},Bl={codeGenerator:()=>lo([so("fs_readSoundFile",[ro("fs_Url","url"),ro("fs_SoundInfo","soundInfo"),ro("fs_OperationSoundCallback","callback")],"fs_OperationId")(Il||(Il=r(["\n            ","\n            _FS_OPERATIONS_SOUND_CALLBACKS.set(id, callback)\n            i_fs_readSoundFile(id, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        "])),ao("fs_OperationId","id","_fs_createOperationId()")),so("x_fs_onReadSoundFileResponse",[ro("fs_OperationId","id"),ro("fs_OperationStatus","status"),ro("FloatArray[]","sound")],"void")(Tl||(Tl=r(["\n            _fs_assertOperationExists(id, 'x_fs_onReadSoundFileResponse')\n            _FS_OPERATIONS_IDS.delete(id)\n            // Finish cleaning before calling the callback in case it would throw an error.\n            const callback = _FS_OPERATIONS_SOUND_CALLBACKS.get(id)\n            callback(id, status, sound)\n            _FS_OPERATIONS_SOUND_CALLBACKS.delete(id)\n        "])))]),exports:[{name:"x_fs_onReadSoundFileResponse"}],imports:[so("i_fs_readSoundFile",[ro("fs_OperationId","id"),ro("fs_Url","url"),ro("Message","info")],"void")(xl||(xl=r([""])))],dependencies:[zl]},Vl={codeGenerator:()=>lo([so("fs_writeSoundFile",[ro("FloatArray[]","sound"),ro("fs_Url","url"),ro("fs_SoundInfo","soundInfo"),ro("fs_OperationCallback","callback")],"fs_OperationId")(Ol||(Ol=r(["\n            ","\n            _FS_OPERATIONS_CALLBACKS.set(id, callback)\n            i_fs_writeSoundFile(id, sound, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        "])),ao("fs_OperationId","id","_fs_createOperationId()")),so("x_fs_onWriteSoundFileResponse",[ro("fs_OperationId","id"),ro("fs_OperationStatus","status")],"void")(Cl||(Cl=r(["\n            _fs_assertOperationExists(id, 'x_fs_onWriteSoundFileResponse')\n            _FS_OPERATIONS_IDS.delete(id)\n            // Finish cleaning before calling the callback in case it would throw an error.\n            ","\n            callback(id, status)\n            _FS_OPERATIONS_CALLBACKS.delete(id)\n        "])),ao("fs_OperationCallback","callback","_FS_OPERATIONS_CALLBACKS.get(id)"))]),exports:[{name:"x_fs_onWriteSoundFileResponse"}],imports:[so("i_fs_writeSoundFile",[ro("fs_OperationId","id"),ro("FloatArray[]","sound"),ro("fs_Url","url"),ro("Message","info")],"void")(Ml||(Ml=r([""])))],dependencies:[zl]},Gl={codeGenerator:()=>lo([ao("Map<fs_OperationId, Array<buf_SoundBuffer>>","_FS_SOUND_STREAM_BUFFERS","new Map()"),ao("Int","_FS_SOUND_BUFFER_LENGTH","20 * 44100"),so("fs_closeSoundStream",[ro("fs_OperationId","id"),ro("fs_OperationStatus","status")],"void")(El||(El=r(["\n            if (!_FS_OPERATIONS_IDS.has(id)) {\n                return\n            }\n            _FS_OPERATIONS_IDS.delete(id)\n            _FS_OPERATIONS_CALLBACKS.get(id)(id, status)\n            _FS_OPERATIONS_CALLBACKS.delete(id)\n            // Delete this last, to give the callback \n            // a chance to save a reference to the buffer\n            // If write stream, there won't be a buffer\n            if (_FS_SOUND_STREAM_BUFFERS.has(id)) {\n                _FS_SOUND_STREAM_BUFFERS.delete(id)\n            }\n            i_fs_closeSoundStream(id, status)\n        "]))),so("x_fs_onCloseSoundStream",[ro("fs_OperationId","id"),ro("fs_OperationStatus","status")],"void")(Al||(Al=r(["\n            fs_closeSoundStream(id, status)\n        "])))]),exports:[{name:"x_fs_onCloseSoundStream"}],imports:[so("i_fs_closeSoundStream",[ro("fs_OperationId","id"),ro("fs_OperationStatus","status")],"void")(Fl||(Fl=r([""])))],dependencies:[Di,zl]},Wl={codeGenerator:()=>lo([so("fs_openSoundReadStream",[ro("fs_Url","url"),ro("fs_SoundInfo","soundInfo"),ro("fs_OperationCallback","callback")],"fs_OperationId")(Pl||(Pl=r(["\n            ","\n            ","\n            for (","; channel < soundInfo.channelCount; channel++) {\n                buffers.push(buf_create(_FS_SOUND_BUFFER_LENGTH))\n            }\n            _FS_SOUND_STREAM_BUFFERS.set(id, buffers)\n            _FS_OPERATIONS_CALLBACKS.set(id, callback)\n            i_fs_openSoundReadStream(id, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        "])),ao("fs_OperationId","id","_fs_createOperationId()"),ao("Array<buf_SoundBuffer>","buffers","[]"),ro("Int","channel","0")),so("x_fs_onSoundStreamData",[ro("fs_OperationId","id"),ro("FloatArray[]","block")],"Int")(Nl||(Nl=r(["\n            _fs_assertOperationExists(id, 'x_fs_onSoundStreamData')\n            const buffers = _FS_SOUND_STREAM_BUFFERS.get(id)\n            for (","; i < buffers.length; i++) {\n                buf_pushBlock(buffers[i], block[i])\n            }\n            return buffers[0].pullAvailableLength\n        "])),ro("Int","i","0"))]),exports:[{name:"x_fs_onSoundStreamData"}],imports:[so("i_fs_openSoundReadStream",[ro("fs_OperationId","id"),ro("fs_Url","url"),ro("Message","info")],"void")(Rl||(Rl=r([""])))],dependencies:[Gl,Ui]},$l={codeGenerator:()=>lo([so("fs_openSoundWriteStream",[ro("fs_Url","url"),ro("fs_SoundInfo","soundInfo"),ro("fs_OperationCallback","callback")],"fs_OperationId")(Ll||(Ll=r(["\n            const id = _fs_createOperationId()\n            _FS_SOUND_STREAM_BUFFERS.set(id, [])\n            _FS_OPERATIONS_CALLBACKS.set(id, callback)\n            i_fs_openSoundWriteStream(id, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        "]))),so("fs_sendSoundStreamData",[ro("fs_OperationId","id"),ro("FloatArray[]","block")],"void")(Dl||(Dl=r(["\n            _fs_assertOperationExists(id, 'fs_sendSoundStreamData')\n            i_fs_sendSoundStreamData(id, block)\n        "])))]),imports:[so("i_fs_openSoundWriteStream",[ro("fs_OperationId","id"),ro("fs_Url","url"),ro("Message","info")],"void")(Ul||(Ul=r([""]))),so("i_fs_sendSoundStreamData",[ro("fs_OperationId","id"),ro("FloatArray[]","block")],"void")(jl||(jl=r([""])))],dependencies:[Gl]};const Hl=(e,n)=>{const t=Ql(e);return lo(n.map((e=>to(e)?e.codeGenerator(t):e(t))).reduce(((e,n)=>e.every((e=>!Zl(e,n)))?[...e,n]:e),[]))},Kl=()=>[Ei,fi,Sl],ql=(e,n)=>n.filter(to).filter((e=>e.exports)).reduce(((n,t)=>[...n,...t.exports.filter((t=>(!t.targets||t.targets.includes(e))&&n.every((e=>t.name!==e.name))))]),[]),Yl=e=>e.filter(to).filter((e=>e.imports)).reduce(((e,n)=>[...e,...n.imports.filter((n=>e.every((e=>n.name!==e.name))))]),[]),Xl=e=>e.flatMap((e=>to(e)&&e.dependencies?[...Xl(e.dependencies),e]:[e])),Jl=(e,n,t)=>Gs(n,t).reduce(((n,t)=>[...n,...eo(e,t.type).dependencies]),[]),Ql=e=>{let{settings:n,target:t,variableNamesIndex:r}=e;return{target:t,audioSettings:n.audio,globs:r.globs}},Zl=(e,n)=>JSON.stringify(e)===JSON.stringify(n),eu=e=>"(".concat(e.args.map((e=>"".concat(e.name,": ").concat(e.type))).join(", "),") => ").concat(e.returnType);var nu,tu,ru,au;const su=oo([ro("Message","m")],"void")(nu||(nu=r([""]))),ou=(e,n)=>{const{precompilation:t,variableNamesIndex:r,nodeImplementations:a}=e,s=t.nodes[n.id],{globs:o}=r,{state:i,messageSenders:l}=s.generationContext,u=eo(a,n.type),c=jo(zo(n,"messageReceivers"),u.messageReceivers?u.messageReceivers({globs:o,state:i,snds:l,node:n,compilation:e}):{});Object.keys(s.messageReceivers).forEach((e=>{const t=c[e];((e,n)=>{if("object"!==typeof e||"Func"!==e.astType)throw new Error("Expected an ast Func, got : ".concat(e));if(e.args.length!==n.args.length||e.args.some(((e,t)=>e.type!==n.args[t].type))||e.returnType!==n.returnType)throw new Error("Func should be have signature ".concat(eu(n))+" got instead ".concat(eu(e)))})(t,su);const a=s.messageReceivers[e];a.name=r.nodes[n.id].messageReceivers[e],a.args=t.args,a.body=t.body,a.returnType=t.returnType}))},iu=(e,n)=>{const{nodeImplementations:t}=e,r=lu(n);return!!eo(t,n.type).inlineLoop&&1===r.length},lu=e=>Object.values(e.sinks)[0]||[],uu=(e,n,t)=>{const{settings:{io:r}}=e,a=du(r.messageReceivers,n.id);return Vs(n,t).length+ +a.includes(t)},cu=(e,n,t)=>{const{settings:{io:r}}=e,a=du(r.messageSenders,n.id);return Bs(n,t).length+ +a.includes(t)},du=(e,n)=>e[n]&&e[n].portletIds||[];var fu,pu,gu=e=>{const{graph:n,precompilation:t}=e,a=Gs(n,t.traversals.all);(e=>{let{graph:n,variableNamesIndex:t,settings:{io:r}}=e;["messageReceivers","messageSenders"].forEach((e=>{const a=("messageReceivers"===e?r.messageReceivers:r.messageSenders)||{};Object.entries(a).forEach((r=>{let[a,s]=r;const o=Us(n,a);t.io[e][a]=jo(zo(o,e),{}),s.portletIds.forEach((n=>{t.io[e][a][n]="io".concat("messageReceivers"===e?"Rcv":"Snd","_").concat(a,"_").concat(n)}))}))}))})(e),(e=>{const{graph:n,nodeImplementations:t,precompilation:r,target:a}=e,s=Xl([...Kl(),...Jl(t,n,r.traversals.all)]);r.dependencies.ast=Hl(e,s),r.dependencies.exports=ql(a,s),r.dependencies.imports=Yl(s)})(e),a.forEach((n=>{Object.values(n.inlets).forEach((t=>{"signal"===t.type?((e,n,t)=>{const{precompilation:r,variableNamesIndex:a}=e;0===Vs(n,t).length&&(r.nodes[n.id].generationContext.signalIns[t]=a.globs.nullSignal)})(e,n,t.id):"message"===t.type&&((e,n,t)=>{const a=e.precompilation.nodes[n.id];if(uu(e,n,t)>=1){const s=Go(e,"messageReceivers",n.id,t);a.generationContext.messageReceivers[t]=s,a.messageReceivers[t]=so(s,[ro("Message","m")],"void")(tu||(tu=r(['throw new Error("This placeholder should have been replaced during compilation")'])))}})(e,n,t.id)}))})),a.forEach((n=>{Object.values(n.outlets).forEach((t=>{"signal"===t.type?((e,n,t)=>{const{precompilation:r}=e,a=Bs(n,t);if(!iu(e,n)){const s=Go(e,"signalOuts",n.id,t);r.nodes[n.id].signalOuts[t]=s,r.nodes[n.id].generationContext.signalOuts[t]=s,a.forEach((e=>{let{portletId:n,nodeId:t}=e;r.nodes[t].generationContext.signalIns[n]=s}))}})(e,n,t.id):"message"===t.type&&((e,n,t)=>{const r=Bs(n,t),{variableNamesIndex:a,precompilation:s,settings:{io:o}}=e,i=du(o.messageSenders,n.id),l=s.nodes[n.id],u=cu(e,n,t);if(u>1){const s=i.includes(t),o=Go(e,"messageSenders",n.id,t);l.generationContext.messageSenders[t]=o,l.messageSenders[t]={messageSenderName:o,messageReceiverNames:[...r.map((e=>{let{nodeId:n,portletId:t}=e;return a.nodes[n].messageReceivers[t]})),...s?[a.io.messageSenders[n.id][t]]:[]]}}else 0===u?l.generationContext.messageSenders[t]=e.variableNamesIndex.globs.nullMessageReceiver:1!==r.length||i.includes(t)?0===r.length&&i.includes(t)&&(l.generationContext.messageSenders[t]=a.io.messageSenders[n.id][t]):l.generationContext.messageSenders[t]=a.nodes[r[0].nodeId].messageReceivers[r[0].portletId]})(e,n,t.id)}))})),a.forEach((n=>{((e,n)=>{const{precompilation:t,nodeImplementations:a,variableNamesIndex:s}=e,{globs:o}=s,i=t.nodes[n.id],{state:l,messageSenders:u}=i.generationContext,c=eo(a,n.type);i.initialization=c.initialization?c.initialization({globs:o,state:l,snds:u,node:n,compilation:e}):uo(ru||(ru=r([""])))})(e,n),ou(e,n)}));const s=(e=>{const n=Object.values(e).filter((e=>!!e.isPullingSignal));return Ws(e,n)})(n);Gs(n,s).filter((n=>hu(e,n))).forEach((n=>{const t=((e,n)=>{const{precompilation:t,variableNamesIndex:r,nodeImplementations:a,graph:s,target:o}=e,{globs:i}=r,l=Ws(s,[n],(n=>iu(e,n))),u=l.reduce(((n,r)=>{const{signalIns:u,state:c}=t.nodes[r].generationContext,d=Us(s,r),f=eo(a,d.type),p=Ls(Object.values(d.inlets).map((e=>[e,Vs(d,e.id)])).filter((e=>{let[n,t]=e;return"signal"===n.type&&t.length>0&&l.includes(t[0].nodeId)})),(e=>{let[t,r]=e;const a=r[0];if(!(a.nodeId in n))throw new Error("Unexpected error : inlining failed, missing inlined source ".concat(a.nodeId));return[t.id,n[a.nodeId]]})),g=f.inlineLoop({globs:i,state:c,ins:jo(zo(d,"ins"),{...u,...p}),node:d,compilation:e});return(g.content.length>1||"string"===typeof g.content[0]&&g.content[0].includes(" "))&&(g.content.unshift("("),g.content.push(")")),{...n,[r]:Co(Zs(o),g)}}),{}),c=lu(n)[0];return t.nodes[c.nodeId].generationContext.signalIns[c.portletId]=u[n.id],l})(e,n);t.forEach((e=>{s.splice(s.indexOf(e),1)}))})),Gs(n,s).forEach((n=>{t.traversals.loop.push(n.id),((e,n)=>{const{precompilation:t,nodeImplementations:a,variableNamesIndex:s}=e,o=t.nodes[n.id],{globs:i}=s,{signalOuts:l,signalIns:u,messageSenders:c,state:d}=o.generationContext,f=eo(a,n.type),p={globs:i,node:n,state:d,ins:u,compilation:e};if(f.inlineLoop){const e=Object.keys(n.outlets)[0];o.loop=uo(au||(au=r([""," = ",""])),s.nodes[n.id].signalOuts[e],f.inlineLoop(p))}else{if(!f.loop)throw new Error("No loop to generate for node ".concat(n.type,":").concat(n.id));o.loop=f.loop({...p,outs:l,snds:c})}})(e,n)}))};const mu=(e,n,t)=>({nodes:jo("precompilation",Rs(e,(e=>({generationContext:{messageReceivers:jo(zo(e,"generationContext:messageReceivers"),{}),signalOuts:jo(zo(e,"generationContext:signalOuts"),{}),messageSenders:jo(zo(e,"generationContext:messageSenders"),{}),signalIns:jo(zo(e,"generationContext:signalIns"),{}),state:t.nodes[e.id].state},messageReceivers:jo(zo(e,"messageReceivers"),{}),messageSenders:jo(zo(e,"messageSenders"),{}),signalOuts:jo(zo(e,"signalOuts"),{}),initialization:uo(fu||(fu=r([""]))),loop:uo(pu||(pu=r([""])))})))),dependencies:{imports:[],exports:[],ast:lo([])},traversals:{all:n,loop:[]}}),hu=(e,n)=>{const{graph:t}=e,r=lu(n)[0];if(!r)return!1;const a=Us(t,r.nodeId);return iu(e,n)&&!iu(e,a)};var yu=(e,n,t,a)=>{const s=bu(a),o=((e,n)=>jo("variableNamesIndex",{nodes:jo("nodes",Rs(e,(e=>jo(zo(e),{messageReceivers:jo(zo(e,"messageReceivers"),{}),messageSenders:jo(zo(e,"messageSenders"),{}),signalOuts:jo(zo(e,"signalOuts"),{}),state:"".concat($o(n,e),"_STATE")})))),globs:Vo(),io:{messageReceivers:jo("io:messageReceivers",{}),messageSenders:jo("io:messageSenders",{})}}))(e,s.debug),i=((e,n)=>{const t=Object.values(e).filter((e=>!!e.isPullingSignal)),r=Object.values(e).filter((e=>!!e.isPushingMessages));return Object.keys(n.messageReceivers||{}).forEach((n=>{r.find((e=>e.id===n))||r.push(Us(e,n))})),Array.from(new Set([...Hs(e,r),...Ws(e,t)]))})(e,s.io),l=((e,n)=>Ls(Object.values(e).filter((e=>n.includes(e.id))),(e=>[e.id,{...e,sources:Ys(e.sources,n),sinks:qs(e.sinks,n)}])))(e,i),u={graph:l,nodeImplementations:n,target:t,settings:s,variableNamesIndex:o,precompilation:mu(l,i,o)};let c;if(gu(u),"javascript"===u.target)c=(e=>{const{variableNamesIndex:n,settings:{io:t},precompilation:a}=e,s=e.variableNamesIndex.globs,o=no(e);return Co(Js,uo(Mo||(Mo=r(["\n        ","\n        ","\n        ","\n\n        ","\n\n        ","\n        ","\n\n        ","\n\n        const exports = {\n            metadata: ",",\n            configure: (sampleRate, blockSize) => {\n                exports.metadata.audioSettings.sampleRate = sampleRate\n                exports.metadata.audioSettings.blockSize = blockSize\n                "," = sampleRate\n                "," = blockSize\n                _commons_emitEngineConfigure()\n            },\n            loop: (",", ",") => {\n                ","\n            },\n            io: {\n                messageReceivers: {\n                    ","\n                },\n                messageSenders: {\n                    ","\n                },\n            }\n        }\n\n        ","\n    "])),So(e),a.dependencies.ast,To(e),wo(e),ko(e),Io(e,((e,n,t)=>uo(Eo||(Eo=r(["const "," = (m) => {exports.io.messageSenders['","']['","'].onMessage(m)}"])),e,n,t))),_o(e),JSON.stringify(o),s.sampleRate,s.blockSize,s.input,s.output,xo(e),Object.entries(t.messageReceivers).map((e=>{let[t,a]=e;return uo(Ao||(Ao=r(["",": {\n                            ","\n                        },"])),t,a.portletIds.map((e=>'"'.concat(e,'": ').concat(n.io.messageReceivers[t][e],","))))})),Object.entries(t.messageSenders).map((e=>{let[n,t]=e;return uo(Fo||(Fo=r(["",": {\n                            ","\n                        },"])),n,t.portletIds.map((e=>'"'.concat(e,'": {onMessage: () => undefined},'))))})),Oo(e,(e=>{let{name:n}=e;return uo(Po||(Po=r(["\n                exports."," = () => { throw new Error('import for "," not provided') }\n                const "," = (...args) => exports.","(...args)\n            "])),n,n,n,n)}),(e=>{let{name:n}=e;return uo(No||(No=r(["exports."," = ",""])),n,n)}))))})(u);else{if("assemblyscript"!==u.target)throw new Error("Invalid compilation.target ".concat(u.target));c=(e=>{const{settings:{audio:n,io:t},variableNamesIndex:a,precompilation:s}=e,{channelCount:o}=n,i=e.variableNamesIndex.globs,l=no(e);return Co(Qs,uo(Ro||(Ro=r(["\n        ","\n        ","\n        ","\n\n        ","\n\n        ","\n        ","\n\n        const metadata: string = '","'\n        let ",": FloatArray = createFloatArray(0)\n        let ",": FloatArray = createFloatArray(0)\n\n        ","\n\n        export function configure(sampleRate: Float, blockSize: Int): void {\n            "," = createFloatArray(blockSize * ",")\n            "," = createFloatArray(blockSize * ",")\n            "," = sampleRate\n            "," = blockSize\n            _commons_emitEngineConfigure()\n        }\n\n        export function getInput(): FloatArray { return "," }\n\n        export function getOutput(): FloatArray { return "," }\n\n        export function loop(): void {\n            ","\n        }\n\n        export {\n            metadata,\n            ","\n        }\n\n        ","\n    "])),So(e),s.dependencies.ast,To(e),wo(e),ko(e),Io(e,(e=>uo(Lo||(Lo=r(["export declare function ","(m: Message): void"])),e))),JSON.stringify(l),i.input,i.output,_o(e),i.input,o.in.toString(),i.output,o.out.toString(),i.sampleRate,i.blockSize,i.input,i.output,xo(e),Object.entries(t.messageReceivers).map((e=>{let[n,t]=e;return t.portletIds.map((e=>a.io.messageReceivers[n][e]+","))})),Oo(e,(e=>{let{name:n,args:t,returnType:a}=e;return uo(Do||(Do=r(["export declare function "," (","): ",""])),n,t.map((e=>"".concat(e.name,": ").concat(e.type))).join(","),a)}),(e=>{let{name:n}=e;return uo(Uo||(Uo=r(["export { "," }"])),n)}))))})(u)}return{status:0,code:c}};const bu=e=>{const n=e.arrays||{},t={messageReceivers:(e.io||{}).messageReceivers||{},messageSenders:(e.io||{}).messageSenders||{}},r=e.debug||!1,a=e.audio||{channelCount:{in:2,out:2},bitDepth:64};if(![32,64].includes(a.bitDepth))throw new vu('"bitDepth" can be only 32 or 64');return{audio:a,arrays:n,io:t,debug:r}};class vu extends Error{}const Su="webpd-runtime.js";const wu=e=>{const{artefacts:n}=e;if(!n.javascript&&!n.wasm)throw new Error("Needs at least javascript or wasm to run");const t=n.javascript?"patch.js":"patch.wasm",r={"index.html":'\n<!DOCTYPE html>\n<html lang="en">\n    <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <meta http-equiv="X-UA-Compatible" content="ie=edge">\n        <title>WebPd boilerplate</title>\n        <style>\n            #start {\n                display: none;\n                position: fixed;\n                top: 50%;\n                left: 50%;\n                transform: translate(-50%, -50%);\n            }\n            #loading {\n                width: 100%;\n                height: 100%;\n                position: fixed;\n                top: 50%;\n                transform: translateY(-50%);\n                display: flex;\n                justify-content: center;\n                align-items: center;\n            }\n        </style>\n    </head>\n    <body>\n        <h1>My Web Page</h1>\n        <div>For more info about usage (how to interact with the patch), you can open this HTML file in a code editor.</div>\n        <button id="start"> Start </button>\n        <div id="loading"> Loading ... </div>\n        <script src="'.concat(Su,"\"><\/script>\n        <script>\n            // SUMMARY\n            // 1. WEB PAGE INITIALIZATION\n            // 2. SENDING MESSAGES FROM JAVASCRIPT TO THE PATCH\n            // 3. SENDING MESSAGES FROM THE PATCH TO JAVASCRIPT (coming soon ...)\n\n\n            // ------------- 1. WEB PAGE INITIALIZATION\n            const loadingDiv = document.querySelector('#loading')\n            const startButton = document.querySelector('#start')\n            const audioContext = new AudioContext()\n\n            let patch = null\n            let stream = null\n            let webpdNode = null\n\n            const initApp = async () => {\n                // Register the worklet\n                await WebPdRuntime.initialize(audioContext)\n\n                // Fetch the patch code\n                response = await fetch('").concat(t,"')\n                patch = await ").concat(n.javascript?"response.text()":"response.arrayBuffer()","\n\n                // Comment this if you don't need audio input\n                stream = await navigator.mediaDevices.getUserMedia({ audio: true })\n\n                // Hide loading and show start button\n                loadingDiv.style.display = 'none'\n                startButton.style.display = 'block'\n            }\n\n            const startApp = async () => {\n                // AudioContext needs to be resumed on click to protects users \n                // from being spammed with autoplay.\n                // See : https://github.com/WebAudio/web-audio-api/issues/345\n                if (audioContext.state === 'suspended') {\n                    audioContext.resume()\n                }\n\n                // Setup web audio graph\n                webpdNode = await WebPdRuntime.run(\n                    audioContext, \n                    patch, \n                    WebPdRuntime.defaultSettingsForRun('./").concat(t,"'),\n                )\n                webpdNode.connect(audioContext.destination)\n\n                // Comment this if you don't need audio input\n                const sourceNode = audioContext.createMediaStreamSource(stream)\n                sourceNode.connect(webpdNode)\n\n                // Hide the start button\n                startButton.style.display = 'none'\n            }\n\n            startButton.onclick = startApp\n\n            initApp().\n                then(() => {\n                    console.log('App initialized')\n                })\n\n            \n            // ------------- 2. SENDING MESSAGES FROM JAVASCRIPT TO THE PATCH\n            // Use the function sendMsgToWebPd to send a message from JavaScript to an object inside your patch.\n            // \n            // Parameters : \n            // - nodeId: the ID of the object you want to send a message to. \n            //          This ID is a string that has been assigned by WebPd at compilation.\n            //          You can find below the list of available IDs with hints to help you \n            //          identify the object you want to interact with.\n            // - portletId : the ID of the object portlet to which the message should be sent. \n            // - message : the message to send. This must be a list of strings and / or numbers.\n            // \n            // Examples :\n            // - sending a message to a bang node of ID 'n_0_1' :\n            //          sendMsgToWebPd('n_0_1', '0', ['bang'])\n            // - sending a message to a number object of ID 'n_0_2' :\n            //          sendMsgToWebPd('n_0_2', '0', [123])\n            // \n            const sendMsgToWebPd = (nodeId, portletId, message) => {\n                webpdNode.port.postMessage({\n                    type: 'io:messageReceiver',\n                    payload: {\n                        nodeId,\n                        portletId,\n                        message,\n                    },\n                })\n            }\n            \n            // Here is an index of objects IDs to which you can send messages, with hints so you can find the right ID.\n            // Note that by default only GUI objects (bangs, sliders, etc ...) are available.").concat(n.dspGraph&&n.dspGraph.io&&Object.keys(n.dspGraph.io.messageReceivers).length?Object.entries(n.dspGraph.io.messageReceivers).map((e=>{let[n,{portletIds:t,metadata:r}]=e;return t.map((e=>{const t=r;return t?"control"===t.group||"control:float"===t.group?'\n            //  - nodeId "'.concat(n,'" portletId "').concat(e,'"\n            //      * type "').concat(t.type,'"\n            //      * position ').concat(JSON.stringify(t.position)).concat(t.label?'\n            //      * label "'.concat(t.label,'"'):"","\n            "):"send"===t.group?'\n            //  - nodeId "'.concat(n,'" portletId "').concat(e,'"\n            //      * type "send"\n            //      * send "').concat(t.name,'"\n            '):"":""}))})).join(""):"\n            // EMPTY (did you place a GUI object in your patch ?)\n","\n\n\n            // ------------- 3. SENDING MESSAGES FROM THE PATCH TO JAVASCRIPT\n            // Coming soon ... \n\n        <\/script>\n    </body>\n</html>")};return n.javascript?r[t]=n.javascript:r[t]=n.wasm,r},_u=e=>{const n=e.patches[e.rootPatchId];return{controls:ku(e,n),comments:Object.values(e.patches[e.rootPatchId].nodes).filter((e=>"text"===e.type)).map((e=>({type:"comment",patch:n,node:e,text:e.args[0].toString()})))}},ku=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===t&&(t={topLeft:{x:-1/0,y:-1/0},bottomRight:{x:1/0,y:1/0}});const r=[];return Object.values(n.nodes).forEach((a=>{if("pd"===a.type&&"subpatch"===a.nodeClass){const s=e.patches[a.patchId],o=Mu(a.layout);if(!s.layout.graphOnParent)return;const i=Eu(s.layout),l=Tu({x:o.x,y:o.y},{x:i.viewportX,y:i.viewportY}),u={topLeft:l(t.topLeft),bottomRight:l(t.bottomRight)},c={x:i.viewportX,y:i.viewportY},d={topLeft:c,bottomRight:xu(c,{x:i.viewportWidth,y:i.viewportHeight})},f=Ou(u,d);if(null===f)return;const p=ku(e,s,f),g={type:"container",patch:n,node:a,children:p};r.push(g)}else if(a.type in vs&&"control"===a.nodeClass){const e=Mu(a.layout);if(!Cu({x:e.x,y:e.y},t))return;const s={type:"control",patch:n,node:a};r.push(s)}})),r},Iu=(e,n)=>{e.forEach((e=>{"container"===e.type?Iu(e.children,n):"control"===e.type&&n(e)}))},Tu=(e,n)=>{const t=n.x-e.x,r=n.y-e.y;return e=>({x:e.x+t,y:e.y+r})},xu=(e,n)=>({x:e.x+n.x,y:e.y+n.y}),Ou=(e,n)=>{const t={x:Math.max(e.topLeft.x,n.topLeft.x),y:Math.max(e.topLeft.y,n.topLeft.y)},r={x:Math.min(e.bottomRight.x,n.bottomRight.x),y:Math.min(e.bottomRight.y,n.bottomRight.y)};return r.x<=t.x||r.y<=t.y?null:{topLeft:t,bottomRight:r}},Cu=(e,n)=>n.topLeft.x<=e.x&&e.x<=n.bottomRight.x&&n.topLeft.y<=e.y&&e.y<=n.bottomRight.y,Mu=e=>{if(!e)throw new Error("Missing node layout");const n=e.x,t=e.y;if("number"!==typeof n||"number"!==typeof t)throw new Error("Missing node layout attributes");return{x:n,y:t}},Eu=e=>{if(!e)throw new Error("Missing patch layout");const n=e.viewportX,t=e.viewportY,r=e.viewportWidth,a=e.viewportHeight;if("number"!==typeof n||"number"!==typeof t||"number"!==typeof r||"number"!==typeof a)throw new Error("Missing patch layout attributes");return{viewportX:n,viewportY:t,viewportWidth:r,viewportHeight:a}},Au=/\$(\d+)/,Fu=(e,n)=>{const t=e.patches[n];if(!t)throw new Error("Patch ".concat(n," not found"));return t},Pu=(e,n)=>{const t=e.nodes[n];if(!t)throw new Error("Pd node ".concat(n," not found in patch ").concat(e.id));return t},Nu=(e,n)=>{const t=e[n];return t?t.aliasTo?Nu(e,t.aliasTo):{nodeBuilder:t,nodeType:n}:null},Ru=(e,n)=>{const t=parseInt(n.id);if(isNaN(t))throw new Error("Invalid patch id");const r=[t,...n.args],a=new RegExp(Au,"g");let s;for(;s=a.exec(e);){const n=parseInt(s[1],10),t=0<=n&&n<r.length;if(s[0]===e)return t?r[n]:void 0;t&&(e=e.replace(s[0],r[n].toString()))}return e},Lu=(e,n)=>{const t=Ru(n[0],e),r="string"===typeof n[1]?Ru(n[1],e):n[1];return[(void 0===t?"":t).toString(),void 0===r?0:r,n[2]]},Du=(e,n)=>n.map((n=>"string"===typeof n?Ru(n,e):n));const Uu=async(e,n,t,r)=>{const{pd:a,abstractionLoader:s,errors:o,warnings:i}=e;t.nodes={...t.nodes};for(let l of Object.values(t.nodes)){if(o.hasOwnProperty(l.type))continue;if("subpatch"===l.nodeClass){l=t.nodes[l.id]={...l,patchId:Bu(r.patches,l.patchId)},await Uu(e,n,Fu(a,l.patchId),r);continue}if("array"===l.nodeClass){l=t.nodes[l.id]={...l,arrayId:Bu(r.arrays,l.arrayId)};continue}if(null!==Nu(e.nodeBuilders,l.type))continue;const u=await zu(e,l.type,s);if(u.parsingWarnings&&(i[l.type]=u.parsingWarnings),1===u.status){const{status:e,parsingWarnings:n,...t}=u;o[l.type]=t;continue}const[c,d]=Vu(a,u.pd),f=ju(d);l=t.nodes[l.id]={...l,args:Du(n,l.args),nodeClass:"subpatch",patchId:f.id,type:"pd"},f.args=l.args,Object.values(d.arrays).forEach((e=>e.args=Lu(f,e.args))),a.patches={...a.patches,...d.patches},a.arrays={...a.arrays,...d.arrays},await Uu(e,f,f,c)}},ju=e=>{const n=e.patches[e.rootPatchId];if(!n)throw new Error("Could not resolve root patch");return n},zu=async(e,n,t)=>{if(!e.abstractions[n]){const r=await t(n);return 0===r.status&&(e.abstractions[n]=r.pd),r}return{status:0,pd:e.abstractions[n]}},Bu=(e,n)=>{const t=e.get(n);if(void 0===t)throw new Error("Could not resolve ".concat(n));return t},Vu=(e,n)=>{const t={patches:{},arrays:{},rootPatchId:n.rootPatchId},r={patches:new Map,arrays:new Map};let a=Object.keys(e.patches);a=a.length?a:["-1"];let s=Object.keys(e.arrays);s=s.length?s:["-1"];let o=Math.max(...a.map((e=>parseInt(e))))+1,i=Math.max(...s.map((e=>parseInt(e))))+1;return Object.entries(n.patches).forEach((e=>{let[n,a]=e;const s="".concat(o++);r.patches.set(n,s),t.patches[s]={...a,id:s}})),Object.entries(n.arrays).forEach((e=>{let[n,a]=e;const s="".concat(i++);r.arrays.set(n,s),t.arrays[s]={...a,id:s}})),t.rootPatchId=Bu(r.patches,t.rootPatchId),[r,t]},Gu={translateArgs:()=>({}),build:()=>({inlets:{},outlets:{}})},Wu={pd:Gu,inlet:Gu,outlet:Gu,"inlet~":Gu,"outlet~":Gu},$u=e=>{if("number"!==typeof e)throw new Yu("".concat(e," is not a number"));return e},Hu=e=>{if("string"!==typeof e)throw new Yu("".concat(e," is not a string"));return e},Ku=e=>void 0!==e?$u(e):void 0,qu=e=>void 0!==e?Hu(e):void 0;class Yu extends Error{}var Xu;const Ju={translateArgs:e=>({channelCount:$u(e.args[0])}),build:e=>({inlets:Ls(Ns(e.channelCount),(e=>["".concat(e),{type:"signal",id:"".concat(e)}])),outlets:{0:{type:"signal",id:"0"}}})},Qu={inlineLoop:e=>{let{node:n,ins:t}=e;return uo(Xu||(Xu=r(["",""])),Object.keys(n.inlets).map((e=>t[e])).join(" + "))}};var Zu,ec,nc;const tc=e=>oo([ro("Message","m")])(Zu||(Zu=r(["\n        if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n            "," = msg_readFloatToken(m, 0)\n            return\n        }\n    "])),e),rc=(e,n)=>oo([ro("Message","m")])(nc||(nc=r(["\n        if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n            ","(",", msg_readFloatToken(m, 0))\n            return\n        }\n    "])),e,n),ac=(e,n)=>jo(e,{stateClass:"n_State_".concat(e),...Ls(n||[],(n=>[n,"n_".concat(e,"_").concat(n)]))});var sc,oc;const ic={translateArgs:e=>{let{args:n}=e;return{initValue:Ku(n[0])||0}},build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"signal",id:"0"}}})},lc=ac("sig_t"),uc={initialization:e=>{let{node:{args:n},state:t}=e;return uo(sc||(sc=r(["\n            ","\n        "])),ao(lc.stateClass,t,"{\n                currentValue: ".concat(n.initValue,"\n            }")))},inlineLoop:e=>{let{state:n}=e;return uo(oc||(oc=r(["",".currentValue"])),n)},messageReceivers:e=>{let{state:n}=e;return{0:tc("".concat(n,".currentValue"))}},dependencies:[()=>lo([io(lc.stateClass,[ro("Float","currentValue")])])]};var cc;const dc={translateArgs:()=>({}),build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}}})},fc={messageReceivers:e=>{let{snds:n}=e;return{0:oo([ro("Message","m")])(cc||(cc=r(["\n            if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n                ","(m)\n                return\n            } else {\n                ","(m)\n                return\n            }\n        "])),n.$0,n.$1)}}},pc=(e,n)=>{if(e[n.id])throw new Error('Node "'.concat(n.id,'" already exists'));return e[n.id]=n,e[n.id]},gc=(e,n,t)=>{const r=Us(e,t.nodeId),a=Us(e,n.nodeId),s=Vs(r,t.portletId),o=Bs(a,n.portletId),i=zs(a,n.portletId),l=js(r,t.portletId);if(!o.some((e=>{return r=e,(n=t).portletId===r.portletId&&n.nodeId===r.nodeId;var n,r}))){if(!i)throw new Error("Undefined outlet ".concat(n.nodeId,":").concat(n.portletId));if(!l)throw new Error("Undefined inlet ".concat(t.nodeId,":").concat(t.portletId));if(i.type!==l.type)throw new Error("Incompatible portlets types ".concat(n.nodeId," | ").concat(n.portletId," (").concat(i.type,") -> ").concat(t.nodeId," | ").concat(t.portletId," (").concat(l.type,")"));if("signal"===l.type&&s.length)throw new Error("Signal inlets can have only one connection");hc(r.sources,t.portletId).push(n),hc(a.sinks,n.portletId).push(t)}},mc=(e,n,t)=>{const r=Us(e,n),a=Us(e,t);Object.entries(a.sources).forEach((e=>{let[t,r]=e;return a.sources[t]=r.filter((e=>e.nodeId!==n))})),Object.entries(r.sinks).forEach((e=>{let[n,a]=e;return r.sinks[n]=a.filter((e=>e.nodeId!==t))}))},hc=(e,n)=>e[n]=e[n]||[],yc="_mixer~",bc="_routemsg",vc="sig~";var Sc;!function(e){e.PD="n",e.IMPLICIT_NODE="m"}(Sc||(Sc={}));const wc=(e,n)=>"".concat(Sc.PD,"_").concat(e,"_").concat(n),_c=e=>e.toString(10),kc=(e,n)=>(n=n.replaceAll(/[^a-zA-Z0-9_]/g,""),"".concat(Sc.IMPLICIT_NODE,"_").concat(e.nodeId,"_").concat(e.portletId,"_").concat(n));var Ic=async function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:async e=>({status:1,unknownNodeType:e});const r=await(async(e,n,t)=>{const[r,a]=Vu({patches:{},arrays:{},rootPatchId:e.rootPatchId},e),s={pd:a,nodeBuilders:n,abstractions:{},errors:{},warnings:{},abstractionLoader:t},o=ju(s.pd);return Object.values(s.pd.arrays).forEach((e=>e.args=Lu(o,e.args))),await Uu(s,o,o,r),Object.keys(s.errors).length?{status:1,pd:s.pd,errors:s.errors,warnings:s.warnings}:{status:0,pd:s.pd,abstractions:s.abstractions,warnings:s.warnings}})(e,n,t),a=Object.keys(r.warnings);if(1===r.status)return{status:1,abstractionsLoadingErrors:r.errors,abstractionsLoadingWarnings:a?r.warnings:void 0};const{pd:s}=r,o={pd:s,nodeBuilders:n,graph:{}},i=Uc(s);Nc(o,[i],Tc),Oc(o,[i]),Object.values(o.graph).forEach((e=>{Object.keys(Wu).includes(e.type)&&((e,n)=>{const t=e[n];t&&(Object.values(t.sources).forEach((t=>t.slice(0).forEach((t=>mc(e,t.nodeId,n))))),Object.values(t.sinks).forEach((t=>t.slice(0).forEach((t=>mc(e,n,t.nodeId))))),delete e[n])})(o.graph,e.id)}));const l=Object.values(o.pd.arrays).reduce(((e,n)=>(e[n.args[0]]=n.data?new Float32Array(n.data):new Float32Array(n.args[1]),e)),{});return{status:0,graph:o.graph,pd:o.pd,arrays:l,abstractionsLoadingWarnings:a?r.warnings:void 0}};const Tc=(e,n)=>{const t=Rc(n),r=Dc(n);Object.values(t.nodes).forEach((n=>{const a=wc(t.id,n.id);xc(e,r,t,n,a)}))},xc=(e,n,t,r,a)=>{const s=Nu(e.nodeBuilders,r.type);if(null===s)throw new Error("unknown node type ".concat(r.type));const{nodeBuilder:o,nodeType:i}=s;if(!0===o.isNoop)return null;o.skipDollarArgsResolution||(r={...r,args:Du(n,r.args)});const l=o.translateArgs(r,t,e.pd),u=o.build(l);return pc(e.graph,{id:a,type:i,args:l,sources:{},sinks:{},...u})},Oc=(e,n)=>{const{graph:t}=e;let r=[];Nc(e,n,((e,n)=>{Ac(e,n,r)}));const a=Ec(e,r);Object.values(t).forEach((n=>{Object.values(n.inlets).forEach((r=>{const s={nodeId:n.id,portletId:r.id},o=(a[n.id]?a[n.id][r.id]:void 0)||{signalSources:[],messageSources:[]};if("signal"===r.type){const{nodeBuilder:r}=Nu(e.nodeBuilders,n.type),a=r.configureMessageToSignalConnection?r.configureMessageToSignalConnection(s.portletId,n.args):void 0;Mc(t,o.signalSources,o.messageSources,s,a)}else{if(0!==o.signalSources.length)throw new Error("Unexpected signal connection to node id ".concat(s.nodeId,", inlet ").concat(s.portletId));Cc(t,o.messageSources,s)}}))}))},Cc=(e,n,t)=>n.forEach((n=>{gc(e,n,t)})),Mc=(e,n,t,r,a)=>{let s=null;if(1===n.length)gc(e,n[0],r);else if(n.length>1){const t={channelCount:n.length},a=pc(e,{id:kc(r,yc),type:yc,args:t,sources:{},sinks:{},...Ju.build(t)});gc(e,{nodeId:a.id,portletId:"0"},r),n.forEach(((n,t)=>{gc(e,n,{nodeId:a.id,portletId:_c(t)})}))}else{const n={initValue:a?a.initialSignalValue:0};s=pc(e,{id:kc(r,vc),type:vc,args:n,sources:{},sinks:{},...ic.build(n)}),gc(e,{nodeId:s.id,portletId:"0"},r)}if(t.length){const n={},o=pc(e,{id:kc(r,bc),type:bc,args:n,sources:{},sinks:{},...dc.build(n)});let i=!1;s&&(gc(e,{nodeId:o.id,portletId:"0"},{nodeId:s.id,portletId:"0"}),i=!0),a&&void 0!==a.reroutedMessageInletId&&(gc(e,{nodeId:o.id,portletId:"1"},{nodeId:r.nodeId,portletId:a.reroutedMessageInletId}),i=!0),i&&t.forEach((n=>{gc(e,n,{nodeId:o.id,portletId:"0"})}))}},Ec=(e,n)=>{const{graph:t}=e,r={};return n.forEach((e=>{const[a,s]=e,[o,i]=s,l=wc(Rc(o).id,i.nodeId);r[l]=r[l]||{};const u=_c(i.portletId);if(r[l][u])return;let c=[];n.forEach((e=>{const[n,t]=e;Vc(s,t)&&c.push(n)}));const d=[],f=[];c.forEach((e=>{let[n,r]=e;const a=Rc(n),s={nodeId:wc(a.id,r.nodeId),portletId:_c(r.portletId)},o=Us(t,s.nodeId);"signal"===zs(o,s.portletId).type?d.push(s):f.push(s)})),r[l][u]={signalSources:d,messageSources:f}})),r},Ac=(e,n,t)=>{const{graph:r}=e,a=Rc(n);a.connections.filter((e=>{let{source:n,sink:t}=e;const s=wc(a.id,n.nodeId),o=wc(a.id,t.nodeId);return!(!r[s]||!r[o])})).forEach((r=>{let{source:a,sink:s}=r;const o=Fc(e,[n,a]),i=Pc(e,n,s);o.forEach((e=>i.forEach((n=>{t.some((t=>{let[r,a]=t;return Vc(e,r)&&Vc(n,a)}))||t.push([e,n])}))))}))},Fc=(e,n)=>{let[t,r]=n;const{pd:a}=e,s=Rc(t),o=Pu(s,r.nodeId);if("inlet"===o.type||"inlet~"===o.type){const n=Lc(t);if(!n)return[];const r=Bc(n,s.id),a=zc(s.inlets,o.id);return n.connections.filter((e=>{let{sink:n}=e;return n.nodeId===r.id&&n.portletId===a})).flatMap((n=>{let{source:r}=n;return Fc(e,[[...t.slice(0,-1)],r])}))}if("subpatch"===o.nodeClass){const n=Fu(a,o.patchId),s=jc(n.outlets,r.portletId);return n.connections.filter((e=>{let{sink:n}=e;return n.nodeId===s&&0===n.portletId})).flatMap((r=>{let{source:a}=r;return Fc(e,[[...t,n],a])}))}return[[t,r]]},Pc=(e,n,t)=>{const{pd:r}=e,a=Rc(n),s=Pu(a,t.nodeId);if("outlet"===s.type||"outlet~"===s.type){const t=Lc(n);if(!t)return[];const r=Bc(t,a.id),o=zc(a.outlets,s.id);return t.connections.filter((e=>{let{source:n}=e;return n.nodeId===r.id&&n.portletId===o})).flatMap((t=>{let{sink:r}=t;return Pc(e,[...n.slice(0,-1)],r)}))}if("subpatch"===s.nodeClass){const a=Fu(r,s.patchId),o=jc(a.inlets,t.portletId);return a.connections.filter((e=>{let{source:n}=e;return n.nodeId===o&&0===n.portletId})).flatMap((t=>{let{sink:r}=t;return Pc(e,[...n,a],r)}))}return[[n,t]]},Nc=(e,n,t)=>{const r=Rc(n);t(e,n),Object.values(r.nodes).forEach((r=>{if("subpatch"===r.nodeClass){const a=Fu(e.pd,r.patchId);Nc(e,[...n,a],t)}}))},Rc=e=>{const n=e.slice(-1)[0];if(!n)throw new Error("patchPath empty !");return n},Lc=e=>e.length<2?null:e.slice(-2)[0],Dc=e=>{const n=e.slice(0).reverse().find((e=>e.isRoot));if(!n)throw new Error("Could not resolve root patch from path");return n},Uc=e=>{const n=e.patches[e.rootPatchId];if(!n)throw new Error("Could not resolve root patch");return n},jc=(e,n)=>{const t=e[n];if(void 0===t)throw new Error("Portlet ".concat(n," is undefined in patch.outlets/patch.inlets"));return t},zc=(e,n)=>e.findIndex((e=>e===n)),Bc=(e,n)=>{const t=Object.values(e.nodes).find((e=>"subpatch"===e.nodeClass&&e.patchId===n));if(void 0===t)throw new Error("could not find subpatch node with patchId=".concat(n," inside patch ").concat(e.id));return t},Vc=(e,n)=>{let[t,r]=e,[a,s]=n;return Rc(t).id===Rc(a).id&&r.nodeId===s.nodeId&&r.portletId===s.portletId};var Gc,Wc,$c;const Hc="empty",Kc=()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"message",id:"0"}},isPushingMessages:!0}),qc=ac("control",["setReceiveBusName","setSendReceiveFromMessage","defaultMessageHandler"]),Yc=()=>lo([io(qc.stateClass,[ro("Float","minValue"),ro("Float","maxValue"),ro("Float","valueFloat"),ro("Message","value"),ro("string","receiveBusName"),ro("string","sendBusName"),ro("(m: Message) => void","messageReceiver"),ro("(m: Message) => void","messageSender")]),so(qc.setReceiveBusName,[ro(qc.stateClass,"state"),ro("string","busName")],"void")(Gc||(Gc=r(['\n        if (state.receiveBusName !== "','") {\n            msgBusUnsubscribe(state.receiveBusName, state.messageReceiver)\n        }\n        state.receiveBusName = busName\n        if (state.receiveBusName !== "','") {\n            msgBusSubscribe(state.receiveBusName, state.messageReceiver)\n        }\n    '])),Hc,Hc),so(qc.setSendReceiveFromMessage,[ro(qc.stateClass,"state"),ro("Message","m")],"boolean")(Wc||(Wc=r(["\n        if (\n            msg_isMatching(m, [MSG_STRING_TOKEN, MSG_STRING_TOKEN])\n            && msg_readStringToken(m, 0) === 'receive'\n        ) {\n            ","(state, msg_readStringToken(m, 1))\n            return true\n\n        } else if (\n            msg_isMatching(m, [MSG_STRING_TOKEN, MSG_STRING_TOKEN])\n            && msg_readStringToken(m, 0) === 'send'\n        ) {\n            state.sendBusName = msg_readStringToken(m, 1)\n            return true\n        }\n        return false\n    "])),qc.setReceiveBusName),so(qc.defaultMessageHandler,[ro("Message","m")],"void")($c||($c=r([""])))]);var Xc,Jc,Qc,Zc,ed,nd,td;const rd=()=>lo([ao("Map<string, Float>","SIGNAL_BUSES","new Map()"),"SIGNAL_BUSES.set('', 0)",so("addAssignSignalBus",[ro("string","busName"),ro("Float","value")],"Float")(Xc||(Xc=r(["\n            ","\n            SIGNAL_BUSES.set(\n                busName,\n                newValue,\n            )\n            return newValue\n        "])),ao("Float","newValue","SIGNAL_BUSES.get(busName) + value")),so("setSignalBus",[ro("string","busName"),ro("Float","value")],"void")(Jc||(Jc=r(["\n            SIGNAL_BUSES.set(\n                busName,\n                value,\n            )\n        "]))),so("resetSignalBus",[ro("string","busName")],"void")(Qc||(Qc=r(["\n            SIGNAL_BUSES.set(busName, 0)\n        "]))),so("readSignalBus",[ro("string","busName")],"Float")(Zc||(Zc=r(["\n            return SIGNAL_BUSES.get(busName)\n        "])))]),ad={codeGenerator:()=>lo([ao("Map<string, Array<(m: Message) => void>>","MSG_BUSES","new Map()"),so("msgBusPublish",[ro("string","busName"),ro("Message","message")],"void")(ed||(ed=r(["\n            ","\n            ","\n            for (i = 0; i < callbacks.length; i++) {\n                callbacks[i](message)\n            }\n        "])),ro("Int","i","0"),ao("Array<(m: Message) => void>","callbacks","MSG_BUSES.has(busName) ? MSG_BUSES.get(busName): []")),so("msgBusSubscribe",[ro("string","busName"),ro("(m: Message) => void","callback")],"void")(nd||(nd=r(["\n            if (!MSG_BUSES.has(busName)) {\n                MSG_BUSES.set(busName, [])\n            }\n            MSG_BUSES.get(busName).push(callback)\n        "]))),so("msgBusUnsubscribe",[ro("string","busName"),ro("(m: Message) => void","callback")],"void")(td||(td=r(["\n            if (!MSG_BUSES.has(busName)) {\n                return\n            }\n            ","\n            ","\n            if (found !== -1) {\n                callbacks.splice(found, 1)\n            }\n        "])),ao("Array<(m: Message) => void>","callbacks","MSG_BUSES.get(busName)"),ao("Int","found","callbacks.indexOf(callback) !== -1"))]),dependencies:[Sl]};var sd,od,id,ld,ud,cd,dd,fd,pd;const gd={codeGenerator:()=>lo([so("msg_isBang",[ro("Message","message")],"boolean")(sd||(sd=r(["\n            return (\n                msg_isStringToken(message, 0) \n                && msg_readStringToken(message, 0) === 'bang'\n            )\n        "]))),so("msg_bang",[],"Message")(od||(od=r(["\n            ","\n            msg_writeStringToken(message, 0, 'bang')\n            return message\n        "])),ao("Message","message","msg_create([MSG_STRING_TOKEN, 4])")),so("msg_emptyToBang",[ro("Message","message")],"Message")(id||(id=r(["\n            if (msg_getLength(message) === 0) {\n                return msg_bang()\n            } else {\n                return message\n            }\n        "])))]),dependencies:[Sl]},md={codeGenerator:()=>lo([so("msg_copyTemplate",[ro("Message","src"),ro("Int","start"),ro("Int","end")],"MessageTemplate")(ld||(ld=r(["\n            ","\n            for (","; i < end; i++) {\n                ","\n                template.push(tokenType)\n                if (tokenType === MSG_STRING_TOKEN) {\n                    template.push(msg_readStringToken(src, i).length)\n                }\n            }\n            return template\n        "])),ao("MessageTemplate","template","[]"),ro("Int","i","start"),ao("Int","tokenType","msg_getTokenType(src, i)")),so("msg_copyMessage",[ro("Message","src"),ro("Message","dest"),ro("Int","srcStart"),ro("Int","srcEnd"),ro("Int","destStart")],"void")(ud||(ud=r(["\n            ","\n            ","\n            for (i, j; i < srcEnd; i++, j++) {\n                if (msg_getTokenType(src, i) === MSG_STRING_TOKEN) {\n                    msg_writeStringToken(dest, j, msg_readStringToken(src, i))\n                } else {\n                    msg_writeFloatToken(dest, j, msg_readFloatToken(src, i))\n                }\n            }\n        "])),ro("Int","i","srcStart"),ro("Int","j","destStart")),so("msg_slice",[ro("Message","message"),ro("Int","start"),ro("Int","end")],"Message")(cd||(cd=r(["\n            if (msg_getLength(message) <= start) {\n                throw new Error('message empty')\n            }\n            ","\n            ","\n            msg_copyMessage(message, newMessage, start, end, 0)\n            return newMessage\n        "])),ao("MessageTemplate","template","msg_copyTemplate(message, start, end)"),ao("Message","newMessage","msg_create(template)")),so("msg_concat",[ro("Message","message1"),ro("Message","message2")],"Message")(dd||(dd=r(["\n            ","\n            msg_copyMessage(message1, newMessage, 0, msg_getLength(message1), 0)\n            msg_copyMessage(message2, newMessage, 0, msg_getLength(message2), msg_getLength(message1))\n            return newMessage\n        "])),ao("Message","newMessage","msg_create(msg_copyTemplate(message1, 0, msg_getLength(message1)).concat(msg_copyTemplate(message2, 0, msg_getLength(message2))))")),so("msg_shift",[ro("Message","message")],"Message")(fd||(fd=r(["\n            switch (msg_getLength(message)) {\n                case 0:\n                    throw new Error('message empty')\n                case 1:\n                    return msg_create([])\n                default:\n                    return msg_slice(message, 1, msg_getLength(message))\n            }\n        "])))]),dependencies:[Sl]},hd={codeGenerator:()=>lo([so("msg_isAction",[ro("Message","message"),ro("string","action")],"boolean")(pd||(pd=r(["\n            return msg_isMatching(message, [MSG_STRING_TOKEN])\n                && msg_readStringToken(message, 0) === action\n        "])))]),dependencies:[Sl]};var yd,bd,vd,Sd,wd;const _d={translateArgs:e=>{let{args:[n,t,r,a,s,o]}=e;return{minValue:$u(n),maxValue:$u(t),sendBusName:qu(o)||Hc,receiveBusName:qu(s)||Hc,initValue:1===r?$u(a):0,outputOnLoad:!!r}},build:Kc},kd={translateArgs:e=>{let{args:[n,t,r,a,s]}=e;return{minValue:0,maxValue:$u(n),sendBusName:qu(s)||Hc,receiveBusName:qu(a)||Hc,initValue:1===t?$u(r):0,outputOnLoad:!!t}},build:Kc},Id=e=>{let{prepareStoreValue:n,prepareStoreValueBang:t,name:a}=e;const s=ac(a,["receiveMessage"]);return{initialization:e=>{let{state:n,snds:t,node:{args:a}}=e;return uo(yd||(yd=r(["\n                ","\n    \n                commons_waitEngineConfigure(() => {\n                    ",".messageReceiver = ","\n                    ",".messageSender = ","\n                    ","(",', "','")\n                })\n    \n                ',"\n            "])),ao(qc.stateClass,n,uo(bd||(bd=r(["{\n                    minValue: ",",\n                    maxValue: ",",\n                    valueFloat: ",',\n                    value: msg_create([]),\n                    receiveBusName: "','",\n                    sendBusName: "','",\n                    messageReceiver: ',",\n                    messageSender: ",",\n                }"])),a.minValue,a.maxValue,a.initValue,a.receiveBusName,a.sendBusName,qc.defaultMessageHandler,qc.defaultMessageHandler)),n,oo([ro("Message","m")])(vd||(vd=r(["\n                        ","(",", m)\n                    "])),s.receiveMessage,n),n,t.$0,qc.setReceiveBusName,n,a.receiveBusName,a.outputOnLoad?"commons_waitFrame(0, () => ".concat(t.$0,"(msg_floats([").concat(n,".valueFloat])))"):null)},messageReceivers:e=>{let{state:n}=e;return{0:oo([ro("Message","m")])(Sd||(Sd=r(["\n                ","(",", m)\n                return\n            "])),s.receiveMessage,n)}},dependencies:[gd,ad,gi,mi,Yc,()=>lo([so(s.receiveMessage,[ro(qc.stateClass,"state"),ro("Message","m")],"void")(wd||(wd=r(["\n                    if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n                        ","\n                        ",'\n                        state.messageSender(outMessage)\n                        if (state.sendBusName !== "','") {\n                            msgBusPublish(state.sendBusName, outMessage)\n                        }\n                        return\n        \n                    } else if (msg_isBang(m)) {\n                        ',"\n                        ",'\n                        state.messageSender(outMessage)\n                        if (state.sendBusName !== "',"\") {\n                            msgBusPublish(state.sendBusName, outMessage)\n                        }\n                        return\n        \n                    } else if (\n                        msg_isMatching(m, [MSG_STRING_TOKEN, MSG_FLOAT_TOKEN]) \n                        && msg_readStringToken(m, 0) === 'set'\n                    ) {\n                        ","\n                        return\n                    \n                    } else if (","(state, m) === true) {\n                        return\n                    }\n                "])),n?"state.valueFloat = ".concat(n("msg_readFloatToken(m, 0)")):"state.valueFloat = msg_readFloatToken(m, 0)",ao("Message","outMessage","msg_floats([state.valueFloat])"),Hc,t?"state.valueFloat = ".concat(t("state.valueFloat")):null,ao("Message","outMessage","msg_floats([state.valueFloat])"),Hc,n?"state.valueFloat = ".concat(n("msg_readFloatToken(m, 1)")):"state.valueFloat = msg_readFloatToken(m, 1)",qc.setSendReceiveFromMessage)])]}},Td={tgl:Id({name:"tgl",prepareStoreValueBang:e=>"".concat(e," === 0 ? state.maxValue: 0")}),nbx:Id({name:"nbx",prepareStoreValue:e=>"Math.min(Math.max(".concat(e,",state.minValue),state.maxValue)")}),hsl:Id({name:"sl"}),hradio:Id({name:"radio"})};Td.vsl=Td.hsl,Td.vradio=Td.hradio;const xd={tgl:kd,nbx:_d,hsl:_d,vsl:_d,hradio:kd,vradio:kd},Od=[...Object.keys(xd),"floatatom"],Cd=(e,n)=>{const t=e.patches[e.rootPatchId],r={};return Object.values(t.nodes).forEach((e=>{const a=wc(t.id,e.id),s=n[a];if("send"===e.type&&s){if(!r[a]){const n=e.layout||{},t={group:"send",name:s.args.busName,position:void 0!==n.x&&void 0!==n.y?[n.x,n.y]:void 0};r[a]={portletIds:[],metadata:t}}r[a].portletIds.push("0")}})),r},Md=(e,n)=>{const t={};return Iu(e,(e=>{const r=wc(e.patch.id,e.node.id);if(!t[r]){const a=n[r];if(!a)return;const s=e.node.layout||{};let o={group:"control",type:e.node.type,label:s.label,position:void 0!==s.x&&void 0!==s.y?[s.x,s.y]:void 0};Od.includes(e.node.type)&&(o={...o,group:"control:float",initValue:a.args.initValue,minValue:a.args.minValue,maxValue:a.args.maxValue}),t[r]={portletIds:[],metadata:o}}t[r].portletIds.push("0")})),t},Ed=e=>64===e?Float64Array:Float32Array,Ad=(e,n)=>new Proxy({},{get:(t,r)=>{if(n.hasOwnProperty(r)){const t=String(r),a=n[t];switch(a.type){case"raw":if(r in e)return e[t];throw new Error("Key ".concat(String(t)," doesn't exist in raw module"));case"proxy":case"callback":return a.value}}},set:(e,t,r)=>{if(!n.hasOwnProperty(String(t)))throw new Error("Key ".concat(String(t)," is not defined in bindings"));{const e=String(t),a=n[e];if("callback"!==a.type)throw new Error("Binding key ".concat(String(e)," is read-only"));a.value=r}return!0}}),Fd=(e,n)=>{if(!n)return null;const t=(n>>>=0)+new Uint32Array(e.memory.buffer)[n-4>>>2]>>>1,r=new Uint16Array(e.memory.buffer);let a=n>>>1,s="";for(;t-a>1024;)s+=String.fromCharCode(...r.subarray(a,a+=1024));return s+String.fromCharCode(...r.subarray(a,t))},Pd=(e,n)=>{if(null==n)return 0;const t=n.length,r=e.__new(t<<1,1)>>>0,a=new Uint16Array(e.memory.buffer);for(let s=0;s<t;++s)a[(r>>>1)+s]=n.charCodeAt(s);return r},Nd=(e,n,t)=>{if(!t)return null;const r=new Uint32Array(e.memory.buffer);return new n(e.memory.buffer,r[t+4>>>2],r[t+8>>>2]/n.BYTES_PER_ELEMENT)},Rd=(e,n,t)=>{const r=Ed(n),a=e.createFloatArray(t.length),s=Nd(e,r,a);return s.set(t),{array:s,arrayPointer:a}},Ld=(e,n,t)=>{const r=e.x_core_createListOfArrays();return t.forEach((t=>{const{arrayPointer:a}=Rd(e,n,t);e.x_core_pushToListOfArrays(r,a)})),r},Dd=(e,n,t)=>{const r=e.x_core_getListOfArraysLength(t),a=[],s=Ed(n);for(let o=0;o<r;o++){const n=e.x_core_getListOfArraysElem(t,o);a.push(Nd(e,s,n))}return a},Ud=(e,n)=>{const t=e.x_msg_getTokenTypes(n),r=Nd(e,Int32Array,t),a=[];return r.forEach(((t,r)=>{if(t===e.MSG_FLOAT_TOKEN.valueOf())a.push(e.msg_readFloatToken(n,r));else if(t===e.MSG_STRING_TOKEN.valueOf()){const t=e.msg_readStringToken(n,r);a.push(Fd(e,t))}})),a},jd=async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const t=await WebAssembly.instantiate(e,{env:{abort:(e,n,t,a)=>{const s=Fd(r,e);(()=>{throw Error("".concat(s," at ").concat(t,":").concat(a))})()},seed:()=>Date.now()*Math.random(),"console.log":e=>{console.log(Fd(r,e))}},...n}),r=t.instance.exports;return t.instance},zd=(e,n)=>{n.wasmOutput=Nd(e,n.arrayType,e.getOutput()),n.wasmInput=Nd(e,n.arrayType,e.getInput())},Bd=(e,n)=>({configure:{type:"proxy",value:(t,r)=>{n.metadata.audioSettings.blockSize=r,n.metadata.audioSettings.sampleRate=t,n.blockSize=r,e.configure(t,r),zd(e,n)}},loop:{type:"proxy",value:(t,r)=>{for(let e=0;e<t.length;e++)n.wasmInput.set(t[e],e*n.blockSize);zd(e,n),e.loop(),zd(e,n);for(let e=0;e<r.length;e++)r[e].set(n.wasmOutput.subarray(n.blockSize*e,n.blockSize*(e+1)))}}}),Vd=(e,n)=>Rs(n.metadata.compilation.io.messageReceivers,((t,r)=>({type:"proxy",value:Ls(t.portletIds,(t=>[t,a=>{const s=((e,n)=>{const t=n.reduce(((n,t)=>{if("number"===typeof t)n.push(e.MSG_FLOAT_TOKEN.valueOf());else{if("string"!==typeof t)throw new Error("invalid message value ".concat(t));n.push(e.MSG_STRING_TOKEN.valueOf()),n.push(t.length)}return n}),[]),r=e.x_msg_createTemplate(t.length);Nd(e,Int32Array,r).set(t);const a=e.x_msg_create(r);return n.forEach(((n,t)=>{if("number"===typeof n)e.msg_writeFloatToken(a,t,n);else if("string"===typeof n){const r=Pd(e,n);e.msg_writeStringToken(a,t,r)}})),a})(e,a);e[n.metadata.compilation.variableNamesIndex.io.messageReceivers[r][t]](s)}]))}))),Gd=(e,n)=>Rs(n.metadata.compilation.io.messageSenders,(e=>({type:"proxy",value:Ls(e.portletIds,(e=>[e,{onMessage:()=>{}}]))}))),Wd=(e,n)=>{const t={},{variableNamesIndex:r}=n.compilation;return Object.entries(n.compilation.io.messageSenders).forEach((n=>{let[a,s]=n;s.portletIds.forEach((n=>{const s=r.io.messageSenders[a][n];t[s]=t=>{const r=Ud(e.rawModule,t);e.modules.io.messageSenders[a][n].onMessage(r)}}))})),t},$d=async e=>{const n={};WebAssembly.Module.imports(new WebAssembly.Module(e)).filter((e=>"input"===e.module&&"function"===e.kind)).forEach((e=>n[e.name]=()=>{}));const t=(await jd(e,{input:n})).exports,r=t.metadata.valueOf(),a=Fd(t,r);return JSON.parse(a)},Hd=e=>({i_fs_readSoundFile:(n,t,r)=>{const a=Fd(e.rawModule,t),s=Ud(e.rawModule,r);e.modules.fs.onReadSoundFile(n,a,s)},i_fs_writeSoundFile:(n,t,r,a)=>{const s=Dd(e.rawModule,e.engineData.bitDepth,t),o=Fd(e.rawModule,r),i=Ud(e.rawModule,a);e.modules.fs.onWriteSoundFile(n,s,o,i)},i_fs_openSoundReadStream:(n,t,r)=>{const a=Fd(e.rawModule,t),s=Ud(e.rawModule,r);zd(e.rawModule,e.engineData),e.modules.fs.onOpenSoundReadStream(n,a,s)},i_fs_openSoundWriteStream:(n,t,r)=>{const a=Fd(e.rawModule,t),s=Ud(e.rawModule,r);e.modules.fs.onOpenSoundWriteStream(n,a,s)},i_fs_sendSoundStreamData:(n,t)=>{const r=Dd(e.rawModule,e.engineData.bitDepth,t);e.modules.fs.onSoundStreamData(n,r)},i_fs_closeSoundStream:function(){return e.modules.fs.onCloseSoundStream(...arguments)}}),Kd=async e=>{const n=await $d(e),t={modules:{}},r={...Hd(t),...Wd(t,n)},a=n.audioSettings.bitDepth,s=Ed(a),o={metadata:n,wasmOutput:new s(0),wasmInput:new s(0),arrayType:s,bitDepth:a,blockSize:0};return{rawModule:(await jd(e,{input:r})).exports,engineData:o,forwardReferences:t}},qd=async(e,n,t)=>{const r=Ad(e,((e,n)=>({getArray:{type:"proxy",value:t=>{const r=Pd(e,t),a=e.commons_getArray(r);return Nd(e,n.arrayType,a)}},setArray:{type:"proxy",value:(t,r)=>{const a=Pd(e,t),{arrayPointer:s}=Rd(e,n.bitDepth,r);e.commons_setArray(a,s),zd(e,n)}}}))(e,n)),a=Ad(e,((e,n)=>({sendReadSoundFileResponse:{type:"proxy",value:(t,r,a)=>{let s=0;a&&(s=Ld(e,n.bitDepth,a)),e.x_fs_onReadSoundFileResponse(t,r,s),zd(e,n)}},sendWriteSoundFileResponse:{type:"proxy",value:e.x_fs_onWriteSoundFileResponse},sendSoundStreamData:{type:"proxy",value:(t,r)=>{const a=Ld(e,n.bitDepth,r),s=e.x_fs_onSoundStreamData(t,a);return zd(e,n),s}},closeSoundStream:{type:"proxy",value:e.x_fs_onCloseSoundStream},onReadSoundFile:{type:"callback",value:()=>{}},onWriteSoundFile:{type:"callback",value:()=>{}},onOpenSoundReadStream:{type:"callback",value:()=>{}},onOpenSoundWriteStream:{type:"callback",value:()=>{}},onSoundStreamData:{type:"callback",value:()=>{}},onCloseSoundStream:{type:"callback",value:()=>{}}}))(e,n)),s={messageReceivers:Ad(e,Vd(e,n)),messageSenders:Ad(e,Gd(0,n))};return t.modules.fs=a,t.modules.io=s,t.engineData=n,t.rawModule=e,{...Bd(e,n),metadata:{type:"proxy",value:n.metadata},commons:{type:"proxy",value:r},fs:{type:"proxy",value:a},io:{type:"proxy",value:s}}},Yd=e=>{const n=(e=>new Function("\n        ".concat(e,"\n        return exports\n    "))())(e);return Ad(n,(e=>({fs:{type:"proxy",value:Xd(e)},metadata:{type:"raw"},configure:{type:"raw"},loop:{type:"raw"},io:{type:"raw"},commons:{type:"proxy",value:Jd(e,e.metadata.audioSettings.bitDepth)}}))(n))},Xd=e=>{const n=Ad(e,{onReadSoundFile:{type:"callback",value:()=>{}},onWriteSoundFile:{type:"callback",value:()=>{}},onOpenSoundReadStream:{type:"callback",value:()=>{}},onOpenSoundWriteStream:{type:"callback",value:()=>{}},onSoundStreamData:{type:"callback",value:()=>{}},onCloseSoundStream:{type:"callback",value:()=>{}},sendReadSoundFileResponse:{type:"proxy",value:e.x_fs_onReadSoundFileResponse},sendWriteSoundFileResponse:{type:"proxy",value:e.x_fs_onWriteSoundFileResponse},sendSoundStreamData:{type:"proxy",value:e.x_fs_onSoundStreamData},closeSoundStream:{type:"proxy",value:e.x_fs_onCloseSoundStream}});return e.i_fs_openSoundWriteStream=function(){return n.onOpenSoundWriteStream(...arguments)},e.i_fs_sendSoundStreamData=function(){return n.onSoundStreamData(...arguments)},e.i_fs_openSoundReadStream=function(){return n.onOpenSoundReadStream(...arguments)},e.i_fs_closeSoundStream=function(){return n.onCloseSoundStream(...arguments)},e.i_fs_writeSoundFile=function(){return n.onWriteSoundFile(...arguments)},e.i_fs_readSoundFile=function(){return n.onReadSoundFile(...arguments)},n},Jd=(e,n)=>{const t=Ed(n);return Ad(e,{getArray:{type:"proxy",value:e.commons_getArray},setArray:{type:"proxy",value:(n,r)=>e.commons_setArray(n,new t(r))}})},Qd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Zd(e,n,t,r){if(["32f","64"].indexOf(n)>-1&&["32f","64"].indexOf(r)>-1)return void t.set(e);rf(n),rf(r);let a=function(e,n){let t=function(e){return e};e!=n&&(t=["32f","64"].includes(e)?nf:["32f","64"].includes(n)?tf:ef);return t}(n,r),s={oldMin:Math.pow(2,parseInt(n,10))/2,newMin:Math.pow(2,parseInt(r,10))/2,oldMax:Math.pow(2,parseInt(n,10))/2-1,newMax:Math.pow(2,parseInt(r,10))/2-1};af(n,e,!0);for(let o=0,i=e.length;o<i;o++)t[o]=a(e[o],s);af(r,t,!1)}function ef(e,n){return e=e>0?parseInt(e/n.oldMax*n.newMax,10):parseInt(e/n.oldMin*n.newMin,10)}function nf(e,n){return parseInt(e>0?e*n.newMax:e*n.newMin,10)}function tf(e,n){return e>0?e/n.oldMax:e/n.oldMin}function rf(e){if("32f"!=e&&"64"!=e&&(parseInt(e,10)<"8"||parseInt(e,10)>"53"))throw new Error("Invalid bit depth.")}function af(e,n,t){if("8"==e){let e=t?-128:128;for(let t=0,r=n.length;t<r;t++)n[t]=n[t]+=e}}const sf=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],of=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767];function lf(e,n){let t=function(e,n){cf(e,n);let t=[];return t.push(255&e),t.push(e>>8&255),t.push(n.index),t.push(0),t}(e[0],n);for(let r=3,a=e.length;r<a;r+=2){let a=cf(e[r],n),s=cf(e[r+1],n);t.push(s<<4|a)}return t}function uf(e,n){var t;n.predicted=(t=e[1]<<8|e[0])>32768?t-65536:t,n.index=e[2],n.step=of[n.index];let r=[n.predicted,n.predicted];for(let a=4,s=e.length;a<s;a++){let t=e[a],s=t>>4,o=s<<4^t;r.push(df(o,n)),r.push(df(s,n))}return r}function cf(e,n){let t=e-n.predicted,r=0;t>=0?r=0:(r=8,t=-t);let a=of[n.index],s=a>>3;return t>a&&(r|=4,t-=a,s+=a),a>>=1,t>a&&(r|=2,t-=a,s+=a),a>>=1,t>a&&(r|=1,s+=a),function(e,n,t){8&e?t.predicted-=n:t.predicted+=n;t.predicted<-32768?t.predicted=-32768:t.predicted>32767&&(t.predicted=32767);t.index+=sf[7&e],t.index<0?t.index=0:t.index>88&&(t.index=88)}(r,s,n),r}function df(e,n){let t=0;return 4&e&&(t+=n.step),2&e&&(t+=n.step>>1),1&e&&(t+=n.step>>2),t+=n.step>>3,8&e&&(t=-t),n.predicted+=t,n.predicted>32767?n.predicted=32767:n.predicted<-32767&&(n.predicted=-32767),function(e,n){n.index+=sf[e],n.index<0?n.index=0:n.index>88&&(n.index=88);n.step=of[n.index]}(e,n),n.predicted}const ff=[1,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];function pf(e){let n,t=~(e=-32768==e?-32767:e)>>8&128;if(t||(e*=-1),e>32635&&(e=32635),e>=256){let t=ff[e>>8&127];n=t<<4|e>>t+3&15}else n=e>>4;return 85^n^t}function gf(e){let n=0;0!==(128&(e^=85))&&(e&=-129,n=-1);let t=4+((240&e)>>4),r=0;return r=4!=t?1<<t|(15&e)<<t-4|1<<t-5:e<<1|1,r=0===n?r:-r,8*r*-1}const mf=132,hf=32635,yf=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],bf=[0,132,396,924,1980,4092,8316,16764];function vf(e){let n,t,r,a;return n=e>>8&128,0!=n&&(e=-e),(e+=mf)>hf&&(e=hf),t=yf[e>>7&255],r=e>>t+3&15,a=~(n|t<<4|r),a}function Sf(e){let n,t,r,a;return n=128&(e=~e),t=e>>4&7,r=15&e,a=bf[t]+(r<<t+3),0!=n&&(a=-a),a}function wf(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;for(let a=t;a<r;a+=n)_f(e,n,a)}function _f(e,n,t){n--;for(let r=0;r<n;r++){let a=e[t+r];e[t+r]=e[t+n],e[t+n]=a,n--}}function kf(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,a=e.length;for(;r<a;){let a=e.codePointAt(r);if(a<128)n[t]=a,t++;else{let e=0,s=0;for(a<=2047?(e=1,s=192):a<=65535?(e=2,s=224):a<=1114111&&(e=3,s=240,r++),n[t]=(a>>6*e)+s,t++;e>0;)n[t]=128|a>>6*(e-1)&63,t++,e--}r++}return t}class If{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.bits=e,this.offset=Math.ceil(e/8),this.max=Math.pow(2,e)-1,this.min=0,this.unpack=this.unpack_,n&&(this.max=Math.pow(2,e)/2-1,this.min=-this.max-1,this.unpack=this.unpackSigned_)}pack(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n=this.clamp_(Math.round(n));for(let r=0,a=this.offset;r<a;r++)e[t]=255&Math.floor(n/Math.pow(2,8*r)),t++;return t}unpack_(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=0;for(let r=0;r<this.offset;r++)t+=e[n+r]*Math.pow(256,r);return t}unpackSigned_(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.sign_(this.unpack_(e,n))}clamp_(e){return e>this.max?this.max:e<this.min?this.min:e}sign_(e){return e>this.max&&(e-=2*this.max+2),e}}class Tf{constructor(e,n){this.offset=Math.ceil((e+n)/8),this.ebits=e,this.fbits=n,this.bias=(1<<e-1)-1,this.biasP2=Math.pow(2,this.bias+1),this.ebitsFbits=e+n,this.fbias=Math.pow(2,-(8*this.offset-1-e))}pack(e,n,t){Math.abs(n)>this.biasP2-2*this.ebitsFbits&&(n=n<0?-1/0:1/0);let r=((n=+n)||1/n)<0||n<0?1:0;n=Math.abs(n);let a=Math.min(Math.floor(Math.log(n)/Math.LN2),1023),s=xf(n/Math.pow(2,a)*Math.pow(2,this.fbits));return n!==n?(s=Math.pow(2,this.fbits-1),a=(1<<this.ebits)-1):0!==n&&(n>=Math.pow(2,1-this.bias)?(s/Math.pow(2,this.fbits)>=2&&(a+=1,s=1),a>this.bias?(a=(1<<this.ebits)-1,s=0):(a+=this.bias,s=xf(s)-Math.pow(2,this.fbits))):(s=xf(n/Math.pow(2,1-this.bias-this.fbits)),a=0)),this.packFloatBits_(e,t,r,a,s)}unpack(e,n){let t,r=(1<<this.ebits)-1,a="";for(let i=this.offset-1;i>=0;i--){let t=e[i+n].toString(2);a+="00000000".substring(t.length)+t}let s="1"==a.charAt(0)?-1:1;a=a.substring(1);let o=parseInt(a.substring(0,this.ebits),2);return a=a.substring(this.ebits),o==r?0!==parseInt(a,2)?NaN:s*(1/0):(0===o?(o+=1,t=parseInt(a,2)):t=parseInt("1"+a,2),s*t*this.fbias*Math.pow(2,o-this.bias))}packFloatBits_(e,n,t,r,a){let s=[];s.push(t);for(let c=this.ebits;c>0;c-=1)s[c]=r%2?1:0,r=Math.floor(r/2);let o=s.length;for(let c=this.fbits;c>0;c-=1)s[o+c]=a%2?1:0,a=Math.floor(a/2);let i=s.join(""),l=this.offset+n-1,u=n;for(;l>=n;)e[l]=parseInt(i.substring(0,8),2),i=i.substring(8),l--,u++;return u}}function xf(e){let n=Math.floor(e),t=e-n;return t<.5?n:t>.5||n%2?n+1:n}function Of(e){return function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,r="";for(let a=n;a<t;){let n=128,t=191,s=!1,o=e[a++];if(o>=0&&o<=127)r+=String.fromCharCode(o);else{let i=0;o>=194&&o<=223?i=1:o>=224&&o<=239?(i=2,224===e[a]&&(n=160),237===e[a]&&(t=159)):o>=240&&o<=244?(i=3,240===e[a]&&(n=144),244===e[a]&&(t=143)):s=!0,o&=(1<<8-i-1)-1;for(let r=0;r<i;r++)(e[a]<n||e[a]>t)&&(s=!0),o=o<<6|63&e[a],a++;s?r+=String.fromCharCode(65533):o<=65535?r+=String.fromCharCode(o):(o-=65536,r+=String.fromCharCode(55296+(o>>10&1023),56320+(1023&o)))}}return r}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length)}function Cf(e){let n=[];return kf(e,n),n}function Mf(e,n){return kf(e,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)}function Ef(e,n,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=Lf((n=n||{}).bits,n.fp,n.signed),s=Math.ceil(n.bits/8),o=0,i=r;for(let l=e.length;o<l;o++)r=a.pack(t,e[o],r);return n.be&&wf(t,s,i,r),r}function Af(e,n,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length,s=Lf((n=n||{}).bits,n.fp,n.signed);if(a=function(e,n,t,r){let a=(t-n)%r;return t-a}(0,r,a,s.offset),n.be){let o=function(e){return new Uint8Array(e)}(e);n.be&&wf(o,s.offset,r,a),Rf(o,t,r,a,s)}else Rf(e,t,r,a,s)}function Ff(e,n,t){return Ef([e],n,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}function Pf(e,n){let t=[];return Ff(e,n,t,0),t}function Nf(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];return Af(e,n,r,t,t+Math.ceil(n.bits/8)),r[0]}function Rf(e,n,t,r,a){let s=a.offset;for(let o=0,i=t;i<r;i+=s,o++)n[o]=a.unpack(e,i)}function Lf(e,n,t){return n&&32==e?new Tf(8,23):n&&64==e?new Tf(11,52):new If(e,t)}class Df{constructor(){this.container="",this.chunkSize=0,this.format="",this.signature=null,this.head=0,this.uInt32={bits:32,be:!1},this.supported_containers=["RIFF","RIFX"]}setSignature(e){if(this.head=0,this.container=this.readString(e,4),-1===this.supported_containers.indexOf(this.container))throw Error("Not a supported format.");this.uInt32.be="RIFX"===this.container,this.chunkSize=this.readUInt32(e),this.format=this.readString(e,4),this.signature={chunkId:this.container,chunkSize:this.chunkSize,format:this.format,subChunks:this.getSubChunksIndex_(e)}}findChunk(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=this.signature.subChunks,r=[];for(let a=0;a<t.length;a++)if(t[a].chunkId==e){if(!n)return t[a];r.push(t[a])}return"LIST"==e&&r.length?r:null}readString(e,n){let t="";return t=Of(e,this.head,this.head+n),this.head+=n,t}readUInt32(e){let n=Nf(e,this.uInt32,this.head);return this.head+=4,n}getSubChunksIndex_(e){let n=[],t=this.head;for(;t<=e.length-8;)n.push(this.getSubChunkIndex_(e,t)),t+=8+n[n.length-1].chunkSize,t=t%2?t+1:t;return n}getSubChunkIndex_(e,n){let t={chunkId:this.getChunkId_(e,n),chunkSize:this.getChunkSize_(e,n)};if("LIST"==t.chunkId)t.format=Of(e,n+8,n+12),this.head+=4,t.subChunks=this.getSubChunksIndex_(e);else{let e=t.chunkSize%2?t.chunkSize+1:t.chunkSize;this.head=n+8+e,t.chunkData={start:n+8,end:this.head}}return t}getChunkId_(e,n){return this.head+=4,Of(e,n,n+4)}getChunkSize_(e,n){return this.head+=4,Nf(e,this.uInt32,n+4)}}class Uf extends Df{constructor(){super(),this.supported_containers.push("RF64"),this.fmt={chunkId:"",chunkSize:0,audioFormat:0,numChannels:0,sampleRate:0,byteRate:0,blockAlign:0,bitsPerSample:0,cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]},this.fact={chunkId:"",chunkSize:0,dwSampleLength:0},this.cue={chunkId:"",chunkSize:0,dwCuePoints:0,points:[]},this.smpl={chunkId:"",chunkSize:0,dwManufacturer:0,dwProduct:0,dwSamplePeriod:0,dwMIDIUnityNote:0,dwMIDIPitchFraction:0,dwSMPTEFormat:0,dwSMPTEOffset:0,dwNumSampleLoops:0,dwSamplerData:0,loops:[]},this.bext={chunkId:"",chunkSize:0,description:"",originator:"",originatorReference:"",originationDate:"",originationTime:"",timeReference:[0,0],version:0,UMID:"",loudnessValue:0,loudnessRange:0,maxTruePeakLevel:0,maxMomentaryLoudness:0,maxShortTermLoudness:0,reserved:"",codingHistory:""},this.iXML={chunkId:"",chunkSize:0,value:""},this.ds64={chunkId:"",chunkSize:0,riffSizeHigh:0,riffSizeLow:0,dataSizeHigh:0,dataSizeLow:0,originationTime:0,sampleCountHigh:0,sampleCountLow:0},this.data={chunkId:"",chunkSize:0,samples:new Uint8Array(0)},this.LIST=[],this.junk={chunkId:"",chunkSize:0,chunkData:[]},this._PMX={chunkId:"",chunkSize:0,value:""},this.uInt16={bits:16,be:!1,signed:!1,fp:!1}}fromBuffer(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.clearHeaders(),this.setSignature(e),this.uInt16.be=this.uInt32.be,"WAVE"!=this.format)throw Error('Could not find the "WAVE" format identifier');this.readDs64Chunk_(e),this.readFmtChunk_(e),this.readFactChunk_(e),this.readBextChunk_(e),this.readiXMLChunk_(e),this.readCueChunk_(e),this.readSmplChunk_(e),this.readDataChunk_(e,n),this.readJunkChunk_(e),this.readLISTChunk_(e),this.read_PMXChunk_(e)}clearHeaders(){let e=new Uf;Object.assign(this.fmt,e.fmt),Object.assign(this.fact,e.fact),Object.assign(this.cue,e.cue),Object.assign(this.smpl,e.smpl),Object.assign(this.bext,e.bext),Object.assign(this.iXML,e.iXML),Object.assign(this.ds64,e.ds64),Object.assign(this.data,e.data),this.LIST=[],Object.assign(this.junk,e.junk),Object.assign(this._PMX,e._PMX)}readFmtChunk_(e){let n=this.findChunk("fmt ");if(!n)throw Error('Could not find the "fmt " chunk');this.head=n.chunkData.start,this.fmt.chunkId=n.chunkId,this.fmt.chunkSize=n.chunkSize,this.fmt.audioFormat=this.readUInt16_(e),this.fmt.numChannels=this.readUInt16_(e),this.fmt.sampleRate=this.readUInt32(e),this.fmt.byteRate=this.readUInt32(e),this.fmt.blockAlign=this.readUInt16_(e),this.fmt.bitsPerSample=this.readUInt16_(e),this.readFmtExtension_(e)}readFmtExtension_(e){this.fmt.chunkSize>16&&(this.fmt.cbSize=this.readUInt16_(e),this.fmt.chunkSize>18&&(this.fmt.validBitsPerSample=this.readUInt16_(e),this.fmt.chunkSize>20&&(this.fmt.dwChannelMask=this.readUInt32(e),this.fmt.subformat=[this.readUInt32(e),this.readUInt32(e),this.readUInt32(e),this.readUInt32(e)])))}readFactChunk_(e){let n=this.findChunk("fact");n&&(this.head=n.chunkData.start,this.fact.chunkId=n.chunkId,this.fact.chunkSize=n.chunkSize,this.fact.dwSampleLength=this.readUInt32(e))}readCueChunk_(e){let n=this.findChunk("cue ");if(n){this.head=n.chunkData.start,this.cue.chunkId=n.chunkId,this.cue.chunkSize=n.chunkSize,this.cue.dwCuePoints=this.readUInt32(e);for(let n=0;n<this.cue.dwCuePoints;n++)this.cue.points.push({dwName:this.readUInt32(e),dwPosition:this.readUInt32(e),fccChunk:this.readString(e,4),dwChunkStart:this.readUInt32(e),dwBlockStart:this.readUInt32(e),dwSampleOffset:this.readUInt32(e)})}}readSmplChunk_(e){let n=this.findChunk("smpl");if(n){this.head=n.chunkData.start,this.smpl.chunkId=n.chunkId,this.smpl.chunkSize=n.chunkSize,this.smpl.dwManufacturer=this.readUInt32(e),this.smpl.dwProduct=this.readUInt32(e),this.smpl.dwSamplePeriod=this.readUInt32(e),this.smpl.dwMIDIUnityNote=this.readUInt32(e),this.smpl.dwMIDIPitchFraction=this.readUInt32(e),this.smpl.dwSMPTEFormat=this.readUInt32(e),this.smpl.dwSMPTEOffset=this.readUInt32(e),this.smpl.dwNumSampleLoops=this.readUInt32(e),this.smpl.dwSamplerData=this.readUInt32(e);for(let n=0;n<this.smpl.dwNumSampleLoops;n++)this.smpl.loops.push({dwName:this.readUInt32(e),dwType:this.readUInt32(e),dwStart:this.readUInt32(e),dwEnd:this.readUInt32(e),dwFraction:this.readUInt32(e),dwPlayCount:this.readUInt32(e)})}}readDataChunk_(e,n){let t=this.findChunk("data");if(!t)throw Error('Could not find the "data" chunk');this.data.chunkId="data",this.data.chunkSize=t.chunkSize,n&&(this.data.samples=e.slice(t.chunkData.start,t.chunkData.end))}readBextChunk_(e){let n=this.findChunk("bext");n&&(this.head=n.chunkData.start,this.bext.chunkId=n.chunkId,this.bext.chunkSize=n.chunkSize,this.bext.description=this.readString(e,256),this.bext.originator=this.readString(e,32),this.bext.originatorReference=this.readString(e,32),this.bext.originationDate=this.readString(e,10),this.bext.originationTime=this.readString(e,8),this.bext.timeReference=[this.readUInt32(e),this.readUInt32(e)],this.bext.version=this.readUInt16_(e),this.bext.UMID=this.readString(e,64),this.bext.loudnessValue=this.readUInt16_(e),this.bext.loudnessRange=this.readUInt16_(e),this.bext.maxTruePeakLevel=this.readUInt16_(e),this.bext.maxMomentaryLoudness=this.readUInt16_(e),this.bext.maxShortTermLoudness=this.readUInt16_(e),this.bext.reserved=this.readString(e,180),this.bext.codingHistory=this.readString(e,this.bext.chunkSize-602))}readiXMLChunk_(e){let n=this.findChunk("iXML");n&&(this.head=n.chunkData.start,this.iXML.chunkId=n.chunkId,this.iXML.chunkSize=n.chunkSize,this.iXML.value=Of(e,this.head,this.head+this.iXML.chunkSize))}readDs64Chunk_(e){let n=this.findChunk("ds64");if(n)this.head=n.chunkData.start,this.ds64.chunkId=n.chunkId,this.ds64.chunkSize=n.chunkSize,this.ds64.riffSizeHigh=this.readUInt32(e),this.ds64.riffSizeLow=this.readUInt32(e),this.ds64.dataSizeHigh=this.readUInt32(e),this.ds64.dataSizeLow=this.readUInt32(e),this.ds64.originationTime=this.readUInt32(e),this.ds64.sampleCountHigh=this.readUInt32(e),this.ds64.sampleCountLow=this.readUInt32(e);else if("RF64"==this.container)throw Error('Could not find the "ds64" chunk')}readLISTChunk_(e){let n=this.findChunk("LIST",!0);if(null!==n)for(let t=0;t<n.length;t++){let r=n[t];this.LIST.push({chunkId:r.chunkId,chunkSize:r.chunkSize,format:r.format,subChunks:[]});for(let n=0;n<r.subChunks.length;n++)this.readLISTSubChunks_(r.subChunks[n],r.format,e)}}readLISTSubChunks_(e,n,t){"adtl"==n?["labl","note","ltxt"].indexOf(e.chunkId)>-1&&this.readLISTadtlSubChunks_(t,e):"INFO"==n&&this.readLISTINFOSubChunks_(t,e)}readLISTadtlSubChunks_(e,n){this.head=n.chunkData.start;let t={chunkId:n.chunkId,chunkSize:n.chunkSize,dwName:this.readUInt32(e)};"ltxt"==n.chunkId?(t.dwSampleLength=this.readUInt32(e),t.dwPurposeID=this.readUInt32(e),t.dwCountry=this.readUInt16_(e),t.dwLanguage=this.readUInt16_(e),t.dwDialect=this.readUInt16_(e),t.dwCodePage=this.readUInt16_(e),t.value=""):t.value=this.readZSTR_(e,this.head),this.LIST[this.LIST.length-1].subChunks.push(t)}readLISTINFOSubChunks_(e,n){this.head=n.chunkData.start,this.LIST[this.LIST.length-1].subChunks.push({chunkId:n.chunkId,chunkSize:n.chunkSize,value:this.readZSTR_(e,this.head)})}readJunkChunk_(e){let n=this.findChunk("junk");n&&(this.junk={chunkId:n.chunkId,chunkSize:n.chunkSize,chunkData:[].slice.call(e.slice(n.chunkData.start,n.chunkData.end))})}read_PMXChunk_(e){let n=this.findChunk("_PMX");n&&(this.head=n.chunkData.start,this._PMX.chunkId=n.chunkId,this._PMX.chunkSize=n.chunkSize,this._PMX.value=Of(e,this.head,this.head+this._PMX.chunkSize))}readZSTR_(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let t=n;t<e.length&&(this.head++,0!==e[t]);t++);return Of(e,n,this.head-1)}readUInt16_(e){let n=Nf(e,this.uInt16,this.head);return this.head+=2,n}}function jf(e,n){let t=Cf(e);for(let r=t.length;r<n;r++)t.push(0);return t}class zf extends Uf{toBuffer(){this.uInt16.be="RIFX"===this.container,this.uInt32.be=this.uInt16.be;let e=[this.getJunkBytes_(),this.getDs64Bytes_(),this.getBextBytes_(),this.getiXMLBytes_(),this.getFmtBytes_(),this.getFactBytes_(),Cf(this.data.chunkId),Pf(this.data.samples.length,this.uInt32),this.data.samples,this.getCueBytes_(),this.getSmplBytes_(),this.getLISTBytes_(),this.get_PMXBytes_()],n=0;for(let a=0;a<e.length;a++)n+=e[a].length;let t=new Uint8Array(n+12),r=0;r=Mf(this.container,t,r),r=Ff(n+4,this.uInt32,t,r),r=Mf(this.format,t,r);for(let a=0;a<e.length;a++)t.set(e[a],r),r+=e[a].length;return t}getBextBytes_(){let e=[];return this.enforceBext_(),this.bext.chunkId&&(this.bext.chunkSize=602+this.bext.codingHistory.length,e=e.concat(Cf(this.bext.chunkId),Pf(602+this.bext.codingHistory.length,this.uInt32),jf(this.bext.description,256),jf(this.bext.originator,32),jf(this.bext.originatorReference,32),jf(this.bext.originationDate,10),jf(this.bext.originationTime,8),Pf(this.bext.timeReference[0],this.uInt32),Pf(this.bext.timeReference[1],this.uInt32),Pf(this.bext.version,this.uInt16),jf(this.bext.UMID,64),Pf(this.bext.loudnessValue,this.uInt16),Pf(this.bext.loudnessRange,this.uInt16),Pf(this.bext.maxTruePeakLevel,this.uInt16),Pf(this.bext.maxMomentaryLoudness,this.uInt16),Pf(this.bext.maxShortTermLoudness,this.uInt16),jf(this.bext.reserved,180),jf(this.bext.codingHistory,this.bext.codingHistory.length))),this.enforceByteLen_(e),e}enforceBext_(){for(let e in this.bext)if(this.bext.hasOwnProperty(e)&&this.bext[e]&&"timeReference"!=e){this.bext.chunkId="bext";break}(this.bext.timeReference[0]||this.bext.timeReference[1])&&(this.bext.chunkId="bext")}getiXMLBytes_(){let e=[];if(this.iXML.chunkId){let n=Cf(this.iXML.value);this.iXML.chunkSize=n.length,e=e.concat(Cf(this.iXML.chunkId),Pf(this.iXML.chunkSize,this.uInt32),n)}return this.enforceByteLen_(e),e}getDs64Bytes_(){let e=[];return this.ds64.chunkId&&(e=e.concat(Cf(this.ds64.chunkId),Pf(this.ds64.chunkSize,this.uInt32),Pf(this.ds64.riffSizeHigh,this.uInt32),Pf(this.ds64.riffSizeLow,this.uInt32),Pf(this.ds64.dataSizeHigh,this.uInt32),Pf(this.ds64.dataSizeLow,this.uInt32),Pf(this.ds64.originationTime,this.uInt32),Pf(this.ds64.sampleCountHigh,this.uInt32),Pf(this.ds64.sampleCountLow,this.uInt32))),this.enforceByteLen_(e),e}getCueBytes_(){let e=[];if(this.cue.chunkId){let n=this.getCuePointsBytes_();e=e.concat(Cf(this.cue.chunkId),Pf(n.length+4,this.uInt32),Pf(this.cue.dwCuePoints,this.uInt32),n)}return this.enforceByteLen_(e),e}getCuePointsBytes_(){let e=[];for(let n=0;n<this.cue.dwCuePoints;n++)e=e.concat(Pf(this.cue.points[n].dwName,this.uInt32),Pf(this.cue.points[n].dwPosition,this.uInt32),Cf(this.cue.points[n].fccChunk),Pf(this.cue.points[n].dwChunkStart,this.uInt32),Pf(this.cue.points[n].dwBlockStart,this.uInt32),Pf(this.cue.points[n].dwSampleOffset,this.uInt32));return e}getSmplBytes_(){let e=[];if(this.smpl.chunkId){let n=this.getSmplLoopsBytes_();e=e.concat(Cf(this.smpl.chunkId),Pf(n.length+36,this.uInt32),Pf(this.smpl.dwManufacturer,this.uInt32),Pf(this.smpl.dwProduct,this.uInt32),Pf(this.smpl.dwSamplePeriod,this.uInt32),Pf(this.smpl.dwMIDIUnityNote,this.uInt32),Pf(this.smpl.dwMIDIPitchFraction,this.uInt32),Pf(this.smpl.dwSMPTEFormat,this.uInt32),Pf(this.smpl.dwSMPTEOffset,this.uInt32),Pf(this.smpl.dwNumSampleLoops,this.uInt32),Pf(this.smpl.dwSamplerData,this.uInt32),n)}return this.enforceByteLen_(e),e}getSmplLoopsBytes_(){let e=[];for(let n=0;n<this.smpl.dwNumSampleLoops;n++)e=e.concat(Pf(this.smpl.loops[n].dwName,this.uInt32),Pf(this.smpl.loops[n].dwType,this.uInt32),Pf(this.smpl.loops[n].dwStart,this.uInt32),Pf(this.smpl.loops[n].dwEnd,this.uInt32),Pf(this.smpl.loops[n].dwFraction,this.uInt32),Pf(this.smpl.loops[n].dwPlayCount,this.uInt32));return e}getFactBytes_(){let e=[];return this.fact.chunkId&&(e=e.concat(Cf(this.fact.chunkId),Pf(this.fact.chunkSize,this.uInt32),Pf(this.fact.dwSampleLength,this.uInt32))),this.enforceByteLen_(e),e}getFmtBytes_(){let e=[];if(this.fmt.chunkId){let n=e.concat(Cf(this.fmt.chunkId),Pf(this.fmt.chunkSize,this.uInt32),Pf(this.fmt.audioFormat,this.uInt16),Pf(this.fmt.numChannels,this.uInt16),Pf(this.fmt.sampleRate,this.uInt32),Pf(this.fmt.byteRate,this.uInt32),Pf(this.fmt.blockAlign,this.uInt16),Pf(this.fmt.bitsPerSample,this.uInt16),this.getFmtExtensionBytes_());return this.enforceByteLen_(n),n}throw Error('Could not find the "fmt " chunk')}getFmtExtensionBytes_(){let e=[];return this.fmt.chunkSize>16&&(e=e.concat(Pf(this.fmt.cbSize,this.uInt16))),this.fmt.chunkSize>18&&(e=e.concat(Pf(this.fmt.validBitsPerSample,this.uInt16))),this.fmt.chunkSize>20&&(e=e.concat(Pf(this.fmt.dwChannelMask,this.uInt32))),this.fmt.chunkSize>24&&(e=e.concat(Pf(this.fmt.subformat[0],this.uInt32),Pf(this.fmt.subformat[1],this.uInt32),Pf(this.fmt.subformat[2],this.uInt32),Pf(this.fmt.subformat[3],this.uInt32))),e}getLISTBytes_(){let e=[];for(let n=0;n<this.LIST.length;n++){let t=this.getLISTSubChunksBytes_(this.LIST[n].subChunks,this.LIST[n].format);e=e.concat(Cf(this.LIST[n].chunkId),Pf(t.length+4,this.uInt32),Cf(this.LIST[n].format),t)}return this.enforceByteLen_(e),e}getLISTSubChunksBytes_(e,n){let t=[];for(let r=0,a=e.length;r<a;r++)"INFO"==n?t=t.concat(this.getLISTINFOSubChunksBytes_(e[r])):"adtl"==n&&(t=t.concat(this.getLISTadtlSubChunksBytes_(e[r]))),this.enforceByteLen_(t);return t}getLISTINFOSubChunksBytes_(e){let n=[],t=jf(e.value,e.value.length);return n=n.concat(Cf(e.chunkId),Pf(t.length+1,this.uInt32),t),n.push(0),n}getLISTadtlSubChunksBytes_(e){let n=[];if(["labl","note"].indexOf(e.chunkId)>-1){let t=jf(e.value,e.value.length);n=n.concat(Cf(e.chunkId),Pf(t.length+4+1,this.uInt32),Pf(e.dwName,this.uInt32),t),n.push(0)}else"ltxt"==e.chunkId&&(n=n.concat(this.getLtxtChunkBytes_(e)));return n}getLtxtChunkBytes_(e){return[].concat(Cf(e.chunkId),Pf(e.value.length+20,this.uInt32),Pf(e.dwName,this.uInt32),Pf(e.dwSampleLength,this.uInt32),Pf(e.dwPurposeID,this.uInt32),Pf(e.dwCountry,this.uInt16),Pf(e.dwLanguage,this.uInt16),Pf(e.dwDialect,this.uInt16),Pf(e.dwCodePage,this.uInt16),jf(e.value,e.value.length))}get_PMXBytes_(){let e=[];if(this._PMX.chunkId){let n=Cf(this._PMX.value);this._PMX.chunkSize=n.length,e=e.concat(Cf(this._PMX.chunkId),Pf(this._PMX.chunkSize,this.uInt32),n)}return this.enforceByteLen_(e),e}getJunkBytes_(){let e=[];return this.junk.chunkId?e.concat(Cf(this.junk.chunkId),Pf(this.junk.chunkData.length,this.uInt32),this.junk.chunkData):(this.enforceByteLen_(e),e)}enforceByteLen_(e){e.length%2&&e.push(0)}}function Bf(e,n,t){return!(t<1||e*(n/8)*t>4294967295)}class Vf extends zf{constructor(){super(),this.bitDepth="0",this.dataType={bits:0,be:!1},this.WAV_AUDIO_FORMATS={4:17,8:1,"8a":6,"8m":7,16:1,24:1,32:1,"32f":3,64:3}}fromScratch(e,n,t,r,a){a=a||{},this.clearHeaders(),this.newWavFile_(e,n,t,r,a)}fromBuffer(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super.fromBuffer(e,n),this.bitDepthFromFmt_(),this.updateDataType_()}toBuffer(){return this.validateWavHeader_(),super.toBuffer()}getSamples(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Float64Array,t=new n(this.data.samples.length/(this.dataType.bits/8));return Af(this.data.samples,this.dataType,t,0,this.data.samples.length),!e&&this.fmt.numChannels>1?function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,r=[];for(let a=0;a<n;a++)r[a]=new t(e.length/n);for(let a=0;a<n;a++)for(let t=a,s=0;t<e.length;t+=n,s++)r[a][s]=e[t];return r}(t,this.fmt.numChannels,n):t}getSample(e){if((e*=this.dataType.bits/8)+this.dataType.bits/8>this.data.samples.length)throw new Error("Range error");return Nf(this.data.samples.slice(e,e+this.dataType.bits/8),this.dataType)}setSample(e,n){if((e*=this.dataType.bits/8)+this.dataType.bits/8>this.data.samples.length)throw new Error("Range error");Ff(n,this.dataType,this.data.samples,e)}getiXML(){return this.iXML.value}setiXML(e){if("string"!==typeof e)throw new TypeError("iXML value must be a string.");this.iXML.value=e,this.iXML.chunkId="iXML"}get_PMX(){return this._PMX.value}set_PMX(e){if("string"!==typeof e)throw new TypeError("_PMX value must be a string.");this._PMX.value=e,this._PMX.chunkId="_PMX"}newWavFile_(e,n,t,r,a){a.container||(a.container="RIFF"),this.container=a.container,this.bitDepth=t,r=function(e){let n=[];if(e.length>0)if(e[0].constructor!==Number){n=new Float64Array(e[0].length*e.length);for(let t=0,r=e[0].length,a=0;t<r;t++)for(let s=0,o=e.length;s<o;s++,a++)n[a]=e[s][t]}else n=e;return n}(r),this.updateDataType_();let s=this.dataType.bits/8;this.data.samples=new Uint8Array(r.length*s),Ef(r,this.dataType,this.data.samples,0),this.makeWavHeader_(t,e,n,s,this.data.samples.length,a),this.data.chunkId="data",this.data.chunkSize=this.data.samples.length,this.validateWavHeader_()}makeWavHeader_(e,n,t,r,a,s){"4"==e?this.createADPCMHeader_(e,n,t,r,a,s):"8a"==e||"8m"==e?this.createALawMulawHeader_(e,n,t,r,a,s):-1==Object.keys(this.WAV_AUDIO_FORMATS).indexOf(e)||n>2?this.createExtensibleHeader_(e,n,t,r,a,s):this.createPCMHeader_(e,n,t,r,a,s)}createPCMHeader_(e,n,t,r,a,s){this.container=s.container,this.chunkSize=36+a,this.format="WAVE",this.bitDepth=e,this.fmt={chunkId:"fmt ",chunkSize:16,audioFormat:this.WAV_AUDIO_FORMATS[e]||65534,numChannels:n,sampleRate:t,byteRate:n*r*t,blockAlign:n*r,bitsPerSample:parseInt(e,10),cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]}}createADPCMHeader_(e,n,t,r,a,s){this.createPCMHeader_(e,n,t,r,a,s),this.chunkSize=40+a,this.fmt.chunkSize=20,this.fmt.byteRate=4055,this.fmt.blockAlign=256,this.fmt.bitsPerSample=4,this.fmt.cbSize=2,this.fmt.validBitsPerSample=505,this.fact={chunkId:"fact",chunkSize:4,dwSampleLength:2*a}}createExtensibleHeader_(e,n,t,r,a,s){this.createPCMHeader_(e,n,t,r,a,s),this.chunkSize=60+a,this.fmt.chunkSize=40,this.fmt.bitsPerSample=1+(parseInt(e,10)-1|7),this.fmt.cbSize=22,this.fmt.validBitsPerSample=parseInt(e,10),this.fmt.dwChannelMask=function(e){let n=0;1===e?n=4:2===e?n=3:4===e?n=51:6===e?n=63:8===e&&(n=1599);return n}(n),this.fmt.subformat=[1,1048576,2852126848,1905997824]}createALawMulawHeader_(e,n,t,r,a,s){this.createPCMHeader_(e,n,t,r,a,s),this.chunkSize=40+a,this.fmt.chunkSize=20,this.fmt.cbSize=2,this.fmt.validBitsPerSample=8,this.fact={chunkId:"fact",chunkSize:4,dwSampleLength:a}}bitDepthFromFmt_(){3===this.fmt.audioFormat&&32===this.fmt.bitsPerSample?this.bitDepth="32f":6===this.fmt.audioFormat?this.bitDepth="8a":7===this.fmt.audioFormat?this.bitDepth="8m":this.bitDepth=this.fmt.bitsPerSample.toString()}validateBitDepth_(){if(!this.WAV_AUDIO_FORMATS[this.bitDepth]){if(parseInt(this.bitDepth,10)>8&&parseInt(this.bitDepth,10)<54)return!0;throw new Error("Invalid bit depth.")}return!0}updateDataType_(){this.dataType={bits:1+(parseInt(this.bitDepth,10)-1|7),fp:"32f"==this.bitDepth||"64"==this.bitDepth,signed:"8"!=this.bitDepth,be:"RIFX"==this.container},["4","8a","8m"].indexOf(this.bitDepth)>-1&&(this.dataType.bits=8,this.dataType.signed=!1)}validateWavHeader_(){if(this.validateBitDepth_(),e=this.fmt.numChannels,n=this.fmt.bitsPerSample,e<1||e*n/8>65535)throw new Error("Invalid number of channels.");var e,n;if(!Bf(this.fmt.numChannels,this.fmt.bitsPerSample,this.fmt.sampleRate))throw new Error("Invalid sample rate.")}}class Gf extends Vf{getTag(e){let n=this.getTagIndex_(e);return null!==n.TAG?this.LIST[n.LIST].subChunks[n.TAG].value:null}setTag(e,n){e=function(e){if(e.constructor!==String)throw new Error("Invalid tag name.");if(e.length<4)for(let n=0,t=4-e.length;n<t;n++)e+=" ";return e}(e);let t=this.getTagIndex_(e);null!==t.TAG?(this.LIST[t.LIST].subChunks[t.TAG].chunkSize=n.length+1,this.LIST[t.LIST].subChunks[t.TAG].value=n):null!==t.LIST?this.LIST[t.LIST].subChunks.push({chunkId:e,chunkSize:n.length+1,value:n}):(this.LIST.push({chunkId:"LIST",chunkSize:8+n.length+1,format:"INFO",subChunks:[]}),this.LIST[this.LIST.length-1].subChunks.push({chunkId:e,chunkSize:n.length+1,value:n}))}deleteTag(e){let n=this.getTagIndex_(e);return null!==n.TAG&&(this.LIST[n.LIST].subChunks.splice(n.TAG,1),!0)}listTags(){let e=this.getLISTIndex("INFO"),n={};if(null!==e)for(let t=0,r=this.LIST[e].subChunks.length;t<r;t++)n[this.LIST[e].subChunks[t].chunkId]=this.LIST[e].subChunks[t].value;return n}getLISTIndex(e){for(let n=0,t=this.LIST.length;n<t;n++)if(this.LIST[n].format==e)return n;return null}getTagIndex_(e){let n={LIST:null,TAG:null};for(let t=0,r=this.LIST.length;t<r;t++)if("INFO"==this.LIST[t].format){n.LIST=t;for(let r=0,a=this.LIST[t].subChunks.length;r<a;r++)if(this.LIST[t].subChunks[r].chunkId==e){n.TAG=r;break}break}return n}}class Wf extends Gf{listCuePoints(){let e=this.getCuePoints_();for(let n=0,t=e.length;n<t;n++)e[n].position=e[n].dwSampleOffset/this.fmt.sampleRate*1e3,e[n].dwSampleLength?(e[n].end=e[n].dwSampleLength/this.fmt.sampleRate*1e3,e[n].end+=e[n].position):e[n].end=null,delete e[n].value;return e}setCuePoint(e){this.cue.chunkId="cue ",e.label||(e.label="");let n=this.getCuePoints_();this.clearLISTadtl_(),this.cue.points=[],e.dwSampleOffset=e.position*this.fmt.sampleRate/1e3,e.dwSampleLength=0,e.end&&(e.dwSampleLength=e.end*this.fmt.sampleRate/1e3-e.dwSampleOffset),0===n.length?this.setCuePoint_(e,1):this.setCuePointInOrder_(n,e),this.cue.dwCuePoints=this.cue.points.length}deleteCuePoint(e){this.cue.chunkId="cue ";let n=this.getCuePoints_();this.clearLISTadtl_();let t=this.cue.points.length;this.cue.points=[];for(let r=0;r<t;r++)r+1!==e&&this.setCuePoint_(n[r],r+1);this.cue.dwCuePoints=this.cue.points.length,this.cue.dwCuePoints?this.cue.chunkId="cue ":(this.cue.chunkId="",this.clearLISTadtl_())}updateLabel(e,n){let t=this.getLISTIndex("adtl");if(null!==t)for(let r=0,a=this.LIST[t].subChunks.length;r<a;r++)this.LIST[t].subChunks[r].dwName==e&&(this.LIST[t].subChunks[r].value=n)}getCuePoints_(){let e=[];for(let n=0;n<this.cue.points.length;n++){let t=this.cue.points[n],r=this.getDataForCuePoint_(t.dwName);r.label=r.value?r.value:"",r.dwPosition=t.dwPosition,r.fccChunk=t.fccChunk,r.dwChunkStart=t.dwChunkStart,r.dwBlockStart=t.dwBlockStart,r.dwSampleOffset=t.dwSampleOffset,e.push(r)}return e}getDataForCuePoint_(e){let n=this.getLISTIndex("adtl"),t={};return null!==n&&this.getCueDataFromLIST_(t,n,e),t}getCueDataFromLIST_(e,n,t){for(let r=0,a=this.LIST[n].subChunks.length;r<a;r++)if(this.LIST[n].subChunks[r].dwName==t){let t=this.LIST[n].subChunks[r];e.value=t.value||e.value,e.dwName=t.dwName||0,e.dwSampleLength=t.dwSampleLength||0,e.dwPurposeID=t.dwPurposeID||0,e.dwCountry=t.dwCountry||0,e.dwLanguage=t.dwLanguage||0,e.dwDialect=t.dwDialect||0,e.dwCodePage=t.dwCodePage||0}}setCuePoint_(e,n){this.cue.points.push({dwName:n,dwPosition:e.dwPosition?e.dwPosition:0,fccChunk:e.fccChunk?e.fccChunk:"data",dwChunkStart:e.dwChunkStart?e.dwChunkStart:0,dwBlockStart:e.dwBlockStart?e.dwBlockStart:0,dwSampleOffset:e.dwSampleOffset}),this.setLabl_(e,n)}setCuePointInOrder_(e,n){let t=!1;for(let r=0;r<e.length;r++)e[r].dwSampleOffset>n.dwSampleOffset&&!t?(this.setCuePoint_(n,r+1),this.setCuePoint_(e[r],r+2),t=!0):this.setCuePoint_(e[r],t?r+2:r+1);t||this.setCuePoint_(n,this.cue.points.length+1)}clearLISTadtl_(){for(let e=0,n=this.LIST.length;e<n;e++)"adtl"==this.LIST[e].format&&this.LIST.splice(e)}setLabl_(e,n){let t=this.getLISTIndex("adtl");null===t&&(this.LIST.push({chunkId:"LIST",chunkSize:4,format:"adtl",subChunks:[]}),t=this.LIST.length-1),this.setLabelText_(t,e,n),e.dwSampleLength&&this.setLtxtChunk_(t,e,n)}setLabelText_(e,n,t){this.LIST[e].subChunks.push({chunkId:"labl",chunkSize:4,dwName:t,value:n.label}),this.LIST[e].chunkSize+=12}setLtxtChunk_(e,n,t){this.LIST[e].subChunks.push({chunkId:"ltxt",chunkSize:20,dwName:t,dwSampleLength:n.dwSampleLength,dwPurposeID:n.dwPurposeID||0,dwCountry:n.dwCountry||0,dwLanguage:n.dwLanguage||0,dwDialect:n.dwDialect||0,dwCodePage:n.dwCodePage||0,value:n.label}),this.LIST[e].chunkSize+=28}}class $f{constructor(e,n,t){this.length_=e,this.scaleFactor_=(e-1)/n,this.interpolate=this.sinc,"point"===t.method?this.interpolate=this.point:"linear"===t.method?this.interpolate=this.linear:"cubic"===t.method&&(this.interpolate=this.cubic),this.tangentFactor_=1-Math.max(0,Math.min(1,t.tension||0)),this.sincFilterSize_=t.sincFilterSize||1,this.kernel_=function(e){return function(n){return function(e){if(0===e)return 1;return Math.sin(Math.PI*e)/(Math.PI*e)}(n)*e(n)}}(t.sincWindow||Hf)}point(e,n){return this.getClippedInput_(Math.round(this.scaleFactor_*e),n)}linear(e,n){e=this.scaleFactor_*e;let t=Math.floor(e);return(1-(e-=t))*this.getClippedInput_(t,n)+e*this.getClippedInput_(t+1,n)}cubic(e,n){e=this.scaleFactor_*e;let t=Math.floor(e),r=[this.getTangent_(t,n),this.getTangent_(t+1,n)],a=[this.getClippedInput_(t,n),this.getClippedInput_(t+1,n)],s=(e-=t)*e,o=e*s;return(2*o-3*s+1)*a[0]+(o-2*s+e)*r[0]+(-2*o+3*s)*a[1]+(o-s)*r[1]}sinc(e,n){e=this.scaleFactor_*e;let t=Math.floor(e),r=t-this.sincFilterSize_+1,a=t+this.sincFilterSize_,s=0;for(let o=r;o<=a;o++)s+=this.kernel_(e-o)*this.getClippedInput_(o,n);return s}getTangent_(e,n){return this.tangentFactor_*(this.getClippedInput_(e+1,n)-this.getClippedInput_(e-1,n))/2}getClippedInput_(e,n){return 0<=e&&e<this.length_?n[e]:0}}function Hf(e){return Math.exp(-e/2*e/2)}const Kf={point:!1,linear:!1,cubic:!0,sinc:!0},qf={IIR:16,FIR:71},Yf={IIR:class{constructor(e,n,t){let r=[];for(let a=0;a<e;a++)r.push(this.getCoeffs_({Fs:n,Fc:t,Q:.5/Math.sin(Math.PI/(2*e)*(a+.5))}));this.stages=[];for(let a=0;a<r.length;a++)this.stages[a]={b0:r[a].b[0],b1:r[a].b[1],b2:r[a].b[2],a1:r[a].a[0],a2:r[a].a[1],k:r[a].k,z:[0,0]}}filter(e){let n=e;for(let t=0,r=this.stages.length;t<r;t++)n=this.runStage_(t,n);return n}getCoeffs_(e){let n={a:[],b:[]},t=this.preCalc_(e,n);return n.k=1,n.b.push((1-t.cw)/(2*t.a0)),n.b.push(2*n.b[0]),n.b.push(n.b[0]),n}preCalc_(e,n){let t={},r=2*Math.PI*e.Fc/e.Fs;return t.alpha=Math.sin(r)/(2*e.Q),t.cw=Math.cos(r),t.a0=1+t.alpha,n.a0=t.a0,n.a.push(-2*t.cw/t.a0),n.k=1,n.a.push((1-t.alpha)/t.a0),t}runStage_(e,n){let t=n*this.stages[e].k-this.stages[e].a1*this.stages[e].z[0]-this.stages[e].a2*this.stages[e].z[1],r=this.stages[e].b0*t+this.stages[e].b1*this.stages[e].z[0]+this.stages[e].b2*this.stages[e].z[1];return this.stages[e].z[1]=this.stages[e].z[0],this.stages[e].z[0]=t,r}reset(){for(let e=0;e<this.stages.length;e++)this.stages[e].z=[0,0]}},FIR:class{constructor(e,n,t){let r=2*Math.PI*t/n,a=0;this.filters=[];for(let s=0;s<=e;s++)s-e/2===0?this.filters[s]=r:(this.filters[s]=Math.sin(r*(s-e/2))/(s-e/2),this.filters[s]*=.54-.46*Math.cos(2*Math.PI*s/e)),a+=this.filters[s];for(let s=0;s<=e;s++)this.filters[s]/=a;this.z=this.initZ_()}filter(e){this.z.buf[this.z.pointer]=e;let n=0;for(let t=0,r=this.z.buf.length;t<r;t++)n+=this.filters[t]*this.z.buf[(this.z.pointer+t)%this.z.buf.length];return this.z.pointer=(this.z.pointer+1)%this.z.buf.length,n}reset(){this.z=this.initZ_()}initZ_(){let e=[];for(let n=0;n<this.filters.length-1;n++)e.push(0);return{buf:e,pointer:0}}}};function Xf(e,n,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r=r||{};let a=(t-n)/n+1,s=new Float64Array(e.length*a);r.method=r.method||"cubic";let o=new $f(e.length,s.length,{method:r.method,tension:r.tension||0,sincFilterSize:r.sincFilterSize||6,sincWindow:r.sincWindow||void 0,clip:r.clip||"mirror"});if(void 0===r.LPF&&(r.LPF=Kf[r.method]),r.LPF){r.LPFType=r.LPFType||"IIR";const a=Yf[r.LPFType];if(t>n){!function(e,n,t,r){for(let a=0,s=n.length;a<s;a++)n[a]=r.filter(t.interpolate(a,e));r.reset();for(let a=n.length-1;a>=0;a--)n[a]=r.filter(n[a])}(e,s,o,new a(r.LPForder||qf[r.LPFType],t,n/2))}else{!function(e,n,t,r){for(let a=0,s=e.length;a<s;a++)e[a]=r.filter(e[a]);r.reset();for(let a=e.length-1;a>=0;a--)e[a]=r.filter(e[a]);Jf(e,n,t)}(e,s,o,new a(r.LPForder||qf[r.LPFType],n,t/2))}}else Jf(e,s,o);return s}function Jf(e,n,t){for(let r=0,a=n.length;r<a;r++)n[r]=t.interpolate(r,e)}class Qf extends Wf{toRIFF(){let e=new Float64Array(Zf(this.data.samples.length,this.dataType.bits/8));Af(this.data.samples,this.dataType,e,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,e,{container:"RIFF"})}toRIFX(){let e=new Float64Array(Zf(this.data.samples.length,this.dataType.bits/8));Af(this.data.samples,this.dataType,e,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,e,{container:"RIFX"})}toIMAADPCM(){if(8e3!==this.fmt.sampleRate)throw new Error("Only 8000 Hz files can be compressed as IMA-ADPCM.");if(1!==this.fmt.numChannels)throw new Error("Only mono files can be compressed as IMA-ADPCM.");{this.assure16Bit_();let e=new Int16Array(Zf(this.data.samples.length,2));Af(this.data.samples,this.dataType,e,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"4",function(e){let n={index:0,predicted:0,step:7},t=new Uint8Array(e.length),r=[],a=0,s=0;for(let i=0,l=e.length;i<l;i++)i%505==0&&0!=i&&(t.set(lf(r,n),a),a+=256,r=[],s++),r.push(e[i]);let o=e.length/2;return o%2&&o++,t.slice(0,o+512+4*s)}(e),{container:this.correctContainer_()})}}fromIMAADPCM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"16";this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"16",function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,t={index:0,predicted:0,step:7},r=new Int16Array(2*e.length),a=[],s=0;for(let o=0,i=e.length;o<i;o++){if(o%n==0&&0!=o){let e=uf(a,t);r.set(e,s),s+=e.length,a=[]}a.push(e[o])}return r}(this.data.samples,this.fmt.blockAlign),{container:this.correctContainer_()}),"16"!=e&&this.toBitDepth(e)}toALaw(){this.assure16Bit_();let e=new Int16Array(Zf(this.data.samples.length,2));Af(this.data.samples,this.dataType,e,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"8a",function(e){let n=new Uint8Array(e.length);for(let t=0,r=e.length;t<r;t++)n[t]=pf(e[t]);return n}(e),{container:this.correctContainer_()})}fromALaw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"16";this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"16",function(e){let n=new Int16Array(e.length);for(let t=0,r=e.length;t<r;t++)n[t]=gf(e[t]);return n}(this.data.samples),{container:this.correctContainer_()}),"16"!=e&&this.toBitDepth(e)}toMuLaw(){this.assure16Bit_();let e=new Int16Array(Zf(this.data.samples.length,2));Af(this.data.samples,this.dataType,e,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"8m",function(e){let n=new Uint8Array(e.length);for(let t=0,r=e.length;t<r;t++)n[t]=vf(e[t]);return n}(e),{container:this.correctContainer_()})}fromMuLaw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"16";this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"16",function(e){let n=new Int16Array(e.length);for(let t=0,r=e.length;t<r;t++)n[t]=Sf(e[t]);return n}(this.data.samples),{container:this.correctContainer_()}),"16"!=e&&this.toBitDepth(e)}toBitDepth(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=e,r=this.bitDepth;n||("32f"!=e&&(t=this.dataType.bits.toString()),r=""+this.dataType.bits),this.assureUncompressed_();let a=this.getSamples(!0),s=new Float64Array(a.length);Zd(a,r,s,t),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,e,s,{container:this.correctContainer_()})}toSampleRate(e,n){this.validateResample_(e);let t=this.getSamples(),r=[];if(t.constructor===Float64Array)r=Xf(t,this.fmt.sampleRate,e,n);else for(let a=0;a<t.length;a++)r.push(Xf(t[a],this.fmt.sampleRate,e,n));this.fromExisting_(this.fmt.numChannels,e,this.bitDepth,r,{container:this.correctContainer_()})}validateResample_(e){if(!Bf(this.fmt.numChannels,this.fmt.bitsPerSample,e))throw new Error("Invalid sample rate.");if(["4","8a","8m"].indexOf(this.bitDepth)>-1)throw new Error("wavefile can't change the sample rate of compressed files.")}assure16Bit_(){this.assureUncompressed_(),"16"!=this.bitDepth&&this.toBitDepth("16")}assureUncompressed_(){"8a"==this.bitDepth?this.fromALaw():"8m"==this.bitDepth?this.fromMuLaw():"4"==this.bitDepth&&this.fromIMAADPCM()}correctContainer_(){return"RF64"==this.container?"RIFF":this.container}fromExisting_(e,n,t,r,a){let s=new Wf;Object.assign(this.fmt,s.fmt),Object.assign(this.fact,s.fact),Object.assign(this.ds64,s.ds64),Object.assign(this.data,s.data),this.newWavFile_(e,n,t,r,a)}}function Zf(e,n){let t=e/n;return t%2&&t++,t}class ep extends Qf{constructor(e){super(),e&&this.fromBuffer(e)}fromBase64(e){this.fromBuffer(function(e){let n=new Uint8Array(256);for(let a=0;a<64;a++)n[Qd.charCodeAt(a)]=a;let t=.75*e.length;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);let r=new Uint8Array(t);for(let a=0,s=0;a<e.length;a+=4){let t=n[e.charCodeAt(a)],o=n[e.charCodeAt(a+1)],i=n[e.charCodeAt(a+2)],l=n[e.charCodeAt(a+3)];r[s++]=t<<2|o>>4,r[s++]=(15&o)<<4|i>>2,r[s++]=(3&i)<<6|63&l}return r}(e))}toBase64(){return function(e){let n="";for(let t=0;t<e.length;t+=3)n+=Qd[e[t]>>2],n+=Qd[(3&e[t])<<4|e[t+1]>>4],n+=Qd[(15&e[t+1])<<2|e[t+2]>>6],n+=Qd[63&e[t+2]];return e.length%3===2?n=n.substring(0,n.length-1)+"=":e.length%3===1&&(n=n.substring(0,n.length-2)+"=="),n}(this.toBuffer())}toDataURI(){return"data:audio/wav;base64,"+this.toBase64()}fromDataURI(e){this.fromBase64(e.replace("data:audio/wav;base64,",""))}}const np=(e,n)=>{const t=e.length;let r=new ep;return r.fromScratch(t,n,"32f",e.map((e=>e.map((e=>e))))),r.toBuffer()},tp=async(e,n)=>{switch(n){case"javascript":return Yd(Fs(e,"javascript"));case"assemblyscript":return(async e=>{const{rawModule:n,engineData:t,forwardReferences:r}=await Kd(e),a=await qd(n,t,r);return Ad(n,a)})(Fs(e,"wasm"))}},rp=(e,n,t)=>{const{channelCount:r,sampleRate:a,blockSize:s}=t,o=Math.round(n*a),i=ap("in",t),l=ap("out",t),u=ap("out",t,o);e.configure(a,s);let c=0;for(;c<o;){e.loop(i,l);for(let e=0;e<r.out;e++)u[e].set(l[e].slice(0,Math.min(s,o-c)),c);c+=s}return u},ap=(e,n,t)=>{const{channelCount:r,blockSize:a,bitDepth:s}=n;void 0===t&&(t=a);const o=Ed(s),i=[];for(let l=0;l<r[e];l++)i.push(new o(Math.round(t)));return i},sp={pd:{extensions:[".pd"],description:"Pure Data text"},pdJson:{extensions:[".pd.json"],description:"Pure Data JSON"},dspGraph:{extensions:[".dsp-graph.json"],description:"WebPd DSP graph"},javascript:{extensions:[".js"],description:"JavaScript WebPd module"},assemblyscript:{extensions:[".as"],description:"AssemblyScript DSP code"},wasm:{extensions:[".wasm"],description:"Web Assembly WebPd module"},wav:{extensions:[".wav"],description:"An audio preview of your patch"},app:{extensions:[],description:"Complete web app embedding your compiled WebPd patch"}},op=["pd","pdJson","dspGraph",[["javascript","wav"],["assemblyscript","wasm","wav"],["assemblyscript","wasm","app"],["javascript","app"]]],ip=e=>{const n=Object.entries(sp).filter((n=>{let[t,r]=n;return!!r.extensions.some((n=>e.endsWith(n)))}));return 0===n.length?null:n[0][0]},lp=(e,n,t)=>{let r=up(op,n,[]).filter((n=>n.includes(e))).map((n=>n.slice(n.indexOf(e)+1)));return t&&t!==e&&(r=r.filter((e=>e.includes(t)))),0===r.length?null:r[0]},up=(e,n,t)=>{let r=[...t];return e.flatMap((e=>Array.isArray(e)?up(e,n,r):(r=[...r,e],e===n?[r]:[])))},cp=(e,n)=>{let t=[...n];return e.flatMap(((n,r)=>Array.isArray(n)?cp(n,t):(t=[...t,n],r===e.length-1?[t]:[])))},dp={translateArgs:(e,n)=>{let t;if(e.args.length)t=e.args.map((e=>$u(e)-1));else{const r=new Set;n.connections.forEach((n=>{n.sink.nodeId===e.id&&r.add(n.sink.portletId)}));const a=Math.max(...r);t=[];for(let e=0;e<=a;e++)t.push(e)}return{channelMapping:t}},build:e=>({inlets:Ls(e.channelMapping,((e,n)=>["".concat(n),{type:"signal",id:"".concat(n)}])),outlets:{},isPullingSignal:!0})},fp={loop:e=>{let{ins:n,globs:t,node:r,compilation:{settings:{audio:a},target:s}}=e;return lo([r.args.channelMapping.map(((e,n)=>[e,n])).filter((e=>{let[n]=e;return 0<=n&&n<a.channelCount.out})).map((e=>{let[r,a]=e;return"javascript"===s?"".concat(t.output,"[").concat(r,"][").concat(t.iterFrame,"] = ").concat(n["".concat(a)]):"".concat(t.output,"[").concat(t.iterFrame," + ").concat(t.blockSize," * ").concat(r,"] = ").concat(n["".concat(a)])}))])}},pp={translateArgs:(e,n)=>{let t;if(e.args.length)t=e.args.map((e=>$u(e)-1));else{const r=new Set;n.connections.forEach((n=>{n.source.nodeId===e.id&&r.add(n.source.portletId)}));const a=Math.max(...r);t=[];for(let e=0;e<=a;e++)t.push(e)}return{channelMapping:t}},build:e=>({inlets:{},outlets:Ls(e.channelMapping,((e,n)=>["".concat(n),{type:"signal",id:"".concat(n)}]))})},gp={loop:e=>{let{outs:n,globs:t,node:r,compilation:{settings:{audio:a},target:s}}=e;return lo([r.args.channelMapping.map(((e,n)=>[e,n])).filter((e=>{let[n]=e;return 0<=n&&n<a.channelCount.in})).map((e=>{let[r,a]=e;return"javascript"===s?"".concat(n["".concat(a)]," = ").concat(t.input,"[").concat(r,"][").concat(t.iterFrame,"]"):"".concat(n["".concat(a)]," = ").concat(t.input,"[").concat(t.iterFrame," + ").concat(t.blockSize," * ").concat(r,"]")}))])}};var mp;const hp={messageReceivers:e=>{let{globs:n,snds:t}=e;return{0:oo([ro("Message","m")])(mp||(mp=r(["\n        if (msg_isBang(m)) { \n            ","(msg_floats([","])) \n            return\n        }\n    "])),t.$0,n.sampleRate)}},dependencies:[gd]};var yp,bp,vp;const Sp={translateArgs:e=>({frequency:Ku(e.args[0])||0}),build:()=>({inlets:{0:{type:"signal",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"signal",id:"0"}}}),configureMessageToSignalConnection:(e,n)=>{let{frequency:t}=n;if("0"===e)return{initialSignalValue:t}}},wp=e=>{let{name:n,coeff:t,generateOperation:a}=e;const s=ac(n,["setPhase"]);return{initialization:e=>{let{globs:n,state:a}=e;return uo(bp||(bp=r(["\n            ","\n            \n            commons_waitEngineConfigure(() => {\n                ",".J = "," / ","\n            })\n        "])),ao(s.stateClass,a,"{\n                phase: 0,\n                J: 0,\n            }"),a,t?"".concat(t):"1",n.sampleRate)},messageReceivers:e=>{let{globs:n,state:t}=e;return{1:rc(s.setPhase,t)}},loop:e=>{let{ins:n,state:t,outs:s}=e;return uo(vp||(vp=r(["\n        "," = ","\n        ",".phase += (",".J * ",")\n    "])),s.$0,a("".concat(t,".phase")),t,t,n.$0)},dependencies:[gi,()=>lo([io(s.stateClass,[ro("Float","phase"),ro("Float","J")]),so(s.setPhase,[ro(s.stateClass,"state"),ro("Float","phase")],"void")(yp||(yp=r(["\n            state.phase = phase % 1.0","\n        "])),t?" * ".concat(t):"")])]}},_p={"osc~":wp({name:"osc_t",coeff:"2 * Math.PI",generateOperation:e=>"Math.cos(".concat(e,")")}),"phasor~":wp({name:"phasor_t",generateOperation:e=>"".concat(e," % 1")})},kp={"osc~":Sp,"phasor~":Sp};var Ip,Tp;const xp={translateArgs:e=>{let{args:n}=e;return{minValue:Ku(n[0])||0,maxValue:Ku(n[1])||0}},build:()=>({inlets:{0:{type:"signal",id:"0"},1:{type:"message",id:"1"},2:{type:"message",id:"2"}},outlets:{0:{type:"signal",id:"0"}}})},Op=ac("clip_t"),Cp={initialization:e=>{let{node:{args:n},state:t}=e;return uo(Ip||(Ip=r(["\n            ","\n        "])),ao(Op.stateClass,t,"{\n                minValue: ".concat(n.minValue,",\n                maxValue: ").concat(n.maxValue,",\n            }")))},inlineLoop:e=>{let{ins:n,state:t}=e;return uo(Tp||(Tp=r(["Math.max(Math.min(",".maxValue, ","), ",".minValue)"])),t,n.$0,t)},messageReceivers:e=>{let{state:n}=e;return{1:tc("".concat(n,".minValue")),2:tc("".concat(n,".maxValue"))}},dependencies:[()=>lo([io(Op.stateClass,[ro("Float","minValue"),ro("Float","maxValue")])])]};var Mp,Ep,Ap;const Fp={translateArgs:()=>({}),build:()=>({inlets:{0:{type:"signal",id:"0"},"0_message":{type:"message",id:"0_message"},1:{type:"signal",id:"1"}},outlets:{0:{type:"signal",id:"0"}}}),configureMessageToSignalConnection:e=>{if("0"===e)return{reroutedMessageInletId:"0_message"}}},Pp=ac("samphold_t"),Np={loop:e=>{let{ins:n,outs:t,state:a}=e;return uo(Ep||(Ep=r(["\n    ",".signalMemory = "," = "," < ",".controlMemory ? ",": ",".signalMemory\n    ",".controlMemory = ","\n"])),a,t.$0,n.$1,a,n.$0,a,a,n.$1)},messageReceivers:e=>{let{state:n,globs:t}=e;return{"0_message":oo([ro("Message","m")],"void")(Ap||(Ap=r(["\n        if (\n            msg_isMatching(m, [MSG_STRING_TOKEN, MSG_FLOAT_TOKEN])\n            && msg_readStringToken(m, 0) === 'set'\n        ) {\n            ",".signalMemory = msg_readFloatToken(m, 1)\n            return\n\n        } else if (\n            msg_isMatching(m, [MSG_STRING_TOKEN, MSG_FLOAT_TOKEN])\n            && msg_readStringToken(m, 0) === 'reset'\n        ) {\n            ",".controlMemory = msg_readFloatToken(m, 1)\n            return\n\n        } else if (\n            msg_isMatching(m, [MSG_STRING_TOKEN])\n            && msg_readStringToken(m, 0) === 'reset'\n        ) {\n            ",".controlMemory = 1e20\n            return\n        }\n    "])),n,n,n)}},initialization:e=>{let{node:{args:n},state:t}=e;return uo(Mp||(Mp=r(["\n        ","\n    "])),ao(Pp.stateClass,t,"{\n            signalMemory: 0,\n            controlMemory: 0,\n        }"))},dependencies:[()=>lo([io(Pp.stateClass,[ro("Float","signalMemory"),ro("Float","controlMemory")])])]};var Rp,Lp,Dp;const Up={translateArgs:()=>({}),build:()=>({inlets:{0:{type:"signal",id:"0"},"0_message":{type:"message",id:"0_message"}},outlets:{0:{type:"message",id:"0"}},isPullingSignal:!0}),configureMessageToSignalConnection:e=>{if("0"===e)return{reroutedMessageInletId:"0_message"}}},jp=ac("snapshot_t"),zp={loop:e=>{let{ins:n,state:t}=e;return uo(Lp||(Lp=r(["\n    ",".currentValue = ","\n"])),t,n.$0)},messageReceivers:e=>{let{state:n,snds:t}=e;return{"0_message":oo([ro("Message","m")],"void")(Dp||(Dp=r(["\n        if (msg_isBang(m)) {\n            ","(msg_floats([",".currentValue]))\n            return \n        }\n    "])),t.$0,n)}},initialization:e=>{let{state:n}=e;return uo(Rp||(Rp=r(["\n        ","\n    "])),ao(jp.stateClass,n,"{\n            currentValue: 0\n        }"))},dependencies:[gd,()=>lo([io(jp.stateClass,[ro("Float","currentValue")])])]};var Bp;var Vp,Gp,Wp,$p,Hp;const Kp={codeGenerator:()=>lo([io("LineSegment",[ro("Point","p0"),ro("Point","p1"),ro("Float","dx"),ro("Float","dy")]),so("computeSlope",[ro("Point","p0"),ro("Point","p1")],"Float")(Vp||(Vp=r(["\n            return p1.x !== p0.x ? (p1.y - p0.y) / (p1.x - p0.x) : 0\n        "]))),so("removePointsBeforeFrame",[ro("Array<Point>","points"),ro("Float","frame")],"Array<Point>")(Gp||(Gp=r(["\n            ","\n            ","\n            while (i < points.length) {\n                if (frame <= points[i].x) {\n                    newPoints.push(points[i])\n                }\n                i++\n            }\n            return newPoints\n        "])),ao("Array<Point>","newPoints","[]"),ro("Int","i","0")),so("insertNewLinePoints",[ro("Array<Point>","points"),ro("Point","p0"),ro("Point","p1")],"Array<Point>")(Wp||(Wp=r(["\n            ","\n            ","\n            \n            // Keep the points that are before the new points added\n            while (i < points.length && points[i].x <= p0.x) {\n                newPoints.push(points[i])\n                i++\n            }\n            \n            // Find the start value of the start point :\n            \n            // 1. If there is a previous point and that previous point\n            // is on the same frame, we don't modify the start point value.\n            // (represents a vertical line).\n            if (0 < i - 1 && points[i - 1].x === p0.x) {\n\n            // 2. If new points are inserted in between already existing points \n            // we need to interpolate the existing line to find the startValue.\n            } else if (0 < i && i < points.length) {\n                newPoints.push({\n                    x: p0.x,\n                    y: interpolateLin(p0.x, points[i - 1], points[i])\n                })\n\n            // 3. If new line is inserted after all existing points, \n            // we just take the value of the last point\n            } else if (i >= points.length && points.length) {\n                newPoints.push({\n                    x: p0.x,\n                    y: points[points.length - 1].y,\n                })\n\n            // 4. If new line placed in first position, we take the defaultStartValue.\n            } else if (i === 0) {\n                newPoints.push({\n                    x: p0.x,\n                    y: p0.y,\n                })\n            }\n            \n            newPoints.push({\n                x: p1.x,\n                y: p1.y,\n            })\n            return newPoints\n        "])),ao("Array<Point>","newPoints","[]"),ro("Int","i","0")),so("computeFrameAjustedPoints",[ro("Array<Point>","points")],"Array<Point>")($p||($p=r(["\n            if (points.length < 2) {\n                throw new Error('invalid length for points')\n            }\n\n            ","\n            ","\n            ","\n            ","\n            ","\n            \n            while(i < points.length) {\n                p = points[i]\n                frameLower = Math.floor(p.x)\n                frameUpper = frameLower + 1\n\n                // I. Placing interpolated point at the lower bound of the current frame\n                // ------------------------------------------------------------------------\n                // 1. Point is already on an exact frame,\n                if (p.x === frameLower) {\n                    newPoints.push({ x: p.x, y: p.y })\n\n                    // 1.a. if several of the next points are also on the same X,\n                    // we find the last one to draw a vertical line.\n                    while (\n                        (i + 1) < points.length\n                        && points[i + 1].x === frameLower\n                    ) {\n                        i++\n                    }\n                    if (points[i].y !== newPoints[newPoints.length - 1].y) {\n                        newPoints.push({ x: points[i].x, y: points[i].y })\n                    }\n\n                    // 1.b. if last point, we quit\n                    if (i + 1 >= points.length) {\n                        break\n                    }\n\n                    // 1.c. if next point is in a different frame we can move on to next iteration\n                    if (frameUpper <= points[i + 1].x) {\n                        i++\n                        continue\n                    }\n                \n                // 2. Point isn't on an exact frame\n                // 2.a. There's a previous point, the we use it to interpolate the value.\n                } else if (newPoints.length) {\n                    newPoints.push({\n                        x: frameLower,\n                        y: interpolateLin(frameLower, points[i - 1], p),\n                    })\n                \n                // 2.b. It's the very first point, then we don't change its value.\n                } else {\n                    newPoints.push({ x: frameLower, y: p.y })\n                }\n\n                // II. Placing interpolated point at the upper bound of the current frame\n                // ---------------------------------------------------------------------------\n                // First, we find the closest point from the frame upper bound (could be the same p).\n                // Or could be a point that is exactly placed on frameUpper.\n                while (\n                    (i + 1) < points.length \n                    && (\n                        Math.ceil(points[i + 1].x) === frameUpper\n                        || Math.floor(points[i + 1].x) === frameUpper\n                    )\n                ) {\n                    i++\n                }\n                p = points[i]\n\n                // 1. If the next point is directly in the next frame, \n                // we do nothing, as this corresponds with next iteration frameLower.\n                if (Math.floor(p.x) === frameUpper) {\n                    continue\n                \n                // 2. If there's still a point after p, we use it to interpolate the value\n                } else if (i < points.length - 1) {\n                    newPoints.push({\n                        x: frameUpper,\n                        y: interpolateLin(frameUpper, p, points[i + 1]),\n                    })\n\n                // 3. If it's the last point, we dont change the value\n                } else {\n                    newPoints.push({ x: frameUpper, y: p.y })\n                }\n\n                i++\n            }\n\n            return newPoints\n        "])),ao("Array<Point>","newPoints","[]"),ro("Int","i","0"),ro("Point","p","points[0]"),ro("Float","frameLower","0"),ro("Float","frameUpper","0")),so("computeLineSegments",[ro("Array<Point>","points")],"Array<LineSegment>")(Hp||(Hp=r(["\n            ","\n            ","\n            ","\n            ","\n\n            while(i < points.length - 1) {\n                p0 = points[i]\n                p1 = points[i + 1]\n                lineSegments.push({\n                    p0, p1, \n                    dy: computeSlope(p0, p1),\n                    dx: 1,\n                })\n                i++\n            }\n            return lineSegments\n        "])),ao("Array<LineSegment>","lineSegments","[]"),ro("Int","i","0"),ro("Point","p0"),ro("Point","p1"))]),dependencies:[{codeGenerator:()=>so("interpolateLin",[ro("Float","x"),ro("Point","p0"),ro("Point","p1")],"Float")(Bp||(Bp=r(["\n            return p0.y + (x - p0.x) * (p1.y - p0.y) / (p1.x - p0.x)\n        "]))),dependencies:[()=>io("Point",[ro("Float","x"),ro("Float","y")])]}]};var qp;const Yp=()=>so("computeUnitInSamples",[ro("Float","sampleRate"),ro("Float","amount"),ro("string","unit")],"Float")(qp||(qp=r(["\n        if (unit === 'msec' || unit === 'millisecond') {\n            return amount / 1000 * sampleRate\n        } else if (unit === 'sec' || unit === 'seconds' || unit === 'second') {\n            return amount * sampleRate\n        } else if (unit === 'min' || unit === 'minutes' || unit === 'minute') {\n            return amount * 60 * sampleRate\n        } else if (unit === 'samp' || unit === 'samples' || unit === 'sample') {\n            return amount\n        } else {\n            throw new Error(\"invalid time unit : \" + unit)\n        }\n    "])));var Xp,Jp,Qp,Zp,eg,ng;const tg=ac("vline_t",["setNewLine","setNextDuration","setNextDelay"]),rg={loop:e=>{let{outs:n,state:t,globs:a}=e;return uo(eg||(eg=r(["\n    if (",".lineSegments.length) {\n        if (toFloat(",") < ",".lineSegments[0].p0.x) {\n\n        // This should come first to handle vertical lines\n        } else if (toFloat(",") === ",".lineSegments[0].p1.x) {\n            ",".currentValue = ",".lineSegments[0].p1.y\n            ",".lineSegments.shift()\n\n        } else if (toFloat(",") === ",".lineSegments[0].p0.x) {\n            ",".currentValue = ",".lineSegments[0].p0.y\n\n        } else if (toFloat(",") < ",".lineSegments[0].p1.x) {\n            ",".currentValue += ",".lineSegments[0].dy\n\n        }\n    }\n    "," = ",".currentValue\n"])),t,a.frame,t,a.frame,t,t,t,t,a.frame,t,t,t,a.frame,t,t,t,n.$0,t)},messageReceivers:e=>{let{state:n}=e;return{0:oo([ro("Message","m")])(ng||(ng=r(["\n    if (\n        msg_isMatching(m, [MSG_FLOAT_TOKEN])\n        || msg_isMatching(m, [MSG_FLOAT_TOKEN, MSG_FLOAT_TOKEN])\n        || msg_isMatching(m, [MSG_FLOAT_TOKEN, MSG_FLOAT_TOKEN, MSG_FLOAT_TOKEN])\n    ) {\n        switch (msg_getLength(m)) {\n            case 3:\n                ","(",", msg_readFloatToken(m, 2))\n            case 2:\n                ","(",", msg_readFloatToken(m, 1))\n            case 1:\n                ","(",", msg_readFloatToken(m, 0))\n        }\n        return\n\n    } else if (msg_isAction(m, 'stop')) {\n        ",".points = []\n        ",".lineSegments = []\n        return\n    }\n    "])),tg.setNextDelay,n,tg.setNextDuration,n,tg.setNewLine,n,n,n),1:rc(tg.setNextDuration,n),2:rc(tg.setNextDelay,n)}},initialization:e=>{let{state:n}=e;return uo(Zp||(Zp=r(["\n        ","\n    "])),ao(tg.stateClass,n,"{\n            points: [],\n            lineSegments: [],\n            currentValue: 0,\n            nextDurationSamp: 0,\n            nextDelaySamp: 0,\n        }"))},dependencies:[Kp,Yp,hd,e=>{let{globs:n}=e;return lo([io(tg.stateClass,[ro("Array<Point>","points"),ro("Array<LineSegment>","lineSegments"),ro("Float","currentValue"),ro("Float","nextDurationSamp"),ro("Float","nextDelaySamp")]),so(tg.setNewLine,[ro(tg.stateClass,"state"),ro("Float","targetValue")],"void")(Xp||(Xp=r(["\n        state.points = removePointsBeforeFrame(state.points, toFloat(","))\n        ","\n        ","\n        if (endFrame === toFloat(",")) {\n            state.currentValue = targetValue\n            state.lineSegments = []\n        } else {\n            state.points = insertNewLinePoints(\n                state.points, \n                {x: startFrame, y: state.currentValue},\n                {x: endFrame, y: targetValue}\n            )\n            state.lineSegments = computeLineSegments(\n                computeFrameAjustedPoints(state.points))\n        }\n        state.nextDurationSamp = 0\n        state.nextDelaySamp = 0\n    "])),n.frame,ao("Float","startFrame","toFloat(".concat(n.frame,") + state.nextDelaySamp")),ao("Float","endFrame","startFrame + state.nextDurationSamp"),n.frame),so(tg.setNextDuration,[ro(tg.stateClass,"state"),ro("Float","durationMsec")],"void")(Jp||(Jp=r(["\n        state.nextDurationSamp = computeUnitInSamples(",", durationMsec, 'msec')\n    "])),n.sampleRate),so(tg.setNextDelay,[ro(tg.stateClass,"state"),ro("Float","delayMsec")],"void")(Qp||(Qp=r(["\n        state.nextDelaySamp = computeUnitInSamples(",", delayMsec, 'msec')\n    "])),n.sampleRate)])}]};var ag,sg,og,ig,lg,ug;const cg={translateArgs:e=>{let{args:n}=e;return{initValue:Ku(n[0])||0}},build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"signal",id:"0"}}})},dg=ac("line_t",["defaultLine","setNewLine","setNextDuration","stop"]),fg={initialization:e=>{let{state:n,node:{args:t}}=e;return uo(ig||(ig=r(["\n        ","\n    "])),ao(dg.stateClass,n,"{\n            currentLine: ".concat(dg.defaultLine,",\n            currentValue: ").concat(t.initValue,",\n            nextDurationSamp: 0,\n        }")))},messageReceivers:e=>{let{state:n}=e;return{0:oo([ro("Message","m")])(lg||(lg=r(["\n        if (\n            msg_isMatching(m, [MSG_FLOAT_TOKEN])\n            || msg_isMatching(m, [MSG_FLOAT_TOKEN, MSG_FLOAT_TOKEN])\n        ) {\n            switch (msg_getLength(m)) {\n                case 2:\n                    ","(",", msg_readFloatToken(m, 1))\n                case 1:\n                    ","(",", msg_readFloatToken(m, 0))\n            }\n            return\n\n        } else if (msg_isAction(m, 'stop')) {\n            ","(",")\n            return\n\n        }\n    "])),dg.setNextDuration,n,dg.setNewLine,n,dg.stop,n),1:rc(dg.setNextDuration,n)}},loop:e=>{let{outs:n,state:t,globs:a}=e;return uo(ug||(ug=r(["\n    "," = ",".currentValue\n    if (toFloat(",") < ",".currentLine.p1.x) {\n        ",".currentValue += ",".currentLine.dy\n        if (toFloat("," + 1) >= ",".currentLine.p1.x) {\n            ",".currentValue = ",".currentLine.p1.y\n        }\n    }\n"])),n.$0,t,a.frame,t,t,t,a.frame,t,t,t)},dependencies:[hd,Yp,Kp,e=>{let{globs:n}=e;return lo([io(dg.stateClass,[ro("LineSegment","currentLine"),ro("Float","currentValue"),ro("Float","nextDurationSamp")]),ao("LineSegment",dg.defaultLine,"{\n        p0: {x: -1, y: 0},\n        p1: {x: -1, y: 0},\n        dx: 1,\n        dy: 0,\n    }"),so(dg.setNewLine,[ro(dg.stateClass,"state"),ro("Float","targetValue")],"void")(ag||(ag=r(["\n        ","\n        ","\n        if (endFrame === toFloat(",")) {\n            state.currentLine = ","\n            state.currentValue = targetValue\n            state.nextDurationSamp = 0\n        } else {\n            state.currentLine = {\n                p0: {\n                    x: startFrame, \n                    y: state.currentValue,\n                }, \n                p1: {\n                    x: endFrame, \n                    y: targetValue,\n                }, \n                dx: 1,\n                dy: 0,\n            }\n            state.currentLine.dy = computeSlope(state.currentLine.p0, state.currentLine.p1)\n            state.nextDurationSamp = 0\n        }\n    "])),ao("Float","startFrame","toFloat(".concat(n.frame,")")),ao("Float","endFrame","toFloat(".concat(n.frame,") + state.nextDurationSamp")),n.frame,dg.defaultLine),so(dg.setNextDuration,[ro(dg.stateClass,"state"),ro("Float","durationMsec")],"void")(sg||(sg=r(["\n        state.nextDurationSamp = computeUnitInSamples(",", durationMsec, 'msec')\n    "])),n.sampleRate),so(dg.stop,[ro(dg.stateClass,"state")],"void")(og||(og=r(["\n        state.currentLine.p1.x = -1\n        state.currentLine.p1.y = state.currentValue\n    "])))])}]};var pg,gg,mg,hg,yg,bg,vg,Sg,wg,_g,kg,Ig,Tg;const xg={translateArgs:e=>{let{args:n}=e;return{initValue:Ku(n[0])||0,timeGrainMsec:Math.max(Ku(n[1])||20,20)}},build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"},2:{type:"message",id:"2"}},outlets:{0:{type:"message",id:"0"}},isPushingMessages:!0})},Og=ac("line",["setNewLine","setNextDuration","setGrain","stopCurrentLine","setNextSamp","incrementTime","tick","scheduleNextTick"]),Cg={initialization:e=>{let{node:{args:n,id:t},state:a,snds:s}=e;return uo(wg||(wg=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            ","(",", ",")\n            ",".tickCallback = ","\n        })\n    "])),ao(Og.stateClass,a,uo(_g||(_g=r(["{\n            currentLine: {\n                p0: {x: -1, y: 0},\n                p1: {x: -1, y: 0},\n                dx: 1,\n                dy: 0,\n            },\n            currentValue: ",",\n            nextSamp: -1,\n            nextSampInt: -1,\n            grainSamp: 0,\n            nextDurationSamp: 0,\n            skedId: SKED_ID_NULL,\n            snd0: ",",\n            tickCallback: ",",\n        }"])),n.initValue,s.$0,oo()(kg||(kg=r([""]))))),Og.setGrain,a,n.timeGrainMsec,a,oo()(Ig||(Ig=r(["\n                ","(",")\n            "])),Og.tick,a))},messageReceivers:e=>{let{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(Tg||(Tg=r(["\n        if (\n            msg_isMatching(m, [MSG_FLOAT_TOKEN])\n            || msg_isMatching(m, [MSG_FLOAT_TOKEN, MSG_FLOAT_TOKEN])\n            || msg_isMatching(m, [MSG_FLOAT_TOKEN, MSG_FLOAT_TOKEN, MSG_FLOAT_TOKEN])\n        ) {\n            ","(",")\n            switch (msg_getLength(m)) {\n                case 3:\n                    ","(",", msg_readFloatToken(m, 2))\n                case 2:\n                    ","(",", msg_readFloatToken(m, 1))\n                case 1:\n                    ","\n                    if (",".nextDurationSamp === 0) {\n                        ",".currentValue = targetValue\n                        ","(msg_floats([targetValue]))\n                    } else {\n                        ","(msg_floats([",".currentValue]))\n                        ","(",", targetValue)\n                        ","(",", ",".currentLine.dx)\n                        ","(",")\n                    }\n                    \n            }\n            return\n\n        } else if (msg_isAction(m, 'stop')) {\n            ","(",")\n            return\n\n        } else if (\n            msg_isMatching(m, [MSG_STRING_TOKEN, MSG_FLOAT_TOKEN])\n            && msg_readStringToken(m, 0) === 'set'\n        ) {\n            ","(",")\n            ",".currentValue = msg_readFloatToken(m, 1)\n            return\n        }\n    "])),Og.stopCurrentLine,t,Og.setGrain,t,Og.setNextDuration,t,ao("Float","targetValue","msg_readFloatToken(m, 0)"),t,t,n.$0,n.$0,t,Og.setNewLine,t,Og.incrementTime,t,t,Og.scheduleNextTick,t,Og.stopCurrentLine,t,Og.stopCurrentLine,t,t),1:rc(Og.setNextDuration,t),2:rc(Og.setGrain,t)}},dependencies:[hd,Yp,Kp,gi,mi,e=>{let{globs:n}=e;return lo([io(Og.stateClass,[ro("LineSegment","currentLine"),ro("Float","currentValue"),ro("Float","nextSamp"),ro("Int","nextSampInt"),ro("Float","grainSamp"),ro("Float","nextDurationSamp"),ro("SkedId","skedId"),ro("(m: Message) => void","snd0"),ro("SkedCallback","tickCallback")]),so(Og.setNewLine,[ro(Og.stateClass,"state"),ro("Float","targetValue")],"void")(pg||(pg=r(["\n        state.currentLine = {\n            p0: {\n                x: toFloat(","), \n                y: state.currentValue,\n            }, \n            p1: {\n                x: toFloat(",") + state.nextDurationSamp, \n                y: targetValue,\n            }, \n            dx: state.grainSamp\n        }\n        state.nextDurationSamp = 0\n        state.currentLine.dy = computeSlope(state.currentLine.p0, state.currentLine.p1) * state.grainSamp\n    "])),n.frame,n.frame),so(Og.setNextDuration,[ro(Og.stateClass,"state"),ro("Float","durationMsec")],"void")(gg||(gg=r(["\n        state.nextDurationSamp = computeUnitInSamples(",", durationMsec, 'msec')\n    "])),n.sampleRate),so(Og.setGrain,[ro(Og.stateClass,"state"),ro("Float","grainMsec")],"void")(mg||(mg=r(["\n        state.grainSamp = computeUnitInSamples(",", Math.max(grainMsec, ","), 'msec')\n    "])),n.sampleRate,20),so(Og.stopCurrentLine,[ro(Og.stateClass,"state")],"void")(hg||(hg=r(["\n        if (state.skedId !== SKED_ID_NULL) {\n            commons_cancelWaitFrame(state.skedId)\n            state.skedId = SKED_ID_NULL\n        }\n        if ("," < state.nextSampInt) {\n            ","(state, -1 * (state.nextSamp - toFloat(",")))\n        }\n        ","(state, -1)\n    "])),n.frame,Og.incrementTime,n.frame,Og.setNextSamp),so(Og.setNextSamp,[ro(Og.stateClass,"state"),ro("Float","currentSamp")],"void")(yg||(yg=r(["\n        state.nextSamp = currentSamp\n        state.nextSampInt = toInt(Math.round(currentSamp))\n    "]))),so(Og.incrementTime,[ro(Og.stateClass,"state"),ro("Float","incrementSamp")],"void")(bg||(bg=r(["\n        if (incrementSamp === state.currentLine.dx) {\n            state.currentValue += state.currentLine.dy\n        } else {\n            state.currentValue += interpolateLin(\n                incrementSamp,\n                {x: 0, y: 0},\n                {x: state.currentLine.dx, y: state.currentLine.dy},\n            )\n        }\n        ","(\n            state, \n            (state.nextSamp !== -1 ? state.nextSamp: toFloat(",")) + incrementSamp\n        )\n    "])),Og.setNextSamp,n.frame),so(Og.tick,[ro(Og.stateClass,"state")],"void")(vg||(vg=r(["\n        state.snd0(msg_floats([state.currentValue]))\n        if (toFloat(",") >= state.currentLine.p1.x) {\n            state.currentValue = state.currentLine.p1.y\n            ","(state)\n        } else {\n            ","(state, state.currentLine.dx)\n            ","(state)\n        }\n    "])),n.frame,Og.stopCurrentLine,Og.incrementTime,Og.scheduleNextTick),so(Og.scheduleNextTick,[ro(Og.stateClass,"state")],"void")(Sg||(Sg=r(["\n        state.skedId = commons_waitFrame(state.nextSampInt, state.tickCallback)\n    "])))])}]};var Mg,Eg,Ag;const Fg=440*Math.pow(2,1430/12),Pg=()=>so("mtof",[ro("Float","value")],"Float")(Mg||(Mg=r(["\n        return value <= -1500 ? 0: (value > 1499 ? "," : Math.pow(2, (value - 69) / 12) * 440)\n    "])),Fg),Ng=()=>so("ftom",[ro("Float","value")],"Float")(Eg||(Eg=r(["\n        return value <= 0 ? -1500: 12 * Math.log(value / 440) / Math.LN2 + 69\n    "]))),Rg=()=>so("pow",[ro("Float","leftOp"),ro("Float","rightOp")],"Float")(Ag||(Ag=r(["\n        return leftOp > 0 || (Math.round(rightOp) === rightOp) ? Math.pow(leftOp, rightOp): 0\n    "])));var Lg,Dg,Ug,jg,zg,Bg;const Vg={translateArgs:()=>({}),build:()=>({inlets:{0:{type:"signal",id:"0"}},outlets:{0:{type:"signal",id:"0"}}})},Gg={"abs~":{inlineLoop:e=>{let{ins:n}=e;return uo(Lg||(Lg=r(["Math.abs(",")"])),n.$0)}},"cos~":{inlineLoop:e=>{let{ins:n}=e;return uo(Dg||(Dg=r(["Math.cos("," * 2 * Math.PI)"])),n.$0)}},"wrap~":{inlineLoop:e=>{let{ins:n}=e;return uo(Ug||(Ug=r(["(1 + ("," % 1)) % 1"])),n.$0)}},"sqrt~":{inlineLoop:e=>{let{ins:n}=e;return uo(jg||(jg=r([""," >= 0 ? Math.pow(",", 0.5): 0"])),n.$0,n.$0)}},"mtof~":{inlineLoop:e=>{let{ins:n}=e;return uo(zg||(zg=r(["mtof(",")"])),n.$0)},dependencies:[Pg]},"ftom~":{inlineLoop:e=>{let{ins:n}=e;return uo(Bg||(Bg=r(["ftom(",")"])),n.$0)},dependencies:[Ng]}},Wg={"abs~":Vg,"cos~":Vg,"wrap~":Vg,"sqrt~":Vg,"mtof~":Vg,"ftom~":Vg};var $g,Hg,Kg;const qg=e=>({arrayName:qu(e.args[0])||""}),Yg=ac("tabbase",["setArrayName","createState","prepareIndex","emptyArray"]),Xg=()=>lo([ao("FloatArray",Yg.emptyArray,"createFloatArray(1)"),io(Yg.stateClass,[ro("FloatArray","array"),ro("string","arrayName"),ro("SkedId","arrayChangesSubscription"),ro("Int","readPosition"),ro("Int","readUntil"),ro("Int","writePosition")]),so(Yg.createState,[ro("string","arrayName")],Yg.stateClass)($g||($g=r(["\n        return {\n            array: ",",\n            arrayName,\n            arrayChangesSubscription: SKED_ID_NULL,\n            readPosition: 0,\n            readUntil: 0,\n            writePosition: 0,\n        }\n    "])),Yg.emptyArray),so(Yg.setArrayName,[ro(Yg.stateClass,"state"),ro("string","arrayName"),ro("SkedCallback","callback")],"void")(Hg||(Hg=r(["\n        if (state.arrayChangesSubscription != SKED_ID_NULL) {\n            commons_cancelArrayChangesSubscription(state.arrayChangesSubscription)\n        }\n        state.arrayName = arrayName\n        state.array = ","\n        commons_subscribeArrayChanges(arrayName, callback)\n    "])),Yg.emptyArray),so(Yg.prepareIndex,[ro("Float","index"),ro("Int","arrayLength")],"Int")(Kg||(Kg=r(["\n        return toInt(Math.min(\n            Math.max(\n                0, Math.floor(index)\n            ), toFloat(arrayLength - 1)\n        ))\n    "])))]);var Jg,Qg,Zg;const em={translateArgs:qg,build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"message",id:"0"}}})},nm=ac("tabread",["setArrayNameFinalize"]),tm={initialization:e=>{let{node:{args:n},state:t}=e;return uo(Jg||(Jg=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            if (",".arrayName.length) {\n                ","(\n                    ",", \n                    ",".arrayName,\n                    () => ","(",")\n                )\n            }\n        })\n    "])),ao(Yg.stateClass,t,"".concat(Yg.createState,'("').concat(n.arrayName,'")')),t,Yg.setArrayName,t,t,nm.setArrayNameFinalize,t)},messageReceivers:e=>{const{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(Qg||(Qg=r(["\n                if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {        \n                    if (",".array.length === 0) {\n                        ","(msg_floats([0]))\n\n                    } else {\n                        ","(msg_floats([",".array[\n                            ","(\n                                msg_readFloatToken(m, 0), \n                                ",".array.length\n                            )\n                        ]]))\n                    }\n                    return \n\n                } else if (\n                    msg_isMatching(m, [MSG_STRING_TOKEN, MSG_STRING_TOKEN])\n                    && msg_readStringToken(m, 0) === 'set'\n                ) {\n                    ","(\n                        ",", \n                        msg_readStringToken(m, 1),\n                        () => ","(",")\n                    )\n                    return\n            \n                }\n            "])),t,n.$0,n.$0,t,Yg.prepareIndex,t,Yg.setArrayName,t,nm.setArrayNameFinalize,t)}},dependencies:[gi,pi,Xg,()=>lo([so(nm.setArrayNameFinalize,[ro(Yg.stateClass,"state")],"void")(Zg||(Zg=r(["\n                state.array = commons_getArray(state.arrayName)\n            "])))])]};var rm,am,sm,om;const im={translateArgs:qg,build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{}})},lm=ac("tabwrite",["setArrayNameFinalize","setWritePosition"]),um={initialization:e=>{let{node:{args:n},state:t}=e;return uo(rm||(rm=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            if (",".arrayName.length) {\n                ","(\n                    ",", \n                    ",".arrayName,\n                    () => ","(",")\n                )\n            }\n        })\n    "])),ao(Yg.stateClass,t,"".concat(Yg.createState,'("').concat(n.arrayName,'")')),t,Yg.setArrayName,t,t,lm.setArrayNameFinalize,t)},messageReceivers:e=>{const{state:n}=e;return{0:oo([ro("Message","m")])(am||(am=r(["\n                if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {        \n                    if (",".array.length === 0) {\n                        return\n    \n                    } else {\n                        ",".array[",".writePosition] = msg_readFloatToken(m, 0)\n                        return\n                    }\n    \n                } else if (\n                    msg_isMatching(m, [MSG_STRING_TOKEN, MSG_STRING_TOKEN])\n                    && msg_readStringToken(m, 0) === 'set'\n                ) {\n                    ","(\n                        ",", \n                        msg_readStringToken(m, 1),\n                        () => ","(","),\n                    )\n                    return\n            \n                }\n            "])),n,n,n,Yg.setArrayName,n,lm.setArrayNameFinalize,n),1:rc(lm.setWritePosition,n)}},dependencies:[gi,pi,Xg,()=>lo([so(lm.setArrayNameFinalize,[ro(Yg.stateClass,"state")],"void")(sm||(sm=r(["\n                state.array = commons_getArray(state.arrayName)\n            "]))),so(lm.setWritePosition,[ro(Yg.stateClass,"state"),ro("Float","writePosition")],"void")(om||(om=r(["\n                state.writePosition = ","(writePosition, state.array.length)\n            "])),Yg.prepareIndex)])]};var cm,dm,fm,pm;const gm={translateArgs:e=>({arrayName:qu(e.args[0])||""}),build:()=>({inlets:{0:{type:"signal",id:"0"},"0_message":{type:"message",id:"0_message"}},outlets:{0:{type:"signal",id:"0"}}}),configureMessageToSignalConnection:e=>{if("0"===e)return{reroutedMessageInletId:"0_message"}}},mm=ac("tabread_t",["setArrayNameFinalize"]),hm={initialization:e=>{let{node:{args:n},state:t}=e;return uo(cm||(cm=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            if (",".arrayName.length) {\n                ","(\n                    ",", \n                    ",".arrayName,\n                    () => ","(",")\n                )\n            }\n        })\n    "])),ao(Yg.stateClass,t,"".concat(Yg.createState,'("').concat(n.arrayName,'")')),t,Yg.setArrayName,t,t,mm.setArrayNameFinalize,t)},messageReceivers:e=>{let{state:n}=e;return{"0_message":oo([ro("Message","m")])(dm||(dm=r(["\n            if (\n                msg_isMatching(m, [MSG_STRING_TOKEN, MSG_STRING_TOKEN])\n                && msg_readStringToken(m, 0) === 'set'\n            ) {\n                ","(\n                    ",",\n                    msg_readStringToken(m, 1),\n                    () => ","(","),\n                )\n                return\n    \n            }\n        "])),Yg.setArrayName,n,mm.setArrayNameFinalize,n)}},inlineLoop:e=>{let{ins:n,state:t}=e;return uo(fm||(fm=r(["",".array[toInt(Math.max(Math.min(Math.floor(","), ",".array.length - 1), 0))]"])),t,n.$0,t)},dependencies:[gd,gi,pi,hd,Xg,()=>lo([so(mm.setArrayNameFinalize,[ro(Yg.stateClass,"state")],"void")(pm||(pm=r(["\n                state.array = commons_getArray(state.arrayName)\n            "])))])]},ym={"tabread~":gm,"tabread4~":gm},bm={"tabread~":hm,"tabread4~":hm};var vm,Sm,wm,_m,km,Im;const Tm={translateArgs:e=>({arrayName:qu(e.args[0])||""}),build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"signal",id:"0"},1:{type:"message",id:"1"}}})},xm=ac("tabplay_t",["setArrayNameFinalize","play","stop"]),Om={initialization:e=>{let{node:{args:n},state:t}=e;return uo(vm||(vm=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            if (",".arrayName.length) {\n                ","(\n                    ",", \n                    ",".arrayName,\n                    () => ","(",")\n                )\n            }\n        })\n    "])),ao(Yg.stateClass,t,"".concat(Yg.createState,'("').concat(n.arrayName,'")')),t,Yg.setArrayName,t,t,xm.setArrayNameFinalize,t)},messageReceivers:e=>{let{state:n}=e;return{0:oo([ro("Message","m")])(Sm||(Sm=r(["\n            if (msg_isBang(m)) {\n                ","(",", 0, ",".array.length)\n                return \n                \n            } else if (msg_isAction(m, 'stop')) {\n                ","(",")\n                return \n    \n            } else if (\n                msg_isMatching(m, [MSG_STRING_TOKEN, MSG_STRING_TOKEN])\n                && msg_readStringToken(m, 0) === 'set'\n            ) {\n                ","(\n                    ",",\n                    msg_readStringToken(m, 1),\n                    () => ","(","),\n                )\n                return\n    \n            } else if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n                ","(\n                    ",",\n                    toInt(msg_readFloatToken(m, 0)), \n                    ",".array.length\n                )\n                return \n    \n            } else if (msg_isMatching(m, [MSG_FLOAT_TOKEN, MSG_FLOAT_TOKEN])) {\n                ","\n                ","(\n                    ",",\n                    fromSample,\n                    fromSample + toInt(msg_readFloatToken(m, 1)),\n                )\n                return\n            }\n        "])),xm.play,n,n,xm.stop,n,Yg.setArrayName,n,xm.setArrayNameFinalize,n,xm.play,n,n,ao("Int","fromSample","toInt(msg_readFloatToken(m, 0))"),xm.play,n)}},loop:e=>{let{state:n,snds:t,outs:a}=e;return uo(wm||(wm=r(["\n        if (",".readPosition < ",".readUntil) {\n            "," = ",".array[",".readPosition]\n            ",".readPosition++\n            if (",".readPosition >= ",".readUntil) {\n                ","(msg_bang())\n            }\n        } else {\n            "," = 0\n        }\n    "])),n,n,a.$0,n,n,n,n,n,t.$1,a.$0)},dependencies:[gd,gi,pi,hd,Xg,()=>lo([so(xm.setArrayNameFinalize,[ro(Yg.stateClass,"state")],"void")(_m||(_m=r(["\n                state.array = commons_getArray(state.arrayName)\n                state.readPosition = state.array.length\n                state.readUntil = state.array.length\n            "]))),so(xm.play,[ro(Yg.stateClass,"state"),ro("Int","playFrom"),ro("Int","playTo")],"void")(km||(km=r(["\n                state.readPosition = playFrom\n                state.readUntil = toInt(Math.min(\n                    toFloat(playTo), \n                    toFloat(state.array.length),\n                ))\n            "]))),so(xm.stop,[ro(Yg.stateClass,"state")],"void")(Im||(Im=r(["\n                state.readPosition = 0\n                state.readUntil = 0\n            "])))])]};var Cm,Mm;const Em={codeGenerator:()=>so("parseSoundFileOpenOpts",[ro("Message","m"),ro("fs_SoundInfo","soundInfo")],"Set<Int>")(Cm||(Cm=r(["\n            ","\n            ","\n            while (i < msg_getLength(m)) {\n                if (msg_isStringToken(m, i)) {\n                    ","\n                    if (['-wave', '-aiff', '-caf', '-next', '-ascii'].includes(str)) {\n                        soundInfo.encodingFormat = str.slice(1)\n\n                    } else if (str === '-raw') {\n                        console.log('-raw format not yet supported')\n                        i += 4\n                        \n                    } else if (str === '-big') {\n                        soundInfo.endianness = 'b'\n\n                    } else if (str === '-little') {\n                        soundInfo.endianness = 'l'\n\n                    } else if (str === '-bytes') {\n                        if (i < msg_getLength(m) && msg_isFloatToken(m, i + 1)) {\n                            soundInfo.bitDepth = toInt(msg_readFloatToken(m, i + 1) * 8)\n                            i++\n                        } else {\n                            console.log('failed to parse -bytes <value>')\n                        }\n\n                    } else if (str === '-rate') {\n                        if (i < msg_getLength(m) && msg_isFloatToken(m, i + 1)) {\n                            soundInfo.sampleRate = toInt(msg_readFloatToken(m, i + 1))\n                            i++\n                        } else {\n                            console.log('failed to parse -rate <value>')\n                        }\n\n                    } else {\n                        unhandled.add(i)\n                    }\n                    \n                } else {\n                    unhandled.add(i)\n                }\n                i++\n            }\n            return unhandled\n        "])),ao("Set<Int>","unhandled","new Set()"),ro("Int","i","0"),ao("string","str","msg_readStringToken(m, i)")),dependencies:[Sl,zl]},Am={codeGenerator:()=>so("parseReadWriteFsOpts",[ro("Message","m"),ro("fs_SoundInfo","soundInfo"),ro("Set<Int>","unhandledOptions")],"string")(Mm||(Mm=r(['\n            // Remove the "open" token\n            unhandledOptions.delete(0)\n\n            ',"\n            ","\n            ","\n            ","\n            while (i < msg_getLength(m)) {\n                if (!unhandledOptions.has(i)) {\n\n                } else if (msg_isStringToken(m, i)) {\n                    url = msg_readStringToken(m, i)\n                    urlFound = true\n\n                } else {\n                    console.log(\"[writesf/readsf~] invalid option index \" + i.toString())\n                    errored = true\n                }\n                i++\n            }\n            if (!urlFound) {\n                console.log(\"[writesf/readsf~] invalid options, file url not found\")\n                return ''\n            }\n            if (errored) {\n                return ''\n            }\n            return url\n        "])),ro("string","url",'""'),ro("boolean","urlFound","false"),ro("boolean","errored","false"),ro("Int","i","1")),dependencies:[Sl,zl]};var Fm,Pm,Nm,Rm,Lm;const Dm={translateArgs:e=>({channelCount:Ku(e.args[0])||1}),build:e=>({inlets:{0:{type:"message",id:"0"}},outlets:{...Ls(Ns(e.channelCount),(e=>["".concat(e),{type:"signal",id:"".concat(e)}])),["".concat(e.channelCount)]:{type:"message",id:"".concat(e.channelCount)}}})},Um=ac("readsf_t",["openStream"]),jm={initialization:e=>{let{state:n}=e;return uo(Pm||(Pm=r(["\n        ","\n    "])),ao(Um.stateClass,n,"{\n            buffers: [],\n            streamOperationId: -1,\n            readingStatus: 0,\n        }"))},messageReceivers:e=>{let{node:n,state:t}=e;return{0:oo([ro("Message","m")])(Rm||(Rm=r(["\n        if (msg_getLength(m) >= 2) {\n            if (msg_isStringToken(m, 0) \n                && msg_readStringToken(m, 0) === 'open'\n            ) {\n                ","(\n                    ",",\n                    m,\n                    ",",\n                    ","\n                )\n                return\n            }\n\n        } else if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n            if (msg_readFloatToken(m, 0) === 0) {\n                ",".readingStatus = 3\n                return\n\n            } else {\n                if (",".streamOperationId !== -1) {\n                    ",".readingStatus = 1\n                } else {\n                    console.log('[readsf~] start requested without prior open')\n                }\n                return\n\n            }\n            \n        } else if (msg_isAction(m, 'print')) {\n            console.log('[readsf~] reading = ' + ",".readingStatus.toString())\n            return\n        }\n    "])),Um.openStream,t,n.args.channelCount,oo()(Lm||(Lm=r(["\n                        ",".streamOperationId = -1\n                        if (",".readingStatus === 1) {\n                            ",".readingStatus = 2\n                        } else {\n                            ",".readingStatus = 3\n                        }\n                    "])),t,t,t,t),t,t,t,t)}},loop:e=>{let{state:n,snds:t,outs:a,node:{args:{channelCount:s}}}=e;return uo(Nm||(Nm=r(["\n    switch(",".readingStatus) {\n        case 1: \n            ","\n            break\n            \n        case 2: \n            ","\n            if (",".buffers[0].pullAvailableLength === 0) {\n                ","(msg_bang())\n                ",".readingStatus = 3\n            }\n            break\n\n        case 3: \n            ","\n            ",".readingStatus = 0\n            break\n    }\n"])),n,Ns(s).map((e=>"".concat(a[e]," = buf_pullSample(").concat(n,".buffers[").concat(e,"])"))),Ns(s).map((e=>"".concat(a[e]," = buf_pullSample(").concat(n,".buffers[").concat(e,"])"))),n,t[s],n,Ns(s).map((e=>"".concat(a[e]," = 0"))),n)},dependencies:[Em,Am,gd,hd,Wl,e=>{let{globs:n}=e;return lo([io(Um.stateClass,[ro("Array<buf_SoundBuffer>","buffers"),ro("fs_OperationId","streamOperationId"),ro("Int","readingStatus")]),so(Um.openStream,[ro(Um.stateClass,"state"),ro("Message","m"),ro("Int","channelCount"),ro("fs_OperationCallback","onStreamClose")],"void")(Fm||(Fm=r(["\n        if (state.streamOperationId !== -1) {\n            state.readingStatus = 3\n            fs_closeSoundStream(state.streamOperationId, FS_OPERATION_SUCCESS)\n        }\n\n        ","\n        ","\n        ","\n        if (url.length === 0) {\n            return\n        }\n        state.streamOperationId = fs_openSoundReadStream(\n            url,\n            soundInfo,\n            onStreamClose,\n        )\n        state.buffers = _FS_SOUND_STREAM_BUFFERS.get(state.streamOperationId)\n    "])),ao("fs_SoundInfo","soundInfo","{\n            channelCount,\n            sampleRate: toInt(".concat(n.sampleRate,"),\n            bitDepth: 32,\n            encodingFormat: '',\n            endianness: '',\n            extraOptions: '',\n        }")),ao("Set<Int>","unhandledOptions","parseSoundFileOpenOpts(\n            m,\n            soundInfo,\n        )"),ao("string","url","parseReadWriteFsOpts(\n            m,\n            soundInfo,\n            unhandledOptions\n        )"))])}]};var zm,Bm,Vm,Gm;const Wm=220500,$m={translateArgs:e=>({channelCount:Ku(e.args[0])||1}),build:e=>{let{channelCount:n}=e;return{inlets:{"0_message":{type:"message",id:"0_message"},...Ls(Ns(n),(e=>["".concat(e),{type:"signal",id:"".concat(e)}]))},outlets:{},isPullingSignal:!0}},configureMessageToSignalConnection:e=>{if("0"===e)return{reroutedMessageInletId:"0_message"}}},Hm=ac("writesf_t",["flushBlock"]),Km={initialization:e=>{let{node:{args:n},state:t}=e;return uo(Bm||(Bm=r(["\n        ","\n    "])),ao(Hm.stateClass,t,"{\n            operationId: -1,\n            isWriting: false,\n            cursor: 0,\n            block: [\n                ".concat(Ns(n.channelCount).map((()=>"createFloatArray(".concat(Wm,")"))).join(","),"\n            ],\n        }")))},messageReceivers:e=>{let{node:n,state:t,globs:a}=e;return{"0_message":oo([ro("Message","m")],"void")(Gm||(Gm=r(["\n        if (msg_getLength(m) >= 2) {\n            if (\n                msg_isStringToken(m, 0) \n                && msg_readStringToken(m, 0) === 'open'\n            ) {\n                if (",".operationId !== -1) {\n                    fs_closeSoundStream(",".operationId, FS_OPERATION_SUCCESS)\n                }\n\n                ","\n                ","\n                ","\n                if (url.length === 0) {\n                    return\n                }\n                ",".operationId = fs_openSoundWriteStream(\n                    url,\n                    soundInfo,\n                    () => {\n                        ","(",")\n                        ",".operationId = -1\n                    }\n                )\n                return\n            }\n\n        } else if (msg_isAction(m, 'start')) {\n                ",".isWriting = true\n                return\n\n        } else if (msg_isAction(m, 'stop')) {\n            ","(",")\n            ",".isWriting = false\n            return\n\n        } else if (msg_isAction(m, 'print')) {\n            console.log('[writesf~] writing = ' + ",".isWriting.toString())\n            return\n        }    \n    "])),t,t,ao("fs_SoundInfo","soundInfo","{\n                    channelCount: ".concat(n.args.channelCount,",\n                    sampleRate: toInt(").concat(a.sampleRate,"),\n                    bitDepth: 32,\n                    encodingFormat: '',\n                    endianness: '',\n                    extraOptions: '',\n                }")),ao("Set<Int>","unhandledOptions","parseSoundFileOpenOpts(\n                    m,\n                    soundInfo,\n                )"),ao("string","url","parseReadWriteFsOpts(\n                    m,\n                    soundInfo,\n                    unhandledOptions\n                )"),t,Hm.flushBlock,t,t,t,Hm.flushBlock,t,t,t)}},loop:e=>{let{state:n,ins:t,node:{args:a}}=e;return uo(Vm||(Vm=r(["\n    if (",".isWriting === true) {\n        ","\n        ",".cursor++\n        if (",".cursor === ",") {\n            ","(",")\n        }\n    }\n"])),n,Ns(a.channelCount).map((e=>"".concat(n,".block[").concat(e,"][").concat(n,".cursor] = ").concat(t[e]))),n,n,Wm,Hm.flushBlock,n)},dependencies:[Em,Am,hd,$l,()=>lo([io(Hm.stateClass,[ro("fs_OperationId","operationId"),ro("boolean","isWriting"),ro("Array<FloatArray>","block"),ro("Int","cursor")]),so(Hm.flushBlock,[ro(Hm.stateClass,"state")],"void")(zm||(zm=r(["\n        ","\n        for (","; i < state.block.length; i++) {\n            block.push(state.block[i].subarray(0, state.cursor))\n        }\n        fs_sendSoundStreamData(state.operationId, block)\n        state.cursor = 0\n    "])),ao("Array<FloatArray>","block","[]"),ro("Int","i","0"))])]};var qm,Ym,Xm,Jm,Qm,Zm,eh;const nh={translateArgs:e=>{let{args:n}=e;return{frequency:Ku(n[0])||0,Q:Ku(n[1])||0}},build:()=>({inlets:{0:{type:"signal",id:"0"},"0_message":{type:"message",id:"0_message"},1:{type:"message",id:"1"},2:{type:"message",id:"2"}},outlets:{0:{type:"signal",id:"0"}}}),configureMessageToSignalConnection:e=>{if("0"===e)return{reroutedMessageInletId:"0_message"}}},th=ac("filter_bp_t",["updateCoefs","setFrequency","setQ","clear"]),rh={initialization:e=>{let{node:{args:n},state:t}=e;return uo(qm||(qm=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            ","(",")\n        })\n    "])),ao(th.stateClass,t,"{\n            frequency: ".concat(n.frequency,",\n            Q: ").concat(n.Q,",\n            coef1: 0,\n            coef2: 0,\n            gain: 0,\n            y: 0,\n            ym1: 0,\n            ym2: 0,\n        }")),th.updateCoefs,t)},loop:e=>{let{ins:n,outs:t,state:a}=e;return uo(Ym||(Ym=r(["\n        ",".y = "," + ",".coef1 * ",".ym1 + ",".coef2 * ",".ym2\n        "," = ",".gain * ",".y\n        ",".ym2 = ",".ym1\n        ",".ym1 = ",".y\n    "])),a,n.$0,a,a,a,a,t.$0,a,a,a,a,a,a)},messageReceivers:e=>{let{state:n}=e;return{"0_message":oo([ro("Message","m")],"void")(Xm||(Xm=r(["\n            if (\n                msg_isMatching(m)\n                && msg_readStringToken(m, 0) === 'clear'\n            ) {\n                ","()\n                return \n            }\n        "])),th.clear),1:rc(th.setFrequency,n),2:rc(th.setQ,n)}},dependencies:[e=>{let{globs:n}=e;return lo([io(th.stateClass,[ro("Float","frequency"),ro("Float","Q"),ro("Float","coef1"),ro("Float","coef2"),ro("Float","gain"),ro("Float","y"),ro("Float","ym1"),ro("Float","ym2")]),so(th.updateCoefs,[ro(th.stateClass,"state")],"void")(Jm||(Jm=r(["\n                ","\n                ","\n                ","\n                ","\n        \n                state.coef1 = 2.0 * sigbp_qcos * r\n                state.coef2 = - r * r\n                state.gain = 2 * oneminusr * (oneminusr + r * omega)\n            "])),ro("Float","omega","state.frequency * (2.0 * Math.PI) / ".concat(n.sampleRate)),ro("Float","oneminusr","state.Q < 0.001 ? 1.0 : Math.min(omega / state.Q, 1)"),ro("Float","r","1.0 - oneminusr"),ro("Float","sigbp_qcos","(omega >= -(0.5 * Math.PI) && omega <= 0.5 * Math.PI) ? \n                    (((Math.pow(omega, 6) * (-1.0 / 720.0) + Math.pow(omega, 4) * (1.0 / 24)) - Math.pow(omega, 2) * 0.5) + 1)\n                    : 0")),so(th.setFrequency,[ro(th.stateClass,"state"),ro("Float","frequency")],"void")(Qm||(Qm=r(["\n                state.frequency = (frequency < 0.001) ? 10: frequency\n                ","(state)\n            "])),th.updateCoefs),so(th.setQ,[ro(th.stateClass,"state"),ro("Float","Q")],"void")(Zm||(Zm=r(["\n                state.Q = Math.max(Q, 0)\n                ","(state)\n            "])),th.updateCoefs),so(th.clear,[ro(th.stateClass,"state")],"void")(eh||(eh=r(["\n                state.ym1 = 0\n                state.ym2 = 0\n            "])))])}]};var ah,sh,oh,ih,lh,uh,ch,dh;const fh={translateArgs:e=>({busName:qu(e.args[0])||""}),build:()=>({inlets:{0:{type:"signal",id:"0"},"0_message":{type:"message",id:"0_message"}},outlets:{},isPullingSignal:!0}),configureMessageToSignalConnection:e=>{if("0"===e)return{reroutedMessageInletId:"0_message"}}},ph={translateArgs:e=>({busName:qu(e.args[0])||""}),build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"signal",id:"0"}}})},gh={translateArgs:e=>({busName:qu(e.args[0])||""}),build:()=>({inlets:{0:{type:"signal",id:"0"}},outlets:{},isPullingSignal:!0})},mh={translateArgs:e=>({busName:qu(e.args[0])||""}),build:()=>({inlets:{},outlets:{0:{type:"signal",id:"0"}}})},hh=ac("throw_catch_send_receive_t",["setBusName"]),yh=()=>lo([io(hh.stateClass,[ro("string","busName")]),so(hh.setBusName,[ro(hh.stateClass,"state"),ro("string","busName")],"void")(ah||(ah=r(["\n        if (busName.length) {\n            state.busName = busName\n            resetSignalBus(state.busName)\n        }\n    "])))]),bh=e=>{let{node:{args:n},state:t}=e;return uo(sh||(sh=r(["\n        ","\n\n        ","(",', "','")\n    '])),ao(hh.stateClass,t,"{\n            busName: '',\n        }"),hh.setBusName,t,n.busName)},vh={"throw~":fh,"catch~":mh,"send~":gh,"receive~":ph},Sh={"throw~":{initialization:bh,loop:e=>{let{ins:n,state:t}=e;return uo(oh||(oh=r(["\n        addAssignSignalBus(",".busName, ",")\n    "])),t,n.$0)},messageReceivers:e=>{let{state:n}=e;return{"0_message":oo([ro("Message","m")],"void")(ih||(ih=r(["\n            if (\n                msg_isMatching(m, [MSG_STRING_TOKEN, MSG_STRING_TOKEN])\n                && msg_readStringToken(m, 0) === 'set'\n            ) {\n                ","(",", msg_readStringToken(m, 1))\n                return\n            }\n        "])),hh.setBusName,n)}},dependencies:[rd,yh]},"catch~":{initialization:bh,loop:e=>{let{outs:n,state:t}=e;return uo(lh||(lh=r(["\n        "," = readSignalBus(",".busName)\n        resetSignalBus(",".busName)\n    "])),n.$0,t,t)},dependencies:[rd,yh]},"send~":{initialization:bh,loop:e=>{let{state:n,ins:t}=e;return uo(uh||(uh=r(["\n        setSignalBus(",".busName, ",")\n    "])),n,t.$0)},dependencies:[rd,yh]},"receive~":{initialization:bh,inlineLoop:e=>{let{state:n}=e;return uo(ch||(ch=r(["readSignalBus(",".busName)"])),n)},messageReceivers:e=>{let{state:n}=e;return{0:oo([ro("Message","m")])(dh||(dh=r(["\n            if (\n                msg_isMatching(m, [MSG_STRING_TOKEN, MSG_STRING_TOKEN])\n                && msg_readStringToken(m, 0) === 'set'\n            ) {\n                ","(",", msg_readStringToken(m, 1))\n                return\n            }\n        "])),hh.setBusName,n)}},dependencies:[rd,yh]}};var wh,_h,kh,Ih,Th,xh,Oh,Ch;const Mh={translateArgs:e=>({rate:Ku(e.args[0])||0,unitAmount:Ku(e.args[1])||1,unit:qu(e.args[2])||"msec"}),build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"}}})},Eh=ac("metro",["setRate","scheduleNextTick","stop"]),Ah={initialization:e=>{let{node:{args:n},state:t,globs:a,snds:s}=e;return uo(Ih||(Ih=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            ",".sampleRatio = computeUnitInSamples(",", ",', "','")\n            ',"(",", ",")\n            ",".tickCallback = ","\n        })\n    "])),ao(Eh.stateClass,t,uo(Th||(Th=r(["{\n            rate: 0,\n            sampleRatio: 1,\n            skedId: SKED_ID_NULL,\n            realNextTick: -1,\n            snd0: ",",\n            tickCallback: ",",\n        }"])),s.$0,oo()(xh||(xh=r([""]))))),t,a.sampleRate,n.unitAmount,n.unit,Eh.setRate,t,n.rate,t,oo()(Oh||(Oh=r(["\n                ","(",")\n            "])),Eh.scheduleNextTick,t))},messageReceivers:e=>{let{state:n,globs:t}=e;return{0:oo([ro("Message","m")])(Ch||(Ch=r(["\n        if (msg_getLength(m) === 1) {\n            if (\n                (msg_isFloatToken(m, 0) && msg_readFloatToken(m, 0) === 0)\n                || msg_isAction(m, 'stop')\n            ) {\n                ","(",")\n                return\n\n            } else if (\n                msg_isFloatToken(m, 0)\n                || msg_isBang(m)\n            ) {\n                ",".realNextTick = toFloat(",")\n                ","(",")\n                return\n            }\n        }\n    "])),Eh.stop,n,n,t.frame,Eh.scheduleNextTick,n),1:rc(Eh.setRate,n)}},dependencies:[Yp,gd,hd,gi,mi,()=>lo([io(Eh.stateClass,[ro("Float","rate"),ro("Float","sampleRatio"),ro("Int","skedId"),ro("Float","realNextTick"),ro("(m: Message) => void","snd0"),ro("SkedCallback","tickCallback")]),so(Eh.setRate,[ro(Eh.stateClass,"state"),ro("Float","rate")],"void")(wh||(wh=r(["\n        state.rate = Math.max(rate, 0)\n    "]))),so(Eh.scheduleNextTick,[ro(Eh.stateClass,"state")],"void")(_h||(_h=r(["\n        state.snd0(msg_bang())\n        state.realNextTick = state.realNextTick + state.rate * state.sampleRatio\n        state.skedId = commons_waitFrame(\n            toInt(Math.round(state.realNextTick)), \n            state.tickCallback,\n        )\n    "]))),so(Eh.stop,[ro(Eh.stateClass,"state")],"void")(kh||(kh=r(["\n        if (state.skedId !== SKED_ID_NULL) {\n            commons_cancelWaitFrame(state.skedId)\n            state.skedId = SKED_ID_NULL\n        }\n        state.realNextTick = 0\n    "])))])]};var Fh,Ph,Nh;const Rh={translateArgs:e=>({unitAmount:Ku(e.args[0])||1,unit:qu(e.args[1])||"msec"}),build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"}}})},Lh=ac("timer"),Dh={initialization:e=>{let{node:{args:n},state:t,globs:a}=e;return uo(Fh||(Fh=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            ",".sampleRatio = computeUnitInSamples(",", ",', "','")\n        })\n    '])),ao(Lh.stateClass,t,"{\n            sampleRatio: 0,\n            resetTime: 0,\n        }"),t,a.sampleRate,n.unitAmount,n.unit)},messageReceivers:e=>{let{snds:n,globs:t,state:a}=e;return{0:oo([ro("Message","m")])(Ph||(Ph=r(["\n        if (msg_isBang(m)) {\n            ",".resetTime = ","\n            return\n\n        } else if (\n            msg_isMatching(m, [MSG_STRING_TOKEN, MSG_FLOAT_TOKEN, MSG_STRING_TOKEN])\n            && msg_readStringToken(m, 0) === 'tempo'\n        ) {\n            ",".sampleRatio = computeUnitInSamples(\n                ",", \n                msg_readFloatToken(m, 1), \n                msg_readStringToken(m, 2)\n            )\n            return\n        }\n    "])),a,t.frame,a,t.sampleRate),1:oo([ro("Message","m")])(Nh||(Nh=r(["\n        if (msg_isBang(m)) {\n            ","(msg_floats([toFloat("," - ",".resetTime) / ",".sampleRatio]))\n            return\n        }\n    "])),n.$0,t.frame,a,a)}},dependencies:[Yp,gd,gi,()=>lo([io(Lh.stateClass,[ro("Float","sampleRatio"),ro("Int","resetTime")])])]};var Uh,jh,zh,Bh,Vh;const Gh={translateArgs:e=>({delay:Ku(e.args[0])||0,unitAmount:Ku(e.args[1])||1,unit:qu(e.args[2])||"msec"}),build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"}},isPushingMessages:!0})},Wh=ac("delay",["setDelay","scheduleDelay","stop"]),$h={initialization:e=>{let{node:{args:n},state:t,globs:a}=e;return uo(Uh||(Uh=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            ",".sampleRatio = computeUnitInSamples(",", ",', "','")\n            ',"(",", ",")\n        })\n    "])),ao(Wh.stateClass,t,"{\n            delay: 0,\n            sampleRatio: 1,\n            scheduledBang: SKED_ID_NULL,\n        }"),t,a.sampleRate,n.unitAmount,n.unit,Wh.setDelay,t,n.delay)},messageReceivers:e=>{let{state:n,globs:t,snds:a}=e;return{0:oo([ro("Message","m")])(jh||(jh=r(["\n            if (msg_getLength(m) === 1) {\n                if (msg_isStringToken(m, 0)) {\n                    ","\n                    if (action === 'bang' || action === 'start') {\n                        ","(\n                            ",", \n                            () => ","(msg_bang()),\n                            ",",\n                        )\n                        return\n                    } else if (action === 'stop') {\n                        ","(",")\n                        return\n                    }\n                    \n                } else if (msg_isFloatToken(m, 0)) {\n                    ","(",", msg_readFloatToken(m, 0))\n                    ","(\n                        ",",\n                        () => ","(msg_bang()),\n                        ",",\n                    )\n                    return \n                }\n            \n            } else if (\n                msg_isMatching(m, [MSG_STRING_TOKEN, MSG_FLOAT_TOKEN, MSG_STRING_TOKEN])\n                && msg_readStringToken(m, 0) === 'tempo'\n            ) {\n                ",".sampleRatio = computeUnitInSamples(\n                    ",", \n                    msg_readFloatToken(m, 1), \n                    msg_readStringToken(m, 2)\n                )\n                return\n            }\n        "])),ao("string","action","msg_readStringToken(m, 0)"),Wh.scheduleDelay,n,a.$0,t.frame,Wh.stop,n,Wh.setDelay,n,Wh.scheduleDelay,n,a.$0,t.frame,n,t.sampleRate),1:rc(Wh.setDelay,n)}},dependencies:[Yp,gd,gi,mi,()=>lo([io(Wh.stateClass,[ro("Float","delay","0"),ro("Float","sampleRatio","1"),ro("SkedId","scheduledBang","SKED_ID_NULL")]),so(Wh.setDelay,[ro(Wh.stateClass,"state"),ro("Float","delay")],"void")(zh||(zh=r(["\n                state.delay = Math.max(0, delay)\n            "]))),so(Wh.scheduleDelay,[ro(Wh.stateClass,"state"),ro("SkedCallback","callback"),ro("Int","currentFrame")],"void")(Bh||(Bh=r(["\n                if (state.scheduledBang !== SKED_ID_NULL) {\n                    ","(state)\n                }\n                state.scheduledBang = commons_waitFrame(toInt(\n                    Math.round(\n                        toFloat(currentFrame) + state.delay * state.sampleRatio)),\n                    callback\n                )\n            "])),Wh.stop),so(Wh.stop,[ro(Wh.stateClass,"state")],"void")(Vh||(Vh=r(["\n                commons_cancelWaitFrame(state.scheduledBang)\n                state.scheduledBang = SKED_ID_NULL\n            "])))])]};var Hh,Kh,qh,Yh;const Xh={translateArgs:e=>{let{args:[n,t,r]}=e;return{outputOnLoad:!!n,sendBusName:qu(r)||Hc,receiveBusName:qu(t)||Hc}},build:Kc},Jh=ac("bang",["receiveMessage"]),Qh={initialization:e=>{let{snds:n,state:t,node:{args:a}}=e;return uo(Hh||(Hh=r(["\n        ","\n    \n        commons_waitEngineConfigure(() => {\n            ",".messageReceiver = ","\n            ",".messageSender = ","\n            ","(",', "','")\n        })\n\n        ',"\n    "])),ao(qc.stateClass,t,'{\n            value: msg_create([]),\n            receiveBusName: "'.concat(a.receiveBusName,'",\n            sendBusName: "').concat(a.sendBusName,'",\n            messageReceiver: ').concat(qc.defaultMessageHandler,",\n            messageSender: ").concat(qc.defaultMessageHandler,",\n        }")),t,oo([ro("Message","m")])(Kh||(Kh=r(["\n                ","(",", m)\n            "])),Jh.receiveMessage,t),t,n.$0,qc.setReceiveBusName,t,a.receiveBusName,a.outputOnLoad?"commons_waitFrame(0, () => ".concat(n.$0,"(msg_bang()))"):null)},messageReceivers:e=>{let{state:n}=e;return{0:oo([ro("Message","m")])(qh||(qh=r(["\n            ","(",", m)\n            return\n        "])),Jh.receiveMessage,n)}},dependencies:[gd,ad,gi,mi,Yc,()=>lo([so(Jh.receiveMessage,[ro(qc.stateClass,"state"),ro("Message","m")],"void")(Yh||(Yh=r(["\n                if (","(state, m) === true) {\n                    return\n                }\n                \n                ",'\n                state.messageSender(outMessage)\n                if (state.sendBusName !== "','") {\n                    msgBusPublish(state.sendBusName, outMessage)\n                }\n                return\n            '])),qc.setSendReceiveFromMessage,ao("Message","outMessage","msg_bang()"),Hc)])]};var Zh,ey,ny,ty;const ry={translateArgs:e=>{let{args:[n,t,r,a]}=e;return{sendBusName:qu(a)||Hc,receiveBusName:qu(r)||Hc}},build:Kc},ay=e=>{let{name:n,initValue:t,messageMatch:a}=e;const s=ac(n,["receiveMessage"]);return{initialization:e=>{let{state:n,node:{args:a},snds:o}=e;return uo(Zh||(Zh=r(["\n            ","\n        \n            commons_waitEngineConfigure(() => {\n                ",".messageReceiver = ","\n                ",".messageSender = ","\n                ","(",', "','")\n            })\n        '])),ao(qc.stateClass,n,"{\n                value: ".concat(t,',\n                receiveBusName: "').concat(a.receiveBusName,'",\n                sendBusName: "').concat(a.sendBusName,'",\n                messageReceiver: ').concat(qc.defaultMessageHandler,",\n                messageSender: ").concat(qc.defaultMessageHandler,",\n            }")),n,oo([ro("Message","m")])(ey||(ey=r(["\n                    ","(",", m)\n                "])),s.receiveMessage,n),n,o.$0,qc.setReceiveBusName,n,a.receiveBusName)},messageReceivers:e=>{let{state:n}=e;return{0:oo([ro("Message","m")])(ny||(ny=r(["\n                ","(",", m)\n                return\n            "])),s.receiveMessage,n)}},dependencies:[gd,ad,md,gi,Yc,()=>lo([so(s.receiveMessage,[ro(qc.stateClass,"state"),ro("Message","m")],"void")(ty||(ty=r(['\n                    if (msg_isBang(m)) {\n                        state.messageSender(state.value)\n                        if (state.sendBusName !== "',"\") {\n                            msgBusPublish(state.sendBusName, state.value)\n                        }\n                        return\n                    \n                    } else if (\n                        msg_getTokenType(m, 0) === MSG_STRING_TOKEN\n                        && msg_readStringToken(m, 0) === 'set'\n                    ) {\n                        ","\n                        "," \n                                state.value = setMessage    \n                                return\n                        ","\n        \n                    } else if (","(state, m) === true) {\n                        return\n                        \n                    } ",'\n                    \n                        state.value = m\n                        state.messageSender(state.value)\n                        if (state.sendBusName !== "','") {\n                            msgBusPublish(state.sendBusName, state.value)\n                        }\n                        return\n        \n                    }\n                '])),Hc,ao("Message","setMessage","msg_slice(m, 1, msg_getLength(m))"),a?"if (".concat(a("setMessage"),") {"):null,a?"}":null,qc.setSendReceiveFromMessage,a?"else if (".concat(a("m"),") {"):"else {",Hc)])]}},sy={floatatom:ry,symbolatom:ry,listbox:ry},oy={floatatom:ay({name:"floatatom",initValue:"msg_floats([0])",messageMatch:e=>"msg_isMatching(".concat(e,", [MSG_FLOAT_TOKEN])")}),symbolatom:ay({name:"symbolatom",initValue:"msg_strings([''])",messageMatch:e=>"msg_isMatching(".concat(e,", [MSG_STRING_TOKEN])")}),listbox:ay({name:"listbox",initValue:"msg_bang()"})};var iy;const ly={initialization:e=>{let{snds:n}=e;return uo(iy||(iy=r(["commons_waitFrame(0, () => ","(msg_bang()))"])),n.$0)},dependencies:[gd,mi]};var uy;const cy=()=>so("roundFloatAsPdInt",[ro("Float","value")],"Float")(uy||(uy=r(["\n        return value > 0 ? Math.floor(value): Math.ceil(value)\n    "])));var dy,fy,py,gy;const my={translateArgs:e=>({value:Ku(e.args[0])||0}),build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"}},isPushingMessages:!0})},hy=ac("float_int",["setValueInt","setValueFloat"]),yy=()=>lo([io(hy.stateClass,[ro("Float","value")]),so(hy.setValueInt,[ro(hy.stateClass,"state"),ro("Float","value")],"void")(dy||(dy=r(["\n        state.value = roundFloatAsPdInt(value)\n    "]))),so(hy.setValueFloat,[ro(hy.stateClass,"state"),ro("Float","value")],"void")(fy||(fy=r(["\n        state.value = value\n    "])))]),by=e=>({initialization:n=>{let{node:{args:t},state:a}=n;return uo(py||(py=r(["\n            ","\n            ","(",", ",")\n        "])),ao(hy.stateClass,a,"{\n                value: 0,\n            }"),e,a,t.value)},messageReceivers:n=>{let{snds:t,state:a}=n;return{0:oo([ro("Message","m")])(gy||(gy=r(["\n            if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n                ","(",", msg_readFloatToken(m, 0))\n                ","(msg_floats([",".value]))\n                return \n\n            } else if (msg_isBang(m)) {\n                ","(msg_floats([",".value]))\n                return\n                \n            }\n        "])),e,a,t.$0,a,t.$0,a),1:rc(e,a)}}}),vy={float:my,f:{aliasTo:"float"},int:my,i:{aliasTo:"int"}},Sy={float:{...by(hy.setValueFloat),dependencies:[gd,yy]},int:{...by(hy.setValueInt),dependencies:[cy,gd,yy]}};var wy;const _y={translateArgs:()=>({}),build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"message",id:"0"}}})},ky=e=>{let{operationCode:n,dependencies:t=[]}=e;return{messageReceivers:e=>{let{snds:t}=e;return{0:oo([ro("Message","m")])(wy||(wy=r(["\n            if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n                ","\n                ","(msg_floats([","]))\n                return\n            }\n        "])),ao("Float","value","msg_readFloatToken(m, 0)"),t.$0,n)}},dependencies:t}},Iy={abs:ky({operationCode:"Math.abs(value)"}),wrap:ky({operationCode:"(1 + (value % 1)) % 1"}),cos:ky({operationCode:"Math.cos(value)"}),sqrt:ky({operationCode:"value >= 0 ? Math.pow(value, 0.5): 0"}),mtof:ky({operationCode:"mtof(value)",dependencies:[Pg]}),ftom:ky({operationCode:"ftom(value)",dependencies:[Ng]}),rmstodb:ky({operationCode:"value <= 0 ? 0 : 20 * Math.log(value) / Math.LN10 + 100"}),dbtorms:ky({operationCode:"value <= 0 ? 0 : Math.exp(Math.LN10 * (value - 100) / 20)"}),powtodb:ky({operationCode:"value <= 0 ? 0 : 10 * Math.log(value) / Math.LN10 + 100"}),dbtopow:ky({operationCode:"value <= 0 ? 0 : Math.exp(Math.LN10 * (value - 100) / 10)"}),vu:ky({operationCode:"value"})},Ty={abs:_y,cos:_y,wrap:_y,sqrt:_y,mtof:_y,ftom:_y,rmstodb:_y,dbtorms:_y,powtodb:_y,dbtopow:_y,vu:_y};var xy,Oy,Cy,My,Ey,Ay,Fy;const Py=e=>({translateArgs:n=>{const t=Ku(n.args[0]);return{value:void 0!==t?t:e}},build:()=>({inlets:{0:{type:"signal",id:"0"},1:{type:"signal",id:"1"}},outlets:{0:{type:"signal",id:"0"}}}),configureMessageToSignalConnection:(e,n)=>"0"===e?{initialSignalValue:0}:"1"===e?{initialSignalValue:n.value}:void 0}),Ny={"+~":{inlineLoop:e=>{let{ins:n}=e;return uo(xy||(xy=r([""," + ",""])),n.$0,n.$1)}},"-~":{inlineLoop:e=>{let{ins:n}=e;return uo(Oy||(Oy=r([""," - ",""])),n.$0,n.$1)}},"*~":{inlineLoop:e=>{let{ins:n}=e;return uo(Cy||(Cy=r([""," * ",""])),n.$0,n.$1)}},"/~":{inlineLoop:e=>{let{ins:n}=e;return uo(My||(My=r([""," !== 0 ? "," / "," : 0"])),n.$1,n.$0,n.$1)}},"min~":{inlineLoop:e=>{let{ins:n}=e;return uo(Ey||(Ey=r(["Math.min(",", ",")"])),n.$0,n.$1)}},"max~":{inlineLoop:e=>{let{ins:n}=e;return uo(Ay||(Ay=r(["Math.max(",", ",")"])),n.$0,n.$1)}},"pow~":{inlineLoop:e=>{let{ins:n}=e;return uo(Fy||(Fy=r(["pow(",", ",")"])),n.$0,n.$1)},dependencies:[Rg]}},Ry={"+~":Py(0),"-~":Py(0),"*~":Py(0),"/~":Py(0),"min~":Py(0),"max~":Py(0),"pow~":Py(0)};var Ly,Dy;const Uy={inlineLoop:()=>uo(Ly||(Ly=r(["Math.random() * 2 - 1"]))),messageReceivers:e=>{let{globs:n}=e;return{0:oo([ro("Message","m")])(Dy||(Dy=r(["\n        if (\n            msg_isMatching(m, [MSG_STRING_TOKEN, MSG_FLOAT_TOKEN])\n            && msg_readStringToken(m, 0) === 'seed'\n        ) {\n            console.log('WARNING : seed not implemented yet for [noise~]')\n            return\n        }\n    "])))}}};var jy,zy,By;const Vy={codeGenerator:()=>lo([ao("Map<string, buf_SoundBuffer>","DELAY_BUFFERS","new Map()"),ao("Skeduler","DELAY_BUFFERS_SKEDULER","sked_create(true)"),ao("buf_SoundBuffer","DELAY_BUFFERS_NULL","buf_create(1)"),so("DELAY_BUFFERS_set",[ro("string","delayName"),ro("buf_SoundBuffer","buffer")],"void")(jy||(jy=r(["\n            DELAY_BUFFERS.set(delayName, buffer)\n            sked_emit(DELAY_BUFFERS_SKEDULER, delayName)\n        "]))),so("DELAY_BUFFERS_get",[ro("string","delayName"),ro("SkedCallback","callback")],"void")(zy||(zy=r(["\n            sked_wait(DELAY_BUFFERS_SKEDULER, delayName, callback)\n        "]))),so("DELAY_BUFFERS_delete",[ro("string","delayName")],"void")(By||(By=r(["\n            DELAY_BUFFERS.delete(delayName)\n        "])))]),dependencies:[Di,ni]};var Gy,Wy,$y;const Hy={translateArgs:e=>{let{args:n}=e;return{delayName:qu(n[0])||"",initDelayMsec:Ku(n[1])||0}},build:()=>({inlets:{0:{type:"signal",id:"0"}},outlets:{0:{type:"signal",id:"0"}}}),configureMessageToSignalConnection:(e,n)=>{let{initDelayMsec:t}=n;if("0"===e)return{initialSignalValue:t}}},Ky=()=>{const e=ac("delread",["setDelayName"]);return{initialization:n=>{let{node:{args:t},state:a}=n;return uo(Gy||(Gy=r(["\n            ",'\n\n            commons_waitEngineConfigure(() => {\n                if ("','".length) {\n                    ',"(",', "','", () => {\n                        ',".buffer = DELAY_BUFFERS.get(",".delayName)\n                    })\n                }\n            })\n        "])),ao(e.stateClass,a,"{\n                delayName: '',\n                buffer: DELAY_BUFFERS_NULL,\n            }"),t.delayName,e.setDelayName,a,t.delayName,a,a)},inlineLoop:e=>{let{globs:n,ins:t,state:a}=e;return uo(Wy||(Wy=r(["buf_readSample(",".buffer, toInt(Math.round(\n            Math.min(\n                Math.max(computeUnitInSamples(",", ",', "msec"), 0), \n                toFloat(',".buffer.length - 1)\n            )\n        )))"])),a,n.sampleRate,t.$0,a)},dependencies:[Yp,Vy,gi,ji,()=>lo([io(e.stateClass,[ro("string","delayName"),ro("buf_SoundBuffer","buffer")]),so(e.setDelayName,[ro(e.stateClass,"state"),ro("string","delayName"),ro("SkedCallback","callback")],"void")($y||($y=r(["\n                    if (state.delayName.length) {\n                        state.buffer = DELAY_BUFFERS_NULL\n                    }\n                    state.delayName = delayName\n                    if (state.delayName.length) {\n                        DELAY_BUFFERS_get(state.delayName, callback)\n                    }\n                "])))])]}},qy={"delread~":Hy,"delread4~":Hy},Yy={"delread~":Ky(),"delread4~":Ky()};var Xy,Jy,Qy,Zy;const eb={translateArgs:e=>{let{args:n}=e;return{delayName:qu(n[0])||"",maxDurationMsec:Ku(n[1])||100}},build:()=>({inlets:{0:{type:"signal",id:"0"},"0_message":{type:"message",id:"0_message"}},outlets:{},isPullingSignal:!0}),configureMessageToSignalConnection:e=>{if("0"===e)return{reroutedMessageInletId:"0_message"}}},nb=ac("delwrite",["setDelayName"]),tb={loop:e=>{let{ins:n,state:t}=e;return uo(Xy||(Xy=r(["buf_writeSample(",".buffer, ",")"])),t,n.$0)},messageReceivers:e=>{let{state:n}=e;return{"0_message":oo([ro("Message","m")],"void")(Jy||(Jy=r(["\n            if (msg_isAction(m, 'clear')) {\n                buf_clear(",".buffer)\n                return\n            }\n        "])),n)}},initialization:e=>{let{node:{args:n},state:t,globs:a}=e;return uo(Qy||(Qy=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            ",".buffer = buf_create(\n                toInt(Math.ceil(computeUnitInSamples(\n                    ",", \n                    ",',\n                    "msec"\n                )))\n            )\n            if ("','".length) {\n                ',"(",', "','")\n            }\n        })\n    '])),ao(nb.stateClass,t,"{\n            delayName: '',\n            buffer: DELAY_BUFFERS_NULL,\n        }"),t,a.sampleRate,n.maxDurationMsec,n.delayName,nb.setDelayName,t,n.delayName)},dependencies:[Yp,Vy,hd,()=>lo([io(nb.stateClass,[ro("string","delayName"),ro("buf_SoundBuffer","buffer")]),so(nb.setDelayName,[ro(nb.stateClass,"state"),ro("string","delayName")],"void")(Zy||(Zy=r(["\n                if (state.delayName.length) {\n                    DELAY_BUFFERS_delete(state.delayName)\n                }\n                state.delayName = delayName\n                if (state.delayName.length) {\n                    DELAY_BUFFERS_set(state.delayName, state.buffer)\n                }\n            "])))])]};var rb,ab;const sb={translateArgs:e=>{let{args:n}=e;return{initValue:Ku(n[0])||0}},build:()=>({inlets:{0:{type:"signal",id:"0"},1:{type:"signal",id:"1"}},outlets:{0:{type:"signal",id:"0"}}}),configureMessageToSignalConnection:(e,n)=>{let{initValue:t}=n;if("1"===e)return{initialSignalValue:t}}},ob=e=>{let{generateOperation:n}=e;const t=ac("filter_r_t");return{initialization:e=>{let{node:{args:n},state:a}=e;return uo(rb||(rb=r(["\n            ","\n        "])),ao(t.stateClass,a,"{\n                lastOutput: 0,\n                lastInput: 0,\n            }"))},loop:e=>{let{ins:t,state:a,outs:s}=e;return uo(ab||(ab=r(["\n        ",".lastOutput = "," = ","\n        ",".lastInput = ","\n    "])),a,s.$0,n(t.$0,t.$1,"".concat(a,".lastOutput"),"".concat(a,".lastInput")),a,t.$0)},dependencies:[()=>lo([io(t.stateClass,[ro("Float","lastOutput"),ro("Float","lastInput")])])]}},ib={"rpole~":sb,"rzero~":sb,"rzero_rev~":sb},lb={"rpole~":ob({generateOperation:(e,n,t)=>"".concat(e," + ").concat(n," * ").concat(t)}),"rzero~":ob({generateOperation:(e,n,t,r)=>"".concat(e," - ").concat(n," * ").concat(r)}),"rzero_rev~":ob({generateOperation:(e,n,t,r)=>"".concat(r," - ").concat(n," * ").concat(e)})};var ub,cb;const db={translateArgs:e=>{let{args:n}=e;return{initCoeffRe:Ku(n[0])||0,initCoeffIm:Ku(n[1])||0}},build:()=>({inlets:{0:{type:"signal",id:"0"},1:{type:"signal",id:"1"},2:{type:"signal",id:"2"},3:{type:"signal",id:"3"}},outlets:{0:{type:"signal",id:"0"},1:{type:"signal",id:"1"}}}),configureMessageToSignalConnection:(e,n)=>{let{initCoeffIm:t,initCoeffRe:r}=n;return"0"===e||"1"===e?{initialSignalValue:0}:"2"===e?{initialSignalValue:r}:"3"===e?{initialSignalValue:t}:void 0}},fb=e=>{let{generateOperationRe:n,generateOperationIm:t}=e;const a=ac("filter_c_t");return{initialization:e=>{let{state:n}=e;return uo(ub||(ub=r(["\n            ","\n        "])),ao(a.stateClass,n,"{\n                lastOutputRe: 0,\n                lastOutputIm: 0,\n                lastInputRe: 0,\n                lastInputIm: 0,\n            }"))},loop:e=>{let{ins:a,state:s,outs:o}=e;return uo(cb||(cb=r(["\n            "," = ","\n            ",".lastOutputIm = "," = ","\n            ",".lastOutputRe    = ","\n            ",".lastInputRe = ","\n            ",".lastInputIm = ","\n        "])),o.$0,n(a.$0,a.$1,a.$2,a.$3,"".concat(s,".lastOutputRe"),"".concat(s,".lastOutputIm"),"".concat(s,".lastInputRe"),"".concat(s,".lastInputIm")),s,o.$1,t(a.$0,a.$1,a.$2,a.$3,"".concat(s,".lastOutputRe"),"".concat(s,".lastOutputIm"),"".concat(s,".lastInputRe"),"".concat(s,".lastInputIm")),s,o.$0,s,a.$0,s,a.$1)},dependencies:[()=>lo([io(a.stateClass,[ro("Float","lastOutputRe"),ro("Float","lastOutputIm"),ro("Float","lastInputRe"),ro("Float","lastInputIm")])])]}},pb={"cpole~":db,"czero~":db},gb={"cpole~":fb({generateOperationRe:(e,n,t,r,a,s)=>"".concat(e," + ").concat(a," * ").concat(t," - ").concat(s," * ").concat(r),generateOperationIm:(e,n,t,r,a,s)=>"".concat(n," + ").concat(a," * ").concat(r," + ").concat(s," * ").concat(t)}),"czero~":fb({generateOperationRe:(e,n,t,r,a,s,o,i)=>"".concat(e," - ").concat(o," * ").concat(t," + ").concat(i," * ").concat(r),generateOperationIm:(e,n,t,r,a,s,o,i)=>"".concat(n," - ").concat(o," * ").concat(r," - ").concat(i," * ").concat(t)})};var mb,hb;const yb={translateArgs:e=>{let{args:n}=e;return{initValue:Ku(n[0])||0}},build:()=>({inlets:{0:{type:"signal",id:"0"},1:{type:"signal",id:"1"}},outlets:{0:{type:"signal",id:"0"}}}),configureMessageToSignalConnection:(e,n)=>{if("1"===e)return{initialSignalValue:n.initValue}}},bb=ac("hip_t"),vb={initialization:e=>{let{node:{args:n},state:t}=e;return uo(mb||(mb=r(["\n        ","\n    "])),ao(bb.stateClass,t,"{\n            previous: 0,\n            current: 0,\n            coeff: 0,\n            normal: 0,\n        }"))},loop:e=>{let{ins:n,state:t,outs:a,globs:s}=e;return uo(hb||(hb=r(["\n    ",".coeff = Math.min(Math.max(1 - "," * (2 * Math.PI) / ",", 0), 1)\n    ",".normal = 0.5 * (1 + ",".coeff)\n    ",".current = "," + ",".coeff * ",".previous\n    "," = ",".normal * (",".current - ",".previous)\n    ",".previous = ",".current\n"])),t,n.$1,s.sampleRate,t,t,t,n.$0,t,t,a.$0,t,t,t,t,t)},dependencies:[()=>lo([io(bb.stateClass,[ro("Float","previous"),ro("Float","current"),ro("Float","coeff"),ro("Float","normal")])])]};var Sb,wb,_b;const kb={translateArgs:e=>{let{args:n}=e;return{frequency:Ku(n[0])||0}},build:()=>({inlets:{0:{type:"signal",id:"0"},1:{type:"signal",id:"1"}},outlets:{0:{type:"signal",id:"0"}}}),configureMessageToSignalConnection:(e,n)=>{if("1"===e)return{initialSignalValue:n.frequency}}},Ib=ac("lop_t",["setFreq"]),Tb={initialization:e=>{let{node:{args:n},state:t}=e;return uo(wb||(wb=r(["\n        ","\n    "])),ao(Ib.stateClass,t,"{\n            previous: 0,\n            coeff: 0,\n        }"))},loop:e=>{let{ins:n,state:t,outs:a}=e;return uo(_b||(_b=r(["\n    ","(",", ",")\n    ",".previous = "," = ",".coeff * "," + (1 - ",".coeff) * ",".previous\n"])),Ib.setFreq,t,n.$1,t,a.$0,t,n.$0,t,t)},messageReceivers:e=>{let{state:n}=e;return{1:rc(Ib.setFreq,n)}},dependencies:[e=>{let{globs:n}=e;return lo([io(Ib.stateClass,[ro("Float","previous"),ro("Float","coeff")]),so(Ib.setFreq,[ro(Ib.stateClass,"state"),ro("Float","freq")],"void")(Sb||(Sb=r(["\n        state.coeff = Math.max(Math.min(freq * 2 * Math.PI / ",", 1), 0)\n    "])),n.sampleRate)])}]};var xb,Ob,Cb,Mb,Eb;const Ab={translateArgs:e=>{let{args:n}=e;return{frequency:Ku(n[0])||0,Q:Ku(n[1])||0}},build:()=>({inlets:{0:{type:"signal",id:"0"},1:{type:"signal",id:"1"},2:{type:"message",id:"2"}},outlets:{0:{type:"signal",id:"0"},1:{type:"signal",id:"1"}}})},Fb=ac("vcf_t",["updateCoefs","setFrequency","setQ"]),Pb={initialization:e=>{let{node:{args:n},state:t}=e;return uo(Mb||(Mb=r(["\n        ","\n    "])),ao(Fb.stateClass,t,"{\n            frequency: ".concat(n.frequency,",\n            Q: ").concat(n.Q,",\n            coef1: 0,\n            coef2: 0,\n            gain: 0,\n            y: 0,\n            ym1: 0,\n            ym2: 0,\n        }")))},loop:e=>{let{ins:n,outs:t,state:a}=e;return uo(Eb||(Eb=r(["\n    ","(",", ",")\n    ",".y = "," + ",".coef1 * ",".ym1 + ",".coef2 * ",".ym2\n    "," = "," = ",".gain * ",".y\n    ",".ym2 = ",".ym1\n    ",".ym1 = ",".y\n"])),Fb.setFrequency,a,n.$1,a,n.$0,a,a,a,a,t.$1,t.$0,a,a,a,a,a,a)},messageReceivers:e=>{let{state:n}=e;return{2:rc(Fb.setQ,n)}},dependencies:[e=>{let{globs:n}=e;return lo([io(Fb.stateClass,[ro("Float","frequency"),ro("Float","Q"),ro("Float","coef1"),ro("Float","coef2"),ro("Float","gain"),ro("Float","y"),ro("Float","ym1"),ro("Float","ym2")]),so(Fb.updateCoefs,[ro(Fb.stateClass,"state")],"void")(xb||(xb=r(["\n        ","\n        ","\n        ","\n        ","\n\n        state.coef1 = 2.0 * sigbp_qcos * r\n        state.coef2 = - r * r\n        state.gain = 2 * oneminusr * (oneminusr + r * omega)\n    "])),ro("Float","omega","state.frequency * (2.0 * Math.PI) / ".concat(n.sampleRate)),ro("Float","oneminusr","state.Q < 0.001 ? 1.0 : Math.min(omega / state.Q, 1)"),ro("Float","r","1.0 - oneminusr"),ro("Float","sigbp_qcos","(omega >= -(0.5 * Math.PI) && omega <= 0.5 * Math.PI) ? \n            (((Math.pow(omega, 6) * (-1.0 / 720.0) + Math.pow(omega, 4) * (1.0 / 24)) - Math.pow(omega, 2) * 0.5) + 1)\n            : 0")),so(Fb.setFrequency,[ro(Fb.stateClass,"state"),ro("Float","frequency")],"void")(Ob||(Ob=r(["\n        state.frequency = (frequency < 0.001) ? 10: frequency\n        ","()\n    "])),Fb.updateCoefs),so(Fb.setQ,[ro(Fb.stateClass,"state"),ro("Float","Q")],"void")(Cb||(Cb=r(["\n        state.Q = Math.max(Q, 0)\n        ","()\n    "])),Fb.updateCoefs)])}]};var Nb,Rb,Lb,Db,Ub,jb,zb,Bb,Vb,Gb,Wb,$b,Hb;const Kb=ac("msg"),qb={initialization:e=>{const{node:{args:n},state:t}=e,a=n.templates.map(((n,t)=>Yb(e,n,t)));return uo(Nb||(Nb=r(["\n        ","\n\n        ","\n        \n        ",".messageTransferFunctions = [\n            ","\n        ]\n    "])),ao(Kb.stateClass,t,"{\n            outTemplates: [],\n            outMessages: [],\n            messageTransferFunctions: [],\n        }"),a.filter((e=>{let{inMessageUsed:n}=e;return!n})).map((e=>{let{outMessageCode:n}=e;return n})),t,a.flatMap(((e,n)=>{let{inMessageUsed:a,outMessageCode:s}=e;return[oo([ro("Message","inMessage")],"Message")(Rb||(Rb=r(["\n                    ","\n                    return ",".outMessages[","]\n                "])),a?s:null,t,n),","]})))},messageReceivers:e=>{let{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(Lb||(Lb=r(["\n            if (\n                msg_isStringToken(m, 0) \n                && msg_readStringToken(m, 0) === 'set'\n            ) {\n                ",".outTemplates = [[]]\n                for (","; i < msg_getLength(m); i++) {\n                    if (msg_isFloatToken(m, i)) {\n                        ",".outTemplates[0].push(MSG_FLOAT_TOKEN)\n                    } else {\n                        ",".outTemplates[0].push(MSG_STRING_TOKEN)\n                        ",".outTemplates[0].push(msg_readStringToken(m, i).length)\n                    }\n                }\n\n                ","\n                for (","; i < msg_getLength(m); i++) {\n                    if (msg_isFloatToken(m, i)) {\n                        msg_writeFloatToken(\n                            message, i - 1, msg_readFloatToken(m, i)\n                        )\n                    } else {\n                        msg_writeStringToken(\n                            message, i - 1, msg_readStringToken(m, i)\n                        )\n                    }\n                }\n                ",".outMessages[0] = message\n                ",".messageTransferFunctions.splice(0, ",".messageTransferFunctions.length - 1)\n                ",".messageTransferFunctions[0] = ","\n                return\n\n            } else {\n                for (","; i < ",".messageTransferFunctions.length; i++) {\n                    ","(",".messageTransferFunctions[i](m))\n                }\n                return\n            }\n        "])),t,ro("Int","i","1"),t,t,t,ao("Message","message","msg_create(".concat(t,".outTemplates[0])")),ro("Int","i","1"),t,t,t,t,oo([ro("Message","m")],"Message")(Db||(Db=r(["\n                    return ",".outMessages[0]\n                "])),t),ro("Int","i","0"),t,n.$0,t)}},dependencies:[()=>lo([io(Kb.stateClass,[ro("Array<MessageTemplate>","outTemplates"),ro("Array<Message>","outMessages"),ro("Array<(m: Message) => Message>","messageTransferFunctions")])])]},Yb=(e,n,t)=>{let{state:a}=e;const s="".concat(a,".outTemplates[").concat(t,"]"),o="".concat(a,".outMessages[").concat(t,"]"),i=Xb(n);let l=[],u=[],c=0;i.forEach(((e,n)=>{if("noop"===e.type){const{inIndex:t}=e;l.push(uo(Ub||(Ub=r(["\n                ",".push(msg_getTokenType(inMessage, ","))\n                if (msg_isStringToken(inMessage, ",")) {\n                    stringMem[","] = msg_readStringToken(inMessage, ",")\n                    ",".push(stringMem[","].length)\n                }\n            "])),s,t,t,c,t,s,c)),u.push(uo(jb||(jb=r(["\n                if (msg_isFloatToken(inMessage, ",")) {\n                    msg_writeFloatToken(",", ",", msg_readFloatToken(inMessage, ","))\n                } else if (msg_isStringToken(inMessage, ",")) {\n                    msg_writeStringToken(",", ",", stringMem[","])\n                }\n            "])),t,o,n,t,t,o,n,c)),c++}else"string-template"===e.type?(l.push(uo(zb||(zb=r(['\n                stringToken = "','"\n                ',"\n                stringMem[","] = stringToken\n                ",".push(MSG_STRING_TOKEN)\n                ",".push(stringMem[","].length)\n            "])),e.template,e.variables.map((e=>{let{placeholder:n,inIndex:t}=e;return"\n                    if (msg_isFloatToken(inMessage, ".concat(t,")) {\n                        otherStringToken = msg_readFloatToken(inMessage, ").concat(t,").toString()\n                        if (otherStringToken.endsWith('.0')) {\n                            otherStringToken = otherStringToken.slice(0, -2)\n                        }\n                        stringToken = stringToken.replace(\"").concat(n,'", otherStringToken)\n                    } else if (msg_isStringToken(inMessage, ').concat(t,')) {\n                        stringToken = stringToken.replace("').concat(n,'", msg_readStringToken(inMessage, ').concat(t,"))\n                    }")})).join("\n"),c,s,s,c)),u.push(uo(Bb||(Bb=r(["\n                msg_writeStringToken(",", ",", stringMem[","])\n            "])),o,n,c)),c++):"string-constant"===e.type?(l.push(uo(Vb||(Vb=r(["\n                ",".push(MSG_STRING_TOKEN)\n                ",".push(",")\n            "])),s,s,e.value.length)),u.push(uo(Gb||(Gb=r(["\n                msg_writeStringToken(",", ",', "','")\n            '])),o,n,e.value))):"float-constant"===e.type&&(l.push(uo(Wb||(Wb=r(["\n                ",".push(MSG_FLOAT_TOKEN)\n            "])),s)),u.push(uo($b||($b=r(["\n                msg_writeFloatToken(",", ",", ",")\n            "])),o,n,e.value)))}));const d=i.some((e=>"string-template"===e.type)),f=i.some((e=>"noop"===e.type||"string-template"===e.type));return{inMessageUsed:f,outMessageCode:uo(Hb||(Hb=r(["\n            ","\n            ","\n            ","\n            "," = []\n            ","\n            "," = msg_create(",")\n            ","\n        "])),d?ro("string","stringToken"):null,d?ro("string","otherStringToken"):null,f?ro("Array<string>","stringMem","[]"):null,s,l,o,s,u)}},Xb=e=>e.map((e=>{if("string"===typeof e){const n=Jb.exec(e);if(n&&n[0]===e){return{type:"noop",inIndex:parseInt(n[1],10)-1}}if(n){const n=[];let t;for(;t=Qb.exec(e);)n.push({placeholder:t[0],inIndex:parseInt(t[1],10)-1});return{type:"string-template",template:e,variables:n}}return{type:"string-constant",value:e}}return{type:"float-constant",value:e}})),Jb=/\$(\d+)/,Qb=/\$(\d+)/g;var Zb,ev,nv,tv,rv,av,sv,ov;const iv={translateArgs:e=>{let{args:n}=e;const t=qu(n[0])||"append";let r=n.slice(1);switch(t){case"split":r=[Ku(n[1])||0];break;case"trim":case"length":r=[];break;case"append":case"prepend":break;case"fromsymbol":case"tosymbol":case"store":throw new Error("list operation ".concat(t," not implemented yet"));default:throw new Error("invalid list operation ".concat(t))}return{operation:t,operationArgs:r}},build:e=>{let{operation:n}=e,t=0,r=0;switch(n){case"split":t=2,r=3;break;case"trim":case"length":t=1,r=1;break;case"prepend":case"append":t=2,r=1}return{inlets:Ls(Ns(t),(e=>["".concat(e),{type:"message",id:"".concat(e)}])),outlets:Ls(Ns(r),(e=>["".concat(e),{type:"message",id:"".concat(e)}]))}}},lv=ac("list",["setSplitPoint"]),uv={messageReceivers:e=>{let{snds:n,state:t,node:{args:a}}=e;const s=ao("Message","inMessage","msg_isBang(m) ? msg_create([]): m");switch(a.operation){case"split":return{0:oo([ro("Message","m")])(tv||(tv=r(["\n                    ","\n                    if (msg_getLength(inMessage) < ",".splitPoint) {\n                        ","(m)\n                        return\n                    } else if (msg_getLength(inMessage) === ",".splitPoint) {\n                        ","(msg_bang())\n                        ","(m)\n                        return\n                    }\n                    ","\n                    ","\n                    ","(msg_getLength(outMessage1) === 0 ? msg_bang(): outMessage1)\n                    ","(msg_getLength(outMessage0) === 0 ? msg_bang(): outMessage0)\n                    return\n                "])),s,t,n.$2,t,n.$1,n.$0,ao("Message","outMessage1","msg_slice(inMessage, ".concat(t,".splitPoint, msg_getLength(inMessage))")),ao("Message","outMessage0","msg_slice(inMessage, 0, ".concat(t,".splitPoint)")),n.$1,n.$0),1:rc(lv.setSplitPoint,t)};case"trim":return{0:oo([ro("Message","m")])(rv||(rv=r(["\n                    ","(m)\n                    return\n                "])),n.$0)};case"length":return{0:oo([ro("Message","m")])(av||(av=r(["\n                    if (msg_isBang(m)) {\n                        ","(msg_floats([0]))\n                    } else {\n                        ","(msg_floats([toFloat(msg_getLength(m))]))\n                    }\n                    return\n                "])),n.$0,n.$0)};case"append":case"prepend":const e="prepend"===a.operation?"msg_concat(".concat(t,".currentList, m)"):"msg_concat(m, ".concat(t,".currentList)");return{0:oo([ro("Message","m")])(sv||(sv=r(["\n                    if (msg_isBang(m)) {\n                        ","(msg_getLength(",".currentList) === 0 ? msg_bang(): ",".currentList)\n                    } else {\n                        ","(msg_getLength(",".currentList) === 0 && msg_getLength(m) === 0 ? msg_bang(): ",")\n                    }\n                    return\n                "])),n.$0,t,t,n.$0,t,e),1:oo([ro("Message","m")])(ov||(ov=r(["\n                    ","\n                    ",".currentList = inMessage\n                    return\n                "])),s,t)};default:throw new Error("unknown list operation ".concat(a.operation))}},initialization:e=>{let{node:{args:n},state:t}=e;return uo(ev||(ev=r(["\n    ","\n\n    ","\n\n    ","\n"])),ao(lv.stateClass,t,"{\n        splitPoint: 0,\n        currentList: msg_create([]),\n    }"),"split"===n.operation?"".concat(t,".splitPoint = ").concat(n.operationArgs[0]):null,"append"===n.operation||"prepend"===n.operation?uo(nv||(nv=r([" \n        {\n            ","\n\n            ",".currentList = msg_create(template)\n\n            ","\n        }\n    "])),ao("MessageTemplate","template","[".concat(n.operationArgs.map((e=>"string"===typeof e?"MSG_STRING_TOKEN,".concat(e.length):"MSG_FLOAT_TOKEN")).join(","),"]")),t,n.operationArgs.map(((e,n)=>"string"===typeof e?"msg_writeStringToken(".concat(t,".currentList, ").concat(n,', "').concat(e,'")'):"msg_writeFloatToken(".concat(t,".currentList, ").concat(n,", ").concat(e,")")))):null)},dependencies:[gd,md,()=>lo([io(lv.stateClass,[ro("Int","splitPoint"),ro("Message","currentList")]),so(lv.setSplitPoint,[ro(lv.stateClass,"state"),ro("Float","value")],"void")(Zb||(Zb=r(["\n        state.splitPoint = toInt(value)\n    "])))])]};var cv,dv,fv;const pv={translateArgs:e=>({value:qu(e.args[0])||""}),build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"}},isPushingMessages:!0})},gv=ac("symbol"),mv={messageReceivers:e=>{let{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(dv||(dv=r(["\n        if (msg_isBang(m)) {\n            ","(msg_strings([",".value]))\n            return\n\n        } else if (msg_isMatching(m, [MSG_STRING_TOKEN])) {\n            ",".value = msg_readStringToken(m, 0)\n            ","(msg_strings([",".value]))\n            return\n\n        }\n    "])),n.$0,t,t,n.$0,t),1:oo([ro("Message","m")])(fv||(fv=r(["\n        if (msg_isMatching(m, [MSG_STRING_TOKEN])) {\n            ",".value = msg_readStringToken(m, 0)\n            return \n        }\n    "])),t)}},initialization:e=>{let{node:{args:n},state:t}=e;return uo(cv||(cv=r(["\n        ","\n    "])),ao(gv.stateClass,t,'{\n            value: "'.concat(n.value,'"\n        }')))},dependencies:[gd,ad,()=>lo([io(gv.stateClass,[ro("string","value")])])]};var hv,yv,bv;const vv={translateArgs:e=>({busName:qu(e.args[0])||""}),build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{}})},Sv={translateArgs:e=>({busName:qu(e.args[0])||""}),build:()=>({inlets:{},outlets:{0:{type:"message",id:"0"}},isPushingMessages:!0})},wv=ac("send"),_v={send:vv,receive:Sv},kv={send:{initialization:e=>{let{node:{args:n},state:t}=e;return uo(hv||(hv=r(["\n            ","\n        "])),ao(wv.stateClass,t,'{\n                busName: "'.concat(n.busName,'",\n            }')))},messageReceivers:e=>{let{state:n}=e;return{0:oo([ro("Message","m")])(yv||(yv=r(["\n            msgBusPublish(",".busName, m)\n            return\n        "])),n),1:(t="".concat(n,".busName"),oo([ro("Message","m")])(ec||(ec=r(["\n        if (msg_isMatching(m, [MSG_STRING_TOKEN])) {\n            "," = msg_readStringToken(m, 0)\n            return\n        }\n    "])),t))};var t},dependencies:[ad,gi,()=>lo([io(wv.stateClass,[ro("string","busName")])])]},receive:{initialization:e=>{let{node:{args:n},snds:t}=e;return uo(bv||(bv=r(['\n            commons_waitEngineConfigure(() => {\n                msgBusSubscribe("','", ',")\n            })\n        "])),n.busName,t.$0)},dependencies:[ad,gi]}};var Iv,Tv,xv,Ov,Cv,Mv;const Ev=ac("soundfiler",["Operation","buildMessage1"]),Av={initialization:e=>{let{node:{args:n},state:t}=e;return uo(Tv||(Tv=r(["\n        ","\n    "])),ao(Ev.stateClass,t,"{\n            operations: new Map(),\n        }"))},messageReceivers:e=>{let{state:n,globs:t,snds:a}=e;return{0:oo([ro("Message","m")])(xv||(xv=r(["\n        if (\n            msg_getLength(m) >= 3 \n            && msg_isStringToken(m, 0)\n            && (\n                msg_readStringToken(m, 0) === 'read'\n                || msg_readStringToken(m, 0) === 'write'\n            )\n        ) {\n            ","\n            ","\n            ","\n            ","\n            \n            // Remove the operation type\n            unhandledOptions.delete(0)\n            \n            ","\n            ","\n            while (i < msg_getLength(m)) {\n                if (!unhandledOptions.has(i)) {\n\n                } else if (msg_isStringToken(m, i)) {\n                    str = msg_readStringToken(m, i)\n                    if (str === '-resize') {\n                        unhandledOptions.delete(i)\n                        operation.resize = true\n\n                    } else if (str === '-maxsize' || str === '-nframes') {\n                        unhandledOptions.delete(i)\n                        if (\n                            i + 1 >= msg_getLength(m) \n                            || !msg_isFloatToken(m, i + 1)\n                        ) {\n                            console.log(\"invalid value for -maxsize\")\n                        }\n                        operation.maxSize = msg_readFloatToken(m, i + 1)\n                        unhandledOptions.delete(i + 1)\n                        i++\n\n                    } else if (str === '-skip') {\n                        unhandledOptions.delete(i)\n                        if (\n                            i + 1 >= msg_getLength(m) \n                            || !msg_isFloatToken(m, i + 1)\n                        ) {\n                            console.log(\"invalid value for -skip\")\n                        }\n                        operation.skip = msg_readFloatToken(m, i + 1)\n                        unhandledOptions.delete(i + 1)\n                        i++\n\n                    } else if (str === '-normalize') {\n                        unhandledOptions.delete(i)\n                        console.log('-normalize not implemented')\n                    }\n                }\n                i++\n            }\n\n            i = 1\n            ","\n            while (i < msg_getLength(m)) {\n                if (!unhandledOptions.has(i)) {\n\n                } else if (msg_isStringToken(m, i)) {\n                    str = msg_readStringToken(m, i)\n                    if (!str.startsWith('-') && urlFound === false) {\n                        operation.url = str\n                        urlFound = true\n                    } else {\n                        operation.arrayNames.push(str)\n                    }\n                    unhandledOptions.delete(i)\n                }\n                i++\n            }\n\n            for (i = 0; i < operation.arrayNames.length; i++) {\n                if (!commons_hasArray(operation.arrayNames[i])) {\n                    console.log('[soundfiler] unknown array ' + operation.arrayNames[i])\n                    return\n                }\n            }\n\n            if (unhandledOptions.size) {\n                console.log(\"soundfiler received invalid options\")\n            }\n\n            soundInfo.channelCount = operation.arrayNames.length\n\n            if (operationType === 'read') {\n                ","\n\n                ",".operations.set(id, operation)\n\n            } else if (operationType === 'write') {\n                ","\n                ","\n                ","\n                ","\n                \n                for (i = 0; i < operation.arrayNames.length; i++) {\n                    framesToWrite = Math.max(\n                        framesToWrite,\n                        toFloat(commons_getArray(operation.arrayNames[i]).length) - operation.skip,\n                    )\n                }\n\n                if (operation.maxSize >= 0) {\n                    framesToWrite = Math.min(\n                        operation.maxSize, \n                        framesToWrite\n                    )\n                }\n                operation.framesToWrite = framesToWrite\n\n                if (framesToWrite < 1) {\n                    console.log('[soundfiler] no frames to write')\n                    return\n                }\n\n                for (i = 0; i < operation.arrayNames.length; i++) {\n                    array = commons_getArray(operation.arrayNames[i])\n                    if (framesToWrite > toFloat(array.length) - operation.skip) {\n                        sound.push(createFloatArray(toInt(framesToWrite)))\n                        sound[i].set(array.subarray(\n                            toInt(operation.skip), \n                            toInt(operation.skip + framesToWrite)\n                        ))\n                    } else {\n                        sound.push(array.subarray(\n                            toInt(operation.skip), \n                            toInt(operation.skip + framesToWrite)\n                        ))\n                    }\n                }\n\n                ","\n\n                ","\n\n                ",".operations.set(id, operation)\n            }\n\n            return\n        }\n    "])),ao("string","operationType","msg_readStringToken(m, 0)"),ao("fs_SoundInfo","soundInfo","{\n                channelCount: 0,\n                sampleRate: toInt(".concat(t.sampleRate,"),\n                bitDepth: 32,\n                encodingFormat: '',\n                endianness: '',\n                extraOptions: '',\n            }")),ao(Ev.Operation,"operation","{\n                arrayNames: [],\n                resize: false,\n                maxSize: -1,\n                skip: 0,\n                framesToWrite: 0,\n                url: '',\n                soundInfo,\n            }"),ro("Set<Int>","unhandledOptions","parseSoundFileOpenOpts(\n                m,\n                soundInfo,\n            )"),ro("Int","i","1"),ro("string","str",'""'),ro("boolean","urlFound","false"),ao("fs_OperationId","id",uo(Ov||(Ov=r(["fs_readSoundFile(\n                    operation.url, \n                    soundInfo,\n                    ","\n                )"])),oo([ro("fs_OperationId","id"),ro("fs_OperationStatus","status"),ro("FloatArray[]","sound")],"void")(Cv||(Cv=r(["\n                        ","\n                        ",".operations.delete(id)\n                        ","\n                        ","\n                        ","\n                        ","\n                        for (i = 0; i < sound.length; i++) {\n                            if (operation.resize) {\n                                if (operation.maxSize > 0) {\n                                    framesToRead = Math.min(\n                                        operation.maxSize, \n                                        toFloat(sound[i].length) - operation.skip\n                                    )\n    \n                                } else {\n                                    framesToRead = toFloat(sound[i].length) - operation.skip\n                                }\n    \n                                commons_setArray(\n                                    operation.arrayNames[i], \n                                    sound[i].subarray(\n                                        toInt(operation.skip), \n                                        toInt(operation.skip + framesToRead)\n                                    )\n                                )\n                                \n                            } else {\n                                array = commons_getArray(operation.arrayNames[i])\n                                framesToRead = Math.min(\n                                    toFloat(array.length),\n                                    toFloat(sound[i].length) - operation.skip\n                                )\n                                array.set(sound[i].subarray(0, array.length))\n                            }\n                            maxFramesRead = Math.max(\n                                maxFramesRead,\n                                framesToRead\n                            )\n                        }\n    \n                        ","(","(operation.soundInfo))\n                        ","(msg_floats([maxFramesRead]))\n                    "])),ao(Ev.Operation,"operation","".concat(n,".operations.get(id)")),n,ro("Int","i","0"),ro("Float","maxFramesRead","0"),ro("Float","framesToRead","0"),ro("FloatArray","array","createFloatArray(0)"),a.$1,Ev.buildMessage1,a.$0))),n,ro("Int","i","0"),ro("Float","framesToWrite","0"),ro("FloatArray","array","createFloatArray(0)"),ao("FloatArray[]","sound","[]"),so("callback",[ro("fs_OperationId","id"),ro("fs_OperationStatus","status")],"void")(Mv||(Mv=r(["\n                    ","\n                    ",".operations.delete(id)\n                    ","(","(operation.soundInfo))\n                    ","(msg_floats([operation.framesToWrite]))\n                "])),ao(Ev.Operation,"operation","".concat(n,".operations.get(id)")),n,a.$1,Ev.buildMessage1,a.$0),ao("fs_OperationId","id","fs_writeSoundFile(\n                    sound, \n                    operation.url, \n                    soundInfo, \n                    callback\n                )"),n)}},dependencies:[Em,pi,Bl,Vl,()=>lo([io(Ev.stateClass,[ro("Map<fs_OperationId, ".concat(Ev.Operation,">"),"operations")]),io(Ev.Operation,[ro("string","url"),ro("Array<string>","arrayNames"),ro("boolean","resize"),ro("Float","maxSize"),ro("Float","framesToWrite"),ro("Float","skip"),ro("fs_SoundInfo","soundInfo")]),so(Ev.buildMessage1,[ro("fs_SoundInfo","soundInfo")],"Message")(Iv||(Iv=r(["\n        ","\n        msg_writeFloatToken(m, 0, toFloat(soundInfo.sampleRate))\n        msg_writeFloatToken(m, 1, -1) // TODO IMPLEMENT headersize\n        msg_writeFloatToken(m, 2, toFloat(soundInfo.channelCount))\n        msg_writeFloatToken(m, 3, Math.round(toFloat(soundInfo.bitDepth) / 8))\n        msg_writeStringToken(m, 4, soundInfo.endianness)\n        return m\n    "])),ao("Message","m","msg_create([\n            MSG_FLOAT_TOKEN,\n            MSG_FLOAT_TOKEN,\n            MSG_FLOAT_TOKEN,\n            MSG_FLOAT_TOKEN,\n            MSG_STRING_TOKEN,\n            soundInfo.endianness.length,\n        ])"))])]};var Fv;const Pv={messageReceivers:e=>{let{node:{args:n}}=e;return{0:oo([ro("Message","m")])(Fv||(Fv=r(['\n        console.log("',' " + msg_display(m))\n        return\n    '])),n.prefix)}}};var Nv,Rv;const Lv=["float","bang","symbol","list","anything"],Dv=e=>{switch(e){case"f":return"float";case"b":return"bang";case"s":return"symbol";case"l":return"list";case"a":return"anything";case"p":return"pointer";default:return e}},Uv=e=>{if("pointer"===e)throw new Yu('"pointer" not supported (yet)');if(!Lv.includes(e))throw new Yu("invalid type ".concat(e));return e},jv=(e,n,t)=>{switch(e){case"float":return"msg_floats([messageTokenToFloat(".concat(n,", ").concat(t,")])");case"bang":return"msg_bang()";case"symbol":return"msg_strings([messageTokenToString(".concat(n,", ").concat(t,")])");case"list":case"anything":return"".concat(n);default:throw new Error("type argument ".concat(e," not supported (yet)"))}},zv=()=>so("messageTokenToFloat",[ro("Message","m"),ro("Int","i")],"Float")(Nv||(Nv=r(["\n        if (msg_isFloatToken(m, i)) {\n            return msg_readFloatToken(m, i)\n        } else {\n            return 0\n        }\n    "]))),Bv=()=>so("messageTokenToString",[ro("Message","m"),ro("Int","i")],"string")(Rv||(Rv=r(["\n        if (msg_isStringToken(m, i)) {\n            ","\n            if (str === 'bang') {\n                return 'symbol'\n            } else {\n                return str\n            }\n        } else {\n            return 'float'\n        }\n    "])),ao("string","str","msg_readStringToken(m, i)"));var Vv;const Gv={translateArgs:e=>{let{args:n}=e;return{typeArguments:0===n.length?["bang","bang"]:n.map(Hu).map(Dv).map(Uv)}},build:e=>{let{typeArguments:n}=e;return{inlets:{0:{type:"message",id:"0"}},outlets:Ls(n,((e,n)=>["".concat(n),{type:"message",id:"".concat(n)}]))}}},Wv={messageReceivers:e=>{let{snds:n,node:{args:{typeArguments:t}}}=e;return{0:oo([ro("Message","m")])(Vv||(Vv=r(["\n        ","\n        return\n    "])),t.reverse().map(((e,r)=>"".concat(n[t.length-r-1],"(").concat(jv(e,"m",0),")"))))}},dependencies:[zv,Bv,gd]};var $v,Hv;const Kv={translateArgs:e=>{let{args:n}=e;return{initValue:Ku(n[0])||0}},build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"message",id:"0"}}})},qv=ac("change"),Yv={initialization:e=>{let{node:{args:n},state:t}=e;return uo($v||($v=r(["\n            ","\n        "])),ao(qv.stateClass,t,"{\n                currentValue: ".concat(n.initValue,"\n            }")))},messageReceivers:e=>{let{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(Hv||(Hv=r(["\n            if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n                ","\n                if (newValue !== ",".currentValue) {\n                    ",".currentValue = newValue\n                    ","(msg_floats([",".currentValue]))\n                }\n                return\n    \n            } else if (msg_isBang(m)) {\n                ","(msg_floats([",".currentValue]))\n                return \n    \n            } else if (\n                msg_isMatching(m, [MSG_STRING_TOKEN, MSG_FLOAT_TOKEN])\n                && msg_readStringToken(m, 0) === 'set'\n            ) {\n                ",".currentValue = msg_readFloatToken(m, 1)\n                return\n            }\n        "])),ao("Float","newValue","msg_readFloatToken(m, 0)"),t,t,n[0],t,n[0],t,t)}},dependencies:[gd,()=>lo([io(qv.stateClass,[ro("Float","currentValue")])])]};var Xv,Jv;const Qv={translateArgs:e=>{let{args:n}=e;return{threshold:Ku(n[0])||0}},build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}}})},Zv=ac("moses"),eS={initialization:e=>{let{node:{args:n},state:t}=e;return uo(Xv||(Xv=r(["\n        ","\n    "])),ao(Zv.stateClass,t,"{\n            threshold: ".concat(n.threshold,",\n        }")))},messageReceivers:e=>{let{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(Jv||(Jv=r(["\n        if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n            ","\n            if (value >= ",".threshold) {\n                ","(msg_floats([value]))\n            } else {\n                ","(msg_floats([value]))\n            }\n            return\n        }\n    "])),ao("Float","value","msg_readFloatToken(m, 0)"),t,n[1],n[0]),1:tc("".concat(t,".threshold"))}},dependencies:[()=>lo([io(Zv.stateClass,[ro("Float","threshold")])])]};var nS,tS;const rS={translateArgs:e=>{let{args:n}=e;return{minValue:Ku(n[0])||0,maxValue:Ku(n[1])||0}},build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"},2:{type:"message",id:"2"}},outlets:{0:{type:"message",id:"0"}}})},aS=ac("clip"),sS={initialization:e=>{let{node:{args:n},state:t}=e;return uo(nS||(nS=r(["\n            ","\n        "])),ao(aS.stateClass,t,"{\n                minValue: ".concat(n.minValue,",\n                maxValue: ").concat(n.maxValue,",\n            }")))},messageReceivers:e=>{let{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(tS||(tS=r(["\n            if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n                ","(msg_floats([\n                    Math.max(\n                        Math.min(\n                            ",".maxValue, \n                            msg_readFloatToken(m, 0)\n                        ), \n                        ",".minValue\n                    )\n                ]))\n                return\n            }\n        "])),n[0],t,t),1:tc("".concat(t,".minValue")),2:tc("".concat(t,".maxValue"))}},dependencies:[()=>lo([io(aS.stateClass,[ro("Float","minValue"),ro("Float","maxValue")])])]};var oS,iS,lS,uS;const cS={translateArgs:e=>{let{args:n}=e;return{filters:n.length?n:[0]}},build:e=>{const n={0:{type:"message",id:"0"}};return 1===e.filters.length&&(n[1]={type:"message",id:"1"}),{inlets:n,outlets:Ls(e.filters.length?Ns(e.filters.length+1):[0,1],((e,n)=>["".concat(n),{type:"message",id:"".concat(n)}]))}}},dS=ac("route"),fS={messageReceivers:e=>{let{snds:n,state:t,node:{args:a}}=e;return a.filters.length>1?{0:oo([ro("Message","m")])(iS||(iS=r(["\n                ","\n\n                ","(m)\n                return\n            "])),a.filters.map(((e,t)=>Ds(["float"===e,"\n                        if (msg_isFloatToken(m, 0)) {\n                            ".concat(n[t],"(m)\n                            return\n                        }\n                    ")],["symbol"===e,"\n                        if (msg_isStringToken(m, 0)) {\n                            ".concat(n[t],"(m)\n                            return\n                        }\n                    ")],["list"===e,"\n                        if (msg_getLength(m).length > 1) {\n                            ".concat(n[t],"(m)\n                            return\n                        }\n                    ")],["bang"===e,"\n                        if (msg_isBang(m)) {\n                            ".concat(n[t],"(m)\n                            return\n                        }\n                    ")],["number"===typeof e,"\n                        if (\n                            msg_isFloatToken(m, 0)\n                            && msg_readFloatToken(m, 0) === ".concat(e,"\n                        ) {\n                            ").concat(n[t],"(msg_emptyToBang(msg_shift(m)))\n                            return\n                        }\n                    ")],["string"===typeof e,'\n                        if (\n                            msg_isStringToken(m, 0) \n                            && msg_readStringToken(m, 0) === "'.concat(e,'"\n                        ) {\n                            ').concat(n[t],"(msg_emptyToBang(msg_shift(m)))\n                            return\n                        }")]))),n[a.filters.length])}:{0:oo([ro("Message","m")])(lS||(lS=r(["\n                if (",".filterType === MSG_STRING_TOKEN) {\n                    if (\n                        (",".stringFilter === 'float'\n                            && msg_isFloatToken(m, 0))\n                        || (",".stringFilter === 'symbol'\n                            && msg_isStringToken(m, 0))\n                        || (",".stringFilter === 'list'\n                            && msg_getLength(m) > 1)\n                        || (",".stringFilter === 'bang' \n                            && msg_isBang(m))\n                    ) {\n                        ","(m)\n                        return\n                    \n                    } else if (\n                        msg_isStringToken(m, 0)\n                        && msg_readStringToken(m, 0) === ",".stringFilter\n                    ) {\n                        ","(msg_emptyToBang(msg_shift(m)))\n                        return\n                    }\n\n                } else if (\n                    msg_isFloatToken(m, 0)\n                    && msg_readFloatToken(m, 0) === ",".floatFilter\n                ) {\n                    ","(msg_emptyToBang(msg_shift(m)))\n                    return\n                }\n            \n                ","(m)\n            return\n            "])),t,t,t,t,t,n.$0,t,n.$0,t,n.$0,n.$1),1:oo([ro("Message","m")])(uS||(uS=r(["\n                ",".filterType = msg_getTokenType(m, 0)\n                if (",".filterType === MSG_STRING_TOKEN) {\n                    ",".stringFilter = msg_readStringToken(m, 0)\n                } else {\n                    ",".floatFilter = msg_readFloatToken(m, 0)\n                }\n                return\n            "])),t,t,t,t)}},initialization:e=>{let{node:{args:n},state:t}=e;return uo(oS||(oS=r(["\n        ","\n    "])),ao(dS.stateClass,t,"{\n            floatFilter: ".concat("number"===typeof n.filters[0]?n.filters[0]:0,',\n            stringFilter: "').concat(n.filters[0],'",\n            filterType: ').concat("number"===typeof n.filters[0]?"MSG_FLOAT_TOKEN":"MSG_STRING_TOKEN",",\n        }")))},dependencies:[gd,md,()=>lo([io(dS.stateClass,[ro("Float","floatFilter"),ro("string","stringFilter"),ro("Int","filterType")])])]};var pS,gS,mS;const hS={translateArgs:e=>{let{args:n}=e;return{isClosed:0===(Ku(n[0])||0)}},build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"}}})},yS=ac("spigot",["setIsClosed"]),bS={initialization:e=>{let{node:{args:n},state:t}=e;return uo(gS||(gS=r(["\n        ","\n    "])),ao(yS.stateClass,t,"{\n            isClosed: ".concat(n.isClosed?"true":"false","\n        }")))},messageReceivers:e=>{let{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(mS||(mS=r(["\n        if (!",".isClosed) {\n            ","(m)\n        }\n        return\n    "])),t,n.$0),1:rc(yS.setIsClosed,t)}},dependencies:[()=>lo([io(yS.stateClass,[ro("Float","isClosed")]),so(yS.setIsClosed,[ro(yS.stateClass,"state"),ro("Float","value")],"void")(pS||(pS=r(["\n        state.isClosed = (value === 0)\n    "])))])]};var vS,SS,wS;const _S=ac("until"),kS={messageReceivers:e=>{let{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(SS||(SS=r(["\n        if (msg_isBang(m)) {\n            ",".continueIter = true\n            while (",".continueIter) {\n                ","(msg_bang())\n            }\n            return\n\n        } else if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n            ",".continueIter = true\n            ","\n            ","\n            while (",".continueIter && iterCount++ < maxIterCount) {\n                ","(msg_bang())\n            }\n            return\n        }\n    "])),t,t,n[0],t,ro("Int","maxIterCount","toInt(msg_readFloatToken(m, 0))"),ro("Int","iterCount","0"),t,n[0]),1:oo([ro("Message","m")])(wS||(wS=r(["\n        if (msg_isBang(m)) {\n            ",".continueIter = false\n            return\n        }\n    "])),t)}},initialization:e=>{let{state:n}=e;return uo(vS||(vS=r(["\n        ","\n    "])),ao(_S.stateClass,n,"{\n            continueIter: true,\n        }"))},dependencies:[gd,()=>lo([io(_S.stateClass,[ro("boolean","continueIter")])])]};var IS,TS,xS;const OS={translateArgs:e=>{let{args:n}=e;return{maxValue:Ku(n[0])||0}},build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"}}})},CS=ac("random",["setMaxValue"]),MS={messageReceivers:e=>{let{snds:n,state:t}=e;return{0:oo([ro("Message","m")])(xS||(xS=r(["\n        if (msg_isBang(m)) {\n            ","(msg_floats([Math.floor(Math.random() * ",".maxValue)]))\n            return\n        } else if (\n            msg_isMatching(m, [MSG_STRING_TOKEN, MSG_FLOAT_TOKEN])\n            && msg_readStringToken(m, 0) === 'seed'\n        ) {\n            console.log('WARNING : seed not implemented yet for [random]')\n            return\n        }\n    "])),n[0],t),1:rc(CS.setMaxValue,t)}},initialization:e=>{let{node:{args:n},state:t}=e;return uo(TS||(TS=r(["\n        ","\n    "])),ao(CS.stateClass,t,"{\n            maxValue: ".concat(n.maxValue,"\n        }")))},dependencies:[gd,()=>lo([io(CS.stateClass,[ro("Float","maxValue")]),so(CS.setMaxValue,[ro(CS.stateClass,"state"),ro("Float","maxValue")],"void")(IS||(IS=r(["\n        state.maxValue = Math.max(maxValue, 0)\n    "])))])]};var ES,AS,FS,PS,NS,RS,LS,DS;const US={translateArgs:e=>{let{args:n}=e,t=0;return n.length>=1&&(t=$u(n[n.length-1]),n=n.slice(0,-1)),n=n.length?n:[0],{typeArguments:n.map(Dv).map((e=>["number"===typeof e?"float":Uv(e),"number"===typeof e?e:"float"===e?0:"symbol"])),delay:t}},build:e=>({inlets:{...Ls(e.typeArguments,((e,n)=>["".concat(n),{type:"message",id:"".concat(n)}])),["".concat(e.typeArguments.length)]:{type:"message",id:"".concat(e.typeArguments.length)}},outlets:Ls(e.typeArguments,((e,n)=>["".concat(n),{type:"message",id:"".concat(n)}]))})},jS=ac("pipe",["prepareMessageScheduling","sendMessages","clear","setDelay","ScheduledMessage","dummyScheduledMessage"]),zS={messageReceivers:e=>{let{node:{args:n},state:t,globs:a}=e;return{0:oo([ro("Message","m")])(RS||(RS=r(["\n        if (msg_isAction(m, 'clear')) {\n            ","(",")\n            return \n\n        } else if (msg_isAction(m, 'flush')) {\n            if (",".scheduledMessages.length) {\n                ","(\n                    ",", \n                    ",".scheduledMessages[",".scheduledMessages.length - 1].frame\n                )\n            }\n            return\n\n        } else {\n            ","\n            ","\n\n            ","\n\n            return\n        }\n    "])),jS.clear,t,t,jS.sendMessages,t,t,t,ao("Message","inMessage","msg_isBang(m) ? msg_create([]): m"),ao("Int","insertIndex","".concat(jS.prepareMessageScheduling,"(\n                ").concat(t,", \n                () => {\n                    ").concat(jS.sendMessages,"(").concat(t,", ").concat(a.frame,")\n                },\n            )")),n.typeArguments.slice(0).reverse().map(((e,t)=>{let[r]=e;return[n.typeArguments.length-t-1,r]})).map(((e,n)=>{let[a,s]=e;return uo(LS||(LS=r(["\n                        if (msg_getLength(inMessage) > ",") {\n                            ",".scheduledMessages[insertIndex + ","].message = \n                                ","\n                            ",".outputMessages[","] \n                                = ",".scheduledMessages[insertIndex + ","].message\n                        } else {\n                            ",".scheduledMessages[insertIndex + ","].message \n                                = ",".outputMessages[","]\n                        }\n                    "])),a,t,n,jv(s,"inMessage",a),t,a,t,n,t,n,t,a)}))),...Ls(n.typeArguments.slice(1),((e,n)=>{let[a]=e;return["".concat(n+1),oo([ro("Message","m")])(DS||(DS=r(["\n                ",".outputMessages[","] = ","\n                return\n            "])),t,n+1,jv(a,"m",0))]})),[n.typeArguments.length]:rc(jS.setDelay,t)}},initialization:e=>{let{node:{args:n,id:t},state:a,snds:s}=e;return uo(NS||(NS=r(["\n        ","\n\n        commons_waitEngineConfigure(() => {\n            ","(",", ",")\n        })\n    "])),ao(jS.stateClass,a,"{\n            delay: 0,\n            outputMessages: [".concat(n.typeArguments.map((e=>{let[n,t]=e;return"number"===typeof t?"msg_floats([".concat(t,"])"):'msg_strings(["'.concat(t,'"])')})).join(","),"],\n            scheduledMessages: [],\n            snds: [").concat(Ns(n.typeArguments.length).reverse().map((e=>s[e])).join(", "),"],\n        }")),jS.setDelay,a,n.delay)},dependencies:[zv,Bv,gd,hd,gi,mi,e=>{let{globs:n}=e;return lo([io(jS.stateClass,[ro("Int","delay"),ro("Array<Message>","outputMessages"),ro("Array<".concat(jS.ScheduledMessage,">"),"scheduledMessages"),ro("Array<(m: Message) => void>","snds")]),io(jS.ScheduledMessage,[ro("Message","message"),ro("Int","frame"),ro("SkedId","skedId")]),ao(jS.ScheduledMessage,jS.dummyScheduledMessage,"{\n        message: msg_create([]),\n        frame: 0,\n        skedId: SKED_ID_NULL,\n    }"),so(jS.prepareMessageScheduling,[ro(jS.stateClass,"state"),ro("SkedCallback","callback")],"Int")(ES||(ES=r(["\n        ","\n        ","\n        ","\n\n        while (\n            insertIndex < state.scheduledMessages.length \n            && state.scheduledMessages[insertIndex].frame <= frame\n        ) {\n            insertIndex++\n        }\n\n        ","\n        if (\n            insertIndex === 0 || \n            (\n                insertIndex > 0 \n                && state.scheduledMessages[insertIndex - 1].frame !== frame\n            )\n        ) {\n            skedId = commons_waitFrame(frame, callback)\n        }\n\n        ","\n        for (","; i < state.snds.length; i++) {\n            state.scheduledMessages.push(",")\n        }\n        state.scheduledMessages.copyWithin(\n            (insertIndex + 1) * state.snds.length, \n            insertIndex * state.snds.length\n        )\n        for (","; i < state.snds.length; i++) {\n            state.scheduledMessages[insertIndex + i] = {\n                message: ",".message,\n                frame,\n                skedId,\n            }\n        }\n\n        return insertIndex\n    "])),ro("Int","insertIndex","0"),ro("Int","frame","".concat(n.frame," + state.delay")),ro("SkedId","skedId","SKED_ID_NULL"),"","",ro("Int","i",0),jS.dummyScheduledMessage,ro("Int","i",0),jS.dummyScheduledMessage),so(jS.sendMessages,[ro(jS.stateClass,"state"),ro("Int","toFrame")],"void")(AS||(AS=r(["\n        ","\n        while (\n            state.scheduledMessages.length \n            && state.scheduledMessages[0].frame <= toFrame\n        ) {\n            for (i = 0; i < state.snds.length; i++) {\n                // Snds are already reversed\n                state.snds[i](state.scheduledMessages.shift().message)\n            }\n        }\n    "])),ro("Int","i",0)),so(jS.clear,[ro(jS.stateClass,"state")],"void")(FS||(FS=r(["\n        ","\n        ","\n        for (i; i < length; i++) {\n            commons_cancelWaitFrame(state.scheduledMessages[i].skedId)\n        }\n        state.scheduledMessages = []\n    "])),ro("Int","i","0"),ao("Int","length","state.scheduledMessages.length")),so(jS.setDelay,[ro(jS.stateClass,"state"),ro("Float","delay")],"void")(PS||(PS=r(["\n        state.delay = toInt(Math.round(delay / 1000 * ","))\n    "])),n.sampleRate)])}]};var BS,VS,GS,WS;const $S={translateArgs:e=>{let{args:n}=e;return{typeArguments:(n.length?n:["float","float"]).map(Dv).map((e=>{if("bang"===(e=e||"float")&&(e="float"),"number"===typeof e)return e;if(!["float","symbol"].includes(e))throw new Error("".concat(e," not supported (yet)"));return e})).map((e=>["number"===typeof e?"float":Uv(e),"number"===typeof e?e:"float"===e?0:"symbol"]))}},build:e=>{let{typeArguments:n}=e;return{inlets:Ls(n,((e,n)=>["".concat(n),{type:"message",id:"".concat(n)}])),outlets:{0:{type:"message",id:"0"}}}}},HS=ac("pack"),KS={messageReceivers:e=>{let{snds:n,state:t,node:a}=e;return{0:oo([ro("Message","m")])(VS||(VS=r(["\n        if (!msg_isBang(m)) {\n            for (","; i < msg_getLength(m); i++) {\n                ",".stringValues[i] = messageTokenToString(m, i)\n                ",".floatValues[i] = messageTokenToFloat(m, i)\n            }\n        }\n\n        ","\n\n        ","\n\n        ","\n\n        ","(messageOut)\n        return\n    "])),ro("Int","i","0"),t,t,ao("MessageTemplate","template","[".concat(a.args.typeArguments.map(((e,n)=>{let[r]=e;return"symbol"===r?"MSG_STRING_TOKEN, ".concat(t,".stringValues[").concat(n,"].length"):"MSG_FLOAT_TOKEN"})).join(","),"]")),ao("Message","messageOut","msg_create(template)"),a.args.typeArguments.map(((e,n)=>{let[r]=e;return"symbol"===r?"msg_writeStringToken(messageOut, ".concat(n,", ").concat(t,".stringValues[").concat(n,"])"):"msg_writeFloatToken(messageOut, ".concat(n,", ").concat(t,".floatValues[").concat(n,"])")})),n[0]),...Ls(a.args.typeArguments.slice(1),((e,n)=>{let[a]=e;if("symbol"===a)return["".concat(n+1),oo([ro("Message","m")])(GS||(GS=r(["\n                    ",".stringValues[","] = messageTokenToString(m, 0)\n                    return\n                "])),t,n+1)];if("float"===a)return["".concat(n+1),oo([ro("Message","m")])(WS||(WS=r(["\n                    ",".floatValues[","] = messageTokenToFloat(m, 0)\n                    return\n                "])),t,n+1)];throw new Error("Unsupported type argument ".concat(a))}))}},initialization:e=>{let{node:{args:n},state:t}=e;return uo(BS||(BS=r(["\n        ","\n    "])),ao(HS.stateClass,t,"{\n            floatValues: [".concat(n.typeArguments.map((e=>{let[n,t]=e;return"float"===n?t:0})).join(","),"],\n            stringValues: [").concat(n.typeArguments.map((e=>{let[n,t]=e;return"symbol"===n?'"'.concat(t,'"'):'""'})).join(","),"]\n        }")))},dependencies:[Bv,zv,gd,()=>lo([io(HS.stateClass,[ro("Array<Float>","floatValues"),ro("Array<string>","stringValues")])])]};var qS;const YS={translateArgs:e=>{let{args:n}=e;return{typeArguments:0===n.length?["float","float"]:n.map(Dv).map((e=>{if("number"===typeof e)return"float";if("symbol"===e||"float"===e)return e;throw new Error('Invalid type argument for unpack "'.concat(e,'"'))}))}},build:e=>{let{typeArguments:n}=e;return{inlets:{0:{type:"message",id:"0"}},outlets:Ls(n,((e,n)=>["".concat(n),{type:"message",id:"".concat(n)}]))}}},XS={messageReceivers:e=>{let{snds:n,node:{args:t}}=e;return{0:oo([ro("Message","m")])(qS||(qS=r(["\n        ","\n        return\n    "])),t.typeArguments.map(((e,n)=>[e,n])).reverse().map((e=>{let[t,r]=e;return"\n                if (\n                    msg_getLength(m) >= ".concat(r+1,"\n                ) {\n                    if (msg_getTokenType(m, ").concat(r,") === ").concat("float"===t?"MSG_FLOAT_TOKEN":"MSG_STRING_TOKEN",") {\n                        ").concat(Ds(["float"===t,"".concat(n[r],"(msg_floats([msg_readFloatToken(m, ").concat(r,")]))")],["symbol"===t,"".concat(n[r],"(msg_strings([msg_readStringToken(m, ").concat(r,")]))")]),"\n                    } else {\n                        console.log('unpack : invalid token type index ").concat(r,"')\n                    }\n                }\n            ")})))}}};var JS,QS,ZS,ew;const nw={translateArgs:e=>{let{args:n}=e;return{tokenizedExpressions:pw(n).map(lw)}},build:e=>({inlets:Ls(dw(e.tokenizedExpressions),(e=>{let{id:n}=e;return["".concat(n),{type:"message",id:"".concat(n)}]})),outlets:Ls(e.tokenizedExpressions,((e,n)=>["".concat(n),{type:"message",id:"".concat(n)}]))})},tw={translateArgs:e=>{let{args:n}=e;return{tokenizedExpressions:pw(n).map(lw)}},build:e=>({inlets:Ls(fw(e.tokenizedExpressions),(e=>{let{id:n,type:t}=e;return["".concat(n),{type:"signal"===t?"signal":"message",id:"".concat(n)}]})),outlets:Ls(e.tokenizedExpressions,((e,n)=>["".concat(n),{type:"signal",id:"".concat(n)}]))})},rw=ac("expr"),aw=()=>lo([io(rw.stateClass,[ro("Map<Int, Float>","floatInputs"),ro("Map<Int, string>","stringInputs"),ro("Array<Float>","outputs")])]),sw=e=>{let{node:{args:n,type:t},state:a}=e;const s="expr"===t?dw(n.tokenizedExpressions):fw(n.tokenizedExpressions).filter((e=>{let{type:n}=e;return"signal"!==n}));return uo(JS||(JS=r(["\n        ","\n\n        ","\n        ","\n    "])),ao(rw.stateClass,a,"{\n            floatInputs: new Map(),\n            stringInputs: new Map(),\n            outputs: new Array(".concat(n.tokenizedExpressions.length,"),\n        }")),s.filter((e=>"float"===e.type||"int"===e.type)).map((e=>"".concat(a,".floatInputs.set(").concat(e.id,", 0)"))),s.filter((e=>"string"===e.type)).map((e=>"".concat(a,".stringInputs.set(").concat(e.id,", '')"))))},ow=e=>{let{snds:n,state:t,node:{args:a,type:s}}=e;const o="expr"===s?dw(a.tokenizedExpressions):fw(a.tokenizedExpressions).filter((e=>{let{type:n}=e;return"signal"!==n})),i=o.length&&0===o[0].id;return{0:oo([ro("Message","m")])(QS||(QS=r(["\n            if (!msg_isBang(m)) {\n                for (","; i < msg_getLength(m); i++) {\n                    ",".stringInputs.set(i, messageTokenToString(m, i))\n                    ",".floatInputs.set(i, messageTokenToFloat(m, i))\n                }\n            }\n\n            ","\n            \n            return\n        "])),ro("Int","i","0"),t,t,"expr"===s?"\n                ".concat(a.tokenizedExpressions.map(((e,n)=>"".concat(t,".outputs[").concat(n,"] = ").concat(uw(t,null,e)))),"\n        \n                ").concat(a.tokenizedExpressions.map(((e,r)=>"".concat(n["".concat(r)],"(msg_floats([").concat(t,".outputs[").concat(r,"]]))"))),"\n            "):null),...Ls(o.slice(i?1:0),(e=>{let{id:n,type:a}=e;if("float"===a||"int"===a)return["".concat(n),oo([ro("Message","m")])(ZS||(ZS=r(["\n                            ",".floatInputs.set(",", messageTokenToFloat(m, 0))\n                            return\n                        "])),t,n)];if("string"===a)return["".concat(n),oo([ro("Message","m")])(ew||(ew=r(["\n                            ",".stringInputs.set(",", messageTokenToString(m, 0))\n                            return\n                        "])),t,n)];throw new Error("invalid input type ".concat(a))}))}},iw=/(?<f>\$f(?<id_f>[0-9]+))|(?<v>\$v(?<id_v>[0-9]+))|(?<i>\$i(?<id_i>[0-9]+))|(?<s>\$s(?<id_s>[0-9]+)\s*\[(?<sIndex>[^\[\]]*)\])/,lw=e=>{let n,t=[];for(;n=iw.exec(e);)n.index&&t.push({type:"raw",content:e.slice(0,n.index)}),n[1]?t.push({type:"float",id:parseInt(n[2])-1}):n[3]?t.push({type:"signal",id:parseInt(n[4])-1}):n[5]?t.push({type:"int",id:parseInt(n[6])-1}):n[7]&&(t=[...t,{type:"string",id:parseInt(n[8])-1},{type:"indexing-start"},...lw(n[9]),{type:"indexing-end"}]),e=e.slice(n.index+n[0].length);return e.length&&t.push({type:"raw",content:e}),t},uw=(e,n,t)=>"+("+t.map((t=>{switch(t.type){case"float":return"".concat(e,".floatInputs.get(").concat(t.id,")");case"signal":if(null===n)throw new Error("invalid token signal received");return n[t.id];case"int":return"roundFloatAsPdInt(".concat(e,".floatInputs.get(").concat(t.id,"))");case"string":return"commons_getArray(".concat(e,".stringInputs.get(").concat(t.id,"))");case"indexing-start":return"[toInt(";case"indexing-end":return")]";case"raw":return t.content}})).join("")+")",cw=e=>{const n=[];e.forEach((e=>{e.forEach((e=>{"float"!==e.type&&"signal"!==e.type&&"int"!==e.type&&"string"!==e.type||n.push(e)}))})),n.sort(((e,n)=>{let{id:t}=e,{id:r}=n;return t-r}));const t=new Map;return n.filter((e=>{if(t.has(e.id)){if(t.get(e.id).type!==e.type)throw new Error("contradictory definitions for input ".concat(e.id));return!1}return t.set(e.id,e),!0}))},dw=e=>{const n=cw(e);return n.forEach((e=>{if("signal"===e.type)throw new Error("invalid signal token $v# for [expr]")})),n},fw=e=>cw(e),pw=e=>{let n=e.join(" ");return Object.getOwnPropertyNames(Math).forEach((e=>{n=n.replaceAll(e,"Math.".concat(e))})),n.split(";").map((e=>e.trim()))},gw={expr:{messageReceivers:ow,initialization:sw,dependencies:[Bv,zv,cy,gd,pi,aw]},"expr~":{messageReceivers:ow,initialization:sw,loop:e=>{let{node:{args:n},state:t,outs:r,ins:a}=e;return lo(n.tokenizedExpressions.map(((e,n)=>"".concat(r[n]," = ").concat(uw(t,a,e)))))},dependencies:[Bv,zv,cy,gd,pi,aw]}},mw={expr:nw,"expr~":tw};var hw,yw,bw,vw;const Sw=e=>({translateArgs:n=>{const t=Ku(n.args[0]);return{value:void 0!==t?t:e}},build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"}}})}),ww=ac("binopbase"),_w=e=>{let{operationName:n,generateOperation:t,dependencies:a=[],prepareLeftOp:s,prepareRightOp:o}=e;const i=ac(n,["setLeft","setRight"]);return{initialization:e=>{let{state:n,node:{args:t}}=e;return uo(hw||(hw=r(["\n        ","\n            ","(",", 0)\n            ","(",", ",")\n        "])),ao(ww.stateClass,n,"{\n                leftOp: 0,\n                rightOp: 0,\n            }"),i.setLeft,n,i.setRight,n,t.value)},messageReceivers:e=>{let{state:n,snds:a}=e;return{0:oo([ro("Message","m")])(yw||(yw=r(["\n                if (msg_isMatching(m, [MSG_FLOAT_TOKEN])) {\n                    ","(",", msg_readFloatToken(m, 0))\n                    ","(msg_floats([","]))\n                    return\n                \n                } else if (msg_isBang(m)) {\n                    ","(msg_floats([","]))\n                    return\n                }\n            "])),i.setLeft,n,a.$0,t(n),a.$0,t(n)),1:rc(i.setRight,n)}},dependencies:[gd,...a,()=>lo([io(ww.stateClass,[ro("Float","leftOp"),ro("Float","rightOp")])]),()=>lo([so(i.setLeft,[ro(ww.stateClass,"state"),ro("Float","value")],"void")(bw||(bw=r(["\n                    state.leftOp = ","\n                "])),s||"value"),so(i.setRight,[ro(ww.stateClass,"state"),ro("Float","value")],"void")(vw||(vw=r(["\n                    state.rightOp = ","\n                "])),o||"value")])]}},kw={"+":_w({operationName:"add",generateOperation:e=>"".concat(e,".leftOp + ").concat(e,".rightOp")}),"-":_w({operationName:"sub",generateOperation:e=>"".concat(e,".leftOp - ").concat(e,".rightOp")}),"*":_w({operationName:"mul",generateOperation:e=>"".concat(e,".leftOp * ").concat(e,".rightOp")}),"/":_w({operationName:"div",generateOperation:e=>"".concat(e,".rightOp !== 0 ? ").concat(e,".leftOp / ").concat(e,".rightOp: 0")}),max:_w({operationName:"max",generateOperation:e=>"Math.max(".concat(e,".leftOp, ").concat(e,".rightOp)")}),min:_w({operationName:"min",generateOperation:e=>"Math.min(".concat(e,".leftOp, ").concat(e,".rightOp)")}),mod:_w({operationName:"mod",prepareLeftOp:"value > 0 ? Math.floor(value): Math.ceil(value)",prepareRightOp:"Math.floor(Math.abs(value))",generateOperation:e=>"".concat(e,".rightOp !== 0 ? (").concat(e,".rightOp + (").concat(e,".leftOp % ").concat(e,".rightOp)) % ").concat(e,".rightOp: 0")}),"%":_w({operationName:"modlegacy",generateOperation:e=>"".concat(e,".leftOp % ").concat(e,".rightOp")}),pow:_w({operationName:"pow",generateOperation:e=>"pow(".concat(e,".leftOp, ").concat(e,".rightOp)"),dependencies:[Rg]}),log:_w({operationName:"log",generateOperation:e=>"Math.log(".concat(e,".leftOp) / Math.log(").concat(e,".rightOp)")}),"||":_w({operationName:"or",prepareLeftOp:"Math.floor(Math.abs(value))",prepareRightOp:"Math.floor(Math.abs(value))",generateOperation:e=>"".concat(e,".leftOp || ").concat(e,".rightOp ? 1: 0")}),"&&":_w({operationName:"and",prepareLeftOp:"Math.floor(Math.abs(value))",prepareRightOp:"Math.floor(Math.abs(value))",generateOperation:e=>"".concat(e,".leftOp && ").concat(e,".rightOp ? 1: 0")}),">":_w({operationName:"gt",generateOperation:e=>"".concat(e,".leftOp > ").concat(e,".rightOp ? 1: 0")}),">=":_w({operationName:"gte",generateOperation:e=>"".concat(e,".leftOp >= ").concat(e,".rightOp ? 1: 0")}),"<":_w({operationName:"lt",generateOperation:e=>"".concat(e,".leftOp < ").concat(e,".rightOp ? 1: 0")}),"<=":_w({operationName:"lte",generateOperation:e=>"".concat(e,".leftOp <= ").concat(e,".rightOp ? 1: 0")}),"==":_w({operationName:"eq",generateOperation:e=>"".concat(e,".leftOp == ").concat(e,".rightOp ? 1: 0")}),"!=":_w({operationName:"neq",generateOperation:e=>"".concat(e,".leftOp != ").concat(e,".rightOp ? 1: 0")})},Iw={"+":Sw(0),"-":Sw(0),"*":Sw(1),"/":Sw(1),max:Sw(0),min:Sw(1),mod:Sw(0),"%":Sw(0),pow:Sw(0),log:Sw(Math.E),"||":Sw(0),"&&":Sw(0),">":Sw(0),">=":Sw(0),"<":Sw(0),"<=":Sw(0),"==":Sw(0),"!=":Sw(0)},Tw={...Wu,...Ry,...Wg,...kp,...ib,...pb,...qy,...vh,..._v,..._v,...ym,"noise~":{translateArgs:()=>({}),build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"signal",id:"0"}}})},"snapshot~":Up,"sig~":ic,"samphold~":Fp,"clip~":xp,"vline~":{translateArgs:()=>({}),build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"},2:{type:"message",id:"2"}},outlets:{0:{type:"signal",id:"0"}}})},"line~":cg,"dac~":dp,"adc~":pp,"samplerate~":{translateArgs:()=>({}),build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"message",id:"0"}}})},"tabplay~":Tm,"readsf~":Dm,"writesf~":$m,"vd~":{aliasTo:"delread4~"},"bp~":nh,"hip~":yb,"lop~":kb,"vcf~":Ab,"delwrite~":eb,"s~":{aliasTo:"send~"},"r~":{aliasTo:"receive~"},...xd,...sy,...Iw,...Ty,...vy,...mw,bang:Xh,bng:{aliasTo:"bang"},b:{aliasTo:"bang"},list:iv,symbol:pv,loadbang:{translateArgs:()=>({}),build:()=>({inlets:{},outlets:{0:{type:"message",id:"0"}},isPushingMessages:!0})},s:{aliasTo:"send"},r:{aliasTo:"receive"},print:{translateArgs:e=>{let n="print:";return 1===e.args.length&&"-n"===e.args[0]?n="":e.args.length>=1&&(n=e.args.join(" ")+":"),{prefix:n}},build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{}})},trigger:Gv,t:{aliasTo:"trigger"},change:Kv,clip:rS,pipe:US,moses:Qv,pack:$S,unpack:YS,spigot:hS,until:{translateArgs:()=>({}),build:()=>({inlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}},outlets:{0:{type:"message",id:"0"}}})},random:OS,route:cS,select:{aliasTo:"route"},sel:{aliasTo:"route"},msg:{skipDollarArgsResolution:!0,translateArgs:e=>{let{args:n}=e;const t=[[]];return n.forEach((e=>{","===e?t.push([]):t[t.length-1].push(e)})),{templates:t.filter((e=>e.length)).map((e=>"symbol"===e[0]?["string"===typeof e[1]?e[1]:""]:e))}},build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"message",id:"0"}}})},metro:Mh,timer:Rh,delay:Gh,del:{aliasTo:"delay"},line:xg,soundfiler:{translateArgs:()=>({}),build:()=>({inlets:{0:{type:"message",id:"0"}},outlets:{0:{type:"message",id:"0"},1:{type:"message",id:"1"}}})},tabread:em,tabwrite:im,"_mixer~":Ju,_routemsg:dc,graph:{isNoop:!0},table:{isNoop:!0},array:{isNoop:!0},text:{isNoop:!0},cnv:{isNoop:!0},"block~":{isNoop:!0},openpanel:{isNoop:!0}},xw={...Ny,...Gg,..._p,...lb,...gb,...Yy,...Sh,...kv,...bm,"noise~":Uy,"snapshot~":zp,"sig~":uc,"samphold~":Np,"clip~":Cp,"vline~":rg,"line~":fg,"dac~":fp,"adc~":gp,"samplerate~":hp,"tabplay~":Om,"readsf~":jm,"writesf~":Km,"delwrite~":tb,"bp~":rh,"hip~":vb,"lop~":Tb,"vcf~":Pb,...Td,...oy,...kw,...Sy,...Iy,...gw,bang:Qh,list:uv,symbol:mv,loadbang:ly,print:Pv,trigger:Wv,change:Yv,clip:sS,pipe:zS,moses:eS,pack:KS,unpack:XS,spigot:bS,until:kS,route:fS,random:MS,msg:qb,metro:Ah,timer:Dh,delay:$h,line:Cg,tabread:tm,tabwrite:um,soundfiler:Av,"_mixer~":Qu,_routemsg:fc},Ow=async e=>{throw new As(e)},Cw=()=>({}),Mw=async(e,n,t)=>{let{nodeBuilders:r,nodeImplementations:a,audioSettings:s,renderAudioSettings:o,io:i={},abstractionLoader:l}=t,u=[],c=[];switch(n){case"pdJson":const t=Is(e.pd);return 0===t.status?(e.pdJson=t.pd,{status:0,warnings:Aw(t.warnings)}):{status:1,warnings:Aw(t.warnings),errors:Aw(t.errors)};case"dspGraph":const f=await Ic(e.pdJson,r,l);if(f.abstractionsLoadingWarnings&&(u=Object.entries(f.abstractionsLoadingWarnings).filter((e=>{let[n,t]=e;return!!t.length})).flatMap((e=>{let[n,t]=e;return["Warnings when parsing abstraction ".concat(n," :"),...Aw(t)]}))),0===f.status){if(!i.messageReceivers){const{controls:e}=_u(f.pd);i.messageReceivers={...Md(e,f.graph),...Cd(f.pd,f.graph)}}return e.dspGraph={graph:f.graph,arrays:f.arrays,pd:f.pd,io:{messageReceivers:{},messageSenders:{},...i}},{status:0,warnings:u}}{const e=Object.values(f.abstractionsLoadingErrors).filter((e=>!!e.unknownNodeType)).map((e=>e.unknownNodeType));return e.length&&(c=[...c,...Ew(new Set(e))]),c=[...c,...Object.entries(f.abstractionsLoadingErrors).filter((e=>{let[n,t]=e;return!!t.parsingErrors})).flatMap((e=>{let[n,t]=e;return["Failed to parse abstraction ".concat(n," :"),...Aw(t.parsingErrors)]}))],{status:1,errors:c,warnings:u}}case"javascript":case"assemblyscript":const p=yu(e.dspGraph.graph,a,n,{audio:s,io:e.dspGraph.io,arrays:e.dspGraph.arrays});return"javascript"===n?e.javascript=p.code:e.assemblyscript=p.code,{status:0,warnings:[]};case"wasm":try{e.wasm=await(async(e,n)=>{if(!qa)throw new Error("assemblyscript compiler was not set properly. Please use WebPd's setAsc function to initialize it.");const t={optimizeLevel:3,debug:!0,runtime:"incremental",exportRuntime:!0,sourceMap:!0};32===n&&(t.use=["Math=NativeMathf"]);const{error:r,binary:a,stderr:s}=await qa.compileString(e,t);if(r)throw new Error(s.toString());return a.buffer})(Fs(e,"assemblyscript"),s.bitDepth)}catch(d){return{status:1,errors:[d.message],warnings:[]}}return{status:0,warnings:[]};case"wav":return e.wav=await(async(e,n,t)=>{let r="assemblyscript";if(!n.wasm&&!n.javascript)throw new Error("Need compiled wasm or compiled js to render wav");n.wasm||(r="javascript");const a=await tp(n,r),s=await rp(a,e,t);return np(s,t.sampleRate)})(o.previewDurationSeconds,e,{...s,...o}),{status:0,warnings:[]};case"app":return e.app=((e,n)=>{if("bare-bones"===e)return{...wu({artefacts:n}),[Su]:"var WebPdRuntime = (function (exports) {\n  'use strict';\n\n  var _WebPdWorkletProcessorCode = \"/*\\n * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\\n *\\n * This file is part of WebPd\\n * (see https://github.com/sebpiq/WebPd).\\n *\\n * This program is free software: you can redistribute it and/or modify\\n * it under the terms of the GNU Lesser General Public License as published by\\n * the Free Software Foundation, either version 3 of the License, or\\n * (at your option) any later version.\\n *\\n * This program is distributed in the hope that it will be useful,\\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\n * GNU Lesser General Public License for more details.\\n *\\n * You should have received a copy of the GNU Lesser General Public License\\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\\n */\\nconst FS_CALLBACK_NAMES = [\\n    'onReadSoundFile',\\n    'onOpenSoundReadStream',\\n    'onWriteSoundFile',\\n    'onOpenSoundWriteStream',\\n    'onSoundStreamData',\\n    'onCloseSoundStream',\\n];\\nclass WasmWorkletProcessor extends AudioWorkletProcessor {\\n    constructor() {\\n        super();\\n        this.port.onmessage = this.onMessage.bind(this);\\n        this.settings = {\\n            blockSize: null,\\n            sampleRate,\\n        };\\n        this.dspConfigured = false;\\n        this.engine = null;\\n    }\\n    process(inputs, outputs) {\\n        const output = outputs[0];\\n        const input = inputs[0];\\n        if (!this.dspConfigured) {\\n            if (!this.engine) {\\n                return true;\\n            }\\n            this.settings.blockSize = output[0].length;\\n            this.engine.configure(this.settings.sampleRate, this.settings.blockSize);\\n            this.dspConfigured = true;\\n        }\\n        this.engine.loop(input, output);\\n        return true;\\n    }\\n    onMessage(messageEvent) {\\n        const message = messageEvent.data;\\n        switch (message.type) {\\n            case 'code:WASM':\\n                this.setWasm(message.payload.wasmBuffer);\\n                break;\\n            case 'code:JS':\\n                this.setJsCode(message.payload.jsCode);\\n                break;\\n            case 'io:messageReceiver':\\n                this.engine.io.messageReceivers[message.payload.nodeId][message.payload.portletId](message.payload.message);\\n                break;\\n            case 'fs':\\n                const returned = this.engine.fs[message.payload.functionName].apply(null, message.payload.arguments);\\n                this.port.postMessage({\\n                    type: 'fs',\\n                    payload: {\\n                        functionName: message.payload.functionName + '_return',\\n                        operationId: message.payload.arguments[0],\\n                        returned,\\n                    },\\n                });\\n                break;\\n            case 'destroy':\\n                this.destroy();\\n                break;\\n            default:\\n                new Error(`unknown message type ${message.type}`);\\n        }\\n    }\\n    // TODO : control for channelCount of wasmModule\\n    setWasm(wasmBuffer) {\\n        return AssemblyScriptWasmBindings.createEngine(wasmBuffer).then((engine) => this.setEngine(engine));\\n    }\\n    setJsCode(code) {\\n        const engine = JavaScriptBindings.createEngine(code);\\n        this.setEngine(engine);\\n    }\\n    setEngine(engine) {\\n        FS_CALLBACK_NAMES.forEach((functionName) => {\\n            ;\\n            engine.fs[functionName] = (...args) => {\\n                // We don't use transferables, because that would imply reallocating each time new array in the engine.\\n                this.port.postMessage({\\n                    type: 'fs',\\n                    payload: {\\n                        functionName,\\n                        arguments: args,\\n                    },\\n                });\\n            };\\n        });\\n        this.engine = engine;\\n        this.dspConfigured = false;\\n    }\\n    destroy() {\\n        this.process = () => false;\\n    }\\n}\\nregisterProcessor('webpd-node', WasmWorkletProcessor);\\n\";\n\n  var AssemblyScriptWasmBindingsCode = \"var AssemblyScriptWasmBindings = (function (exports) {\\n    'use strict';\\n\\n    const getFloatArrayType = (bitDepth) => bitDepth === 64 ? Float64Array : Float32Array;\\n    const createModule = (rawModule, bindings) => new Proxy({}, {\\n        get: (_, k) => {\\n            if (bindings.hasOwnProperty(k)) {\\n                const key = String(k);\\n                const bindingSpec = bindings[key];\\n                switch (bindingSpec.type) {\\n                    case 'raw':\\n                        if (k in rawModule) {\\n                            return rawModule[key];\\n                        }\\n                        else {\\n                            throw new Error(`Key ${String(key)} doesn't exist in raw module`);\\n                        }\\n                    case 'proxy':\\n                    case 'callback':\\n                        return bindingSpec.value;\\n                }\\n            }\\n            else {\\n                return undefined;\\n            }\\n        },\\n        set: (_, k, newValue) => {\\n            if (bindings.hasOwnProperty(String(k))) {\\n                const key = String(k);\\n                const bindingSpec = bindings[key];\\n                if (bindingSpec.type === 'callback') {\\n                    bindingSpec.value = newValue;\\n                }\\n                else {\\n                    throw new Error(`Binding key ${String(key)} is read-only`);\\n                }\\n            }\\n            else {\\n                throw new Error(`Key ${String(k)} is not defined in bindings`);\\n            }\\n            return true;\\n        },\\n    });\\n\\n    const liftString = (wasmExports, pointer) => {\\n        if (!pointer)\\n            return null;\\n        pointer = pointer >>> 0;\\n        const end = (pointer +\\n            new Uint32Array(wasmExports.memory.buffer)[(pointer - 4) >>> 2]) >>>\\n            1;\\n        const memoryU16 = new Uint16Array(wasmExports.memory.buffer);\\n        let start = pointer >>> 1;\\n        let string = '';\\n        while (end - start > 1024) {\\n            string += String.fromCharCode(...memoryU16.subarray(start, (start += 1024)));\\n        }\\n        return string + String.fromCharCode(...memoryU16.subarray(start, end));\\n    };\\n    const lowerString = (wasmExports, value) => {\\n        if (value == null)\\n            return 0;\\n        const length = value.length, pointer = wasmExports.__new(length << 1, 1) >>> 0, memoryU16 = new Uint16Array(wasmExports.memory.buffer);\\n        for (let i = 0; i < length; ++i)\\n            memoryU16[(pointer >>> 1) + i] = value.charCodeAt(i);\\n        return pointer;\\n    };\\n    const readTypedArray = (wasmExports, constructor, pointer) => {\\n        if (!pointer)\\n            return null;\\n        const memoryU32 = new Uint32Array(wasmExports.memory.buffer);\\n        return new constructor(wasmExports.memory.buffer, memoryU32[(pointer + 4) >>> 2], memoryU32[(pointer + 8) >>> 2] / constructor.BYTES_PER_ELEMENT);\\n    };\\n    const lowerFloatArray = (wasmExports, bitDepth, data) => {\\n        const arrayType = getFloatArrayType(bitDepth);\\n        const arrayPointer = wasmExports.createFloatArray(data.length);\\n        const array = readTypedArray(wasmExports, arrayType, arrayPointer);\\n        array.set(data);\\n        return { array, arrayPointer };\\n    };\\n    const lowerListOfFloatArrays = (wasmExports, bitDepth, data) => {\\n        const arraysPointer = wasmExports.x_core_createListOfArrays();\\n        data.forEach((array) => {\\n            const { arrayPointer } = lowerFloatArray(wasmExports, bitDepth, array);\\n            wasmExports.x_core_pushToListOfArrays(arraysPointer, arrayPointer);\\n        });\\n        return arraysPointer;\\n    };\\n    const readListOfFloatArrays = (wasmExports, bitDepth, listOfArraysPointer) => {\\n        const listLength = wasmExports.x_core_getListOfArraysLength(listOfArraysPointer);\\n        const arrays = [];\\n        const arrayType = getFloatArrayType(bitDepth);\\n        for (let i = 0; i < listLength; i++) {\\n            const arrayPointer = wasmExports.x_core_getListOfArraysElem(listOfArraysPointer, i);\\n            arrays.push(readTypedArray(wasmExports, arrayType, arrayPointer));\\n        }\\n        return arrays;\\n    };\\n\\n    const liftMessage = (wasmExports, messagePointer) => {\\n        const messageTokenTypesPointer = wasmExports.x_msg_getTokenTypes(messagePointer);\\n        const messageTokenTypes = readTypedArray(wasmExports, Int32Array, messageTokenTypesPointer);\\n        const message = [];\\n        messageTokenTypes.forEach((tokenType, tokenIndex) => {\\n            if (tokenType === wasmExports.MSG_FLOAT_TOKEN.valueOf()) {\\n                message.push(wasmExports.msg_readFloatToken(messagePointer, tokenIndex));\\n            }\\n            else if (tokenType === wasmExports.MSG_STRING_TOKEN.valueOf()) {\\n                const stringPointer = wasmExports.msg_readStringToken(messagePointer, tokenIndex);\\n                message.push(liftString(wasmExports, stringPointer));\\n            }\\n        });\\n        return message;\\n    };\\n    const lowerMessage = (wasmExports, message) => {\\n        const template = message.reduce((template, value) => {\\n            if (typeof value === 'number') {\\n                template.push(wasmExports.MSG_FLOAT_TOKEN.valueOf());\\n            }\\n            else if (typeof value === 'string') {\\n                template.push(wasmExports.MSG_STRING_TOKEN.valueOf());\\n                template.push(value.length);\\n            }\\n            else {\\n                throw new Error(`invalid message value ${value}`);\\n            }\\n            return template;\\n        }, []);\\n        const templateArrayPointer = wasmExports.x_msg_createTemplate(template.length);\\n        const loweredTemplateArray = readTypedArray(wasmExports, Int32Array, templateArrayPointer);\\n        loweredTemplateArray.set(template);\\n        const messagePointer = wasmExports.x_msg_create(templateArrayPointer);\\n        message.forEach((value, index) => {\\n            if (typeof value === 'number') {\\n                wasmExports.msg_writeFloatToken(messagePointer, index, value);\\n            }\\n            else if (typeof value === 'string') {\\n                const stringPointer = lowerString(wasmExports, value);\\n                wasmExports.msg_writeStringToken(messagePointer, index, stringPointer);\\n            }\\n        });\\n        return messagePointer;\\n    };\\n\\n    const mapObject = (src, func) => {\\n        const dest = {};\\n        Object.entries(src).forEach(([key, srcValue], i) => {\\n            dest[key] = func(srcValue, key, i);\\n        });\\n        return dest;\\n    };\\n    const mapArray = (src, func) => {\\n        const dest = {};\\n        src.forEach((srcValue, i) => {\\n            const [key, destValue] = func(srcValue, i);\\n            dest[key] = destValue;\\n        });\\n        return dest;\\n    };\\n\\n    const instantiateWasmModule = async (wasmBuffer, wasmImports = {}) => {\\n        const instanceAndModule = await WebAssembly.instantiate(wasmBuffer, {\\n            env: {\\n                abort: (messagePointer, _, lineNumber, columnNumber) => {\\n                    const message = liftString(wasmExports, messagePointer);\\n                    lineNumber = lineNumber;\\n                    columnNumber = columnNumber;\\n                    (() => {\\n                        throw Error(`${message} at ${lineNumber}:${columnNumber}`);\\n                    })();\\n                },\\n                seed: () => {\\n                    return (() => {\\n                        return Date.now() * Math.random();\\n                    })();\\n                },\\n                'console.log': (textPointer) => {\\n                    console.log(liftString(wasmExports, textPointer));\\n                },\\n            },\\n            ...wasmImports,\\n        });\\n        const wasmExports = instanceAndModule.instance\\n            .exports;\\n        return instanceAndModule.instance;\\n    };\\n\\n    const updateWasmInOuts = (rawModule, engineData) => {\\n        engineData.wasmOutput = readTypedArray(rawModule, engineData.arrayType, rawModule.getOutput());\\n        engineData.wasmInput = readTypedArray(rawModule, engineData.arrayType, rawModule.getInput());\\n    };\\n    const createEngineLifecycleBindings = (rawModule, engineData) => {\\n        return {\\n            configure: {\\n                type: 'proxy',\\n                value: (sampleRate, blockSize) => {\\n                    engineData.metadata.audioSettings.blockSize = blockSize;\\n                    engineData.metadata.audioSettings.sampleRate = sampleRate;\\n                    engineData.blockSize = blockSize;\\n                    rawModule.configure(sampleRate, blockSize);\\n                    updateWasmInOuts(rawModule, engineData);\\n                },\\n            },\\n            loop: {\\n                type: 'proxy',\\n                value: (input, output) => {\\n                    for (let channel = 0; channel < input.length; channel++) {\\n                        engineData.wasmInput.set(input[channel], channel * engineData.blockSize);\\n                    }\\n                    updateWasmInOuts(rawModule, engineData);\\n                    rawModule.loop();\\n                    updateWasmInOuts(rawModule, engineData);\\n                    for (let channel = 0; channel < output.length; channel++) {\\n                        output[channel].set(engineData.wasmOutput.subarray(engineData.blockSize * channel, engineData.blockSize * (channel + 1)));\\n                    }\\n                },\\n            },\\n        };\\n    };\\n    const createIoMessageReceiversBindings = (rawModule, engineData) => mapObject(engineData.metadata.compilation.io.messageReceivers, (spec, nodeId) => ({\\n        type: 'proxy',\\n        value: mapArray(spec.portletIds, (inletId) => [\\n            inletId,\\n            (message) => {\\n                const messagePointer = lowerMessage(rawModule, message);\\n                rawModule[engineData.metadata.compilation.variableNamesIndex.io\\n                    .messageReceivers[nodeId][inletId]](messagePointer);\\n            },\\n        ]),\\n    }));\\n    const createIoMessageSendersBindings = (_, engineData) => mapObject(engineData.metadata.compilation.io.messageSenders, (spec) => ({\\n        type: 'proxy',\\n        value: mapArray(spec.portletIds, (outletId) => [\\n            outletId,\\n            {\\n                onMessage: () => undefined,\\n            },\\n        ]),\\n    }));\\n    const ioMsgSendersImports = (forwardReferences, metadata) => {\\n        const wasmImports = {};\\n        const { variableNamesIndex } = metadata.compilation;\\n        Object.entries(metadata.compilation.io.messageSenders).forEach(([nodeId, spec]) => {\\n            spec.portletIds.forEach((outletId) => {\\n                const listenerName = variableNamesIndex.io.messageSenders[nodeId][outletId];\\n                wasmImports[listenerName] = (messagePointer) => {\\n                    const message = liftMessage(forwardReferences.rawModule, messagePointer);\\n                    forwardReferences.modules.io.messageSenders[nodeId][outletId].onMessage(message);\\n                };\\n            });\\n        });\\n        return wasmImports;\\n    };\\n    const readMetadata = async (wasmBuffer) => {\\n        const inputImports = {};\\n        const wasmModule = WebAssembly.Module.imports(new WebAssembly.Module(wasmBuffer));\\n        wasmModule\\n            .filter((imprt) => imprt.module === 'input' && imprt.kind === 'function')\\n            .forEach((imprt) => (inputImports[imprt.name] = () => undefined));\\n        const wasmInstance = await instantiateWasmModule(wasmBuffer, {\\n            input: inputImports,\\n        });\\n        const wasmExports = wasmInstance.exports;\\n        const stringPointer = wasmExports.metadata.valueOf();\\n        const metadataJSON = liftString(wasmExports, stringPointer);\\n        return JSON.parse(metadataJSON);\\n    };\\n\\n    const createFsBindings = (rawModule, engineData) => ({\\n        sendReadSoundFileResponse: {\\n            type: 'proxy',\\n            value: (operationId, status, sound) => {\\n                let soundPointer = 0;\\n                if (sound) {\\n                    soundPointer = lowerListOfFloatArrays(rawModule, engineData.bitDepth, sound);\\n                }\\n                rawModule.x_fs_onReadSoundFileResponse(operationId, status, soundPointer);\\n                updateWasmInOuts(rawModule, engineData);\\n            },\\n        },\\n        sendWriteSoundFileResponse: {\\n            type: 'proxy',\\n            value: rawModule.x_fs_onWriteSoundFileResponse,\\n        },\\n        sendSoundStreamData: {\\n            type: 'proxy',\\n            value: (operationId, sound) => {\\n                const soundPointer = lowerListOfFloatArrays(rawModule, engineData.bitDepth, sound);\\n                const writtenFrameCount = rawModule.x_fs_onSoundStreamData(operationId, soundPointer);\\n                updateWasmInOuts(rawModule, engineData);\\n                return writtenFrameCount;\\n            },\\n        },\\n        closeSoundStream: {\\n            type: 'proxy',\\n            value: rawModule.x_fs_onCloseSoundStream,\\n        },\\n        onReadSoundFile: { type: 'callback', value: () => undefined },\\n        onWriteSoundFile: { type: 'callback', value: () => undefined },\\n        onOpenSoundReadStream: { type: 'callback', value: () => undefined },\\n        onOpenSoundWriteStream: { type: 'callback', value: () => undefined },\\n        onSoundStreamData: { type: 'callback', value: () => undefined },\\n        onCloseSoundStream: { type: 'callback', value: () => undefined },\\n    });\\n    const createFsImports = (forwardReferences) => {\\n        let wasmImports = {\\n            i_fs_readSoundFile: (operationId, urlPointer, infoPointer) => {\\n                const url = liftString(forwardReferences.rawModule, urlPointer);\\n                const info = liftMessage(forwardReferences.rawModule, infoPointer);\\n                forwardReferences.modules.fs.onReadSoundFile(operationId, url, info);\\n            },\\n            i_fs_writeSoundFile: (operationId, soundPointer, urlPointer, infoPointer) => {\\n                const sound = readListOfFloatArrays(forwardReferences.rawModule, forwardReferences.engineData.bitDepth, soundPointer);\\n                const url = liftString(forwardReferences.rawModule, urlPointer);\\n                const info = liftMessage(forwardReferences.rawModule, infoPointer);\\n                forwardReferences.modules.fs.onWriteSoundFile(operationId, sound, url, info);\\n            },\\n            i_fs_openSoundReadStream: (operationId, urlPointer, infoPointer) => {\\n                const url = liftString(forwardReferences.rawModule, urlPointer);\\n                const info = liftMessage(forwardReferences.rawModule, infoPointer);\\n                updateWasmInOuts(forwardReferences.rawModule, forwardReferences.engineData);\\n                forwardReferences.modules.fs.onOpenSoundReadStream(operationId, url, info);\\n            },\\n            i_fs_openSoundWriteStream: (operationId, urlPointer, infoPointer) => {\\n                const url = liftString(forwardReferences.rawModule, urlPointer);\\n                const info = liftMessage(forwardReferences.rawModule, infoPointer);\\n                forwardReferences.modules.fs.onOpenSoundWriteStream(operationId, url, info);\\n            },\\n            i_fs_sendSoundStreamData: (operationId, blockPointer) => {\\n                const block = readListOfFloatArrays(forwardReferences.rawModule, forwardReferences.engineData.bitDepth, blockPointer);\\n                forwardReferences.modules.fs.onSoundStreamData(operationId, block);\\n            },\\n            i_fs_closeSoundStream: (...args) => forwardReferences.modules.fs.onCloseSoundStream(...args),\\n        };\\n        return wasmImports;\\n    };\\n\\n    const createCommonsBindings = (rawModule, engineData) => ({\\n        getArray: {\\n            type: 'proxy',\\n            value: (arrayName) => {\\n                const arrayNamePointer = lowerString(rawModule, arrayName);\\n                const arrayPointer = rawModule.commons_getArray(arrayNamePointer);\\n                return readTypedArray(rawModule, engineData.arrayType, arrayPointer);\\n            },\\n        },\\n        setArray: {\\n            type: 'proxy',\\n            value: (arrayName, array) => {\\n                const stringPointer = lowerString(rawModule, arrayName);\\n                const { arrayPointer } = lowerFloatArray(rawModule, engineData.bitDepth, array);\\n                rawModule.commons_setArray(stringPointer, arrayPointer);\\n                updateWasmInOuts(rawModule, engineData);\\n            },\\n        },\\n    });\\n\\n    const createEngine = async (wasmBuffer) => {\\n        const { rawModule, engineData, forwardReferences } = await createRawModule(wasmBuffer);\\n        const engineBindings = await createBindings(rawModule, engineData, forwardReferences);\\n        return createModule(rawModule, engineBindings);\\n    };\\n    const createRawModule = async (wasmBuffer) => {\\n        const metadata = await readMetadata(wasmBuffer);\\n        const forwardReferences = { modules: {} };\\n        const wasmImports = {\\n            ...createFsImports(forwardReferences),\\n            ...ioMsgSendersImports(forwardReferences, metadata),\\n        };\\n        const bitDepth = metadata.audioSettings.bitDepth;\\n        const arrayType = getFloatArrayType(bitDepth);\\n        const engineData = {\\n            metadata,\\n            wasmOutput: new arrayType(0),\\n            wasmInput: new arrayType(0),\\n            arrayType,\\n            bitDepth,\\n            blockSize: 0,\\n        };\\n        const wasmInstance = await instantiateWasmModule(wasmBuffer, {\\n            input: wasmImports,\\n        });\\n        const rawModule = wasmInstance.exports;\\n        return { rawModule, engineData, forwardReferences };\\n    };\\n    const createBindings = async (rawModule, engineData, forwardReferences) => {\\n        const commons = createModule(rawModule, createCommonsBindings(rawModule, engineData));\\n        const fs = createModule(rawModule, createFsBindings(rawModule, engineData));\\n        const io = {\\n            messageReceivers: createModule(rawModule, createIoMessageReceiversBindings(rawModule, engineData)),\\n            messageSenders: createModule(rawModule, createIoMessageSendersBindings(rawModule, engineData)),\\n        };\\n        forwardReferences.modules.fs = fs;\\n        forwardReferences.modules.io = io;\\n        forwardReferences.engineData = engineData;\\n        forwardReferences.rawModule = rawModule;\\n        return {\\n            ...createEngineLifecycleBindings(rawModule, engineData),\\n            metadata: { type: 'proxy', value: engineData.metadata },\\n            commons: { type: 'proxy', value: commons },\\n            fs: { type: 'proxy', value: fs },\\n            io: { type: 'proxy', value: io },\\n        };\\n    };\\n\\n    exports.createBindings = createBindings;\\n    exports.createEngine = createEngine;\\n    exports.createRawModule = createRawModule;\\n\\n    return exports;\\n\\n})({});\\n\";\n\n  var JavaScriptBindingsCode = \"var JavaScriptBindings = (function (exports) {\\n    'use strict';\\n\\n    const getFloatArrayType = (bitDepth) => bitDepth === 64 ? Float64Array : Float32Array;\\n    const createModule = (rawModule, bindings) => new Proxy({}, {\\n        get: (_, k) => {\\n            if (bindings.hasOwnProperty(k)) {\\n                const key = String(k);\\n                const bindingSpec = bindings[key];\\n                switch (bindingSpec.type) {\\n                    case 'raw':\\n                        if (k in rawModule) {\\n                            return rawModule[key];\\n                        }\\n                        else {\\n                            throw new Error(`Key ${String(key)} doesn't exist in raw module`);\\n                        }\\n                    case 'proxy':\\n                    case 'callback':\\n                        return bindingSpec.value;\\n                }\\n            }\\n            else {\\n                return undefined;\\n            }\\n        },\\n        set: (_, k, newValue) => {\\n            if (bindings.hasOwnProperty(String(k))) {\\n                const key = String(k);\\n                const bindingSpec = bindings[key];\\n                if (bindingSpec.type === 'callback') {\\n                    bindingSpec.value = newValue;\\n                }\\n                else {\\n                    throw new Error(`Binding key ${String(key)} is read-only`);\\n                }\\n            }\\n            else {\\n                throw new Error(`Key ${String(k)} is not defined in bindings`);\\n            }\\n            return true;\\n        },\\n    });\\n\\n    const createRawModule = (code) => new Function(`\\n        ${code}\\n        return exports\\n    `)();\\n    const createBindings = (rawModule) => ({\\n        fs: { type: 'proxy', value: createFsModule(rawModule) },\\n        metadata: { type: 'raw' },\\n        configure: { type: 'raw' },\\n        loop: { type: 'raw' },\\n        io: { type: 'raw' },\\n        commons: {\\n            type: 'proxy',\\n            value: createCommonsModule(rawModule, rawModule.metadata.audioSettings.bitDepth),\\n        },\\n    });\\n    const createEngine = (code) => {\\n        const rawModule = createRawModule(code);\\n        return createModule(rawModule, createBindings(rawModule));\\n    };\\n    const createFsModule = (rawModule) => {\\n        const fs = createModule(rawModule, {\\n            onReadSoundFile: { type: 'callback', value: () => undefined },\\n            onWriteSoundFile: { type: 'callback', value: () => undefined },\\n            onOpenSoundReadStream: { type: 'callback', value: () => undefined },\\n            onOpenSoundWriteStream: { type: 'callback', value: () => undefined },\\n            onSoundStreamData: { type: 'callback', value: () => undefined },\\n            onCloseSoundStream: { type: 'callback', value: () => undefined },\\n            sendReadSoundFileResponse: {\\n                type: 'proxy',\\n                value: rawModule.x_fs_onReadSoundFileResponse,\\n            },\\n            sendWriteSoundFileResponse: {\\n                type: 'proxy',\\n                value: rawModule.x_fs_onWriteSoundFileResponse,\\n            },\\n            sendSoundStreamData: {\\n                type: 'proxy',\\n                value: rawModule.x_fs_onSoundStreamData,\\n            },\\n            closeSoundStream: {\\n                type: 'proxy',\\n                value: rawModule.x_fs_onCloseSoundStream,\\n            },\\n        });\\n        rawModule.i_fs_openSoundWriteStream = (...args) => fs.onOpenSoundWriteStream(...args);\\n        rawModule.i_fs_sendSoundStreamData = (...args) => fs.onSoundStreamData(...args);\\n        rawModule.i_fs_openSoundReadStream = (...args) => fs.onOpenSoundReadStream(...args);\\n        rawModule.i_fs_closeSoundStream = (...args) => fs.onCloseSoundStream(...args);\\n        rawModule.i_fs_writeSoundFile = (...args) => fs.onWriteSoundFile(...args);\\n        rawModule.i_fs_readSoundFile = (...args) => fs.onReadSoundFile(...args);\\n        return fs;\\n    };\\n    const createCommonsModule = (rawModule, bitDepth) => {\\n        const floatArrayType = getFloatArrayType(bitDepth);\\n        return createModule(rawModule, {\\n            getArray: { type: 'proxy', value: rawModule.commons_getArray },\\n            setArray: {\\n                type: 'proxy',\\n                value: (arrayName, array) => rawModule.commons_setArray(arrayName, new floatArrayType(array)),\\n            },\\n        });\\n    };\\n\\n    exports.createBindings = createBindings;\\n    exports.createEngine = createEngine;\\n    exports.createRawModule = createRawModule;\\n\\n    return exports;\\n\\n})({});\\n\";\n\n  var fetchRetry$1 = function (fetch, defaults) {\n    defaults = defaults || {};\n    if (typeof fetch !== 'function') {\n      throw new ArgumentError('fetch must be a function');\n    }\n\n    if (typeof defaults !== 'object') {\n      throw new ArgumentError('defaults must be an object');\n    }\n\n    if (defaults.retries !== undefined && !isPositiveInteger(defaults.retries)) {\n      throw new ArgumentError('retries must be a positive integer');\n    }\n\n    if (defaults.retryDelay !== undefined && !isPositiveInteger(defaults.retryDelay) && typeof defaults.retryDelay !== 'function') {\n      throw new ArgumentError('retryDelay must be a positive integer or a function returning a positive integer');\n    }\n\n    if (defaults.retryOn !== undefined && !Array.isArray(defaults.retryOn) && typeof defaults.retryOn !== 'function') {\n      throw new ArgumentError('retryOn property expects an array or function');\n    }\n\n    var baseDefaults = {\n      retries: 3,\n      retryDelay: 1000,\n      retryOn: [],\n    };\n\n    defaults = Object.assign(baseDefaults, defaults);\n\n    return function fetchRetry(input, init) {\n      var retries = defaults.retries;\n      var retryDelay = defaults.retryDelay;\n      var retryOn = defaults.retryOn;\n\n      if (init && init.retries !== undefined) {\n        if (isPositiveInteger(init.retries)) {\n          retries = init.retries;\n        } else {\n          throw new ArgumentError('retries must be a positive integer');\n        }\n      }\n\n      if (init && init.retryDelay !== undefined) {\n        if (isPositiveInteger(init.retryDelay) || (typeof init.retryDelay === 'function')) {\n          retryDelay = init.retryDelay;\n        } else {\n          throw new ArgumentError('retryDelay must be a positive integer or a function returning a positive integer');\n        }\n      }\n\n      if (init && init.retryOn) {\n        if (Array.isArray(init.retryOn) || (typeof init.retryOn === 'function')) {\n          retryOn = init.retryOn;\n        } else {\n          throw new ArgumentError('retryOn property expects an array or function');\n        }\n      }\n\n      // eslint-disable-next-line no-undef\n      return new Promise(function (resolve, reject) {\n        var wrappedFetch = function (attempt) {\n          // As of node 18, this is no longer needed since node comes with native support for fetch:\n          /* istanbul ignore next */\n          var _input =\n            typeof Request !== 'undefined' && input instanceof Request\n              ? input.clone()\n              : input;\n          fetch(_input, init)\n            .then(function (response) {\n              if (Array.isArray(retryOn) && retryOn.indexOf(response.status) === -1) {\n                resolve(response);\n              } else if (typeof retryOn === 'function') {\n                try {\n                  // eslint-disable-next-line no-undef\n                  return Promise.resolve(retryOn(attempt, null, response))\n                    .then(function (retryOnResponse) {\n                      if(retryOnResponse) {\n                        retry(attempt, null, response);\n                      } else {\n                        resolve(response);\n                      }\n                    }).catch(reject);\n                } catch (error) {\n                  reject(error);\n                }\n              } else {\n                if (attempt < retries) {\n                  retry(attempt, null, response);\n                } else {\n                  resolve(response);\n                }\n              }\n            })\n            .catch(function (error) {\n              if (typeof retryOn === 'function') {\n                try {\n                  // eslint-disable-next-line no-undef\n                  Promise.resolve(retryOn(attempt, error, null))\n                    .then(function (retryOnResponse) {\n                      if(retryOnResponse) {\n                        retry(attempt, error, null);\n                      } else {\n                        reject(error);\n                      }\n                    })\n                    .catch(function(error) {\n                      reject(error);\n                    });\n                } catch(error) {\n                  reject(error);\n                }\n              } else if (attempt < retries) {\n                retry(attempt, error, null);\n              } else {\n                reject(error);\n              }\n            });\n        };\n\n        function retry(attempt, error, response) {\n          var delay = (typeof retryDelay === 'function') ?\n            retryDelay(attempt, error, response) : retryDelay;\n          setTimeout(function () {\n            wrappedFetch(++attempt);\n          }, delay);\n        }\n\n        wrappedFetch(0);\n      });\n    };\n  };\n\n  function isPositiveInteger(value) {\n    return Number.isInteger(value) && value >= 0;\n  }\n\n  function ArgumentError(message) {\n    this.name = 'ArgumentError';\n    this.message = message;\n  }\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const fetchRetry = fetchRetry$1(fetch);\n  /**\n   * Note : the audio worklet feature is available only in secure context.\n   * This function will fail when used in insecure context (non-https, etc ...)\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/AudioWorklet\n   */\n  const addModule = async (context, processorCode) => {\n      const blob = new Blob([processorCode], { type: 'text/javascript' });\n      const workletProcessorUrl = URL.createObjectURL(blob);\n      return context.audioWorklet.addModule(workletProcessorUrl);\n  };\n  // TODO : testing\n  const fetchFile = async (url) => {\n      let response;\n      try {\n          response = await fetchRetry(url, { retries: 3 });\n      }\n      catch (err) {\n          throw new FileError(response.status, err.toString());\n      }\n      if (!response.ok) {\n          const responseText = await response.text();\n          throw new FileError(response.status, responseText);\n      }\n      return response.arrayBuffer();\n  };\n  const audioBufferToArray = (audioBuffer) => {\n      const sound = [];\n      for (let channel = 0; channel < audioBuffer.numberOfChannels; channel++) {\n          sound.push(audioBuffer.getChannelData(channel));\n      }\n      return sound;\n  };\n  // TODO : testing\n  const fixSoundChannelCount = (sound, targetChannelCount) => {\n      if (sound.length === 0) {\n          throw new Error(`Received empty sound`);\n      }\n      const floatArrayType = sound[0].constructor;\n      const frameCount = sound[0].length;\n      const fixedSound = sound.slice(0, targetChannelCount);\n      while (sound.length < targetChannelCount) {\n          fixedSound.push(new floatArrayType(frameCount));\n      }\n      return fixedSound;\n  };\n  const resolveRelativeUrl = (rootUrl, relativeUrl) => {\n      return new URL(relativeUrl, rootUrl).href;\n  };\n  class FileError extends Error {\n      constructor(status, msg) {\n          super(`Error ${status} : ${msg}`);\n      }\n  }\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  // TODO : manage transferables\n  class WebPdWorkletNode extends AudioWorkletNode {\n      constructor(context) {\n          super(context, 'webpd-node', {\n              numberOfOutputs: 1,\n              outputChannelCount: [2],\n          });\n      }\n      destroy() {\n          this.port.postMessage({\n              type: 'destroy',\n              payload: {},\n          });\n      }\n  }\n  // Concatenate WorkletProcessor code with the Wasm bindings it needs\n  const WEBPD_WORKLET_PROCESSOR_CODE = AssemblyScriptWasmBindingsCode +\n      ';\\n' +\n      JavaScriptBindingsCode +\n      ';\\n' +\n      _WebPdWorkletProcessorCode;\n  const registerWebPdWorkletNode = (context) => {\n      return addModule(context, WEBPD_WORKLET_PROCESSOR_CODE);\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const FILES = {};\n  const STREAMS = {};\n  class FakeStream {\n      constructor(url, sound) {\n          this.url = url;\n          this.sound = sound;\n          this.frameCount = sound[0].length;\n          this.readPosition = 0;\n      }\n  }\n  const read = async (url) => {\n      if (FILES[url]) {\n          return FILES[url];\n      }\n      const arrayBuffer = await fetchFile(url);\n      return {\n          type: 'binary',\n          data: arrayBuffer,\n      };\n  };\n  // TODO : testing\n  const readSound = async (url, context) => {\n      let fakeFile = FILES[url] || (await read(url));\n      switch (fakeFile.type) {\n          case 'binary':\n              const audioBuffer = await context.decodeAudioData(fakeFile.data);\n              return audioBufferToArray(audioBuffer);\n          case 'sound':\n              // We copy the data here o it can be manipulated freely by the host.\n              // e.g. if the buffer is sent as transferrable to the node we don't want the original to be transferred.\n              return fakeFile.data.map((array) => array.slice());\n      }\n  };\n  const writeSound = async (sound, url) => {\n      FILES[url] = {\n          type: 'sound',\n          data: sound,\n      };\n  };\n  const readStreamSound = async (operationId, url, channelCount, context) => {\n      const sound = await readSound(url, context);\n      STREAMS[operationId] = new FakeStream(url, fixSoundChannelCount(sound, channelCount));\n      return STREAMS[operationId];\n  };\n  const writeStreamSound = async (operationId, url, channelCount) => {\n      const emptySound = [];\n      for (let channel = 0; channel < channelCount; channel++) {\n          emptySound.push(new Float32Array(0));\n      }\n      STREAMS[operationId] = new FakeStream(url, emptySound);\n      FILES[url] = {\n          type: 'sound',\n          data: emptySound,\n      };\n      return STREAMS[operationId];\n  };\n  const getStream = (operationId) => {\n      return STREAMS[operationId];\n  };\n  const killStream = (operationId) => {\n      console.log('KILL STREAM', operationId);\n      delete STREAMS[operationId];\n  };\n  const pullBlock = (stream, frameCount) => {\n      const block = stream.sound.map((array) => array.slice(stream.readPosition, stream.readPosition + frameCount));\n      stream.readPosition += frameCount;\n      return block;\n  };\n  const pushBlock = (stream, block) => {\n      stream.sound = stream.sound.map((channelData, channel) => {\n          const concatenated = new Float32Array(channelData.length + block[channel].length);\n          concatenated.set(channelData);\n          concatenated.set(block[channel], channelData.length);\n          return concatenated;\n      });\n      stream.frameCount = stream.sound[0].length;\n      FILES[stream.url].data = stream.sound;\n  };\n  var fakeFs = {\n      writeSound,\n      readSound,\n      readStreamSound,\n      writeStreamSound,\n      pullBlock,\n      pushBlock,\n  };\n\n  var closeSoundStream = async (_, payload, __) => {\n      if (payload.functionName === 'onCloseSoundStream') {\n          killStream(payload.arguments[0]);\n      }\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  /** Generate an integer series from 0 to `count` (non-inclusive). */\n  const countTo$1 = (count) => {\n      const results = [];\n      for (let i = 0; i < count; i++) {\n          results.push(i);\n      }\n      return results;\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const Var$1 = (typeName, name, value) => _preventToString$1({\n      astType: 'Var',\n      name,\n      type: typeName,\n      value: value !== undefined ? _prepareVarValue$1(value) : undefined,\n  });\n  const ConstVar$1 = (typeName, name, value) => _preventToString$1({\n      astType: 'ConstVar',\n      name,\n      type: typeName,\n      value: _prepareVarValue$1(value),\n  });\n  const Func$1 = (name, args = [], returnType = 'void') => (strings, ...content) => _preventToString$1({\n      astType: 'Func',\n      name,\n      args,\n      returnType,\n      body: ast$1(strings, ...content),\n  });\n  const AnonFunc$1 = (args = [], returnType = 'void') => (strings, ...content) => _preventToString$1({\n      astType: 'Func',\n      name: null,\n      args,\n      returnType,\n      body: ast$1(strings, ...content),\n  });\n  const Class$1 = (name, members) => _preventToString$1({\n      astType: 'Class',\n      name,\n      members,\n  });\n  const Sequence$1 = (content) => ({\n      astType: 'Sequence',\n      content: _processRawContent$1(_intersperse$1(content, countTo$1(content.length - 1).map(() => '\\n'))),\n  });\n  const ast$1 = (strings, ...content) => _preventToString$1({\n      astType: 'Sequence',\n      content: _processRawContent$1(_intersperse$1(strings, content)),\n  });\n  const _processRawContent$1 = (content) => {\n      // 1. Flatten arrays and AstSequence, filter out nulls, and convert numbers to strings\n      // Basically converts input to an Array<AstContent>.\n      const flattenedAndFiltered = content.flatMap((element) => {\n          if (typeof element === 'string') {\n              return [element];\n          }\n          else if (typeof element === 'number') {\n              return [element.toString()];\n          }\n          else {\n              if (element === null) {\n                  return [];\n              }\n              else if (Array.isArray(element)) {\n                  return _processRawContent$1(_intersperse$1(element, countTo$1(element.length - 1).map(() => '\\n')));\n              }\n              else if (typeof element === 'object' &&\n                  element.astType === 'Sequence') {\n                  return element.content;\n              }\n              else {\n                  return [element];\n              }\n          }\n      });\n      // 2. Combine adjacent strings\n      const [combinedContent, remainingString] = flattenedAndFiltered.reduce(([combinedContent, currentString], element) => {\n          if (typeof element === 'string') {\n              return [combinedContent, currentString + element];\n          }\n          else {\n              if (currentString.length) {\n                  return [[...combinedContent, currentString, element], ''];\n              }\n              else {\n                  return [[...combinedContent, element], ''];\n              }\n          }\n      }, [[], '']);\n      if (remainingString.length) {\n          combinedContent.push(remainingString);\n      }\n      return combinedContent;\n  };\n  /**\n   * Intersperse content from array1 with content from array2.\n   * `array1.length` must be equal to `array2.length + 1`.\n   */\n  const _intersperse$1 = (array1, array2) => {\n      if (array1.length === 0) {\n          return [];\n      }\n      return array1\n          .slice(1)\n          .reduce((combinedContent, element, i) => combinedContent.concat([array2[i], element]), [array1[0]]);\n  };\n  /**\n   * Prevents AST elements from being rendered as a string, as this is\n   * most likely an error due to unproper use of `ast`.\n   * Deacivated. Activate for debugging by uncommenting the line below.\n   */\n  const _preventToString$1 = (element) => ({\n      ...element,\n      // Uncomment this to activate\n      // toString: () => { throw new Error(`Rendering element ${elemennt.astType} as string is probably an error`) }\n  });\n  const _prepareVarValue$1 = (value) => {\n      if (typeof value === 'number') {\n          return Sequence$1([value.toString()]);\n      }\n      else if (typeof value === 'string') {\n          return Sequence$1([value]);\n      }\n      else {\n          return value;\n      }\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const bufCore$1 = () => Sequence$1([\n      /**\n       * Ring buffer\n       */\n      Class$1('buf_SoundBuffer', [\n          Var$1('FloatArray', 'data'),\n          Var$1('Int', 'length'),\n          Var$1('Int', 'writeCursor'),\n          Var$1('Int', 'pullAvailableLength'),\n      ]),\n      /** Erases all the content from the buffer */\n      Func$1('buf_clear', [\n          Var$1('buf_SoundBuffer', 'buffer')\n      ], 'void') `\n        buffer.data.fill(0)\n    `,\n      /** Erases all the content from the buffer */\n      Func$1('buf_create', [\n          Var$1('Int', 'length')\n      ], 'buf_SoundBuffer') `\n        return {\n            data: createFloatArray(length),\n            length: length,\n            writeCursor: 0,\n            pullAvailableLength: 0,\n        }\n    `\n  ]);\n  const bufPushPull$1 = {\n      codeGenerator: () => Sequence$1([\n          /**\n           * Pushes a block to the buffer, throwing an error if the buffer is full.\n           * If the block is written successfully, {@link buf_SoundBuffer#writeCursor}\n           * is moved corresponding with the length of data written.\n           *\n           * @todo : Optimize by allowing to read/write directly from host\n           */\n          Func$1('buf_pushBlock', [\n              Var$1('buf_SoundBuffer', 'buffer'),\n              Var$1('FloatArray', 'block')\n          ], 'Int') `\n            if (buffer.pullAvailableLength + block.length > buffer.length) {\n                throw new Error('buffer full')\n            }\n\n            ${Var$1('Int', 'left', 'block.length')}\n            while (left > 0) {\n                ${ConstVar$1('Int', 'lengthToWrite', `toInt(Math.min(\n                    toFloat(buffer.length - buffer.writeCursor), \n                    toFloat(left),\n                ))`)}\n                buffer.data.set(\n                    block.subarray(\n                        block.length - left, \n                        block.length - left + lengthToWrite\n                    ), \n                    buffer.writeCursor\n                )\n                left -= lengthToWrite\n                buffer.writeCursor = (buffer.writeCursor + lengthToWrite) % buffer.length\n                buffer.pullAvailableLength += lengthToWrite\n            }\n            return buffer.pullAvailableLength\n        `,\n          /**\n           * Pulls a single sample from the buffer.\n           * This is a destructive operation, and the sample will be\n           * unavailable for subsequent readers with the same operation.\n           */\n          Func$1('buf_pullSample', [\n              Var$1('buf_SoundBuffer', 'buffer')\n          ], 'Float') `\n            if (buffer.pullAvailableLength <= 0) {\n                return 0\n            }\n            ${ConstVar$1('Int', 'readCursor', 'buffer.writeCursor - buffer.pullAvailableLength')}\n            buffer.pullAvailableLength -= 1\n            return buffer.data[readCursor >= 0 ? readCursor : buffer.length + readCursor]\n        `\n      ]),\n      dependencies: [bufCore$1],\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const msg$1 = {\n      codeGenerator: ({ target }) => {\n          const declareFuncs = {\n              msg_create: Func$1('msg_create', [Var$1('MessageTemplate', 'template')], 'Message'),\n              msg_writeStringToken: Func$1('msg_writeStringToken', [\n                  Var$1('Message', 'message'),\n                  Var$1('Int', 'tokenIndex'),\n                  Var$1('string', 'value'),\n              ], 'void'),\n              msg_writeFloatToken: Func$1('msg_writeFloatToken', [\n                  Var$1('Message', 'message'),\n                  Var$1('Int', 'tokenIndex'),\n                  Var$1('MessageFloatToken', 'value'),\n              ], 'void'),\n              msg_readStringToken: Func$1('msg_readStringToken', [\n                  Var$1('Message', 'message'),\n                  Var$1('Int', 'tokenIndex'),\n              ], 'string'),\n              msg_readFloatToken: Func$1('msg_readFloatToken', [\n                  Var$1('Message', 'message'),\n                  Var$1('Int', 'tokenIndex'),\n              ], 'MessageFloatToken'),\n              msg_getLength: Func$1('msg_getLength', [\n                  Var$1('Message', 'message')\n              ], 'Int'),\n              msg_getTokenType: Func$1('msg_getTokenType', [\n                  Var$1('Message', 'message'),\n                  Var$1('Int', 'tokenIndex'),\n              ], 'Int'),\n              msg_isStringToken: Func$1('msg_isStringToken', [\n                  Var$1('Message', 'message'),\n                  Var$1('Int', 'tokenIndex'),\n              ], 'boolean'),\n              msg_isFloatToken: Func$1('msg_isFloatToken', [\n                  Var$1('Message', 'message'),\n                  Var$1('Int', 'tokenIndex'),\n              ], 'boolean'),\n              msg_isMatching: Func$1('msg_isMatching', [\n                  Var$1('Message', 'message'),\n                  Var$1('Array<MessageHeaderEntry>', 'tokenTypes'),\n              ], 'boolean'),\n              msg_floats: Func$1('msg_floats', [\n                  Var$1('Array<Float>', 'values'),\n              ], 'Message'),\n              msg_strings: Func$1('msg_strings', [\n                  Var$1('Array<string>', 'values'),\n              ], 'Message'),\n              msg_display: Func$1('msg_display', [\n                  Var$1('Message', 'message'),\n              ], 'string')\n          };\n          if (target === 'assemblyscript') {\n              return Sequence$1([\n                  `\n                type MessageFloatToken = Float\n                type MessageCharToken = Int\n\n                type MessageTemplate = Array<Int>\n                type MessageHeaderEntry = Int\n                type MessageHeader = Int32Array\n                `,\n                  ConstVar$1('MessageHeaderEntry', 'MSG_FLOAT_TOKEN', '0'),\n                  ConstVar$1('MessageHeaderEntry', 'MSG_STRING_TOKEN', '1'),\n                  // =========================== EXPORTED API\n                  Func$1('x_msg_create', [\n                      Var$1('Int32Array', 'templateTypedArray')\n                  ], 'Message') `\n                    const template: MessageTemplate = new Array<Int>(templateTypedArray.length)\n                    for (let i: Int = 0; i < templateTypedArray.length; i++) {\n                        template[i] = templateTypedArray[i]\n                    }\n                    return msg_create(template)\n                `,\n                  Func$1('x_msg_getTokenTypes', [\n                      Var$1('Message', 'message')\n                  ], 'MessageHeader') `\n                    return message.tokenTypes\n                `,\n                  Func$1('x_msg_createTemplate', [\n                      Var$1('i32', 'length')\n                  ], 'Int32Array') `\n                    return new Int32Array(length)\n                `,\n                  // =========================== MSG API\n                  declareFuncs.msg_create `\n                    let i: Int = 0\n                    let byteCount: Int = 0\n                    let tokenTypes: Array<MessageHeaderEntry> = []\n                    let tokenPositions: Array<MessageHeaderEntry> = []\n\n                    i = 0\n                    while (i < template.length) {\n                        switch(template[i]) {\n                            case MSG_FLOAT_TOKEN:\n                                byteCount += sizeof<MessageFloatToken>()\n                                tokenTypes.push(MSG_FLOAT_TOKEN)\n                                tokenPositions.push(byteCount)\n                                i += 1\n                                break\n                            case MSG_STRING_TOKEN:\n                                byteCount += sizeof<MessageCharToken>() * template[i + 1]\n                                tokenTypes.push(MSG_STRING_TOKEN)\n                                tokenPositions.push(byteCount)\n                                i += 2\n                                break\n                            default:\n                                throw new Error(\"unknown token type : \" + template[i].toString())\n                        }\n                    }\n\n                    const tokenCount = tokenTypes.length\n                    const headerByteCount = _msg_computeHeaderLength(tokenCount) * sizeof<MessageHeaderEntry>()\n                    byteCount += headerByteCount\n\n                    const buffer = new ArrayBuffer(byteCount)\n                    const dataView = new DataView(buffer)\n                    let writePosition: Int = 0\n                    \n                    dataView.setInt32(writePosition, tokenCount)\n                    writePosition += sizeof<MessageHeaderEntry>()\n\n                    for (i = 0; i < tokenCount; i++) {\n                        dataView.setInt32(writePosition, tokenTypes[i])\n                        writePosition += sizeof<MessageHeaderEntry>()\n                    }\n\n                    dataView.setInt32(writePosition, headerByteCount)\n                    writePosition += sizeof<MessageHeaderEntry>()\n                    for (i = 0; i < tokenCount; i++) {\n                        dataView.setInt32(writePosition, headerByteCount + tokenPositions[i])\n                        writePosition += sizeof<MessageHeaderEntry>()\n                    }\n\n                    const header = _msg_unpackHeader(dataView, tokenCount)\n                    return {\n                        dataView,\n                        tokenCount,\n                        header,\n                        tokenTypes: _msg_unpackTokenTypes(header),\n                        tokenPositions: _msg_unpackTokenPositions(header),\n                    }\n                `,\n                  declareFuncs.msg_writeStringToken `\n                    const startPosition = message.tokenPositions[tokenIndex]\n                    const endPosition = message.tokenPositions[tokenIndex + 1]\n                    const expectedStringLength: Int = (endPosition - startPosition) / sizeof<MessageCharToken>()\n                    if (value.length !== expectedStringLength) {\n                        throw new Error('Invalid string size, specified ' + expectedStringLength.toString() + ', received ' + value.length.toString())\n                    }\n\n                    for (let i = 0; i < value.length; i++) {\n                        message.dataView.setInt32(\n                            startPosition + i * sizeof<MessageCharToken>(), \n                            value.codePointAt(i)\n                        )\n                    }\n                `,\n                  declareFuncs.msg_writeFloatToken `\n                    setFloatDataView(message.dataView, message.tokenPositions[tokenIndex], value)\n                `,\n                  declareFuncs.msg_readStringToken `\n                    const startPosition = message.tokenPositions[tokenIndex]\n                    const endPosition = message.tokenPositions[tokenIndex + 1]\n                    const stringLength: Int = (endPosition - startPosition) / sizeof<MessageCharToken>()\n                    let value: string = ''\n                    for (let i = 0; i < stringLength; i++) {\n                        value += String.fromCodePoint(message.dataView.getInt32(startPosition + sizeof<MessageCharToken>() * i))\n                    }\n                    return value\n                `,\n                  declareFuncs.msg_readFloatToken `\n                    return getFloatDataView(message.dataView, message.tokenPositions[tokenIndex])\n                `,\n                  declareFuncs.msg_getLength `\n                    return message.tokenTypes.length\n                `,\n                  declareFuncs.msg_getTokenType `\n                    return message.tokenTypes[tokenIndex]\n                `,\n                  declareFuncs.msg_isStringToken `\n                    return msg_getTokenType(message, tokenIndex) === MSG_STRING_TOKEN\n                `,\n                  declareFuncs.msg_isFloatToken `\n                    return msg_getTokenType(message, tokenIndex) === MSG_FLOAT_TOKEN\n                `,\n                  declareFuncs.msg_isMatching `\n                    if (message.tokenTypes.length !== tokenTypes.length) {\n                        return false\n                    }\n                    for (let i: Int = 0; i < tokenTypes.length; i++) {\n                        if (message.tokenTypes[i] !== tokenTypes[i]) {\n                            return false\n                        }\n                    }\n                    return true\n                `,\n                  declareFuncs.msg_floats `\n                    const message: Message = msg_create(values.map<MessageHeaderEntry>(v => MSG_FLOAT_TOKEN))\n                    for (let i: Int = 0; i < values.length; i++) {\n                        msg_writeFloatToken(message, i, values[i])\n                    }\n                    return message\n                `,\n                  declareFuncs.msg_strings `\n                    const template: MessageTemplate = []\n                    for (let i: Int = 0; i < values.length; i++) {\n                        template.push(MSG_STRING_TOKEN)\n                        template.push(values[i].length)\n                    }\n                    const message: Message = msg_create(template)\n                    for (let i: Int = 0; i < values.length; i++) {\n                        msg_writeStringToken(message, i, values[i])\n                    }\n                    return message\n                `,\n                  declareFuncs.msg_display `\n                    let displayArray: Array<string> = []\n                    for (let i: Int = 0; i < msg_getLength(message); i++) {\n                        if (msg_isFloatToken(message, i)) {\n                            displayArray.push(msg_readFloatToken(message, i).toString())\n                        } else {\n                            displayArray.push('\"' + msg_readStringToken(message, i) + '\"')\n                        }\n                    }\n                    return '[' + displayArray.join(', ') + ']'\n                `,\n                  // =========================== PRIVATE\n                  // Message header : [\n                  //      <Token count>, \n                  //      <Token 1 type>,  ..., <Token N type>, \n                  //      <Token 1 start>, ..., <Token N start>, <Token N end>\n                  //      ... DATA ...\n                  // ]\n                  Class$1('Message', [\n                      Var$1('DataView', 'dataView'),\n                      Var$1('MessageHeader', 'header'),\n                      Var$1('MessageHeaderEntry', 'tokenCount'),\n                      Var$1('MessageHeader', 'tokenTypes'),\n                      Var$1('MessageHeader', 'tokenPositions'),\n                  ]),\n                  Func$1('_msg_computeHeaderLength', [\n                      Var$1('Int', 'tokenCount')\n                  ], 'Int') `\n                    return 1 + tokenCount * 2 + 1\n                `,\n                  Func$1('_msg_unpackTokenCount', [\n                      Var$1('DataView', 'messageDataView')\n                  ], 'MessageHeaderEntry') `\n                    return messageDataView.getInt32(0)\n                `,\n                  Func$1('_msg_unpackHeader', [\n                      Var$1('DataView', 'messageDataView'),\n                      Var$1('MessageHeaderEntry', 'tokenCount'),\n                  ], 'MessageHeader') `\n                    const headerLength = _msg_computeHeaderLength(tokenCount)\n                    // TODO : why is this \\`wrap\\` not working ?\n                    // return Int32Array.wrap(messageDataView.buffer, 0, headerLength)\n                    const messageHeader = new Int32Array(headerLength)\n                    for (let i = 0; i < headerLength; i++) {\n                        messageHeader[i] = messageDataView.getInt32(sizeof<MessageHeaderEntry>() * i)\n                    }\n                    return messageHeader\n                `,\n                  Func$1('_msg_unpackTokenTypes', [\n                      Var$1('MessageHeader', 'header'),\n                  ], 'MessageHeader') `\n                    return header.slice(1, 1 + header[0])\n                `,\n                  Func$1('_msg_unpackTokenPositions', [\n                      Var$1('MessageHeader', 'header'),\n                  ], 'MessageHeader') `\n                    return header.slice(1 + header[0])\n                `,\n              ]);\n          }\n          else if (target === 'javascript') {\n              return Sequence$1([\n                  ConstVar$1('string', 'MSG_FLOAT_TOKEN', '\"number\"'),\n                  ConstVar$1('string', 'MSG_STRING_TOKEN', '\"string\"'),\n                  declareFuncs.msg_create `\n                    const m = []\n                    let i = 0\n                    while (i < template.length) {\n                        if (template[i] === MSG_STRING_TOKEN) {\n                            m.push('')\n                            i += 2\n                        } else if (template[i] === MSG_FLOAT_TOKEN) {\n                            m.push(0)\n                            i += 1\n                        }\n                    }\n                    return m\n                `,\n                  declareFuncs.msg_getLength `\n                    return message.length\n                `,\n                  declareFuncs.msg_getTokenType `\n                    return typeof message[tokenIndex]\n                `,\n                  declareFuncs.msg_isStringToken `\n                    return msg_getTokenType(message, tokenIndex) === 'string'\n                `,\n                  declareFuncs.msg_isFloatToken `\n                    return msg_getTokenType(message, tokenIndex) === 'number'\n                `,\n                  declareFuncs.msg_isMatching `\n                    return (message.length === tokenTypes.length) \n                        && message.every((v, i) => msg_getTokenType(message, i) === tokenTypes[i])\n                `,\n                  declareFuncs.msg_writeFloatToken `\n                    message[tokenIndex] = value\n                `,\n                  declareFuncs.msg_writeStringToken `\n                    message[tokenIndex] = value\n                `,\n                  declareFuncs.msg_readFloatToken `\n                    return message[tokenIndex]\n                `,\n                  declareFuncs.msg_readStringToken `\n                    return message[tokenIndex]\n                `,\n                  declareFuncs.msg_floats `\n                    return values\n                `,\n                  declareFuncs.msg_strings `\n                    return values\n                `,\n                  declareFuncs.msg_display `\n                    return '[' + message\n                        .map(t => typeof t === 'string' ? '\"' + t + '\"' : t.toString())\n                        .join(', ') + ']'\n                `,\n              ]);\n          }\n          else {\n              throw new Error(`Unexpected target: ${target}`);\n          }\n      },\n      exports: [\n          { name: 'x_msg_create', targets: ['assemblyscript'] },\n          { name: 'x_msg_getTokenTypes', targets: ['assemblyscript'] },\n          { name: 'x_msg_createTemplate', targets: ['assemblyscript'] },\n          { name: 'msg_writeStringToken', targets: ['assemblyscript'] },\n          { name: 'msg_writeFloatToken', targets: ['assemblyscript'] },\n          { name: 'msg_readStringToken', targets: ['assemblyscript'] },\n          { name: 'msg_readFloatToken', targets: ['assemblyscript'] },\n          { name: 'MSG_FLOAT_TOKEN', targets: ['assemblyscript'] },\n          { name: 'MSG_STRING_TOKEN', targets: ['assemblyscript'] },\n      ],\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const FS_OPERATION_SUCCESS$1 = 0;\n  const FS_OPERATION_FAILURE$1 = 1;\n  const fsCore$1 = {\n      codeGenerator: ({ target }) => {\n          const content = [];\n          if (target === 'assemblyscript') {\n              content.push(`\n                type fs_OperationId = Int\n                type fs_OperationStatus = Int\n                type fs_OperationCallback = (id: fs_OperationId, status: fs_OperationStatus) => void\n                type fs_OperationSoundCallback = (id: fs_OperationId, status: fs_OperationStatus, sound: FloatArray[]) => void\n                type fs_Url = string\n            `);\n          }\n          return Sequence$1([\n              ...content,\n              ConstVar$1('Int', 'FS_OPERATION_SUCCESS', FS_OPERATION_SUCCESS$1.toString()),\n              ConstVar$1('Int', 'FS_OPERATION_FAILURE', FS_OPERATION_FAILURE$1.toString()),\n              ConstVar$1('Set<fs_OperationId>', '_FS_OPERATIONS_IDS', 'new Set()'),\n              ConstVar$1('Map<fs_OperationId, fs_OperationCallback>', '_FS_OPERATIONS_CALLBACKS', 'new Map()'),\n              ConstVar$1('Map<fs_OperationId, fs_OperationSoundCallback>', '_FS_OPERATIONS_SOUND_CALLBACKS', 'new Map()'),\n              // We start at 1, because 0 is what ASC uses when host forgets to pass an arg to \n              // a function. Therefore we can get false negatives when a test happens to expect a 0.\n              Var$1('Int', '_FS_OPERATION_COUNTER', '1'),\n              Class$1('fs_SoundInfo', [\n                  Var$1('Int', 'channelCount'),\n                  Var$1('Int', 'sampleRate'),\n                  Var$1('Int', 'bitDepth'),\n                  Var$1('string', 'encodingFormat'),\n                  Var$1('string', 'endianness'),\n                  Var$1('string', 'extraOptions'),\n              ]),\n              Func$1('fs_soundInfoToMessage', [\n                  Var$1('fs_SoundInfo', 'soundInfo')\n              ], 'Message') `\n                ${ConstVar$1('Message', 'info', `msg_create([\n                    MSG_FLOAT_TOKEN,\n                    MSG_FLOAT_TOKEN,\n                    MSG_FLOAT_TOKEN,\n                    MSG_STRING_TOKEN,\n                    soundInfo.encodingFormat.length,\n                    MSG_STRING_TOKEN,\n                    soundInfo.endianness.length,\n                    MSG_STRING_TOKEN,\n                    soundInfo.extraOptions.length\n                ])`)}\n                msg_writeFloatToken(info, 0, toFloat(soundInfo.channelCount))\n                msg_writeFloatToken(info, 1, toFloat(soundInfo.sampleRate))\n                msg_writeFloatToken(info, 2, toFloat(soundInfo.bitDepth))\n                msg_writeStringToken(info, 3, soundInfo.encodingFormat)\n                msg_writeStringToken(info, 4, soundInfo.endianness)\n                msg_writeStringToken(info, 5, soundInfo.extraOptions)\n                return info\n            `,\n              Func$1('_fs_assertOperationExists', [\n                  Var$1('fs_OperationId', 'id'),\n                  Var$1('string', 'operationName'),\n              ], 'void') `\n                if (!_FS_OPERATIONS_IDS.has(id)) {\n                    throw new Error(operationName + ' operation unknown : ' + id.toString())\n                }\n            `,\n              Func$1('_fs_createOperationId', [], 'fs_OperationId') `\n                ${ConstVar$1('fs_OperationId', 'id', '_FS_OPERATION_COUNTER++')}\n                _FS_OPERATIONS_IDS.add(id)\n                return id\n            `\n          ]);\n      },\n      dependencies: [msg$1],\n  };\n  ({\n      codeGenerator: () => Sequence$1([\n          Func$1('fs_readSoundFile', [\n              Var$1('fs_Url', 'url'),\n              Var$1('fs_SoundInfo', 'soundInfo'),\n              Var$1('fs_OperationSoundCallback', 'callback'),\n          ], 'fs_OperationId') `\n            ${ConstVar$1('fs_OperationId', 'id', '_fs_createOperationId()')}\n            _FS_OPERATIONS_SOUND_CALLBACKS.set(id, callback)\n            i_fs_readSoundFile(id, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        `,\n          Func$1('x_fs_onReadSoundFileResponse', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('fs_OperationStatus', 'status'),\n              Var$1('FloatArray[]', 'sound'),\n          ], 'void') `\n            _fs_assertOperationExists(id, 'x_fs_onReadSoundFileResponse')\n            _FS_OPERATIONS_IDS.delete(id)\n            // Finish cleaning before calling the callback in case it would throw an error.\n            const callback = _FS_OPERATIONS_SOUND_CALLBACKS.get(id)\n            callback(id, status, sound)\n            _FS_OPERATIONS_SOUND_CALLBACKS.delete(id)\n        `\n      ]),\n      exports: [\n          {\n              name: 'x_fs_onReadSoundFileResponse',\n          },\n      ],\n      imports: [\n          Func$1('i_fs_readSoundFile', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('fs_Url', 'url'),\n              Var$1('Message', 'info'),\n          ], 'void') ``,\n      ],\n      dependencies: [fsCore$1],\n  });\n  ({\n      codeGenerator: () => Sequence$1([\n          Func$1('fs_writeSoundFile', [\n              Var$1('FloatArray[]', 'sound'),\n              Var$1('fs_Url', 'url'),\n              Var$1('fs_SoundInfo', 'soundInfo'),\n              Var$1('fs_OperationCallback', 'callback'),\n          ], 'fs_OperationId') `\n            ${ConstVar$1('fs_OperationId', 'id', '_fs_createOperationId()')}\n            _FS_OPERATIONS_CALLBACKS.set(id, callback)\n            i_fs_writeSoundFile(id, sound, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        `,\n          Func$1('x_fs_onWriteSoundFileResponse', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('fs_OperationStatus', 'status'),\n          ], 'void') `\n            _fs_assertOperationExists(id, 'x_fs_onWriteSoundFileResponse')\n            _FS_OPERATIONS_IDS.delete(id)\n            // Finish cleaning before calling the callback in case it would throw an error.\n            ${ConstVar$1('fs_OperationCallback', 'callback', '_FS_OPERATIONS_CALLBACKS.get(id)')}\n            callback(id, status)\n            _FS_OPERATIONS_CALLBACKS.delete(id)\n        `\n      ]),\n      exports: [\n          {\n              name: 'x_fs_onWriteSoundFileResponse',\n          },\n      ],\n      imports: [\n          Func$1('i_fs_writeSoundFile', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('FloatArray[]', 'sound'),\n              Var$1('fs_Url', 'url'),\n              Var$1('Message', 'info'),\n          ], 'void') ``,\n      ],\n      dependencies: [fsCore$1],\n  });\n  const fsSoundStreamCore$1 = {\n      codeGenerator: () => Sequence$1([\n          ConstVar$1('Map<fs_OperationId, Array<buf_SoundBuffer>>', '_FS_SOUND_STREAM_BUFFERS', 'new Map()'),\n          ConstVar$1('Int', '_FS_SOUND_BUFFER_LENGTH', '20 * 44100'),\n          Func$1('fs_closeSoundStream', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('fs_OperationStatus', 'status'),\n          ], 'void') `\n            if (!_FS_OPERATIONS_IDS.has(id)) {\n                return\n            }\n            _FS_OPERATIONS_IDS.delete(id)\n            _FS_OPERATIONS_CALLBACKS.get(id)(id, status)\n            _FS_OPERATIONS_CALLBACKS.delete(id)\n            // Delete this last, to give the callback \n            // a chance to save a reference to the buffer\n            // If write stream, there won't be a buffer\n            if (_FS_SOUND_STREAM_BUFFERS.has(id)) {\n                _FS_SOUND_STREAM_BUFFERS.delete(id)\n            }\n            i_fs_closeSoundStream(id, status)\n        `,\n          Func$1('x_fs_onCloseSoundStream', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('fs_OperationStatus', 'status'),\n          ], 'void') `\n            fs_closeSoundStream(id, status)\n        `\n      ]),\n      exports: [\n          {\n              name: 'x_fs_onCloseSoundStream',\n          },\n      ],\n      imports: [\n          Func$1('i_fs_closeSoundStream', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('fs_OperationStatus', 'status'),\n          ], 'void') ``,\n      ],\n      dependencies: [bufCore$1, fsCore$1],\n  };\n  ({\n      codeGenerator: () => Sequence$1([\n          Func$1('fs_openSoundReadStream', [\n              Var$1('fs_Url', 'url'),\n              Var$1('fs_SoundInfo', 'soundInfo'),\n              Var$1('fs_OperationCallback', 'callback'),\n          ], 'fs_OperationId') `\n            ${ConstVar$1('fs_OperationId', 'id', '_fs_createOperationId()')}\n            ${ConstVar$1('Array<buf_SoundBuffer>', 'buffers', '[]')}\n            for (${Var$1('Int', 'channel', '0')}; channel < soundInfo.channelCount; channel++) {\n                buffers.push(buf_create(_FS_SOUND_BUFFER_LENGTH))\n            }\n            _FS_SOUND_STREAM_BUFFERS.set(id, buffers)\n            _FS_OPERATIONS_CALLBACKS.set(id, callback)\n            i_fs_openSoundReadStream(id, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        `,\n          Func$1('x_fs_onSoundStreamData', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('FloatArray[]', 'block'),\n          ], 'Int') `\n            _fs_assertOperationExists(id, 'x_fs_onSoundStreamData')\n            const buffers = _FS_SOUND_STREAM_BUFFERS.get(id)\n            for (${Var$1('Int', 'i', '0')}; i < buffers.length; i++) {\n                buf_pushBlock(buffers[i], block[i])\n            }\n            return buffers[0].pullAvailableLength\n        `\n      ]),\n      exports: [\n          {\n              name: 'x_fs_onSoundStreamData',\n          },\n      ],\n      imports: [\n          Func$1('i_fs_openSoundReadStream', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('fs_Url', 'url'),\n              Var$1('Message', 'info'),\n          ], 'void') ``,\n      ],\n      dependencies: [fsSoundStreamCore$1, bufPushPull$1],\n  });\n  ({\n      codeGenerator: () => Sequence$1([\n          Func$1('fs_openSoundWriteStream', [\n              Var$1('fs_Url', 'url'),\n              Var$1('fs_SoundInfo', 'soundInfo'),\n              Var$1('fs_OperationCallback', 'callback'),\n          ], 'fs_OperationId') `\n            const id = _fs_createOperationId()\n            _FS_SOUND_STREAM_BUFFERS.set(id, [])\n            _FS_OPERATIONS_CALLBACKS.set(id, callback)\n            i_fs_openSoundWriteStream(id, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        `,\n          Func$1('fs_sendSoundStreamData', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('FloatArray[]', 'block')\n          ], 'void') `\n            _fs_assertOperationExists(id, 'fs_sendSoundStreamData')\n            i_fs_sendSoundStreamData(id, block)\n        `\n      ]),\n      imports: [\n          Func$1('i_fs_openSoundWriteStream', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('fs_Url', 'url'),\n              Var$1('Message', 'info'),\n          ], 'void') ``,\n          Func$1('i_fs_sendSoundStreamData', [\n              Var$1('fs_OperationId', 'id'),\n              Var$1('FloatArray[]', 'block'),\n          ], 'void') ``,\n      ],\n      dependencies: [fsSoundStreamCore$1],\n  });\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  AnonFunc$1([Var$1('Message', 'm')], 'void') ``;\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  var readSoundFile = async (node, payload, settings) => {\n      if (payload.functionName === 'onReadSoundFile') {\n          const [operationId, url, [channelCount]] = payload.arguments;\n          const absoluteUrl = resolveRelativeUrl(settings.rootUrl, url);\n          let operationStatus = FS_OPERATION_SUCCESS$1;\n          let sound = null;\n          try {\n              sound = await fakeFs.readSound(absoluteUrl, node.context);\n          }\n          catch (err) {\n              operationStatus = FS_OPERATION_FAILURE$1;\n              console.error(err);\n          }\n          if (sound) {\n              sound = fixSoundChannelCount(sound, channelCount);\n          }\n          node.port.postMessage({\n              type: 'fs',\n              payload: {\n                  functionName: 'sendReadSoundFileResponse',\n                  arguments: [operationId, operationStatus, sound],\n              },\n          }, \n          // Add as transferables to avoid copies between threads\n          sound.map((array) => array.buffer));\n      }\n      else if (payload.functionName === 'sendReadSoundFileResponse_return') ;\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const BUFFER_HIGH = 10 * 44100;\n  const BUFFER_LOW = BUFFER_HIGH / 2;\n  var readSoundStream = async (node, payload, settings) => {\n      if (payload.functionName === 'onOpenSoundReadStream') {\n          const [operationId, url, [channelCount]] = payload.arguments;\n          try {\n              const absoluteUrl = resolveRelativeUrl(settings.rootUrl, url);\n              await fakeFs.readStreamSound(operationId, absoluteUrl, channelCount, node.context);\n          }\n          catch (err) {\n              console.error(err);\n              node.port.postMessage({\n                  type: 'fs',\n                  payload: {\n                      functionName: 'closeSoundStream',\n                      arguments: [operationId, FS_OPERATION_FAILURE$1],\n                  },\n              });\n              return;\n          }\n          streamLoop(node, operationId, 0);\n      }\n      else if (payload.functionName === 'sendSoundStreamData_return') {\n          const stream = getStream(payload.operationId);\n          if (!stream) {\n              throw new Error(`unknown stream ${payload.operationId}`);\n          }\n          streamLoop(node, payload.operationId, payload.returned);\n      }\n      else if (payload.functionName === 'closeSoundStream_return') {\n          const stream = getStream(payload.operationId);\n          if (stream) {\n              killStream(payload.operationId);\n          }\n      }\n  };\n  const streamLoop = (node, operationId, framesAvailableInEngine) => {\n      const sampleRate = node.context.sampleRate;\n      const secondsToThreshold = Math.max(framesAvailableInEngine - BUFFER_LOW, 10) / sampleRate;\n      const framesToSend = BUFFER_HIGH -\n          (framesAvailableInEngine - secondsToThreshold * sampleRate);\n      setTimeout(() => {\n          const stream = getStream(operationId);\n          if (!stream) {\n              console.log(`stream ${operationId} was maybe closed`);\n              return;\n          }\n          if (stream.readPosition < stream.frameCount) {\n              const block = pullBlock(stream, framesToSend);\n              node.port.postMessage({\n                  type: 'fs',\n                  payload: {\n                      functionName: 'sendSoundStreamData',\n                      arguments: [operationId, block],\n                  },\n              }, \n              // Add as transferables to avoid copies between threads\n              block.map((array) => array.buffer));\n          }\n          else {\n              node.port.postMessage({\n                  type: 'fs',\n                  payload: {\n                      functionName: 'closeSoundStream',\n                      arguments: [operationId, FS_OPERATION_SUCCESS$1],\n                  },\n              });\n          }\n      }, secondsToThreshold * 1000);\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  var writeSoundFile = async (node, payload, settings) => {\n      if (payload.functionName === 'onWriteSoundFile') {\n          const [operationId, sound, url, [channelCount]] = payload.arguments;\n          const fixedSound = fixSoundChannelCount(sound, channelCount);\n          const absoluteUrl = resolveRelativeUrl(settings.rootUrl, url);\n          await fakeFs.writeSound(fixedSound, absoluteUrl);\n          let operationStatus = FS_OPERATION_SUCCESS$1;\n          node.port.postMessage({\n              type: 'fs',\n              payload: {\n                  functionName: 'sendWriteSoundFileResponse',\n                  arguments: [operationId, operationStatus],\n              },\n          });\n      }\n      else if (payload.functionName === 'sendWriteSoundFileResponse_return') ;\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  var writeSoundStream = async (_, payload, settings) => {\n      if (payload.functionName === 'onOpenSoundWriteStream') {\n          const [operationId, url, [channelCount]] = payload.arguments;\n          const absoluteUrl = resolveRelativeUrl(settings.rootUrl, url);\n          await fakeFs.writeStreamSound(operationId, absoluteUrl, channelCount);\n      }\n      else if (payload.functionName === 'onSoundStreamData') {\n          const [operationId, sound] = payload.arguments;\n          const stream = getStream(operationId);\n          if (!stream) {\n              throw new Error(`unknown stream ${operationId}`);\n          }\n          pushBlock(stream, sound);\n      }\n      else if (payload.functionName === 'closeSoundStream_return') {\n          const stream = getStream(payload.operationId);\n          if (stream) {\n              killStream(payload.operationId);\n          }\n      }\n  };\n\n  var index = async (node, messageEvent, settings) => {\n      const message = messageEvent.data;\n      const { payload } = message;\n      if (message.type !== 'fs') {\n          throw new Error(`Unknown message type from node ${message.type}`);\n      }\n      if (payload.functionName === 'onReadSoundFile' ||\n          payload.functionName === 'sendReadSoundFileResponse_return') {\n          readSoundFile(node, payload, settings);\n      }\n      else if (payload.functionName === 'onOpenSoundReadStream' ||\n          payload.functionName === 'sendSoundStreamData_return') {\n          readSoundStream(node, payload, settings);\n      }\n      else if (payload.functionName === 'onWriteSoundFile' ||\n          payload.functionName === 'sendWriteSoundFileResponse_return') {\n          writeSoundFile(node, payload, settings);\n      }\n      else if (payload.functionName === 'onOpenSoundWriteStream' ||\n          payload.functionName === 'onSoundStreamData') {\n          writeSoundStream(node, payload, settings);\n      }\n      else if (payload.functionName === 'closeSoundStream_return') {\n          writeSoundStream(node, payload, settings);\n          readSoundStream(node, payload, settings);\n      }\n      else if (payload.functionName === 'onCloseSoundStream') {\n          closeSoundStream(node, payload);\n      }\n      else {\n          throw new Error(`Unknown callback ${payload.functionName}`);\n      }\n  };\n\n  var initialize = (...args) => {\n      return registerWebPdWorkletNode(...args);\n  };\n\n  const urlDirName = (url) => {\n      if (isExternalUrl(url)) {\n          return new URL('.', url).href;\n      }\n      else {\n          return new URL('.', new URL(url, document.URL).href).href;\n      }\n  };\n  const isExternalUrl = (urlString) => {\n      try {\n          const url = new URL(urlString);\n          if (url.origin !== new URL(document.URL, document.baseURI).origin) {\n              return true;\n          }\n      }\n      catch (_e) {\n          new URL(urlString, document.baseURI);\n      }\n      return false;\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  /** Generate an integer series from 0 to `count` (non-inclusive). */\n  const countTo = (count) => {\n      const results = [];\n      for (let i = 0; i < count; i++) {\n          results.push(i);\n      }\n      return results;\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const Var = (typeName, name, value) => _preventToString({\n      astType: 'Var',\n      name,\n      type: typeName,\n      value: value !== undefined ? _prepareVarValue(value) : undefined,\n  });\n  const ConstVar = (typeName, name, value) => _preventToString({\n      astType: 'ConstVar',\n      name,\n      type: typeName,\n      value: _prepareVarValue(value),\n  });\n  const Func = (name, args = [], returnType = 'void') => (strings, ...content) => _preventToString({\n      astType: 'Func',\n      name,\n      args,\n      returnType,\n      body: ast(strings, ...content),\n  });\n  const AnonFunc = (args = [], returnType = 'void') => (strings, ...content) => _preventToString({\n      astType: 'Func',\n      name: null,\n      args,\n      returnType,\n      body: ast(strings, ...content),\n  });\n  const Class = (name, members) => _preventToString({\n      astType: 'Class',\n      name,\n      members,\n  });\n  const Sequence = (content) => ({\n      astType: 'Sequence',\n      content: _processRawContent(_intersperse(content, countTo(content.length - 1).map(() => '\\n'))),\n  });\n  const ast = (strings, ...content) => _preventToString({\n      astType: 'Sequence',\n      content: _processRawContent(_intersperse(strings, content)),\n  });\n  const _processRawContent = (content) => {\n      // 1. Flatten arrays and AstSequence, filter out nulls, and convert numbers to strings\n      // Basically converts input to an Array<AstContent>.\n      const flattenedAndFiltered = content.flatMap((element) => {\n          if (typeof element === 'string') {\n              return [element];\n          }\n          else if (typeof element === 'number') {\n              return [element.toString()];\n          }\n          else {\n              if (element === null) {\n                  return [];\n              }\n              else if (Array.isArray(element)) {\n                  return _processRawContent(_intersperse(element, countTo(element.length - 1).map(() => '\\n')));\n              }\n              else if (typeof element === 'object' &&\n                  element.astType === 'Sequence') {\n                  return element.content;\n              }\n              else {\n                  return [element];\n              }\n          }\n      });\n      // 2. Combine adjacent strings\n      const [combinedContent, remainingString] = flattenedAndFiltered.reduce(([combinedContent, currentString], element) => {\n          if (typeof element === 'string') {\n              return [combinedContent, currentString + element];\n          }\n          else {\n              if (currentString.length) {\n                  return [[...combinedContent, currentString, element], ''];\n              }\n              else {\n                  return [[...combinedContent, element], ''];\n              }\n          }\n      }, [[], '']);\n      if (remainingString.length) {\n          combinedContent.push(remainingString);\n      }\n      return combinedContent;\n  };\n  /**\n   * Intersperse content from array1 with content from array2.\n   * `array1.length` must be equal to `array2.length + 1`.\n   */\n  const _intersperse = (array1, array2) => {\n      if (array1.length === 0) {\n          return [];\n      }\n      return array1\n          .slice(1)\n          .reduce((combinedContent, element, i) => combinedContent.concat([array2[i], element]), [array1[0]]);\n  };\n  /**\n   * Prevents AST elements from being rendered as a string, as this is\n   * most likely an error due to unproper use of `ast`.\n   * Deacivated. Activate for debugging by uncommenting the line below.\n   */\n  const _preventToString = (element) => ({\n      ...element,\n      // Uncomment this to activate\n      // toString: () => { throw new Error(`Rendering element ${elemennt.astType} as string is probably an error`) }\n  });\n  const _prepareVarValue = (value) => {\n      if (typeof value === 'number') {\n          return Sequence([value.toString()]);\n      }\n      else if (typeof value === 'string') {\n          return Sequence([value]);\n      }\n      else {\n          return value;\n      }\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const bufCore = () => Sequence([\n      /**\n       * Ring buffer\n       */\n      Class('buf_SoundBuffer', [\n          Var('FloatArray', 'data'),\n          Var('Int', 'length'),\n          Var('Int', 'writeCursor'),\n          Var('Int', 'pullAvailableLength'),\n      ]),\n      /** Erases all the content from the buffer */\n      Func('buf_clear', [\n          Var('buf_SoundBuffer', 'buffer')\n      ], 'void') `\n        buffer.data.fill(0)\n    `,\n      /** Erases all the content from the buffer */\n      Func('buf_create', [\n          Var('Int', 'length')\n      ], 'buf_SoundBuffer') `\n        return {\n            data: createFloatArray(length),\n            length: length,\n            writeCursor: 0,\n            pullAvailableLength: 0,\n        }\n    `\n  ]);\n  const bufPushPull = {\n      codeGenerator: () => Sequence([\n          /**\n           * Pushes a block to the buffer, throwing an error if the buffer is full.\n           * If the block is written successfully, {@link buf_SoundBuffer#writeCursor}\n           * is moved corresponding with the length of data written.\n           *\n           * @todo : Optimize by allowing to read/write directly from host\n           */\n          Func('buf_pushBlock', [\n              Var('buf_SoundBuffer', 'buffer'),\n              Var('FloatArray', 'block')\n          ], 'Int') `\n            if (buffer.pullAvailableLength + block.length > buffer.length) {\n                throw new Error('buffer full')\n            }\n\n            ${Var('Int', 'left', 'block.length')}\n            while (left > 0) {\n                ${ConstVar('Int', 'lengthToWrite', `toInt(Math.min(\n                    toFloat(buffer.length - buffer.writeCursor), \n                    toFloat(left),\n                ))`)}\n                buffer.data.set(\n                    block.subarray(\n                        block.length - left, \n                        block.length - left + lengthToWrite\n                    ), \n                    buffer.writeCursor\n                )\n                left -= lengthToWrite\n                buffer.writeCursor = (buffer.writeCursor + lengthToWrite) % buffer.length\n                buffer.pullAvailableLength += lengthToWrite\n            }\n            return buffer.pullAvailableLength\n        `,\n          /**\n           * Pulls a single sample from the buffer.\n           * This is a destructive operation, and the sample will be\n           * unavailable for subsequent readers with the same operation.\n           */\n          Func('buf_pullSample', [\n              Var('buf_SoundBuffer', 'buffer')\n          ], 'Float') `\n            if (buffer.pullAvailableLength <= 0) {\n                return 0\n            }\n            ${ConstVar('Int', 'readCursor', 'buffer.writeCursor - buffer.pullAvailableLength')}\n            buffer.pullAvailableLength -= 1\n            return buffer.data[readCursor >= 0 ? readCursor : buffer.length + readCursor]\n        `\n      ]),\n      dependencies: [bufCore],\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const msg = {\n      codeGenerator: ({ target }) => {\n          const declareFuncs = {\n              msg_create: Func('msg_create', [Var('MessageTemplate', 'template')], 'Message'),\n              msg_writeStringToken: Func('msg_writeStringToken', [\n                  Var('Message', 'message'),\n                  Var('Int', 'tokenIndex'),\n                  Var('string', 'value'),\n              ], 'void'),\n              msg_writeFloatToken: Func('msg_writeFloatToken', [\n                  Var('Message', 'message'),\n                  Var('Int', 'tokenIndex'),\n                  Var('MessageFloatToken', 'value'),\n              ], 'void'),\n              msg_readStringToken: Func('msg_readStringToken', [\n                  Var('Message', 'message'),\n                  Var('Int', 'tokenIndex'),\n              ], 'string'),\n              msg_readFloatToken: Func('msg_readFloatToken', [\n                  Var('Message', 'message'),\n                  Var('Int', 'tokenIndex'),\n              ], 'MessageFloatToken'),\n              msg_getLength: Func('msg_getLength', [\n                  Var('Message', 'message')\n              ], 'Int'),\n              msg_getTokenType: Func('msg_getTokenType', [\n                  Var('Message', 'message'),\n                  Var('Int', 'tokenIndex'),\n              ], 'Int'),\n              msg_isStringToken: Func('msg_isStringToken', [\n                  Var('Message', 'message'),\n                  Var('Int', 'tokenIndex'),\n              ], 'boolean'),\n              msg_isFloatToken: Func('msg_isFloatToken', [\n                  Var('Message', 'message'),\n                  Var('Int', 'tokenIndex'),\n              ], 'boolean'),\n              msg_isMatching: Func('msg_isMatching', [\n                  Var('Message', 'message'),\n                  Var('Array<MessageHeaderEntry>', 'tokenTypes'),\n              ], 'boolean'),\n              msg_floats: Func('msg_floats', [\n                  Var('Array<Float>', 'values'),\n              ], 'Message'),\n              msg_strings: Func('msg_strings', [\n                  Var('Array<string>', 'values'),\n              ], 'Message'),\n              msg_display: Func('msg_display', [\n                  Var('Message', 'message'),\n              ], 'string')\n          };\n          if (target === 'assemblyscript') {\n              return Sequence([\n                  `\n                type MessageFloatToken = Float\n                type MessageCharToken = Int\n\n                type MessageTemplate = Array<Int>\n                type MessageHeaderEntry = Int\n                type MessageHeader = Int32Array\n                `,\n                  ConstVar('MessageHeaderEntry', 'MSG_FLOAT_TOKEN', '0'),\n                  ConstVar('MessageHeaderEntry', 'MSG_STRING_TOKEN', '1'),\n                  // =========================== EXPORTED API\n                  Func('x_msg_create', [\n                      Var('Int32Array', 'templateTypedArray')\n                  ], 'Message') `\n                    const template: MessageTemplate = new Array<Int>(templateTypedArray.length)\n                    for (let i: Int = 0; i < templateTypedArray.length; i++) {\n                        template[i] = templateTypedArray[i]\n                    }\n                    return msg_create(template)\n                `,\n                  Func('x_msg_getTokenTypes', [\n                      Var('Message', 'message')\n                  ], 'MessageHeader') `\n                    return message.tokenTypes\n                `,\n                  Func('x_msg_createTemplate', [\n                      Var('i32', 'length')\n                  ], 'Int32Array') `\n                    return new Int32Array(length)\n                `,\n                  // =========================== MSG API\n                  declareFuncs.msg_create `\n                    let i: Int = 0\n                    let byteCount: Int = 0\n                    let tokenTypes: Array<MessageHeaderEntry> = []\n                    let tokenPositions: Array<MessageHeaderEntry> = []\n\n                    i = 0\n                    while (i < template.length) {\n                        switch(template[i]) {\n                            case MSG_FLOAT_TOKEN:\n                                byteCount += sizeof<MessageFloatToken>()\n                                tokenTypes.push(MSG_FLOAT_TOKEN)\n                                tokenPositions.push(byteCount)\n                                i += 1\n                                break\n                            case MSG_STRING_TOKEN:\n                                byteCount += sizeof<MessageCharToken>() * template[i + 1]\n                                tokenTypes.push(MSG_STRING_TOKEN)\n                                tokenPositions.push(byteCount)\n                                i += 2\n                                break\n                            default:\n                                throw new Error(\"unknown token type : \" + template[i].toString())\n                        }\n                    }\n\n                    const tokenCount = tokenTypes.length\n                    const headerByteCount = _msg_computeHeaderLength(tokenCount) * sizeof<MessageHeaderEntry>()\n                    byteCount += headerByteCount\n\n                    const buffer = new ArrayBuffer(byteCount)\n                    const dataView = new DataView(buffer)\n                    let writePosition: Int = 0\n                    \n                    dataView.setInt32(writePosition, tokenCount)\n                    writePosition += sizeof<MessageHeaderEntry>()\n\n                    for (i = 0; i < tokenCount; i++) {\n                        dataView.setInt32(writePosition, tokenTypes[i])\n                        writePosition += sizeof<MessageHeaderEntry>()\n                    }\n\n                    dataView.setInt32(writePosition, headerByteCount)\n                    writePosition += sizeof<MessageHeaderEntry>()\n                    for (i = 0; i < tokenCount; i++) {\n                        dataView.setInt32(writePosition, headerByteCount + tokenPositions[i])\n                        writePosition += sizeof<MessageHeaderEntry>()\n                    }\n\n                    const header = _msg_unpackHeader(dataView, tokenCount)\n                    return {\n                        dataView,\n                        tokenCount,\n                        header,\n                        tokenTypes: _msg_unpackTokenTypes(header),\n                        tokenPositions: _msg_unpackTokenPositions(header),\n                    }\n                `,\n                  declareFuncs.msg_writeStringToken `\n                    const startPosition = message.tokenPositions[tokenIndex]\n                    const endPosition = message.tokenPositions[tokenIndex + 1]\n                    const expectedStringLength: Int = (endPosition - startPosition) / sizeof<MessageCharToken>()\n                    if (value.length !== expectedStringLength) {\n                        throw new Error('Invalid string size, specified ' + expectedStringLength.toString() + ', received ' + value.length.toString())\n                    }\n\n                    for (let i = 0; i < value.length; i++) {\n                        message.dataView.setInt32(\n                            startPosition + i * sizeof<MessageCharToken>(), \n                            value.codePointAt(i)\n                        )\n                    }\n                `,\n                  declareFuncs.msg_writeFloatToken `\n                    setFloatDataView(message.dataView, message.tokenPositions[tokenIndex], value)\n                `,\n                  declareFuncs.msg_readStringToken `\n                    const startPosition = message.tokenPositions[tokenIndex]\n                    const endPosition = message.tokenPositions[tokenIndex + 1]\n                    const stringLength: Int = (endPosition - startPosition) / sizeof<MessageCharToken>()\n                    let value: string = ''\n                    for (let i = 0; i < stringLength; i++) {\n                        value += String.fromCodePoint(message.dataView.getInt32(startPosition + sizeof<MessageCharToken>() * i))\n                    }\n                    return value\n                `,\n                  declareFuncs.msg_readFloatToken `\n                    return getFloatDataView(message.dataView, message.tokenPositions[tokenIndex])\n                `,\n                  declareFuncs.msg_getLength `\n                    return message.tokenTypes.length\n                `,\n                  declareFuncs.msg_getTokenType `\n                    return message.tokenTypes[tokenIndex]\n                `,\n                  declareFuncs.msg_isStringToken `\n                    return msg_getTokenType(message, tokenIndex) === MSG_STRING_TOKEN\n                `,\n                  declareFuncs.msg_isFloatToken `\n                    return msg_getTokenType(message, tokenIndex) === MSG_FLOAT_TOKEN\n                `,\n                  declareFuncs.msg_isMatching `\n                    if (message.tokenTypes.length !== tokenTypes.length) {\n                        return false\n                    }\n                    for (let i: Int = 0; i < tokenTypes.length; i++) {\n                        if (message.tokenTypes[i] !== tokenTypes[i]) {\n                            return false\n                        }\n                    }\n                    return true\n                `,\n                  declareFuncs.msg_floats `\n                    const message: Message = msg_create(values.map<MessageHeaderEntry>(v => MSG_FLOAT_TOKEN))\n                    for (let i: Int = 0; i < values.length; i++) {\n                        msg_writeFloatToken(message, i, values[i])\n                    }\n                    return message\n                `,\n                  declareFuncs.msg_strings `\n                    const template: MessageTemplate = []\n                    for (let i: Int = 0; i < values.length; i++) {\n                        template.push(MSG_STRING_TOKEN)\n                        template.push(values[i].length)\n                    }\n                    const message: Message = msg_create(template)\n                    for (let i: Int = 0; i < values.length; i++) {\n                        msg_writeStringToken(message, i, values[i])\n                    }\n                    return message\n                `,\n                  declareFuncs.msg_display `\n                    let displayArray: Array<string> = []\n                    for (let i: Int = 0; i < msg_getLength(message); i++) {\n                        if (msg_isFloatToken(message, i)) {\n                            displayArray.push(msg_readFloatToken(message, i).toString())\n                        } else {\n                            displayArray.push('\"' + msg_readStringToken(message, i) + '\"')\n                        }\n                    }\n                    return '[' + displayArray.join(', ') + ']'\n                `,\n                  // =========================== PRIVATE\n                  // Message header : [\n                  //      <Token count>, \n                  //      <Token 1 type>,  ..., <Token N type>, \n                  //      <Token 1 start>, ..., <Token N start>, <Token N end>\n                  //      ... DATA ...\n                  // ]\n                  Class('Message', [\n                      Var('DataView', 'dataView'),\n                      Var('MessageHeader', 'header'),\n                      Var('MessageHeaderEntry', 'tokenCount'),\n                      Var('MessageHeader', 'tokenTypes'),\n                      Var('MessageHeader', 'tokenPositions'),\n                  ]),\n                  Func('_msg_computeHeaderLength', [\n                      Var('Int', 'tokenCount')\n                  ], 'Int') `\n                    return 1 + tokenCount * 2 + 1\n                `,\n                  Func('_msg_unpackTokenCount', [\n                      Var('DataView', 'messageDataView')\n                  ], 'MessageHeaderEntry') `\n                    return messageDataView.getInt32(0)\n                `,\n                  Func('_msg_unpackHeader', [\n                      Var('DataView', 'messageDataView'),\n                      Var('MessageHeaderEntry', 'tokenCount'),\n                  ], 'MessageHeader') `\n                    const headerLength = _msg_computeHeaderLength(tokenCount)\n                    // TODO : why is this \\`wrap\\` not working ?\n                    // return Int32Array.wrap(messageDataView.buffer, 0, headerLength)\n                    const messageHeader = new Int32Array(headerLength)\n                    for (let i = 0; i < headerLength; i++) {\n                        messageHeader[i] = messageDataView.getInt32(sizeof<MessageHeaderEntry>() * i)\n                    }\n                    return messageHeader\n                `,\n                  Func('_msg_unpackTokenTypes', [\n                      Var('MessageHeader', 'header'),\n                  ], 'MessageHeader') `\n                    return header.slice(1, 1 + header[0])\n                `,\n                  Func('_msg_unpackTokenPositions', [\n                      Var('MessageHeader', 'header'),\n                  ], 'MessageHeader') `\n                    return header.slice(1 + header[0])\n                `,\n              ]);\n          }\n          else if (target === 'javascript') {\n              return Sequence([\n                  ConstVar('string', 'MSG_FLOAT_TOKEN', '\"number\"'),\n                  ConstVar('string', 'MSG_STRING_TOKEN', '\"string\"'),\n                  declareFuncs.msg_create `\n                    const m = []\n                    let i = 0\n                    while (i < template.length) {\n                        if (template[i] === MSG_STRING_TOKEN) {\n                            m.push('')\n                            i += 2\n                        } else if (template[i] === MSG_FLOAT_TOKEN) {\n                            m.push(0)\n                            i += 1\n                        }\n                    }\n                    return m\n                `,\n                  declareFuncs.msg_getLength `\n                    return message.length\n                `,\n                  declareFuncs.msg_getTokenType `\n                    return typeof message[tokenIndex]\n                `,\n                  declareFuncs.msg_isStringToken `\n                    return msg_getTokenType(message, tokenIndex) === 'string'\n                `,\n                  declareFuncs.msg_isFloatToken `\n                    return msg_getTokenType(message, tokenIndex) === 'number'\n                `,\n                  declareFuncs.msg_isMatching `\n                    return (message.length === tokenTypes.length) \n                        && message.every((v, i) => msg_getTokenType(message, i) === tokenTypes[i])\n                `,\n                  declareFuncs.msg_writeFloatToken `\n                    message[tokenIndex] = value\n                `,\n                  declareFuncs.msg_writeStringToken `\n                    message[tokenIndex] = value\n                `,\n                  declareFuncs.msg_readFloatToken `\n                    return message[tokenIndex]\n                `,\n                  declareFuncs.msg_readStringToken `\n                    return message[tokenIndex]\n                `,\n                  declareFuncs.msg_floats `\n                    return values\n                `,\n                  declareFuncs.msg_strings `\n                    return values\n                `,\n                  declareFuncs.msg_display `\n                    return '[' + message\n                        .map(t => typeof t === 'string' ? '\"' + t + '\"' : t.toString())\n                        .join(', ') + ']'\n                `,\n              ]);\n          }\n          else {\n              throw new Error(`Unexpected target: ${target}`);\n          }\n      },\n      exports: [\n          { name: 'x_msg_create', targets: ['assemblyscript'] },\n          { name: 'x_msg_getTokenTypes', targets: ['assemblyscript'] },\n          { name: 'x_msg_createTemplate', targets: ['assemblyscript'] },\n          { name: 'msg_writeStringToken', targets: ['assemblyscript'] },\n          { name: 'msg_writeFloatToken', targets: ['assemblyscript'] },\n          { name: 'msg_readStringToken', targets: ['assemblyscript'] },\n          { name: 'msg_readFloatToken', targets: ['assemblyscript'] },\n          { name: 'MSG_FLOAT_TOKEN', targets: ['assemblyscript'] },\n          { name: 'MSG_STRING_TOKEN', targets: ['assemblyscript'] },\n      ],\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const FS_OPERATION_SUCCESS = 0;\n  const FS_OPERATION_FAILURE = 1;\n  const fsCore = {\n      codeGenerator: ({ target }) => {\n          const content = [];\n          if (target === 'assemblyscript') {\n              content.push(`\n                type fs_OperationId = Int\n                type fs_OperationStatus = Int\n                type fs_OperationCallback = (id: fs_OperationId, status: fs_OperationStatus) => void\n                type fs_OperationSoundCallback = (id: fs_OperationId, status: fs_OperationStatus, sound: FloatArray[]) => void\n                type fs_Url = string\n            `);\n          }\n          return Sequence([\n              ...content,\n              ConstVar('Int', 'FS_OPERATION_SUCCESS', FS_OPERATION_SUCCESS.toString()),\n              ConstVar('Int', 'FS_OPERATION_FAILURE', FS_OPERATION_FAILURE.toString()),\n              ConstVar('Set<fs_OperationId>', '_FS_OPERATIONS_IDS', 'new Set()'),\n              ConstVar('Map<fs_OperationId, fs_OperationCallback>', '_FS_OPERATIONS_CALLBACKS', 'new Map()'),\n              ConstVar('Map<fs_OperationId, fs_OperationSoundCallback>', '_FS_OPERATIONS_SOUND_CALLBACKS', 'new Map()'),\n              // We start at 1, because 0 is what ASC uses when host forgets to pass an arg to \n              // a function. Therefore we can get false negatives when a test happens to expect a 0.\n              Var('Int', '_FS_OPERATION_COUNTER', '1'),\n              Class('fs_SoundInfo', [\n                  Var('Int', 'channelCount'),\n                  Var('Int', 'sampleRate'),\n                  Var('Int', 'bitDepth'),\n                  Var('string', 'encodingFormat'),\n                  Var('string', 'endianness'),\n                  Var('string', 'extraOptions'),\n              ]),\n              Func('fs_soundInfoToMessage', [\n                  Var('fs_SoundInfo', 'soundInfo')\n              ], 'Message') `\n                ${ConstVar('Message', 'info', `msg_create([\n                    MSG_FLOAT_TOKEN,\n                    MSG_FLOAT_TOKEN,\n                    MSG_FLOAT_TOKEN,\n                    MSG_STRING_TOKEN,\n                    soundInfo.encodingFormat.length,\n                    MSG_STRING_TOKEN,\n                    soundInfo.endianness.length,\n                    MSG_STRING_TOKEN,\n                    soundInfo.extraOptions.length\n                ])`)}\n                msg_writeFloatToken(info, 0, toFloat(soundInfo.channelCount))\n                msg_writeFloatToken(info, 1, toFloat(soundInfo.sampleRate))\n                msg_writeFloatToken(info, 2, toFloat(soundInfo.bitDepth))\n                msg_writeStringToken(info, 3, soundInfo.encodingFormat)\n                msg_writeStringToken(info, 4, soundInfo.endianness)\n                msg_writeStringToken(info, 5, soundInfo.extraOptions)\n                return info\n            `,\n              Func('_fs_assertOperationExists', [\n                  Var('fs_OperationId', 'id'),\n                  Var('string', 'operationName'),\n              ], 'void') `\n                if (!_FS_OPERATIONS_IDS.has(id)) {\n                    throw new Error(operationName + ' operation unknown : ' + id.toString())\n                }\n            `,\n              Func('_fs_createOperationId', [], 'fs_OperationId') `\n                ${ConstVar('fs_OperationId', 'id', '_FS_OPERATION_COUNTER++')}\n                _FS_OPERATIONS_IDS.add(id)\n                return id\n            `\n          ]);\n      },\n      dependencies: [msg],\n  };\n  ({\n      codeGenerator: () => Sequence([\n          Func('fs_readSoundFile', [\n              Var('fs_Url', 'url'),\n              Var('fs_SoundInfo', 'soundInfo'),\n              Var('fs_OperationSoundCallback', 'callback'),\n          ], 'fs_OperationId') `\n            ${ConstVar('fs_OperationId', 'id', '_fs_createOperationId()')}\n            _FS_OPERATIONS_SOUND_CALLBACKS.set(id, callback)\n            i_fs_readSoundFile(id, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        `,\n          Func('x_fs_onReadSoundFileResponse', [\n              Var('fs_OperationId', 'id'),\n              Var('fs_OperationStatus', 'status'),\n              Var('FloatArray[]', 'sound'),\n          ], 'void') `\n            _fs_assertOperationExists(id, 'x_fs_onReadSoundFileResponse')\n            _FS_OPERATIONS_IDS.delete(id)\n            // Finish cleaning before calling the callback in case it would throw an error.\n            const callback = _FS_OPERATIONS_SOUND_CALLBACKS.get(id)\n            callback(id, status, sound)\n            _FS_OPERATIONS_SOUND_CALLBACKS.delete(id)\n        `\n      ]),\n      exports: [\n          {\n              name: 'x_fs_onReadSoundFileResponse',\n          },\n      ],\n      imports: [\n          Func('i_fs_readSoundFile', [\n              Var('fs_OperationId', 'id'),\n              Var('fs_Url', 'url'),\n              Var('Message', 'info'),\n          ], 'void') ``,\n      ],\n      dependencies: [fsCore],\n  });\n  ({\n      codeGenerator: () => Sequence([\n          Func('fs_writeSoundFile', [\n              Var('FloatArray[]', 'sound'),\n              Var('fs_Url', 'url'),\n              Var('fs_SoundInfo', 'soundInfo'),\n              Var('fs_OperationCallback', 'callback'),\n          ], 'fs_OperationId') `\n            ${ConstVar('fs_OperationId', 'id', '_fs_createOperationId()')}\n            _FS_OPERATIONS_CALLBACKS.set(id, callback)\n            i_fs_writeSoundFile(id, sound, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        `,\n          Func('x_fs_onWriteSoundFileResponse', [\n              Var('fs_OperationId', 'id'),\n              Var('fs_OperationStatus', 'status'),\n          ], 'void') `\n            _fs_assertOperationExists(id, 'x_fs_onWriteSoundFileResponse')\n            _FS_OPERATIONS_IDS.delete(id)\n            // Finish cleaning before calling the callback in case it would throw an error.\n            ${ConstVar('fs_OperationCallback', 'callback', '_FS_OPERATIONS_CALLBACKS.get(id)')}\n            callback(id, status)\n            _FS_OPERATIONS_CALLBACKS.delete(id)\n        `\n      ]),\n      exports: [\n          {\n              name: 'x_fs_onWriteSoundFileResponse',\n          },\n      ],\n      imports: [\n          Func('i_fs_writeSoundFile', [\n              Var('fs_OperationId', 'id'),\n              Var('FloatArray[]', 'sound'),\n              Var('fs_Url', 'url'),\n              Var('Message', 'info'),\n          ], 'void') ``,\n      ],\n      dependencies: [fsCore],\n  });\n  const fsSoundStreamCore = {\n      codeGenerator: () => Sequence([\n          ConstVar('Map<fs_OperationId, Array<buf_SoundBuffer>>', '_FS_SOUND_STREAM_BUFFERS', 'new Map()'),\n          ConstVar('Int', '_FS_SOUND_BUFFER_LENGTH', '20 * 44100'),\n          Func('fs_closeSoundStream', [\n              Var('fs_OperationId', 'id'),\n              Var('fs_OperationStatus', 'status'),\n          ], 'void') `\n            if (!_FS_OPERATIONS_IDS.has(id)) {\n                return\n            }\n            _FS_OPERATIONS_IDS.delete(id)\n            _FS_OPERATIONS_CALLBACKS.get(id)(id, status)\n            _FS_OPERATIONS_CALLBACKS.delete(id)\n            // Delete this last, to give the callback \n            // a chance to save a reference to the buffer\n            // If write stream, there won't be a buffer\n            if (_FS_SOUND_STREAM_BUFFERS.has(id)) {\n                _FS_SOUND_STREAM_BUFFERS.delete(id)\n            }\n            i_fs_closeSoundStream(id, status)\n        `,\n          Func('x_fs_onCloseSoundStream', [\n              Var('fs_OperationId', 'id'),\n              Var('fs_OperationStatus', 'status'),\n          ], 'void') `\n            fs_closeSoundStream(id, status)\n        `\n      ]),\n      exports: [\n          {\n              name: 'x_fs_onCloseSoundStream',\n          },\n      ],\n      imports: [\n          Func('i_fs_closeSoundStream', [\n              Var('fs_OperationId', 'id'),\n              Var('fs_OperationStatus', 'status'),\n          ], 'void') ``,\n      ],\n      dependencies: [bufCore, fsCore],\n  };\n  ({\n      codeGenerator: () => Sequence([\n          Func('fs_openSoundReadStream', [\n              Var('fs_Url', 'url'),\n              Var('fs_SoundInfo', 'soundInfo'),\n              Var('fs_OperationCallback', 'callback'),\n          ], 'fs_OperationId') `\n            ${ConstVar('fs_OperationId', 'id', '_fs_createOperationId()')}\n            ${ConstVar('Array<buf_SoundBuffer>', 'buffers', '[]')}\n            for (${Var('Int', 'channel', '0')}; channel < soundInfo.channelCount; channel++) {\n                buffers.push(buf_create(_FS_SOUND_BUFFER_LENGTH))\n            }\n            _FS_SOUND_STREAM_BUFFERS.set(id, buffers)\n            _FS_OPERATIONS_CALLBACKS.set(id, callback)\n            i_fs_openSoundReadStream(id, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        `,\n          Func('x_fs_onSoundStreamData', [\n              Var('fs_OperationId', 'id'),\n              Var('FloatArray[]', 'block'),\n          ], 'Int') `\n            _fs_assertOperationExists(id, 'x_fs_onSoundStreamData')\n            const buffers = _FS_SOUND_STREAM_BUFFERS.get(id)\n            for (${Var('Int', 'i', '0')}; i < buffers.length; i++) {\n                buf_pushBlock(buffers[i], block[i])\n            }\n            return buffers[0].pullAvailableLength\n        `\n      ]),\n      exports: [\n          {\n              name: 'x_fs_onSoundStreamData',\n          },\n      ],\n      imports: [\n          Func('i_fs_openSoundReadStream', [\n              Var('fs_OperationId', 'id'),\n              Var('fs_Url', 'url'),\n              Var('Message', 'info'),\n          ], 'void') ``,\n      ],\n      dependencies: [fsSoundStreamCore, bufPushPull],\n  });\n  ({\n      codeGenerator: () => Sequence([\n          Func('fs_openSoundWriteStream', [\n              Var('fs_Url', 'url'),\n              Var('fs_SoundInfo', 'soundInfo'),\n              Var('fs_OperationCallback', 'callback'),\n          ], 'fs_OperationId') `\n            const id = _fs_createOperationId()\n            _FS_SOUND_STREAM_BUFFERS.set(id, [])\n            _FS_OPERATIONS_CALLBACKS.set(id, callback)\n            i_fs_openSoundWriteStream(id, url, fs_soundInfoToMessage(soundInfo))\n            return id\n        `,\n          Func('fs_sendSoundStreamData', [\n              Var('fs_OperationId', 'id'),\n              Var('FloatArray[]', 'block')\n          ], 'void') `\n            _fs_assertOperationExists(id, 'fs_sendSoundStreamData')\n            i_fs_sendSoundStreamData(id, block)\n        `\n      ]),\n      imports: [\n          Func('i_fs_openSoundWriteStream', [\n              Var('fs_OperationId', 'id'),\n              Var('fs_Url', 'url'),\n              Var('Message', 'info'),\n          ], 'void') ``,\n          Func('i_fs_sendSoundStreamData', [\n              Var('fs_OperationId', 'id'),\n              Var('FloatArray[]', 'block'),\n          ], 'void') ``,\n      ],\n      dependencies: [fsSoundStreamCore],\n  });\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  AnonFunc([Var('Message', 'm')], 'void') ``;\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  // NOTE : not necessarily the most logical place to put this function, but we need it here\n  // cause it's imported by the bindings.\n  const getFloatArrayType = (bitDepth) => bitDepth === 64 ? Float64Array : Float32Array;\n  /** Helper to create a Module by wrapping a RawModule with Bindings */\n  const createModule = (rawModule, bindings) => \n  // Use empty object on proxy cause proxy cannot redefine access of member of its target,\n  // which causes issues for example for WebAssembly exports.\n  // See : https://stackoverflow.com/questions/75148897/get-on-proxy-property-items-is-a-read-only-and-non-configurable-data-proper\n  new Proxy({}, {\n      get: (_, k) => {\n          if (bindings.hasOwnProperty(k)) {\n              const key = String(k);\n              const bindingSpec = bindings[key];\n              switch (bindingSpec.type) {\n                  case 'raw':\n                      // Cannot use hasOwnProperty here cause not defined in wasm exports object\n                      if (k in rawModule) {\n                          return rawModule[key];\n                      }\n                      else {\n                          throw new Error(`Key ${String(key)} doesn't exist in raw module`);\n                      }\n                  case 'proxy':\n                  case 'callback':\n                      return bindingSpec.value;\n              }\n              // We need to return undefined here for compatibility with various APIs\n              // which inspect object's attributes.\n          }\n          else {\n              return undefined;\n          }\n      },\n      set: (_, k, newValue) => {\n          if (bindings.hasOwnProperty(String(k))) {\n              const key = String(k);\n              const bindingSpec = bindings[key];\n              if (bindingSpec.type === 'callback') {\n                  bindingSpec.value = newValue;\n              }\n              else {\n                  throw new Error(`Binding key ${String(key)} is read-only`);\n              }\n          }\n          else {\n              throw new Error(`Key ${String(k)} is not defined in bindings`);\n          }\n          return true;\n      },\n  });\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  /** @copyright Assemblyscript ESM bindings */\n  const liftString = (wasmExports, pointer) => {\n      if (!pointer)\n          return null;\n      pointer = pointer >>> 0;\n      const end = (pointer +\n          new Uint32Array(wasmExports.memory.buffer)[(pointer - 4) >>> 2]) >>>\n          1;\n      const memoryU16 = new Uint16Array(wasmExports.memory.buffer);\n      let start = pointer >>> 1;\n      let string = '';\n      while (end - start > 1024) {\n          string += String.fromCharCode(...memoryU16.subarray(start, (start += 1024)));\n      }\n      return string + String.fromCharCode(...memoryU16.subarray(start, end));\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  // REF : Assemblyscript ESM bindings\n  const instantiateWasmModule = async (wasmBuffer, wasmImports = {}) => {\n      const instanceAndModule = await WebAssembly.instantiate(wasmBuffer, {\n          env: {\n              abort: (messagePointer, \n              // filename, not useful because we compile everything to a single string\n              _, lineNumber, columnNumber) => {\n                  const message = liftString(wasmExports, messagePointer);\n                  lineNumber = lineNumber;\n                  columnNumber = columnNumber;\n                  (() => {\n                      // @external.js\n                      throw Error(`${message} at ${lineNumber}:${columnNumber}`);\n                  })();\n              },\n              seed: () => {\n                  return (() => {\n                      return Date.now() * Math.random();\n                  })();\n              },\n              'console.log': (textPointer) => {\n                  console.log(liftString(wasmExports, textPointer));\n              },\n          },\n          ...wasmImports,\n      });\n      const wasmExports = instanceAndModule.instance\n          .exports;\n      return instanceAndModule.instance;\n  };\n\n  const readMetadata$2 = async (wasmBuffer) => {\n      // In order to read metadata, we need to introspect the module to get the imports\n      const inputImports = {};\n      const wasmModule = WebAssembly.Module.imports(new WebAssembly.Module(wasmBuffer));\n      // Then we generate dummy functions to be able to instantiate the module\n      wasmModule\n          .filter((imprt) => imprt.module === 'input' && imprt.kind === 'function')\n          .forEach((imprt) => (inputImports[imprt.name] = () => undefined));\n      const wasmInstance = await instantiateWasmModule(wasmBuffer, {\n          input: inputImports,\n      });\n      // Finally, once the module instantiated, we read the metadata\n      const wasmExports = wasmInstance.exports;\n      const stringPointer = wasmExports.metadata.valueOf();\n      const metadataJSON = liftString(wasmExports, stringPointer);\n      return JSON.parse(metadataJSON);\n  };\n\n  /*\n   * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n   *\n   * This file is part of WebPd\n   * (see https://github.com/sebpiq/WebPd).\n   *\n   * This program is free software: you can redistribute it and/or modify\n   * it under the terms of the GNU Lesser General Public License as published by\n   * the Free Software Foundation, either version 3 of the License, or\n   * (at your option) any later version.\n   *\n   * This program is distributed in the hope that it will be useful,\n   * but WITHOUT ANY WARRANTY; without even the implied warranty of\n   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n   * GNU Lesser General Public License for more details.\n   *\n   * You should have received a copy of the GNU Lesser General Public License\n   * along with this program. If not, see <http://www.gnu.org/licenses/>.\n   */\n  const createRawModule = (code) => new Function(`\n        ${code}\n        return exports\n    `)();\n  const createBindings = (rawModule) => ({\n      fs: { type: 'proxy', value: createFsModule(rawModule) },\n      metadata: { type: 'raw' },\n      configure: { type: 'raw' },\n      loop: { type: 'raw' },\n      io: { type: 'raw' },\n      commons: {\n          type: 'proxy',\n          value: createCommonsModule(rawModule, rawModule.metadata.audioSettings.bitDepth),\n      },\n  });\n  const createEngine = (code) => {\n      const rawModule = createRawModule(code);\n      return createModule(rawModule, createBindings(rawModule));\n  };\n  const createFsModule = (rawModule) => {\n      const fs = createModule(rawModule, {\n          onReadSoundFile: { type: 'callback', value: () => undefined },\n          onWriteSoundFile: { type: 'callback', value: () => undefined },\n          onOpenSoundReadStream: { type: 'callback', value: () => undefined },\n          onOpenSoundWriteStream: { type: 'callback', value: () => undefined },\n          onSoundStreamData: { type: 'callback', value: () => undefined },\n          onCloseSoundStream: { type: 'callback', value: () => undefined },\n          sendReadSoundFileResponse: {\n              type: 'proxy',\n              value: rawModule.x_fs_onReadSoundFileResponse,\n          },\n          sendWriteSoundFileResponse: {\n              type: 'proxy',\n              value: rawModule.x_fs_onWriteSoundFileResponse,\n          },\n          sendSoundStreamData: {\n              type: 'proxy',\n              value: rawModule.x_fs_onSoundStreamData,\n          },\n          closeSoundStream: {\n              type: 'proxy',\n              value: rawModule.x_fs_onCloseSoundStream,\n          },\n      });\n      rawModule.i_fs_openSoundWriteStream = (...args) => fs.onOpenSoundWriteStream(...args);\n      rawModule.i_fs_sendSoundStreamData = (...args) => fs.onSoundStreamData(...args);\n      rawModule.i_fs_openSoundReadStream = (...args) => fs.onOpenSoundReadStream(...args);\n      rawModule.i_fs_closeSoundStream = (...args) => fs.onCloseSoundStream(...args);\n      rawModule.i_fs_writeSoundFile = (...args) => fs.onWriteSoundFile(...args);\n      rawModule.i_fs_readSoundFile = (...args) => fs.onReadSoundFile(...args);\n      return fs;\n  };\n  const createCommonsModule = (rawModule, bitDepth) => {\n      const floatArrayType = getFloatArrayType(bitDepth);\n      return createModule(rawModule, {\n          getArray: { type: 'proxy', value: rawModule.commons_getArray },\n          setArray: {\n              type: 'proxy',\n              value: (arrayName, array) => rawModule.commons_setArray(arrayName, new floatArrayType(array)),\n          },\n      });\n  };\n\n  const readMetadata$1 = async (target, compiled) => {\n      switch (target) {\n          case 'assemblyscript':\n              return readMetadata$2(compiled);\n          case 'javascript':\n              return createEngine(compiled).metadata;\n      }\n  };\n\n  const defaultSettingsForRun = (patchUrl) => {\n      const rootUrl = urlDirName(patchUrl);\n      return {\n          messageHandler: (node, message) => index(node, message, { rootUrl }),\n      };\n  };\n  const readMetadata = (compiledPatch) => {\n      if (typeof compiledPatch === 'string') {\n          return readMetadata$1('javascript', compiledPatch);\n      }\n      else {\n          return readMetadata$1('assemblyscript', compiledPatch);\n      }\n  };\n\n  var run = async (audioContext, compiledPatch, settings) => {\n      const { messageHandler } = settings;\n      const webpdNode = new WebPdWorkletNode(audioContext);\n      webpdNode.port.onmessage = (msg) => messageHandler(webpdNode, msg);\n      if (typeof compiledPatch === 'string') {\n          webpdNode.port.postMessage({\n              type: 'code:JS',\n              payload: {\n                  jsCode: compiledPatch,\n              },\n          });\n      }\n      else {\n          webpdNode.port.postMessage({\n              type: 'code:WASM',\n              payload: {\n                  wasmBuffer: compiledPatch,\n              },\n          });\n      }\n      return webpdNode;\n  };\n\n  exports.defaultSettingsForRun = defaultSettingsForRun;\n  exports.initialize = initialize;\n  exports.readMetadata = readMetadata;\n  exports.run = run;\n\n  return exports;\n\n})({});\n"};throw new Error("Unknown template ".concat(e))})("bare-bones",e),{status:0,warnings:[]};default:throw new Error("invalid build step ".concat(n))}},Ew=e=>["Unknown object types ".concat(Array.from(e).map((e=>"".concat(e))).join(", "))],Aw=e=>e.map((e=>{let{message:n,lineIndex:t}=e;return"line ".concat(t+1," : ").concat(n)}));function Fw(e){return Number.isInteger(e)&&e>=0}function Pw(e){this.name="ArgumentError",this.message=e}const Nw=function(e,n){if(n=n||{},"function"!==typeof e)throw new Pw("fetch must be a function");if("object"!==typeof n)throw new Pw("defaults must be an object");if(void 0!==n.retries&&!Fw(n.retries))throw new Pw("retries must be a positive integer");if(void 0!==n.retryDelay&&!Fw(n.retryDelay)&&"function"!==typeof n.retryDelay)throw new Pw("retryDelay must be a positive integer or a function returning a positive integer");if(void 0!==n.retryOn&&!Array.isArray(n.retryOn)&&"function"!==typeof n.retryOn)throw new Pw("retryOn property expects an array or function");return n=Object.assign({retries:3,retryDelay:1e3,retryOn:[]},n),function(t,r){var a=n.retries,s=n.retryDelay,o=n.retryOn;if(r&&void 0!==r.retries){if(!Fw(r.retries))throw new Pw("retries must be a positive integer");a=r.retries}if(r&&void 0!==r.retryDelay){if(!Fw(r.retryDelay)&&"function"!==typeof r.retryDelay)throw new Pw("retryDelay must be a positive integer or a function returning a positive integer");s=r.retryDelay}if(r&&r.retryOn){if(!Array.isArray(r.retryOn)&&"function"!==typeof r.retryOn)throw new Pw("retryOn property expects an array or function");o=r.retryOn}return new Promise((function(n,i){var l=function(s){var l="undefined"!==typeof Request&&t instanceof Request?t.clone():t;e(l,r).then((function(e){if(Array.isArray(o)&&-1===o.indexOf(e.status))n(e);else if("function"===typeof o)try{return Promise.resolve(o(s,null,e)).then((function(t){t?u(s,null,e):n(e)})).catch(i)}catch(t){i(t)}else s<a?u(s,null,e):n(e)})).catch((function(e){if("function"===typeof o)try{Promise.resolve(o(s,e,null)).then((function(n){n?u(s,e,null):i(e)})).catch((function(e){i(e)}))}catch(e){i(e)}else s<a?u(s,e,null):i(e)}))};function u(e,n,t){var r="function"===typeof s?s(e,n,t):s;setTimeout((function(){l(++e)}),r)}l(0)}))}}(fetch),Rw=(e,n)=>{if(0===e.length)throw new Error("Received empty sound");const t=e[0].constructor,r=e[0].length,a=e.slice(0,n);for(;e.length<n;)a.push(new t(r));return a},Lw=(e,n)=>new URL(n,e).href;class Dw extends Error{constructor(e,n){super("Error ".concat(e," : ").concat(n))}}class Uw extends AudioWorkletNode{constructor(e){super(e,"webpd-node",{numberOfOutputs:1,outputChannelCount:[2]})}destroy(){this.port.postMessage({type:"destroy",payload:{}})}}const jw=e=>(async(e,n)=>{const t=new Blob([n],{type:"text/javascript"}),r=URL.createObjectURL(t);return e.audioWorklet.addModule(r)})(e,"var AssemblyScriptWasmBindings = (function (exports) {\n    'use strict';\n\n    const getFloatArrayType = (bitDepth) => bitDepth === 64 ? Float64Array : Float32Array;\n    const createModule = (rawModule, bindings) => new Proxy({}, {\n        get: (_, k) => {\n            if (bindings.hasOwnProperty(k)) {\n                const key = String(k);\n                const bindingSpec = bindings[key];\n                switch (bindingSpec.type) {\n                    case 'raw':\n                        if (k in rawModule) {\n                            return rawModule[key];\n                        }\n                        else {\n                            throw new Error(`Key ${String(key)} doesn't exist in raw module`);\n                        }\n                    case 'proxy':\n                    case 'callback':\n                        return bindingSpec.value;\n                }\n            }\n            else {\n                return undefined;\n            }\n        },\n        set: (_, k, newValue) => {\n            if (bindings.hasOwnProperty(String(k))) {\n                const key = String(k);\n                const bindingSpec = bindings[key];\n                if (bindingSpec.type === 'callback') {\n                    bindingSpec.value = newValue;\n                }\n                else {\n                    throw new Error(`Binding key ${String(key)} is read-only`);\n                }\n            }\n            else {\n                throw new Error(`Key ${String(k)} is not defined in bindings`);\n            }\n            return true;\n        },\n    });\n\n    const liftString = (wasmExports, pointer) => {\n        if (!pointer)\n            return null;\n        pointer = pointer >>> 0;\n        const end = (pointer +\n            new Uint32Array(wasmExports.memory.buffer)[(pointer - 4) >>> 2]) >>>\n            1;\n        const memoryU16 = new Uint16Array(wasmExports.memory.buffer);\n        let start = pointer >>> 1;\n        let string = '';\n        while (end - start > 1024) {\n            string += String.fromCharCode(...memoryU16.subarray(start, (start += 1024)));\n        }\n        return string + String.fromCharCode(...memoryU16.subarray(start, end));\n    };\n    const lowerString = (wasmExports, value) => {\n        if (value == null)\n            return 0;\n        const length = value.length, pointer = wasmExports.__new(length << 1, 1) >>> 0, memoryU16 = new Uint16Array(wasmExports.memory.buffer);\n        for (let i = 0; i < length; ++i)\n            memoryU16[(pointer >>> 1) + i] = value.charCodeAt(i);\n        return pointer;\n    };\n    const readTypedArray = (wasmExports, constructor, pointer) => {\n        if (!pointer)\n            return null;\n        const memoryU32 = new Uint32Array(wasmExports.memory.buffer);\n        return new constructor(wasmExports.memory.buffer, memoryU32[(pointer + 4) >>> 2], memoryU32[(pointer + 8) >>> 2] / constructor.BYTES_PER_ELEMENT);\n    };\n    const lowerFloatArray = (wasmExports, bitDepth, data) => {\n        const arrayType = getFloatArrayType(bitDepth);\n        const arrayPointer = wasmExports.createFloatArray(data.length);\n        const array = readTypedArray(wasmExports, arrayType, arrayPointer);\n        array.set(data);\n        return { array, arrayPointer };\n    };\n    const lowerListOfFloatArrays = (wasmExports, bitDepth, data) => {\n        const arraysPointer = wasmExports.x_core_createListOfArrays();\n        data.forEach((array) => {\n            const { arrayPointer } = lowerFloatArray(wasmExports, bitDepth, array);\n            wasmExports.x_core_pushToListOfArrays(arraysPointer, arrayPointer);\n        });\n        return arraysPointer;\n    };\n    const readListOfFloatArrays = (wasmExports, bitDepth, listOfArraysPointer) => {\n        const listLength = wasmExports.x_core_getListOfArraysLength(listOfArraysPointer);\n        const arrays = [];\n        const arrayType = getFloatArrayType(bitDepth);\n        for (let i = 0; i < listLength; i++) {\n            const arrayPointer = wasmExports.x_core_getListOfArraysElem(listOfArraysPointer, i);\n            arrays.push(readTypedArray(wasmExports, arrayType, arrayPointer));\n        }\n        return arrays;\n    };\n\n    const liftMessage = (wasmExports, messagePointer) => {\n        const messageTokenTypesPointer = wasmExports.x_msg_getTokenTypes(messagePointer);\n        const messageTokenTypes = readTypedArray(wasmExports, Int32Array, messageTokenTypesPointer);\n        const message = [];\n        messageTokenTypes.forEach((tokenType, tokenIndex) => {\n            if (tokenType === wasmExports.MSG_FLOAT_TOKEN.valueOf()) {\n                message.push(wasmExports.msg_readFloatToken(messagePointer, tokenIndex));\n            }\n            else if (tokenType === wasmExports.MSG_STRING_TOKEN.valueOf()) {\n                const stringPointer = wasmExports.msg_readStringToken(messagePointer, tokenIndex);\n                message.push(liftString(wasmExports, stringPointer));\n            }\n        });\n        return message;\n    };\n    const lowerMessage = (wasmExports, message) => {\n        const template = message.reduce((template, value) => {\n            if (typeof value === 'number') {\n                template.push(wasmExports.MSG_FLOAT_TOKEN.valueOf());\n            }\n            else if (typeof value === 'string') {\n                template.push(wasmExports.MSG_STRING_TOKEN.valueOf());\n                template.push(value.length);\n            }\n            else {\n                throw new Error(`invalid message value ${value}`);\n            }\n            return template;\n        }, []);\n        const templateArrayPointer = wasmExports.x_msg_createTemplate(template.length);\n        const loweredTemplateArray = readTypedArray(wasmExports, Int32Array, templateArrayPointer);\n        loweredTemplateArray.set(template);\n        const messagePointer = wasmExports.x_msg_create(templateArrayPointer);\n        message.forEach((value, index) => {\n            if (typeof value === 'number') {\n                wasmExports.msg_writeFloatToken(messagePointer, index, value);\n            }\n            else if (typeof value === 'string') {\n                const stringPointer = lowerString(wasmExports, value);\n                wasmExports.msg_writeStringToken(messagePointer, index, stringPointer);\n            }\n        });\n        return messagePointer;\n    };\n\n    const mapObject = (src, func) => {\n        const dest = {};\n        Object.entries(src).forEach(([key, srcValue], i) => {\n            dest[key] = func(srcValue, key, i);\n        });\n        return dest;\n    };\n    const mapArray = (src, func) => {\n        const dest = {};\n        src.forEach((srcValue, i) => {\n            const [key, destValue] = func(srcValue, i);\n            dest[key] = destValue;\n        });\n        return dest;\n    };\n\n    const instantiateWasmModule = async (wasmBuffer, wasmImports = {}) => {\n        const instanceAndModule = await WebAssembly.instantiate(wasmBuffer, {\n            env: {\n                abort: (messagePointer, _, lineNumber, columnNumber) => {\n                    const message = liftString(wasmExports, messagePointer);\n                    lineNumber = lineNumber;\n                    columnNumber = columnNumber;\n                    (() => {\n                        throw Error(`${message} at ${lineNumber}:${columnNumber}`);\n                    })();\n                },\n                seed: () => {\n                    return (() => {\n                        return Date.now() * Math.random();\n                    })();\n                },\n                'console.log': (textPointer) => {\n                    console.log(liftString(wasmExports, textPointer));\n                },\n            },\n            ...wasmImports,\n        });\n        const wasmExports = instanceAndModule.instance\n            .exports;\n        return instanceAndModule.instance;\n    };\n\n    const updateWasmInOuts = (rawModule, engineData) => {\n        engineData.wasmOutput = readTypedArray(rawModule, engineData.arrayType, rawModule.getOutput());\n        engineData.wasmInput = readTypedArray(rawModule, engineData.arrayType, rawModule.getInput());\n    };\n    const createEngineLifecycleBindings = (rawModule, engineData) => {\n        return {\n            configure: {\n                type: 'proxy',\n                value: (sampleRate, blockSize) => {\n                    engineData.metadata.audioSettings.blockSize = blockSize;\n                    engineData.metadata.audioSettings.sampleRate = sampleRate;\n                    engineData.blockSize = blockSize;\n                    rawModule.configure(sampleRate, blockSize);\n                    updateWasmInOuts(rawModule, engineData);\n                },\n            },\n            loop: {\n                type: 'proxy',\n                value: (input, output) => {\n                    for (let channel = 0; channel < input.length; channel++) {\n                        engineData.wasmInput.set(input[channel], channel * engineData.blockSize);\n                    }\n                    updateWasmInOuts(rawModule, engineData);\n                    rawModule.loop();\n                    updateWasmInOuts(rawModule, engineData);\n                    for (let channel = 0; channel < output.length; channel++) {\n                        output[channel].set(engineData.wasmOutput.subarray(engineData.blockSize * channel, engineData.blockSize * (channel + 1)));\n                    }\n                },\n            },\n        };\n    };\n    const createIoMessageReceiversBindings = (rawModule, engineData) => mapObject(engineData.metadata.compilation.io.messageReceivers, (spec, nodeId) => ({\n        type: 'proxy',\n        value: mapArray(spec.portletIds, (inletId) => [\n            inletId,\n            (message) => {\n                const messagePointer = lowerMessage(rawModule, message);\n                rawModule[engineData.metadata.compilation.variableNamesIndex.io\n                    .messageReceivers[nodeId][inletId]](messagePointer);\n            },\n        ]),\n    }));\n    const createIoMessageSendersBindings = (_, engineData) => mapObject(engineData.metadata.compilation.io.messageSenders, (spec) => ({\n        type: 'proxy',\n        value: mapArray(spec.portletIds, (outletId) => [\n            outletId,\n            {\n                onMessage: () => undefined,\n            },\n        ]),\n    }));\n    const ioMsgSendersImports = (forwardReferences, metadata) => {\n        const wasmImports = {};\n        const { variableNamesIndex } = metadata.compilation;\n        Object.entries(metadata.compilation.io.messageSenders).forEach(([nodeId, spec]) => {\n            spec.portletIds.forEach((outletId) => {\n                const listenerName = variableNamesIndex.io.messageSenders[nodeId][outletId];\n                wasmImports[listenerName] = (messagePointer) => {\n                    const message = liftMessage(forwardReferences.rawModule, messagePointer);\n                    forwardReferences.modules.io.messageSenders[nodeId][outletId].onMessage(message);\n                };\n            });\n        });\n        return wasmImports;\n    };\n    const readMetadata = async (wasmBuffer) => {\n        const inputImports = {};\n        const wasmModule = WebAssembly.Module.imports(new WebAssembly.Module(wasmBuffer));\n        wasmModule\n            .filter((imprt) => imprt.module === 'input' && imprt.kind === 'function')\n            .forEach((imprt) => (inputImports[imprt.name] = () => undefined));\n        const wasmInstance = await instantiateWasmModule(wasmBuffer, {\n            input: inputImports,\n        });\n        const wasmExports = wasmInstance.exports;\n        const stringPointer = wasmExports.metadata.valueOf();\n        const metadataJSON = liftString(wasmExports, stringPointer);\n        return JSON.parse(metadataJSON);\n    };\n\n    const createFsBindings = (rawModule, engineData) => ({\n        sendReadSoundFileResponse: {\n            type: 'proxy',\n            value: (operationId, status, sound) => {\n                let soundPointer = 0;\n                if (sound) {\n                    soundPointer = lowerListOfFloatArrays(rawModule, engineData.bitDepth, sound);\n                }\n                rawModule.x_fs_onReadSoundFileResponse(operationId, status, soundPointer);\n                updateWasmInOuts(rawModule, engineData);\n            },\n        },\n        sendWriteSoundFileResponse: {\n            type: 'proxy',\n            value: rawModule.x_fs_onWriteSoundFileResponse,\n        },\n        sendSoundStreamData: {\n            type: 'proxy',\n            value: (operationId, sound) => {\n                const soundPointer = lowerListOfFloatArrays(rawModule, engineData.bitDepth, sound);\n                const writtenFrameCount = rawModule.x_fs_onSoundStreamData(operationId, soundPointer);\n                updateWasmInOuts(rawModule, engineData);\n                return writtenFrameCount;\n            },\n        },\n        closeSoundStream: {\n            type: 'proxy',\n            value: rawModule.x_fs_onCloseSoundStream,\n        },\n        onReadSoundFile: { type: 'callback', value: () => undefined },\n        onWriteSoundFile: { type: 'callback', value: () => undefined },\n        onOpenSoundReadStream: { type: 'callback', value: () => undefined },\n        onOpenSoundWriteStream: { type: 'callback', value: () => undefined },\n        onSoundStreamData: { type: 'callback', value: () => undefined },\n        onCloseSoundStream: { type: 'callback', value: () => undefined },\n    });\n    const createFsImports = (forwardReferences) => {\n        let wasmImports = {\n            i_fs_readSoundFile: (operationId, urlPointer, infoPointer) => {\n                const url = liftString(forwardReferences.rawModule, urlPointer);\n                const info = liftMessage(forwardReferences.rawModule, infoPointer);\n                forwardReferences.modules.fs.onReadSoundFile(operationId, url, info);\n            },\n            i_fs_writeSoundFile: (operationId, soundPointer, urlPointer, infoPointer) => {\n                const sound = readListOfFloatArrays(forwardReferences.rawModule, forwardReferences.engineData.bitDepth, soundPointer);\n                const url = liftString(forwardReferences.rawModule, urlPointer);\n                const info = liftMessage(forwardReferences.rawModule, infoPointer);\n                forwardReferences.modules.fs.onWriteSoundFile(operationId, sound, url, info);\n            },\n            i_fs_openSoundReadStream: (operationId, urlPointer, infoPointer) => {\n                const url = liftString(forwardReferences.rawModule, urlPointer);\n                const info = liftMessage(forwardReferences.rawModule, infoPointer);\n                updateWasmInOuts(forwardReferences.rawModule, forwardReferences.engineData);\n                forwardReferences.modules.fs.onOpenSoundReadStream(operationId, url, info);\n            },\n            i_fs_openSoundWriteStream: (operationId, urlPointer, infoPointer) => {\n                const url = liftString(forwardReferences.rawModule, urlPointer);\n                const info = liftMessage(forwardReferences.rawModule, infoPointer);\n                forwardReferences.modules.fs.onOpenSoundWriteStream(operationId, url, info);\n            },\n            i_fs_sendSoundStreamData: (operationId, blockPointer) => {\n                const block = readListOfFloatArrays(forwardReferences.rawModule, forwardReferences.engineData.bitDepth, blockPointer);\n                forwardReferences.modules.fs.onSoundStreamData(operationId, block);\n            },\n            i_fs_closeSoundStream: (...args) => forwardReferences.modules.fs.onCloseSoundStream(...args),\n        };\n        return wasmImports;\n    };\n\n    const createCommonsBindings = (rawModule, engineData) => ({\n        getArray: {\n            type: 'proxy',\n            value: (arrayName) => {\n                const arrayNamePointer = lowerString(rawModule, arrayName);\n                const arrayPointer = rawModule.commons_getArray(arrayNamePointer);\n                return readTypedArray(rawModule, engineData.arrayType, arrayPointer);\n            },\n        },\n        setArray: {\n            type: 'proxy',\n            value: (arrayName, array) => {\n                const stringPointer = lowerString(rawModule, arrayName);\n                const { arrayPointer } = lowerFloatArray(rawModule, engineData.bitDepth, array);\n                rawModule.commons_setArray(stringPointer, arrayPointer);\n                updateWasmInOuts(rawModule, engineData);\n            },\n        },\n    });\n\n    const createEngine = async (wasmBuffer) => {\n        const { rawModule, engineData, forwardReferences } = await createRawModule(wasmBuffer);\n        const engineBindings = await createBindings(rawModule, engineData, forwardReferences);\n        return createModule(rawModule, engineBindings);\n    };\n    const createRawModule = async (wasmBuffer) => {\n        const metadata = await readMetadata(wasmBuffer);\n        const forwardReferences = { modules: {} };\n        const wasmImports = {\n            ...createFsImports(forwardReferences),\n            ...ioMsgSendersImports(forwardReferences, metadata),\n        };\n        const bitDepth = metadata.audioSettings.bitDepth;\n        const arrayType = getFloatArrayType(bitDepth);\n        const engineData = {\n            metadata,\n            wasmOutput: new arrayType(0),\n            wasmInput: new arrayType(0),\n            arrayType,\n            bitDepth,\n            blockSize: 0,\n        };\n        const wasmInstance = await instantiateWasmModule(wasmBuffer, {\n            input: wasmImports,\n        });\n        const rawModule = wasmInstance.exports;\n        return { rawModule, engineData, forwardReferences };\n    };\n    const createBindings = async (rawModule, engineData, forwardReferences) => {\n        const commons = createModule(rawModule, createCommonsBindings(rawModule, engineData));\n        const fs = createModule(rawModule, createFsBindings(rawModule, engineData));\n        const io = {\n            messageReceivers: createModule(rawModule, createIoMessageReceiversBindings(rawModule, engineData)),\n            messageSenders: createModule(rawModule, createIoMessageSendersBindings(rawModule, engineData)),\n        };\n        forwardReferences.modules.fs = fs;\n        forwardReferences.modules.io = io;\n        forwardReferences.engineData = engineData;\n        forwardReferences.rawModule = rawModule;\n        return {\n            ...createEngineLifecycleBindings(rawModule, engineData),\n            metadata: { type: 'proxy', value: engineData.metadata },\n            commons: { type: 'proxy', value: commons },\n            fs: { type: 'proxy', value: fs },\n            io: { type: 'proxy', value: io },\n        };\n    };\n\n    exports.createBindings = createBindings;\n    exports.createEngine = createEngine;\n    exports.createRawModule = createRawModule;\n\n    return exports;\n\n})({});\n;\nvar JavaScriptBindings = (function (exports) {\n    'use strict';\n\n    const getFloatArrayType = (bitDepth) => bitDepth === 64 ? Float64Array : Float32Array;\n    const createModule = (rawModule, bindings) => new Proxy({}, {\n        get: (_, k) => {\n            if (bindings.hasOwnProperty(k)) {\n                const key = String(k);\n                const bindingSpec = bindings[key];\n                switch (bindingSpec.type) {\n                    case 'raw':\n                        if (k in rawModule) {\n                            return rawModule[key];\n                        }\n                        else {\n                            throw new Error(`Key ${String(key)} doesn't exist in raw module`);\n                        }\n                    case 'proxy':\n                    case 'callback':\n                        return bindingSpec.value;\n                }\n            }\n            else {\n                return undefined;\n            }\n        },\n        set: (_, k, newValue) => {\n            if (bindings.hasOwnProperty(String(k))) {\n                const key = String(k);\n                const bindingSpec = bindings[key];\n                if (bindingSpec.type === 'callback') {\n                    bindingSpec.value = newValue;\n                }\n                else {\n                    throw new Error(`Binding key ${String(key)} is read-only`);\n                }\n            }\n            else {\n                throw new Error(`Key ${String(k)} is not defined in bindings`);\n            }\n            return true;\n        },\n    });\n\n    const createRawModule = (code) => new Function(`\n        ${code}\n        return exports\n    `)();\n    const createBindings = (rawModule) => ({\n        fs: { type: 'proxy', value: createFsModule(rawModule) },\n        metadata: { type: 'raw' },\n        configure: { type: 'raw' },\n        loop: { type: 'raw' },\n        io: { type: 'raw' },\n        commons: {\n            type: 'proxy',\n            value: createCommonsModule(rawModule, rawModule.metadata.audioSettings.bitDepth),\n        },\n    });\n    const createEngine = (code) => {\n        const rawModule = createRawModule(code);\n        return createModule(rawModule, createBindings(rawModule));\n    };\n    const createFsModule = (rawModule) => {\n        const fs = createModule(rawModule, {\n            onReadSoundFile: { type: 'callback', value: () => undefined },\n            onWriteSoundFile: { type: 'callback', value: () => undefined },\n            onOpenSoundReadStream: { type: 'callback', value: () => undefined },\n            onOpenSoundWriteStream: { type: 'callback', value: () => undefined },\n            onSoundStreamData: { type: 'callback', value: () => undefined },\n            onCloseSoundStream: { type: 'callback', value: () => undefined },\n            sendReadSoundFileResponse: {\n                type: 'proxy',\n                value: rawModule.x_fs_onReadSoundFileResponse,\n            },\n            sendWriteSoundFileResponse: {\n                type: 'proxy',\n                value: rawModule.x_fs_onWriteSoundFileResponse,\n            },\n            sendSoundStreamData: {\n                type: 'proxy',\n                value: rawModule.x_fs_onSoundStreamData,\n            },\n            closeSoundStream: {\n                type: 'proxy',\n                value: rawModule.x_fs_onCloseSoundStream,\n            },\n        });\n        rawModule.i_fs_openSoundWriteStream = (...args) => fs.onOpenSoundWriteStream(...args);\n        rawModule.i_fs_sendSoundStreamData = (...args) => fs.onSoundStreamData(...args);\n        rawModule.i_fs_openSoundReadStream = (...args) => fs.onOpenSoundReadStream(...args);\n        rawModule.i_fs_closeSoundStream = (...args) => fs.onCloseSoundStream(...args);\n        rawModule.i_fs_writeSoundFile = (...args) => fs.onWriteSoundFile(...args);\n        rawModule.i_fs_readSoundFile = (...args) => fs.onReadSoundFile(...args);\n        return fs;\n    };\n    const createCommonsModule = (rawModule, bitDepth) => {\n        const floatArrayType = getFloatArrayType(bitDepth);\n        return createModule(rawModule, {\n            getArray: { type: 'proxy', value: rawModule.commons_getArray },\n            setArray: {\n                type: 'proxy',\n                value: (arrayName, array) => rawModule.commons_setArray(arrayName, new floatArrayType(array)),\n            },\n        });\n    };\n\n    exports.createBindings = createBindings;\n    exports.createEngine = createEngine;\n    exports.createRawModule = createRawModule;\n\n    return exports;\n\n})({});\n;\n/*\n * Copyright (c) 2022-2023 S\xe9bastien Piquemal <sebpiq@protonmail.com>, Chris McCormick.\n *\n * This file is part of WebPd\n * (see https://github.com/sebpiq/WebPd).\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nconst FS_CALLBACK_NAMES = [\n    'onReadSoundFile',\n    'onOpenSoundReadStream',\n    'onWriteSoundFile',\n    'onOpenSoundWriteStream',\n    'onSoundStreamData',\n    'onCloseSoundStream',\n];\nclass WasmWorkletProcessor extends AudioWorkletProcessor {\n    constructor() {\n        super();\n        this.port.onmessage = this.onMessage.bind(this);\n        this.settings = {\n            blockSize: null,\n            sampleRate,\n        };\n        this.dspConfigured = false;\n        this.engine = null;\n    }\n    process(inputs, outputs) {\n        const output = outputs[0];\n        const input = inputs[0];\n        if (!this.dspConfigured) {\n            if (!this.engine) {\n                return true;\n            }\n            this.settings.blockSize = output[0].length;\n            this.engine.configure(this.settings.sampleRate, this.settings.blockSize);\n            this.dspConfigured = true;\n        }\n        this.engine.loop(input, output);\n        return true;\n    }\n    onMessage(messageEvent) {\n        const message = messageEvent.data;\n        switch (message.type) {\n            case 'code:WASM':\n                this.setWasm(message.payload.wasmBuffer);\n                break;\n            case 'code:JS':\n                this.setJsCode(message.payload.jsCode);\n                break;\n            case 'io:messageReceiver':\n                this.engine.io.messageReceivers[message.payload.nodeId][message.payload.portletId](message.payload.message);\n                break;\n            case 'fs':\n                const returned = this.engine.fs[message.payload.functionName].apply(null, message.payload.arguments);\n                this.port.postMessage({\n                    type: 'fs',\n                    payload: {\n                        functionName: message.payload.functionName + '_return',\n                        operationId: message.payload.arguments[0],\n                        returned,\n                    },\n                });\n                break;\n            case 'destroy':\n                this.destroy();\n                break;\n            default:\n                new Error(`unknown message type ${message.type}`);\n        }\n    }\n    // TODO : control for channelCount of wasmModule\n    setWasm(wasmBuffer) {\n        return AssemblyScriptWasmBindings.createEngine(wasmBuffer).then((engine) => this.setEngine(engine));\n    }\n    setJsCode(code) {\n        const engine = JavaScriptBindings.createEngine(code);\n        this.setEngine(engine);\n    }\n    setEngine(engine) {\n        FS_CALLBACK_NAMES.forEach((functionName) => {\n            ;\n            engine.fs[functionName] = (...args) => {\n                // We don't use transferables, because that would imply reallocating each time new array in the engine.\n                this.port.postMessage({\n                    type: 'fs',\n                    payload: {\n                        functionName,\n                        arguments: args,\n                    },\n                });\n            };\n        });\n        this.engine = engine;\n        this.dspConfigured = false;\n    }\n    destroy() {\n        this.process = () => false;\n    }\n}\nregisterProcessor('webpd-node', WasmWorkletProcessor);\n"),zw=e=>{const n=[];for(let t=0;t<e;t++)n.push(t);return n},Bw=(e,n,t)=>Yw({astType:"Var",name:n,type:e,value:void 0!==t?Xw(t):void 0}),Vw=(e,n,t)=>Yw({astType:"ConstVar",name:n,type:e,value:Xw(t)}),Gw=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"void";return function(r){for(var a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];return Yw({astType:"Func",name:e,args:n,returnType:t,body:Hw(r,...s)})}},Ww=(e,n)=>Yw({astType:"Class",name:e,members:n}),$w=e=>({astType:"Sequence",content:Kw(qw(e,zw(e.length-1).map((()=>"\n"))))}),Hw=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return Yw({astType:"Sequence",content:Kw(qw(e,t))})},Kw=e=>{const n=e.flatMap((e=>"string"===typeof e?[e]:"number"===typeof e?[e.toString()]:null===e?[]:Array.isArray(e)?Kw(qw(e,zw(e.length-1).map((()=>"\n")))):"object"===typeof e&&"Sequence"===e.astType?e.content:[e])),[t,r]=n.reduce(((e,n)=>{let[t,r]=e;return"string"===typeof n?[t,r+n]:r.length?[[...t,r,n],""]:[[...t,n],""]}),[[],""]);return r.length&&t.push(r),t},qw=(e,n)=>0===e.length?[]:e.slice(1).reduce(((e,t,r)=>e.concat([n[r],t])),[e[0]]),Yw=e=>({...e}),Xw=e=>"number"===typeof e?$w([e.toString()]):"string"===typeof e?$w([e]):e;var Jw,Qw;const Zw=()=>$w([Ww("buf_SoundBuffer",[Bw("FloatArray","data"),Bw("Int","length"),Bw("Int","writeCursor"),Bw("Int","pullAvailableLength")]),Gw("buf_clear",[Bw("buf_SoundBuffer","buffer")],"void")(Jw||(Jw=r(["\n        buffer.data.fill(0)\n    "]))),Gw("buf_create",[Bw("Int","length")],"buf_SoundBuffer")(Qw||(Qw=r(["\n        return {\n            data: createFloatArray(length),\n            length: length,\n            writeCursor: 0,\n            pullAvailableLength: 0,\n        }\n    "])))]);var e_,n_,t_,r_,a_,s_,o_,i_,l_,u_,c_,d_,f_,p_,g_,m_,h_,y_,b_,v_,S_,w_,__,k_,I_,T_,x_,O_,C_,M_,E_,A_,F_,P_;var N_,R_,L_,D_,U_,j_,z_,B_,V_,G_,W_;const $_={codeGenerator:e=>{let{target:n}=e;const t=[];return"assemblyscript"===n&&t.push("\n                type fs_OperationId = Int\n                type fs_OperationStatus = Int\n                type fs_OperationCallback = (id: fs_OperationId, status: fs_OperationStatus) => void\n                type fs_OperationSoundCallback = (id: fs_OperationId, status: fs_OperationStatus, sound: FloatArray[]) => void\n                type fs_Url = string\n            "),$w([...t,Vw("Int","FS_OPERATION_SUCCESS",(0).toString()),Vw("Int","FS_OPERATION_FAILURE",1..toString()),Vw("Set<fs_OperationId>","_FS_OPERATIONS_IDS","new Set()"),Vw("Map<fs_OperationId, fs_OperationCallback>","_FS_OPERATIONS_CALLBACKS","new Map()"),Vw("Map<fs_OperationId, fs_OperationSoundCallback>","_FS_OPERATIONS_SOUND_CALLBACKS","new Map()"),Bw("Int","_FS_OPERATION_COUNTER","1"),Ww("fs_SoundInfo",[Bw("Int","channelCount"),Bw("Int","sampleRate"),Bw("Int","bitDepth"),Bw("string","encodingFormat"),Bw("string","endianness"),Bw("string","extraOptions")]),Gw("fs_soundInfoToMessage",[Bw("fs_SoundInfo","soundInfo")],"Message")(N_||(N_=r(["\n                ","\n                msg_writeFloatToken(info, 0, toFloat(soundInfo.channelCount))\n                msg_writeFloatToken(info, 1, toFloat(soundInfo.sampleRate))\n                msg_writeFloatToken(info, 2, toFloat(soundInfo.bitDepth))\n                msg_writeStringToken(info, 3, soundInfo.encodingFormat)\n                msg_writeStringToken(info, 4, soundInfo.endianness)\n                msg_writeStringToken(info, 5, soundInfo.extraOptions)\n                return info\n            "])),Vw("Message","info","msg_create([\n                    MSG_FLOAT_TOKEN,\n                    MSG_FLOAT_TOKEN,\n                    MSG_FLOAT_TOKEN,\n                    MSG_STRING_TOKEN,\n                    soundInfo.encodingFormat.length,\n                    MSG_STRING_TOKEN,\n                    soundInfo.endianness.length,\n                    MSG_STRING_TOKEN,\n                    soundInfo.extraOptions.length\n                ])")),Gw("_fs_assertOperationExists",[Bw("fs_OperationId","id"),Bw("string","operationName")],"void")(R_||(R_=r(["\n                if (!_FS_OPERATIONS_IDS.has(id)) {\n                    throw new Error(operationName + ' operation unknown : ' + id.toString())\n                }\n            "]))),Gw("_fs_createOperationId",[],"fs_OperationId")(L_||(L_=r(["\n                ","\n                _FS_OPERATIONS_IDS.add(id)\n                return id\n            "])),Vw("fs_OperationId","id","_FS_OPERATION_COUNTER++"))])},dependencies:[{codeGenerator:e=>{let{target:n}=e;const t={msg_create:Gw("msg_create",[Bw("MessageTemplate","template")],"Message"),msg_writeStringToken:Gw("msg_writeStringToken",[Bw("Message","message"),Bw("Int","tokenIndex"),Bw("string","value")],"void"),msg_writeFloatToken:Gw("msg_writeFloatToken",[Bw("Message","message"),Bw("Int","tokenIndex"),Bw("MessageFloatToken","value")],"void"),msg_readStringToken:Gw("msg_readStringToken",[Bw("Message","message"),Bw("Int","tokenIndex")],"string"),msg_readFloatToken:Gw("msg_readFloatToken",[Bw("Message","message"),Bw("Int","tokenIndex")],"MessageFloatToken"),msg_getLength:Gw("msg_getLength",[Bw("Message","message")],"Int"),msg_getTokenType:Gw("msg_getTokenType",[Bw("Message","message"),Bw("Int","tokenIndex")],"Int"),msg_isStringToken:Gw("msg_isStringToken",[Bw("Message","message"),Bw("Int","tokenIndex")],"boolean"),msg_isFloatToken:Gw("msg_isFloatToken",[Bw("Message","message"),Bw("Int","tokenIndex")],"boolean"),msg_isMatching:Gw("msg_isMatching",[Bw("Message","message"),Bw("Array<MessageHeaderEntry>","tokenTypes")],"boolean"),msg_floats:Gw("msg_floats",[Bw("Array<Float>","values")],"Message"),msg_strings:Gw("msg_strings",[Bw("Array<string>","values")],"Message"),msg_display:Gw("msg_display",[Bw("Message","message")],"string")};if("assemblyscript"===n)return $w(["\n                type MessageFloatToken = Float\n                type MessageCharToken = Int\n\n                type MessageTemplate = Array<Int>\n                type MessageHeaderEntry = Int\n                type MessageHeader = Int32Array\n                ",Vw("MessageHeaderEntry","MSG_FLOAT_TOKEN","0"),Vw("MessageHeaderEntry","MSG_STRING_TOKEN","1"),Gw("x_msg_create",[Bw("Int32Array","templateTypedArray")],"Message")(e_||(e_=r(["\n                    const template: MessageTemplate = new Array<Int>(templateTypedArray.length)\n                    for (let i: Int = 0; i < templateTypedArray.length; i++) {\n                        template[i] = templateTypedArray[i]\n                    }\n                    return msg_create(template)\n                "]))),Gw("x_msg_getTokenTypes",[Bw("Message","message")],"MessageHeader")(n_||(n_=r(["\n                    return message.tokenTypes\n                "]))),Gw("x_msg_createTemplate",[Bw("i32","length")],"Int32Array")(t_||(t_=r(["\n                    return new Int32Array(length)\n                "]))),t.msg_create(r_||(r_=r(['\n                    let i: Int = 0\n                    let byteCount: Int = 0\n                    let tokenTypes: Array<MessageHeaderEntry> = []\n                    let tokenPositions: Array<MessageHeaderEntry> = []\n\n                    i = 0\n                    while (i < template.length) {\n                        switch(template[i]) {\n                            case MSG_FLOAT_TOKEN:\n                                byteCount += sizeof<MessageFloatToken>()\n                                tokenTypes.push(MSG_FLOAT_TOKEN)\n                                tokenPositions.push(byteCount)\n                                i += 1\n                                break\n                            case MSG_STRING_TOKEN:\n                                byteCount += sizeof<MessageCharToken>() * template[i + 1]\n                                tokenTypes.push(MSG_STRING_TOKEN)\n                                tokenPositions.push(byteCount)\n                                i += 2\n                                break\n                            default:\n                                throw new Error("unknown token type : " + template[i].toString())\n                        }\n                    }\n\n                    const tokenCount = tokenTypes.length\n                    const headerByteCount = _msg_computeHeaderLength(tokenCount) * sizeof<MessageHeaderEntry>()\n                    byteCount += headerByteCount\n\n                    const buffer = new ArrayBuffer(byteCount)\n                    const dataView = new DataView(buffer)\n                    let writePosition: Int = 0\n                    \n                    dataView.setInt32(writePosition, tokenCount)\n                    writePosition += sizeof<MessageHeaderEntry>()\n\n                    for (i = 0; i < tokenCount; i++) {\n                        dataView.setInt32(writePosition, tokenTypes[i])\n                        writePosition += sizeof<MessageHeaderEntry>()\n                    }\n\n                    dataView.setInt32(writePosition, headerByteCount)\n                    writePosition += sizeof<MessageHeaderEntry>()\n                    for (i = 0; i < tokenCount; i++) {\n                        dataView.setInt32(writePosition, headerByteCount + tokenPositions[i])\n                        writePosition += sizeof<MessageHeaderEntry>()\n                    }\n\n                    const header = _msg_unpackHeader(dataView, tokenCount)\n                    return {\n                        dataView,\n                        tokenCount,\n                        header,\n                        tokenTypes: _msg_unpackTokenTypes(header),\n                        tokenPositions: _msg_unpackTokenPositions(header),\n                    }\n                ']))),t.msg_writeStringToken(a_||(a_=r(["\n                    const startPosition = message.tokenPositions[tokenIndex]\n                    const endPosition = message.tokenPositions[tokenIndex + 1]\n                    const expectedStringLength: Int = (endPosition - startPosition) / sizeof<MessageCharToken>()\n                    if (value.length !== expectedStringLength) {\n                        throw new Error('Invalid string size, specified ' + expectedStringLength.toString() + ', received ' + value.length.toString())\n                    }\n\n                    for (let i = 0; i < value.length; i++) {\n                        message.dataView.setInt32(\n                            startPosition + i * sizeof<MessageCharToken>(), \n                            value.codePointAt(i)\n                        )\n                    }\n                "]))),t.msg_writeFloatToken(s_||(s_=r(["\n                    setFloatDataView(message.dataView, message.tokenPositions[tokenIndex], value)\n                "]))),t.msg_readStringToken(o_||(o_=r(["\n                    const startPosition = message.tokenPositions[tokenIndex]\n                    const endPosition = message.tokenPositions[tokenIndex + 1]\n                    const stringLength: Int = (endPosition - startPosition) / sizeof<MessageCharToken>()\n                    let value: string = ''\n                    for (let i = 0; i < stringLength; i++) {\n                        value += String.fromCodePoint(message.dataView.getInt32(startPosition + sizeof<MessageCharToken>() * i))\n                    }\n                    return value\n                "]))),t.msg_readFloatToken(i_||(i_=r(["\n                    return getFloatDataView(message.dataView, message.tokenPositions[tokenIndex])\n                "]))),t.msg_getLength(l_||(l_=r(["\n                    return message.tokenTypes.length\n                "]))),t.msg_getTokenType(u_||(u_=r(["\n                    return message.tokenTypes[tokenIndex]\n                "]))),t.msg_isStringToken(c_||(c_=r(["\n                    return msg_getTokenType(message, tokenIndex) === MSG_STRING_TOKEN\n                "]))),t.msg_isFloatToken(d_||(d_=r(["\n                    return msg_getTokenType(message, tokenIndex) === MSG_FLOAT_TOKEN\n                "]))),t.msg_isMatching(f_||(f_=r(["\n                    if (message.tokenTypes.length !== tokenTypes.length) {\n                        return false\n                    }\n                    for (let i: Int = 0; i < tokenTypes.length; i++) {\n                        if (message.tokenTypes[i] !== tokenTypes[i]) {\n                            return false\n                        }\n                    }\n                    return true\n                "]))),t.msg_floats(p_||(p_=r(["\n                    const message: Message = msg_create(values.map<MessageHeaderEntry>(v => MSG_FLOAT_TOKEN))\n                    for (let i: Int = 0; i < values.length; i++) {\n                        msg_writeFloatToken(message, i, values[i])\n                    }\n                    return message\n                "]))),t.msg_strings(g_||(g_=r(["\n                    const template: MessageTemplate = []\n                    for (let i: Int = 0; i < values.length; i++) {\n                        template.push(MSG_STRING_TOKEN)\n                        template.push(values[i].length)\n                    }\n                    const message: Message = msg_create(template)\n                    for (let i: Int = 0; i < values.length; i++) {\n                        msg_writeStringToken(message, i, values[i])\n                    }\n                    return message\n                "]))),t.msg_display(m_||(m_=r(["\n                    let displayArray: Array<string> = []\n                    for (let i: Int = 0; i < msg_getLength(message); i++) {\n                        if (msg_isFloatToken(message, i)) {\n                            displayArray.push(msg_readFloatToken(message, i).toString())\n                        } else {\n                            displayArray.push('\"' + msg_readStringToken(message, i) + '\"')\n                        }\n                    }\n                    return '[' + displayArray.join(', ') + ']'\n                "]))),Ww("Message",[Bw("DataView","dataView"),Bw("MessageHeader","header"),Bw("MessageHeaderEntry","tokenCount"),Bw("MessageHeader","tokenTypes"),Bw("MessageHeader","tokenPositions")]),Gw("_msg_computeHeaderLength",[Bw("Int","tokenCount")],"Int")(h_||(h_=r(["\n                    return 1 + tokenCount * 2 + 1\n                "]))),Gw("_msg_unpackTokenCount",[Bw("DataView","messageDataView")],"MessageHeaderEntry")(y_||(y_=r(["\n                    return messageDataView.getInt32(0)\n                "]))),Gw("_msg_unpackHeader",[Bw("DataView","messageDataView"),Bw("MessageHeaderEntry","tokenCount")],"MessageHeader")(b_||(b_=r(["\n                    const headerLength = _msg_computeHeaderLength(tokenCount)\n                    // TODO : why is this `wrap` not working ?\n                    // return Int32Array.wrap(messageDataView.buffer, 0, headerLength)\n                    const messageHeader = new Int32Array(headerLength)\n                    for (let i = 0; i < headerLength; i++) {\n                        messageHeader[i] = messageDataView.getInt32(sizeof<MessageHeaderEntry>() * i)\n                    }\n                    return messageHeader\n                "],["\n                    const headerLength = _msg_computeHeaderLength(tokenCount)\n                    // TODO : why is this \\`wrap\\` not working ?\n                    // return Int32Array.wrap(messageDataView.buffer, 0, headerLength)\n                    const messageHeader = new Int32Array(headerLength)\n                    for (let i = 0; i < headerLength; i++) {\n                        messageHeader[i] = messageDataView.getInt32(sizeof<MessageHeaderEntry>() * i)\n                    }\n                    return messageHeader\n                "]))),Gw("_msg_unpackTokenTypes",[Bw("MessageHeader","header")],"MessageHeader")(v_||(v_=r(["\n                    return header.slice(1, 1 + header[0])\n                "]))),Gw("_msg_unpackTokenPositions",[Bw("MessageHeader","header")],"MessageHeader")(S_||(S_=r(["\n                    return header.slice(1 + header[0])\n                "])))]);if("javascript"===n)return $w([Vw("string","MSG_FLOAT_TOKEN",'"number"'),Vw("string","MSG_STRING_TOKEN",'"string"'),t.msg_create(w_||(w_=r(["\n                    const m = []\n                    let i = 0\n                    while (i < template.length) {\n                        if (template[i] === MSG_STRING_TOKEN) {\n                            m.push('')\n                            i += 2\n                        } else if (template[i] === MSG_FLOAT_TOKEN) {\n                            m.push(0)\n                            i += 1\n                        }\n                    }\n                    return m\n                "]))),t.msg_getLength(__||(__=r(["\n                    return message.length\n                "]))),t.msg_getTokenType(k_||(k_=r(["\n                    return typeof message[tokenIndex]\n                "]))),t.msg_isStringToken(I_||(I_=r(["\n                    return msg_getTokenType(message, tokenIndex) === 'string'\n                "]))),t.msg_isFloatToken(T_||(T_=r(["\n                    return msg_getTokenType(message, tokenIndex) === 'number'\n                "]))),t.msg_isMatching(x_||(x_=r(["\n                    return (message.length === tokenTypes.length) \n                        && message.every((v, i) => msg_getTokenType(message, i) === tokenTypes[i])\n                "]))),t.msg_writeFloatToken(O_||(O_=r(["\n                    message[tokenIndex] = value\n                "]))),t.msg_writeStringToken(C_||(C_=r(["\n                    message[tokenIndex] = value\n                "]))),t.msg_readFloatToken(M_||(M_=r(["\n                    return message[tokenIndex]\n                "]))),t.msg_readStringToken(E_||(E_=r(["\n                    return message[tokenIndex]\n                "]))),t.msg_floats(A_||(A_=r(["\n                    return values\n                "]))),t.msg_strings(F_||(F_=r(["\n                    return values\n                "]))),t.msg_display(P_||(P_=r(["\n                    return '[' + message\n                        .map(t => typeof t === 'string' ? '\"' + t + '\"' : t.toString())\n                        .join(', ') + ']'\n                "])))]);throw new Error("Unexpected target: ".concat(n))},exports:[{name:"x_msg_create",targets:["assemblyscript"]},{name:"x_msg_getTokenTypes",targets:["assemblyscript"]},{name:"x_msg_createTemplate",targets:["assemblyscript"]},{name:"msg_writeStringToken",targets:["assemblyscript"]},{name:"msg_writeFloatToken",targets:["assemblyscript"]},{name:"msg_readStringToken",targets:["assemblyscript"]},{name:"msg_readFloatToken",targets:["assemblyscript"]},{name:"MSG_FLOAT_TOKEN",targets:["assemblyscript"]},{name:"MSG_STRING_TOKEN",targets:["assemblyscript"]}]}]};Gw("i_fs_readSoundFile",[Bw("fs_OperationId","id"),Bw("fs_Url","url"),Bw("Message","info")],"void")(D_||(D_=r([""]))),Gw("i_fs_writeSoundFile",[Bw("fs_OperationId","id"),Bw("FloatArray[]","sound"),Bw("fs_Url","url"),Bw("Message","info")],"void")(U_||(U_=r([""])));Gw("i_fs_closeSoundStream",[Bw("fs_OperationId","id"),Bw("fs_OperationStatus","status")],"void")(B_||(B_=r([""])));var H_;Gw("i_fs_openSoundReadStream",[Bw("fs_OperationId","id"),Bw("fs_Url","url"),Bw("Message","info")],"void")(V_||(V_=r([""]))),Gw("i_fs_openSoundWriteStream",[Bw("fs_OperationId","id"),Bw("fs_Url","url"),Bw("Message","info")],"void")(G_||(G_=r([""]))),Gw("i_fs_sendSoundStreamData",[Bw("fs_OperationId","id"),Bw("FloatArray[]","block")],"void")(W_||(W_=r([""]))),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"void";return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return Yw({astType:"Func",name:null,args:e,returnType:n,body:Hw(t,...a)})}}([Bw("Message","m")],"void")(H_||(H_=r([""])));const K_=e=>Es((async n=>{const t="".concat(e,"/").concat(n.endsWith(".pd")?n:"".concat(n,".pd")),r=await fetch(t);if(!r.ok)throw new As(n);return await r.text()}));const q_={},Y_={};class X_{constructor(e,n){this.url=e,this.sound=n,this.frameCount=n[0].length,this.readPosition=0}}const J_=async e=>{if(q_[e])return q_[e];const n=await(async e=>{let n;try{n=await Nw(e,{retries:3})}catch(t){throw new Dw(n.status,t.toString())}if(!n.ok){const e=await n.text();throw new Dw(n.status,e)}return n.arrayBuffer()})(e);return{type:"binary",data:n}},Q_=async(e,n)=>{let t=q_[e]||await J_(e);switch(t.type){case"binary":return(e=>{const n=[];for(let t=0;t<e.numberOfChannels;t++)n.push(e.getChannelData(t));return n})(await n.decodeAudioData(t.data));case"sound":return t.data.map((e=>e.slice()))}},Z_=e=>Y_[e],ek=e=>{console.log("KILL STREAM",e),delete Y_[e]},nk=(e,n)=>{const t=e.sound.map((t=>t.slice(e.readPosition,e.readPosition+n)));return e.readPosition+=n,t},tk=(e,n)=>{e.sound=e.sound.map(((e,t)=>{const r=new Float32Array(e.length+n[t].length);return r.set(e),r.set(n[t],e.length),r})),e.frameCount=e.sound[0].length,q_[e.url].data=e.sound};var rk=async(e,n)=>{q_[n]={type:"sound",data:e}},ak=Q_,sk=async(e,n,t,r)=>{const a=await Q_(n,r);return Y_[e]=new X_(n,Rw(a,t)),Y_[e]},ok=async(e,n,t)=>{const r=[];for(let a=0;a<t;a++)r.push(new Float32Array(0));return Y_[e]=new X_(n,r),q_[n]={type:"sound",data:r},Y_[e]};const ik=441e3;var lk=async(e,n,t)=>{if("onOpenSoundReadStream"===n.functionName){const[a,s,[o]]=n.arguments;try{const n=Lw(t.rootUrl,s);await sk(a,n,o,e.context)}catch(r){return console.error(r),void e.port.postMessage({type:"fs",payload:{functionName:"closeSoundStream",arguments:[a,1]}})}uk(e,a,0)}else if("sendSoundStreamData_return"===n.functionName){if(!Z_(n.operationId))throw new Error("unknown stream ".concat(n.operationId));uk(e,n.operationId,n.returned)}else if("closeSoundStream_return"===n.functionName){Z_(n.operationId)&&ek(n.operationId)}};const uk=(e,n,t)=>{const r=e.context.sampleRate,a=Math.max(t-220500,10)/r,s=ik-(t-a*r);setTimeout((()=>{const t=Z_(n);if(t)if(t.readPosition<t.frameCount){const r=nk(t,s);e.port.postMessage({type:"fs",payload:{functionName:"sendSoundStreamData",arguments:[n,r]}},r.map((e=>e.buffer)))}else e.port.postMessage({type:"fs",payload:{functionName:"closeSoundStream",arguments:[n,0]}});else console.log("stream ".concat(n," was maybe closed"))}),1e3*a)};var ck=async(e,n,t)=>{if("onOpenSoundWriteStream"===n.functionName){const[e,r,[a]]=n.arguments,s=Lw(t.rootUrl,r);await ok(e,s,a)}else if("onSoundStreamData"===n.functionName){const[e,t]=n.arguments,r=Z_(e);if(!r)throw new Error("unknown stream ".concat(e));tk(r,t)}else if("closeSoundStream_return"===n.functionName){Z_(n.operationId)&&ek(n.operationId)}},dk=async(e,n,t)=>{const r=n.data,{payload:a}=r;if("fs"!==r.type)throw new Error("Unknown message type from node ".concat(r.type));if("onReadSoundFile"===a.functionName||"sendReadSoundFileResponse_return"===a.functionName)(async(e,n,t)=>{if("onReadSoundFile"===n.functionName){const[a,s,[o]]=n.arguments,i=Lw(t.rootUrl,s);let l=0,u=null;try{u=await ak(i,e.context)}catch(r){l=1,console.error(r)}u&&(u=Rw(u,o)),e.port.postMessage({type:"fs",payload:{functionName:"sendReadSoundFileResponse",arguments:[a,l,u]}},u.map((e=>e.buffer)))}else n.functionName})(e,a,t);else if("onOpenSoundReadStream"===a.functionName||"sendSoundStreamData_return"===a.functionName)lk(e,a,t);else if("onWriteSoundFile"===a.functionName||"sendWriteSoundFileResponse_return"===a.functionName)(async(e,n,t)=>{if("onWriteSoundFile"===n.functionName){const[r,a,s,[o]]=n.arguments,i=Rw(a,o),l=Lw(t.rootUrl,s);await rk(i,l);let u=0;e.port.postMessage({type:"fs",payload:{functionName:"sendWriteSoundFileResponse",arguments:[r,u]}})}else n.functionName})(e,a,t);else if("onOpenSoundWriteStream"===a.functionName||"onSoundStreamData"===a.functionName)ck(0,a,t);else if("closeSoundStream_return"===a.functionName)ck(0,a,t),lk(e,a,t);else{if("onCloseSoundStream"!==a.functionName)throw new Error("Unknown callback ".concat(a.functionName));(async(e,n,t)=>{"onCloseSoundStream"===n.functionName&&ek(n.arguments[0])})(0,a)}};const fk=e=>pk(e)?new URL(".",e).href:new URL(".",new URL(e,document.URL).href).href,pk=e=>{try{if(new URL(e).origin!==new URL(document.URL,document.baseURI).origin)return!0}catch(ye){new URL(e,document.baseURI)}return!1},gk=na("shared/clean"),mk=0,hk=1,yk=2,bk=3,vk={artefacts:Cw()},Sk={buildStatus:mk,step:null},wk=ia({name:"buildOutput",initialState:Sk,reducers:{startBuild:e=>{e.buildStatus=hk},buildSuccess:(e,n)=>{vk.artefacts=n.payload.artefacts,e.buildStatus=yk},startStep:(e,n)=>{e.step=n.payload},stepComplete:(e,n)=>{vk.artefacts=n.payload.artefacts,1===n.payload.status&&(e.buildStatus=bk)}},extraReducers(e){const n=()=>(vk.artefacts=Cw(),Sk);e.addCase(gk,n),e.addCase(Ka.actions.setFormat,n),e.addCase(Wa.actions.setLocalFile,n),e.addCase(Wa.actions.fetchUrlSuccess,n)}}),_k={warnings:null,errors:null},kk=ia({name:"console",initialState:_k,reducers:{setState:(e,n)=>n.payload},extraReducers(e){e.addCase(wk.actions.startBuild,(()=>_k)),e.addCase(wk.actions.stepComplete,((e,n)=>{n.payload.warnings&&(e.warnings=[...e.warnings||[],...n.payload.warnings],0===e.warnings.length&&(e.warnings=null)),n.payload.errors&&(e.errors=[...e.errors||[],...n.payload.errors])})),e.addCase(Wa.actions.setUrl,(()=>_k)),e.addCase(Wa.actions.setLocalFile,(()=>_k)),e.addCase(Wa.actions.clear,(()=>_k)),e.addCase(Ka.actions.setFormat,(()=>_k)),e.addCase(Wa.actions.fetchUrlError,((e,n)=>{e.errors=[n.payload]}))}}),Ik=ia({name:"app",initialState:{isInitialized:!1,willBuildOnLoad:!1,debug:!1},reducers:{setWillBuildOnLoad:(e,n)=>{e.willBuildOnLoad=n.payload},initializationDone:e=>{e.isInitialized=!0},setDebug:(e,n)=>{e.debug=n.payload},pointerUp:()=>{}},extraReducers:e=>{e.addCase(wk.actions.buildSuccess,(e=>{e.willBuildOnLoad=!0}))}});var Tk=t(457),xk="NOT_FOUND";var Ok=function(e,n){return e===n};function Ck(e,n){var t="object"===typeof n?n:{equalityCheck:n},r=t.equalityCheck,a=void 0===r?Ok:r,s=t.maxSize,o=void 0===s?1:s,i=t.resultEqualityCheck,l=function(e){return function(n,t){if(null===n||null===t||n.length!==t.length)return!1;for(var r=n.length,a=0;a<r;a++)if(!e(n[a],t[a]))return!1;return!0}}(a),u=1===o?function(e){var n;return{get:function(t){return n&&e(n.key,t)?n.value:xk},put:function(e,t){n={key:e,value:t}},getEntries:function(){return n?[n]:[]},clear:function(){n=void 0}}}(l):function(e,n){var t=[];function r(e){var r=t.findIndex((function(t){return n(e,t.key)}));if(r>-1){var a=t[r];return r>0&&(t.splice(r,1),t.unshift(a)),a.value}return xk}return{get:r,put:function(n,a){r(n)===xk&&(t.unshift({key:n,value:a}),t.length>e&&t.pop())},getEntries:function(){return t},clear:function(){t=[]}}}(o,l);function c(){var n=u.get(arguments);if(n===xk){if(n=e.apply(null,arguments),i){var t=u.getEntries().find((function(e){return i(e.value,n)}));t&&(n=t.value)}u.put(arguments,n)}return n}return c.clearCache=function(){return u.clear()},c}function Mk(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var s,o=0,i={memoizeOptions:void 0},l=r.pop();if("object"===typeof l&&(i=l,l=r.pop()),"function"!==typeof l)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof l+"]");var u=i.memoizeOptions,c=void 0===u?t:u,d=Array.isArray(c)?c:[c],f=function(e){var n=Array.isArray(e[0])?e[0]:e;if(!n.every((function(e){return"function"===typeof e}))){var t=n.map((function(e){return"function"===typeof e?"function "+(e.name||"unnamed")+"()":typeof e})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+t+"]")}return n}(r),p=e.apply(void 0,[function(){return o++,l.apply(null,arguments)}].concat(d)),g=e((function(){for(var e=[],n=f.length,t=0;t<n;t++)e.push(f[t].apply(null,arguments));return s=p.apply(null,e)}));return Object.assign(g,{resultFunc:l,memoizedResultFunc:p,dependencies:f,lastResult:function(){return s},recomputations:function(){return o},resetRecomputations:function(){return o=0}}),g}}var Ek=Mk(Ck);const Ak=e=>e.buildInput.url,Fk=e=>e.buildInput.filepath,Pk=e=>e.buildInput.arrayBuffer,Nk=Ek(Ak,Fk,((e,n)=>{let t=e||n;return t?ip(t)||"pd":null})),Rk=Ek(Nk,Pk,((e,n)=>null===e||null===n?null:((e,n,t)=>{switch(t){case"pd":return{...e,pd:Ps(n)};case"pdJson":return{...e,pdJson:JSON.parse(Ps(n))};case"dspGraph":return{...e,dspGraph:JSON.parse(Ps(n))};case"javascript":return{...e,javascript:Ps(n)};case"assemblyscript":return{...e,assemblyscript:Ps(n)};case"wasm":return{...e,wasm:n};case"wav":return{...e,wav:new Uint8Array(n)};default:throw new Error("Unexpected format for preloading ".concat(t))}})(Cw(),n,e))),Lk=e=>e.buildOutput.format,Dk=e=>e.buildOutput.codeTarget,Uk=e=>e.buildOutput.previewDurationSeconds,jk=Ek(Nk,(e=>{const n=(e=>new Set(cp(op,[]).filter((n=>n.includes(e))).map((n=>n.slice(n.indexOf(e)+1))).flat()))(e=e||"pd");return["patchPlayer",...$a.filter((e=>n.has(e)))]}));var zk=function(e){return"@@redux-saga/"+e},Bk=zk("CANCEL_PROMISE"),Vk=zk("CHANNEL_END"),Gk=zk("IO"),Wk=zk("MATCH"),$k=zk("MULTICAST"),Hk=zk("SAGA_ACTION"),Kk=zk("SELF_CANCELLATION"),qk=zk("TASK"),Yk=zk("TASK_CANCEL"),Xk=zk("TERMINATE"),Jk=zk("LOCATION"),Qk=t(462);var Zk=function(e){return null===e||void 0===e},eI=function(e){return null!==e&&void 0!==e},nI=function(e){return"function"===typeof e},tI=function(e){return"string"===typeof e},rI=Array.isArray,aI=function(e){return e&&nI(e.then)},sI=function(e){return e&&nI(e.next)&&nI(e.throw)},oI=function e(n){return n&&(tI(n)||uI(n)||nI(n)||rI(n)&&n.every(e))},iI=function(e){return e&&nI(e.take)&&nI(e.close)},lI=function(e){return nI(e)&&e.hasOwnProperty("toString")},uI=function(e){return Boolean(e)&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype},cI=function(e){return iI(e)&&e[$k]};const dI=function(e,n){var t;void 0===n&&(n=!0);var r=new Promise((function(r){t=setTimeout(r,Math.min(2147483647,e),n)}));return r[Bk]=function(){clearTimeout(t)},r};var fI=function(e){return function(){return e}},pI=fI(!0),gI=function(){};var mI=function(e){return e};"function"===typeof Symbol&&Symbol.asyncIterator&&Symbol.asyncIterator;var hI=function(e,n){(0,Qk.Z)(e,n),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(n).forEach((function(t){e[t]=n[t]}))};function yI(e,n){var t=e.indexOf(n);t>=0&&e.splice(t,1)}var bI=function(e){throw e},vI=function(e){return{value:e,done:!0}};function SI(e,n,t){void 0===n&&(n=bI),void 0===t&&(t="iterator");var r={meta:{name:t},next:e,throw:n,return:vI,isSagaIterator:!0};return"undefined"!==typeof Symbol&&(r[Symbol.iterator]=function(){return r}),r}function wI(e,n){var t=n.sagaStack;console.error(e),console.error(t)}var _I=function(e){return Array.apply(null,new Array(e))},kI=function(e){return function(n){return e(Object.defineProperty(n,Hk,{value:!0}))}},II=function(e){return e===Xk},TI=function(e){return e===Yk},xI=function(e){return II(e)||TI(e)};function OI(e,n){var t=Object.keys(e),r=t.length;var a,s=0,o=rI(e)?_I(r):{},i={};return t.forEach((function(e){var t=function(t,i){a||(i||xI(t)?(n.cancel(),n(t,i)):(o[e]=t,++s===r&&(a=!0,n(o))))};t.cancel=gI,i[e]=t})),n.cancel=function(){a||(a=!0,t.forEach((function(e){return i[e].cancel()})))},i}function CI(e){return{name:e.name||"anonymous",location:MI(e)}}function MI(e){return e[Jk]}function EI(e,n){void 0===e&&(e=10);var t=new Array(e),r=0,a=0,s=0,o=function(n){t[a]=n,a=(a+1)%e,r++},i=function(){if(0!=r){var n=t[s];return t[s]=null,r--,s=(s+1)%e,n}},l=function(){for(var e=[];r;)e.push(i());return e};return{isEmpty:function(){return 0==r},put:function(i){var u;if(r<e)o(i);else switch(n){case 1:throw new Error("Channel's Buffer overflow!");case 3:t[a]=i,s=a=(a+1)%e;break;case 4:u=2*e,t=l(),r=t.length,a=t.length,s=0,t.length=u,e=u,o(i)}},take:i,flush:l}}var AI=function(e){return EI(e,4)},FI="TAKE",PI="PUT",NI="ALL",RI="RACE",LI="CALL",DI="CPS",UI="FORK",jI="JOIN",zI="CANCEL",BI="SELECT",VI="ACTION_CHANNEL",GI="CANCELLED",WI="FLUSH",$I="GET_CONTEXT",HI="SET_CONTEXT",KI=function(e,n){var t;return(t={})[Gk]=!0,t.combinator=!1,t.type=e,t.payload=n,t};function qI(e,n){return void 0===e&&(e="*"),oI(e)?(eI(n)&&console.warn("take(pattern) takes one argument but two were provided. Consider passing an array for listening to several action types"),KI(FI,{pattern:e})):cI(e)&&eI(n)&&oI(n)?KI(FI,{channel:e,pattern:n}):iI(e)?(eI(n)&&console.warn("take(channel) takes one argument but two were provided. Second argument is ignored."),KI(FI,{channel:e})):void 0}function YI(e,n){return Zk(n)&&(n=e,e=void 0),KI(PI,{channel:e,action:n})}function XI(e,n){var t,r=null;return nI(e)?t=e:(rI(e)?(r=e[0],t=e[1]):(r=e.context,t=e.fn),r&&tI(t)&&nI(r[t])&&(t=r[t])),{context:r,fn:t,args:n}}function JI(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return KI(LI,XI(e,t))}function QI(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return KI(UI,XI(e,t))}function ZI(e){void 0===e&&(e=mI);for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return KI(BI,{selector:e,args:t})}var eT=JI.bind(null,dI);function nT(){var e={};return e.promise=new Promise((function(n,t){e.resolve=n,e.reject=t})),e}const tT=nT;var rT=[],aT=0;function sT(e){try{lT(),e()}finally{uT()}}function oT(e){rT.push(e),aT||(lT(),cT())}function iT(e){try{return lT(),e()}finally{cT()}}function lT(){aT++}function uT(){aT--}function cT(){var e;for(uT();!aT&&void 0!==(e=rT.shift());)sT(e)}var dT=function(e){return function(n){return e.some((function(e){return hT(e)(n)}))}},fT=function(e){return function(n){return e(n)}},pT=function(e){return function(n){return n.type===String(e)}},gT=function(e){return function(n){return n.type===e}},mT=function(){return pI};function hT(e){var n="*"===e?mT:tI(e)?pT:rI(e)?dT:lI(e)?pT:nI(e)?fT:uI(e)?gT:null;if(null===n)throw new Error("invalid pattern: "+e);return n(e)}var yT={type:Vk},bT=function(e){return e&&e.type===Vk};function vT(e){void 0===e&&(e=AI());var n=!1,t=[];return{take:function(r){n&&e.isEmpty()?r(yT):e.isEmpty()?(t.push(r),r.cancel=function(){yI(t,r)}):r(e.take())},put:function(r){if(!n){if(0===t.length)return e.put(r);t.shift()(r)}},flush:function(t){n&&e.isEmpty()?t(yT):t(e.flush())},close:function(){if(!n){n=!0;var e=t;t=[];for(var r=0,a=e.length;r<a;r++){(0,e[r])(yT)}}}}}function ST(){var e=function(){var e,n=!1,t=[],r=t,a=function(){r===t&&(r=t.slice())},s=function(){n=!0;var e=t=r;r=[],e.forEach((function(e){e(yT)}))};return(e={})[$k]=!0,e.put=function(e){if(!n)if(bT(e))s();else for(var a=t=r,o=0,i=a.length;o<i;o++){var l=a[o];l[Wk](e)&&(l.cancel(),l(e))}},e.take=function(e,t){void 0===t&&(t=mT),n?e(yT):(e[Wk]=t,a(),r.push(e),e.cancel=function(e){var n=!1;return function(){n||(n=!0,e())}}((function(){a(),yI(r,e)})))},e.close=s,e}(),n=e.put;return e.put=function(e){e[Hk]?n(e):oT((function(){n(e)}))},e}var wT=0,_T=1,kT=2,IT=3;function TT(e,n){var t=e[Bk];nI(t)&&(n.cancel=t),e.then(n,(function(e){n(e,!0)}))}var xT,OT=0,CT=function(){return++OT};function MT(e){e.isRunning()&&e.cancel()}var ET=((xT={})[FI]=function(e,n,t){var r=n.channel,a=void 0===r?e.channel:r,s=n.pattern,o=n.maybe,i=function(e){e instanceof Error?t(e,!0):!bT(e)||o?t(e):t(Xk)};try{a.take(i,eI(s)?hT(s):null)}catch(l){return void t(l,!0)}t.cancel=i.cancel},xT[PI]=function(e,n,t){var r=n.channel,a=n.action,s=n.resolve;oT((function(){var n;try{n=(r?r.put:e.dispatch)(a)}catch(o){return void t(o,!0)}s&&aI(n)?TT(n,t):t(n)}))},xT[NI]=function(e,n,t,r){var a=r.digestEffect,s=OT,o=Object.keys(n);if(0!==o.length){var i=OI(n,t);o.forEach((function(e){a(n[e],s,i[e],e)}))}else t(rI(n)?[]:{})},xT[RI]=function(e,n,t,r){var a=r.digestEffect,s=OT,o=Object.keys(n),i=rI(n)?_I(o.length):{},l={},u=!1;o.forEach((function(e){var n=function(n,r){u||(r||xI(n)?(t.cancel(),t(n,r)):(t.cancel(),u=!0,i[e]=n,t(i)))};n.cancel=gI,l[e]=n})),t.cancel=function(){u||(u=!0,o.forEach((function(e){return l[e].cancel()})))},o.forEach((function(e){u||a(n[e],s,l[e],e)}))},xT[LI]=function(e,n,t,r){var a=n.context,s=n.fn,o=n.args,i=r.task;try{var l=s.apply(a,o);if(aI(l))return void TT(l,t);if(sI(l))return void BT(e,l,i.context,OT,CI(s),!1,t);t(l)}catch(u){t(u,!0)}},xT[DI]=function(e,n,t){var r=n.context,a=n.fn,s=n.args;try{var o=function(e,n){Zk(e)?t(n):t(e,!0)};a.apply(r,s.concat(o)),o.cancel&&(t.cancel=o.cancel)}catch(i){t(i,!0)}},xT[UI]=function(e,n,t,r){var a=n.context,s=n.fn,o=n.args,i=n.detached,l=r.task,u=function(e){var n=e.context,t=e.fn,r=e.args;try{var a=t.apply(n,r);if(sI(a))return a;var s=!1;return SI((function(e){return s?{value:e,done:!0}:(s=!0,{value:a,done:!aI(a)})}))}catch(o){return SI((function(){throw o}))}}({context:a,fn:s,args:o}),c=function(e,n){return e.isSagaIterator?{name:e.meta.name}:CI(n)}(u,s);iT((function(){var n=BT(e,u,l.context,OT,c,i,void 0);i?t(n):n.isRunning()?(l.queue.addTask(n),t(n)):n.isAborted()?l.queue.abort(n.error()):t(n)}))},xT[jI]=function(e,n,t,r){var a=r.task,s=function(e,n){if(e.isRunning()){var t={task:a,cb:n};n.cancel=function(){e.isRunning()&&yI(e.joiners,t)},e.joiners.push(t)}else e.isAborted()?n(e.error(),!0):n(e.result())};if(rI(n)){if(0===n.length)return void t([]);var o=OI(n,t);n.forEach((function(e,n){s(e,o[n])}))}else s(n,t)},xT[zI]=function(e,n,t,r){var a=r.task;n===Kk?MT(a):rI(n)?n.forEach(MT):MT(n),t()},xT[BI]=function(e,n,t){var r=n.selector,a=n.args;try{t(r.apply(void 0,[e.getState()].concat(a)))}catch(s){t(s,!0)}},xT[VI]=function(e,n,t){var r=n.pattern,a=vT(n.buffer),s=hT(r),o=function n(t){bT(t)||e.channel.take(n,s),a.put(t)},i=a.close;a.close=function(){o.cancel(),i()},e.channel.take(o,s),t(a)},xT[GI]=function(e,n,t,r){t(r.task.isCancelled())},xT[WI]=function(e,n,t){n.flush(t)},xT[$I]=function(e,n,t,r){t(r.task.context[n])},xT[HI]=function(e,n,t,r){var a=r.task;hI(a.context,n),t()},xT);function AT(e,n){return e+"?"+n}function FT(e){var n=e.name,t=e.location;return t?n+"  "+AT(t.fileName,t.lineNumber):n}function PT(e){var n=function(e,n){var t;return(t=[]).concat.apply(t,n.map(e))}((function(e){return e.cancelledTasks}),e);return n.length?["Tasks cancelled due to error:"].concat(n).join("\n"):""}var NT=null,RT=[],LT=function(e){e.crashedEffect=NT,RT.push(e)},DT=function(){NT=null,RT.length=0},UT=function(e){NT=e},jT=function(){var e=RT[0],n=RT.slice(1),t=e.crashedEffect?function(e){var n=MI(e);return n?n.code+"  "+AT(n.fileName,n.lineNumber):""}(e.crashedEffect):null;return["The above error occurred in task "+FT(e.meta)+(t?" \n when executing effect "+t:"")].concat(n.map((function(e){return"    created by "+FT(e.meta)})),[PT(RT)]).join("\n")};function zT(e,n,t,r,a,s,o){var i;void 0===o&&(o=gI);var l,u,c=wT,d=null,f=[],p=Object.create(t),g=function(e,n,t){var r,a=[],s=!1;function o(e){n(),l(),t(e,!0)}function i(n){a.push(n),n.cont=function(i,l){s||(yI(a,n),n.cont=gI,l?o(i):(n===e&&(r=i),a.length||(s=!0,t(r))))}}function l(){s||(s=!0,a.forEach((function(e){e.cont=gI,e.cancel()})),a=[])}return i(e),{addTask:i,cancelAll:l,abort:o,getTasks:function(){return a}}}(n,(function(){f.push.apply(f,g.getTasks().map((function(e){return e.meta.name})))}),m);function m(n,t){if(t){if(c=kT,LT({meta:a,cancelledTasks:f}),h.isRoot){var r=jT();DT(),e.onError(n,{sagaStack:r})}u=n,d&&d.reject(n)}else n===Yk?c=_T:c!==_T&&(c=IT),l=n,d&&d.resolve(n);h.cont(n,t),h.joiners.forEach((function(e){e.cb(n,t)})),h.joiners=null}var h=((i={})[qk]=!0,i.id=r,i.meta=a,i.isRoot=s,i.context=p,i.joiners=[],i.queue=g,i.cancel=function(){c===wT&&(c=_T,g.cancelAll(),m(Yk,!1))},i.cont=o,i.end=m,i.setContext=function(e){hI(p,e)},i.toPromise=function(){return d||(d=tT(),c===kT?d.reject(u):c!==wT&&d.resolve(l)),d.promise},i.isRunning=function(){return c===wT},i.isCancelled=function(){return c===_T||c===wT&&n.status===_T},i.isAborted=function(){return c===kT},i.result=function(){return l},i.error=function(){return u},i);return h}function BT(e,n,t,r,a,s,o){var i=e.finalizeRunEffect((function(n,t,r){if(aI(n))TT(n,r);else if(sI(n))BT(e,n,u.context,t,a,!1,r);else if(n&&n[Gk]){(0,ET[n.type])(e,n.payload,r,c)}else r(n)}));d.cancel=gI;var l={meta:a,cancel:function(){l.status===wT&&(l.status=_T,d(Yk))},status:wT},u=zT(e,l,t,r,a,s,o),c={task:u,digestEffect:f};return o&&(o.cancel=u.cancel),d(),u;function d(e,t){try{var a;t?(a=n.throw(e),DT()):TI(e)?(l.status=_T,d.cancel(),a=nI(n.return)?n.return(Yk):{done:!0,value:Yk}):a=II(e)?nI(n.return)?n.return():{done:!0}:n.next(e),a.done?(l.status!==_T&&(l.status=IT),l.cont(a.value)):f(a.value,r,d)}catch(s){if(l.status===_T)throw s;l.status=kT,l.cont(s,!0)}}function f(n,t,r,a){void 0===a&&(a="");var s,o=CT();function l(t,a){s||(s=!0,r.cancel=gI,e.sagaMonitor&&(a?e.sagaMonitor.effectRejected(o,t):e.sagaMonitor.effectResolved(o,t)),a&&UT(n),r(t,a))}e.sagaMonitor&&e.sagaMonitor.effectTriggered({effectId:o,parentEffectId:t,label:a,effect:n}),l.cancel=gI,r.cancel=function(){s||(s=!0,l.cancel(),l.cancel=gI,e.sagaMonitor&&e.sagaMonitor.effectCancelled(o))},i(n,o,l)}}function VT(e,n){var t=e.channel,r=void 0===t?ST():t,a=e.dispatch,s=e.getState,o=e.context,i=void 0===o?{}:o,l=e.sagaMonitor,u=e.effectMiddlewares,c=e.onError,d=void 0===c?wI:c;for(var f=arguments.length,p=new Array(f>2?f-2:0),g=2;g<f;g++)p[g-2]=arguments[g];var m=n.apply(void 0,p);var h,y=CT();if(l&&(l.rootSagaStarted=l.rootSagaStarted||gI,l.effectTriggered=l.effectTriggered||gI,l.effectResolved=l.effectResolved||gI,l.effectRejected=l.effectRejected||gI,l.effectCancelled=l.effectCancelled||gI,l.actionDispatched=l.actionDispatched||gI,l.rootSagaStarted({effectId:y,saga:n,args:p})),u){var b=Rr.apply(void 0,u);h=function(e){return function(n,t,r){return b((function(n){return e(n,t,r)}))(n)}}}else h=mI;var v={channel:r,dispatch:kI(a),getState:s,sagaMonitor:l,onError:d,finalizeRunEffect:h};return iT((function(){var e=BT(v,m,i,y,CI(n),!0,void 0);return l&&l.effectResolved(y,e),e}))}const GT=function(e){var n,t=void 0===e?{}:e,r=t.context,a=void 0===r?{}:r,s=t.channel,o=void 0===s?ST():s,i=t.sagaMonitor,l=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(t,["context","channel","sagaMonitor"]);function u(e){var t=e.getState,r=e.dispatch;return n=VT.bind(null,(0,Qk.Z)({},l,{context:a,channel:o,dispatch:r,getState:t,sagaMonitor:i})),function(e){return function(n){i&&i.actionDispatched&&i.actionDispatched(n);var t=e(n);return o.put(n),t}}}return u.run=function(){return n.apply(void 0,arguments)},u.setContext=function(e){hI(a,e)},u},WT=GT;var $T=function(e){return{done:!0,value:e}},HT={};function KT(e){return iI(e)?"channel":lI(e)?String(e):nI(e)?e.name:String(e)}function qT(e,n,t){var r,a,s,o=n;function i(n,t){if(o===HT)return $T(n);if(t&&!a)throw o=HT,t;r&&r(n);var i=t?e[a](t):e[o]();return o=i.nextState,s=i.effect,r=i.stateUpdater,a=i.errorState,o===HT?$T(n):s}return SI(i,(function(e){return i(null,e)}),t)}function YT(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var s,o,i={done:!1,value:qI(e)},l=function(e){return{done:!1,value:QI.apply(void 0,[n].concat(r,[e]))}},u=function(e){return{done:!1,value:(n=e,void 0===n&&(n=Kk),KI(zI,n))};var n},c=function(e){return s=e},d=function(e){return o=e};return qT({q1:function(){return{nextState:"q2",effect:i,stateUpdater:d}},q2:function(){return s?{nextState:"q3",effect:u(s)}:{nextState:"q1",effect:l(o),stateUpdater:c}},q3:function(){return{nextState:"q1",effect:l(o),stateUpdater:c}}},"q1","takeLatest("+KT(e)+", "+n.name+")")}function XT(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];return QI.apply(void 0,[YT,e,n].concat(r))}function*JT(){yield XT(Wa.actions.setLocalFile.type,QT)}function*QT(e){const n=ip(e.payload.filepath);null!==n&&Va.includes(n)||(yield YI(Wa.actions.clear()),yield YI(kk.actions.setState({errors:["Invalid file input ".concat(e.payload.filepath)],warnings:[]})))}function*ZT(){yield XT(Wa.actions.setUrl.type,ex)}function*ex(e){const n=e.payload;try{const e=yield JI(nx,n);yield YI(Wa.actions.fetchUrlSuccess({arrayBuffer:e,url:n}))}catch(t){yield YI(Wa.actions.fetchUrlError(t.message))}}const nx=async e=>{const n=await fetch(e);if(!n.ok)throw new tx("Failed to load ".concat(e));return await n.arrayBuffer()};class tx extends Error{}const rx=(e,n)=>({x:e.x+n.x,y:e.y+n.y}),ax=e=>e.reduce(((e,n)=>{let{topLeft:t,bottomRight:r}=e;return{topLeft:{x:Math.min(n.x,t.x),y:Math.min(n.y,t.y)},bottomRight:{x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)}}}),{topLeft:{x:1/0,y:1/0},bottomRight:{x:-1/0,y:-1/0}}),sx=e=>({x:e.bottomRight.x-e.topLeft.x,y:e.bottomRight.y-e.topLeft.y}),ox=()=>new Promise((e=>setTimeout(e,1))),ix=(e,n)=>{if(!e)throw new Error(n||"expected ".concat(e," to be defined"));return e},lx=(e,n,t)=>{const{node:r,patch:a}=n,s=wc(a.id,r.id);e.transforms[s]=t},ux=(e,n,t)=>{e.controlsValues.values[n]=t,e.settings.valuesUpdatedCallback&&cx(e),((e,n,t)=>{e.webpdNode.port.postMessage({type:"io:messageReceiver",payload:{nodeId:n,portletId:"0",message:t}})})(e,n,[t])},cx=((e,n)=>{let t=null;return function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];t&&clearTimeout(t),t=setTimeout((()=>n(...a)),e)}})(300,(e=>{const n={};Object.entries(e.controlsValues.values).forEach((e=>{let[t,r]=e;n[t]="number"===typeof r?function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;const t=Math.round(e*Math.pow(10,n))/Math.pow(10,n);return 0===t?0:t}(r):r})),e.settings.valuesUpdatedCallback(n)})),dx={x:7,y:12},fx=e=>{const n=e.map((e=>{switch(e.type){case"container":const[n]=gx(fx(e.children)),t={type:"container",label:"string"===typeof e.node.args[0]?e.node.args[0]:null,control:e,dimensions:rx(dx,sx(ax([...n.map((e=>e.position)),...n.map((e=>rx(e.position,e.dimensions)))]))),children:n,position:{x:bx(vx(e.node).x),y:bx(vx(e.node).y)}};return t;case"control":return{type:"control",label:hx(e.node),control:e,dimensions:mx(e.node),position:{x:bx(vx(e.node).x),y:bx(vx(e.node).y)}};default:throw new Error("unexpected control type ".concat(e.type))}}));return n},px=e=>e.map((e=>({type:"comment",text:e.text,position:{x:bx(vx(e.node).x),y:bx(vx(e.node).y)}}))),gx=e=>{const n=ax([...e.map((e=>e.position)),...e.map((e=>rx(e.position,e.dimensions)))]),t=((e,n)=>({x:e.x*n,y:e.y*n}))(n.topLeft,-1);return[e.map((e=>({...e,position:rx(e.position,t)}))),t]},mx=e=>{if("control"!==e.nodeClass)throw new Error("Can only get dimension for control node");switch(e.type){case"floatatom":case"symbolatom":return{x:bx(7*(vx(e).widthInChars||3)),y:bx(15)};case"bng":case"tgl":return{x:bx(vx(e).size),y:bx(vx(e).size)};case"nbx":return{x:bx(7*(vx(e).widthInChars||3)),y:bx(vx(e).height)};case"vradio":return{x:bx(vx(e).size),y:bx(yx(e.args[0])*yx(vx(e).size))};case"hradio":return{x:bx(yx(e.args[0])*yx(vx(e).size)),y:bx(vx(e).size)};case"vsl":case"hsl":return{x:bx(vx(e).width),y:bx(vx(e).height)};case"msg":return{x:bx(7*e.args.join(" ").length),y:bx(15)};case"cnv":return{x:0,y:0};default:throw new Error("unsupported type ".concat(e.type))}},hx=e=>{const n=vx(e).label;return n&&n.length?n:null},yx=e=>{if("number"!==typeof e)throw new Error("Expected ".concat(e," to be a number"));return e},bx=e=>1*Math.round(yx(e)/1),vx=e=>ix(e.layout,"expected node to have a layout"),Sx=(e,n,t,r)=>{t.forEach((t=>{if("container"===t.type){const r=wx(e,n,t);Sx(e,r,t.children,t)}else"control"===t.type&&_x(e,n,t,xx(!!r&&Ox(r)))}))},wx=(e,n,t)=>{const r=document.createElement("div");r.classList.add("controls-container");const a=xx(Ox(t));return r.style.left="".concat(Tx(t.position.x),"px"),r.style.top="".concat(Tx(t.position.y),"px"),r.style.width="".concat(Tx(t.dimensions.x),"px"),r.style.height="".concat(Tx(t.dimensions.y),"px"),r.style.paddingTop="".concat(Tx(a.top),"px"),r.style.paddingBottom="".concat(Tx(a.bottom),"px"),r.style.paddingRight="".concat(Tx(a.right),"px"),r.style.paddingLeft="".concat(Tx(a.left),"px"),Ox(t)&&kx(r,t.label),n.appendChild(r),r},_x=(e,n,t,r)=>{const{node:a,patch:s}=t.control,o=e.settings.colorScheme.next(),i=document.createElement("div");if(i.classList.add("control"),i.classList.add(a.type),i.id="control-".concat(s.id,"-").concat(a.id),i.style.left="".concat(Tx(t.position.x+r.left),"px"),i.style.top="".concat(Tx(t.position.y+r.top),"px"),i.style.width="".concat(Tx(t.dimensions.x),"px"),i.style.height="".concat(Tx(t.dimensions.y),"px"),n.appendChild(i),Ox(t)){kx(i,t.label||"").style.color=o}const l=document.createElement("div");i.appendChild(l);const u={x:Tx(t.dimensions.x),y:Tx(t.dimensions.y-(Ox(t)?5:0))},c=Ix(e,l,t,u);return c.colorize("accent",o),c.colorize("fill","black"),c.colorize("dark",o),c.colorize("mediumDark","#222"),c.colorize("mediumLight","#333"),c.element.style.fontFamily="Rajdhani",i},kx=(e,n)=>{const t=document.createElement("div");return t.classList.add("label"),t.innerHTML=n,t.style.height="".concat(Tx(5),"px"),e.appendChild(t),t},Ix=(e,n,t,r)=>{let{x:a,y:s}=r;const{node:o}=t.control,i=((e,n)=>{const{node:t,patch:r}=n,a=wc(r.id,t.id);return e.controlsValues.values[a]})(e,t.control);let l;switch(o.type){case"hsl":case"vsl":"hsl"===o.type?s*=1.2:a*=1.2,l=new Nexus.Add.Slider(n,{min:o.args[0],max:o.args[1],value:void 0!==i?i:o.args[3],size:[a,s]});break;case"hradio":case"vradio":l=new Nexus.RadioButton(n,{numberOfButtons:o.args[0],active:void 0!==i?i:o.args[2],size:[a,s]});break;case"bng":l=new Nexus.Button(n,{size:[s,s]});break;case"msg":l=new Nexus.TextButton(n,{size:[a,s],text:o.args.join(" ")});break;case"nbx":case"floatatom":l=new Nexus.Number(n,{value:void 0!==i?i:"nbx"===o.type?o.args[3]:0,size:[a,s]});break;case"tgl":l=new Nexus.Button(n,{mode:"toggle",state:void 0!==i?i:!!o.args[2],size:[a,s]});break;case"symbolatom":l=new Nexus.TextButton(n,{size:[a,s],state:!1,text:"SYMBOLATOM NOT SUPPORTED"});break;case"cnv":l=new Nexus.TextButton(n,{size:[a,s],state:!1,text:"CNV NOT SUPPORTED"});break;default:throw new Error("Not supported ".concat(o.type))}return l.on("change",(n=>((e,n,t)=>{const{node:r,patch:a}=n,s=wc(a.id,r.id),o=e.controlsValues.transforms[s];if(!o)throw new Error("no value transform for ".concat(s));const i=o(t);null!==i&&ux(e,s,i)})(e,t.control,n))),l},Tx=e=>3*e,xx=e=>({top:e?dx.y-dx.x/2:dx.y/2,left:dx.x/2,right:dx.x/2,bottom:e?dx.x/2:dx.y/2}),Ox=e=>!(!e.label||!e.label.length),Cx=(e,n)=>{const t=ix(e.dspGraph,"artefacts.dspGraph not defined"),r={values:{},transforms:{}},{controls:a,comments:s}=((e,n)=>{const{controls:t,comments:r}=_u(e);return Iu(t,(e=>{let t=e=>e;"bng"===e.node.type?t=e=>!0===e.state?"bang":null:"msg"===e.node.type?t=e=>!0===e?"bang":null:"tgl"===e.node.type&&(t=e=>+e),lx(n,e,t)})),{controls:t.map((e=>{const n={type:"container",patch:e.patch,node:e.node,children:[e]};return"control"===e.type?n:e})),comments:r}})(t.pd,r),{controlsViews:o,commentsViews:i}=((e,n)=>{const[t,r]=gx(fx(e));return{controlsViews:t,commentsViews:px(n).map((e=>({...e,position:rx(e.position,r)})))}})(a,s),l=new AudioContext;return l.suspend(),{rootElem:null,patchUrl:n,audioContext:l,webpdNode:null,pdJson:t.pd,controls:a,controlsValues:r,controlsViews:o,commentsViews:i,io:{messageReceivers:Md(a,t.graph)},settings:null}},Mx=async(e,n,t)=>{const r={...n,controlsValues:{...n.controlsValues,values:t.initialValues?{...t.initialValues}:{}},settings:t},a=document.createElement("div");r.settings.container.appendChild(a);const s=(e=>(e.innerHTML='\n    <div id="splash-container">\n        <div id="loading"></div>\n        <button id="start">START</button>\n    </div>\n\n    <div id="patch-controls">\n        <div id="controls-root"></div>\n    </div>\n\n    <div id="credits">\n        <button>Credits</button>\n        <div class="content">\n        <div>Sound made using <a href="https://github.com/sebpiq/WebPd/" target="_blank" rel="noopener noreferrer" >WebPd</a>.</div>\n        <div>UI made using <a href="https://nexus-js.github.io/ui/" target="_blank" rel="noopener noreferrer" >NexusUI</a>.</div>\n        <div>Demo source code available <a href="https://github.com/sebpiq/WebPd_demos/" target="_blank" rel="noopener noreferrer" >here</a>.</div>\n        <div>Patch ginger2.pd by <a href="http://www.martin-brinkmann.de/pd-patches.html" target="_blank" rel="noopener noreferrer" >Martin Brinkmann</a>.</div>\n        </div>\n    </div>\n',{controlsRoot:ix(e.querySelector("#controls-root"),"controlsRoot not found"),startButton:ix(e.querySelector("#start"),"startButton not found"),loadingLabel:ix(e.querySelector("#loading"),"loadingLabel not found"),loadingContainer:ix(e.querySelector("#splash-container"),"loadingContainer not found"),creditsButton:ix(e.querySelector("#credits button"),"creditsButton not found"),creditsContainer:ix(e.querySelector("#credits"),"creditsContainer not found")}))(a);!0!==r.settings.showCredits&&(s.creditsButton.style.display="none"),s.creditsButton.onclick=()=>{s.creditsContainer.classList.contains("expanded")?s.creditsContainer.classList.remove("expanded"):s.creditsContainer.classList.add("expanded")},s.startButton.style.display="none",s.startButton.onclick=()=>{s.loadingContainer.style.display="none",Ax(r)},s.loadingLabel.innerHTML="loading assemblyscript compiler ...",console.log("PatchPlayer START"),await function(){return jw(...arguments)}(r.audioContext),s.loadingLabel.innerHTML="generating GUI ...",await ox(),((e,n)=>{Sx(e,n,e.controlsViews,null)})(r,s.controlsRoot),((e,n)=>{e.commentsViews.forEach((e=>{const t=document.createElement("div");t.classList.add("comment"),t.innerHTML=e.text,n.appendChild(t),t.style.left="".concat(Tx(e.position.x),"px"),t.style.top="".concat(Tx(e.position.y),"px")}))})(r,s.controlsRoot),await ox();let o=null;try{o=await navigator.mediaDevices.getUserMedia({audio:!0})}catch(i){console.error("Failed to get microphone stream ".concat(i))}return r.webpdNode=await Ex(r,o,e),r.rootElem=a,s.loadingLabel.style.display="none",s.startButton.style.display="block",r},Ex=async(e,n,t)=>{if(!t.javascript&&!t.wasm)throw new Error("Missing artefacts for creating the engine");const r=await(async(e,n,t)=>{const{messageHandler:r}=t,a=new Uw(e);return a.port.onmessage=e=>r(a,e),"string"===typeof n?a.port.postMessage({type:"code:JS",payload:{jsCode:n}}):a.port.postMessage({type:"code:WASM",payload:{wasmBuffer:n}}),a})(e.audioContext,t.javascript||t.wasm,(e=>{const n=fk(e);return{messageHandler:(e,t)=>dk(e,t,{rootUrl:n})}})(e.patchUrl||"."));if(n){e.audioContext.createMediaStreamSource(n).connect(r)}return r.connect(e.audioContext.destination),r},Ax=e=>{"suspended"===e.audioContext.state&&e.audioContext.resume(),(e=>{Object.entries(e.controlsValues.values).forEach((n=>{let[t,r]=n;ux(e,t,r)}))})(e)},Fx=Ek(Nk,Lk,Dk,((e,n,t)=>{if(console.log("selectBuildSteps CODE TARGET",t),!e||!n)return null;if("patchPlayer"===n)switch(t){case"JavaScript":n="javascript";break;case"WebAssembly":n="wasm"}return"wav"===n&&["pd","pdJson","dspGraph"].includes(e)?lp(e,n,"JavaScript"===t?"javascript":"wasm"):lp(e,n)})),Px=64,Nx={WebAssembly:{display:"Web Assembly",info:"Web Assembly is slower to build, but provides a higher performance when running. Good for when your patch is stable and you want to take it elsewhere."},JavaScript:{display:"JavaScript",info:"JavaScript is fast to build, but slower when running. Good if you want to test things fast."}},Rx=e=>e.app.isInitialized,Lx=e=>e.app.willBuildOnLoad,Dx=e=>e.app.debug,Ux=async(e,n,t)=>{const r={...(a=t.rootUrl||"",{audioSettings:{channelCount:{in:2,out:2},bitDepth:64},renderAudioSettings:{sampleRate:44100,blockSize:4096,previewDurationSeconds:30},abstractionLoader:Ow,nodeBuilders:Tw,nodeImplementations:xw,abstractionLoader:K_(a)}),audioSettings:t.audioSettings,renderAudioSettings:t.renderAudioSettings,io:t.io,abstractionLoader:t.rootUrl?K_(t.rootUrl):jx};var a;return Mw(e,n,r)},jx=Es((async e=>{throw new As(e)}));function*zx(){yield XT(wk.actions.startBuild.type,Vx)}function Bx(e,n){return new Promise((t=>{e.onmessage=e=>{t(e.data)},e.postMessage(n)}))}function*Vx(){const e=new Worker("js/build.worker.js"),n=yield ZI(Rk),t=yield ZI(Fx),r=yield ZI(Lk),a=yield ZI(Ak),s=yield ZI(Uk),o=yield ZI(Dx);if(!n||!t)return void(yield YI(wk.actions.buildSuccess({artefacts:n||Cw(),patchPlayer:null})));yield eT(1);let i={...n},l=null;for(let c of t){console.log("BUILD STEP START",c,i),yield YI(wk.actions.startStep(c));try{const n={audioSettings:{channelCount:{in:2,out:2},bitDepth:Px},renderAudioSettings:{sampleRate:44100,blockSize:4096,previewDurationSeconds:s||30},io:l?l.io:void 0,rootUrl:a?fk(a):null},t={artefacts:i,step:c,settings:n};let r;if("wasm"===c)r=yield JI(Ux,i,c,n);else{const n=yield JI(Bx,e,t);r=n.result,i=n.artefacts}const o=1===r.status?r.errors:void 0;if(yield YI(wk.actions.stepComplete({status:r.status,artefacts:i,errors:o,warnings:r.warnings})),1===r.status)return}catch(u){if(yield YI(wk.actions.stepComplete({status:1,artefacts:i,errors:[u.message],warnings:[]})),o)throw u;return}"dspGraph"===c&&"patchPlayer"===r&&(l=Cx(i,a||null))}yield YI(wk.actions.buildSuccess({artefacts:i,patchPlayer:l}))}function*Gx(){for(;!window.asc;)yield eT(100);var e;e=window.asc,qa=e;const n=yield ZI(Ak),t=yield ZI(Pk);if(n&&!t){if((yield qI([Wa.actions.fetchUrlSuccess,Wa.actions.fetchUrlError])).type===Wa.actions.fetchUrlError.type)return void console.log("INIT FAILED ERROR")}(yield ZI(Lx))&&(yield YI(wk.actions.startBuild())),yield YI(Ik.actions.initializationDone())}const Wx={patchPlayer:null},$x={values:{}},Hx=ia({name:"patchPlayer",initialState:$x,reducers:{valuesChanged:(e,n)=>{e.values=n.payload}},extraReducers:e=>{e.addCase(wk.actions.buildSuccess,((e,n)=>{Wx.patchPlayer=n.payload.patchPlayer})),e.addCase(gk,(()=>(Wx.patchPlayer=null,$x)))}}),Kx=e=>e.patchPlayer.values,qx=()=>Wx.patchPlayer,Yx=WT(),Xx=function(e){var n,t=sa(),r=e||{},a=r.reducer,s=void 0===a?void 0:a,o=r.middleware,i=void 0===o?t():o,l=r.devTools,u=void 0===l||l,c=r.preloadedState,d=void 0===c?void 0:c,f=r.enhancers,p=void 0===f?void 0:f;if("function"===typeof s)n=s;else{if(!ea(s))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');n=Nr(s)}var g=i;"function"===typeof g&&(g=g(t));var m=Lr.apply(void 0,g),h=Rr;u&&(h=Zr(Xr({trace:!1},"object"===typeof u&&u)));var y=new ra(m),b=y;return Array.isArray(p)?b=Vr([m],p):"function"===typeof p&&(b=p(y)),Pr(n,d,h.apply(void 0,b))}({reducer:{app:Ik.reducer,buildInput:Wa.reducer,buildOutput:Ka.reducer,artefacts:wk.reducer,console:kk.reducer,patchPlayer:Hx.reducer},middleware:e=>e({serializableCheck:!1}).concat([Yx])}),Jx=za,Qx=Aa;Yx.run((function*(){yield function(e){var n=KI(NI,e);return n.combinator=!0,n}([Gx(),ZT(),JT(),zx()])}));const Zx=e=>"1"===e,eO=e=>e?"1":"0";var nO,tO;(0,Tk.Z)({store:Xx,params:{jsOrAs:{selector:Dk,action:Ka.actions.setCodeTarget,defaultValue:Ka.getInitialState().codeTarget},target:{selector:Lk,action:Ka.actions.setFormat,defaultValue:Ka.getInitialState().format},url:{selector:Ak,action:Wa.actions.setUrl,defaultValue:Wa.getInitialState().url},build:{selector:Lx,action:Ik.actions.setWillBuildOnLoad,defaultValue:Ik.getInitialState().willBuildOnLoad,stringToValue:Zx,valueToString:eO},debug:{selector:Dx,action:Ik.actions.setDebug,defaultValue:Ik.getInitialState().debug,stringToValue:Zx,valueToString:eO},pp:{selector:Kx,action:Hx.actions.valuesChanged,defaultValue:Hx.getInitialState().values,stringToValue:e=>JSON.parse(e),valueToString:e=>JSON.stringify(e)}},replaceState:!0,initialTruth:"location"});const rO={ginger2:{display:"Martin's Brinkmann ginger2",url:"./patches/Martin-Brinkmann-ginger2.pd"},randomperc1:{display:"Martin's Brinkmann randomperc1",url:"./patches/Martin-Brinkmann-randomperc1.pd"}},aO=Re.form(nO||(nO=r(["\n    display: inline;\n"]))),sO=Re(ln)(tO||(tO=r(["\n    padding-left: 0;\n    padding-top: ",";\n    text-overflow: ellipsis;\n    @media (max-width: ","px) {\n        width: 100%;\n        background-color: transparent;\n        text-align: center;\n    }\n"])),De.spacings.space0p1,De.devices.mobile.maxWidth),oO=()=>{const e=Jx();return(0,Ze.jsx)(aO,{children:(0,Ze.jsxs)(sO,{onChange:n=>{const t=n.currentTarget.value;e(Wa.actions.setUrl(rO[t].url))},children:[(0,Ze.jsx)("option",{value:"",children:"Load one of the following examples"}),Object.entries(rO).map((e=>{let[n,t]=e;return(0,Ze.jsx)("option",{value:n,children:t.display},n)}))]})})};var iO=t(7),lO=t.n(iO);function uO(e,n,t,r){return new(t||(t=Promise))((function(a,s){function o(e){try{l(r.next(e))}catch(n){s(n)}}function i(e){try{l(r.throw(e))}catch(n){s(n)}}function l(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,i)}l((r=r.apply(e,n||[])).next())}))}function cO(e,n){var t,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(o=0)),o;)try{if(t=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=n.call(e,o)}catch(l){i=[6,l],r=0}finally{t=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}Object.create;function dO(e,n){var t="function"===typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,a,s=t.call(e),o=[];try{for(;(void 0===n||n-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(i){a={error:i}}finally{try{r&&!r.done&&(t=s.return)&&t.call(s)}finally{if(a)throw a.error}}return o}function fO(e,n,t){if(t||2===arguments.length)for(var r,a=0,s=n.length;a<s;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))}Object.create;"function"===typeof SuppressedError&&SuppressedError;var pO=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function gO(e,n){var t=function(e){var n=e.name;if(n&&-1!==n.lastIndexOf(".")&&!e.type){var t=n.split(".").pop().toLowerCase(),r=pO.get(t);r&&Object.defineProperty(e,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return e}(e);if("string"!==typeof t.path){var r=e.webkitRelativePath;Object.defineProperty(t,"path",{value:"string"===typeof n?n:"string"===typeof r&&r.length>0?r:e.name,writable:!1,configurable:!1,enumerable:!0})}return t}var mO=[".DS_Store","Thumbs.db"];function hO(e){return"object"===typeof e&&null!==e}function yO(e){return wO(e.target.files).map((function(e){return gO(e)}))}function bO(e){return uO(this,void 0,void 0,(function(){return cO(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return e.getFile()})))];case 1:return[2,n.sent().map((function(e){return gO(e)}))]}}))}))}function vO(e,n){return uO(this,void 0,void 0,(function(){var t;return cO(this,(function(r){switch(r.label){case 0:return e.items?(t=wO(e.items).filter((function(e){return"file"===e.kind})),"drop"!==n?[2,t]:[4,Promise.all(t.map(_O))]):[3,2];case 1:return[2,SO(kO(r.sent()))];case 2:return[2,SO(wO(e.files).map((function(e){return gO(e)})))]}}))}))}function SO(e){return e.filter((function(e){return-1===mO.indexOf(e.name)}))}function wO(e){if(null===e)return[];for(var n=[],t=0;t<e.length;t++){var r=e[t];n.push(r)}return n}function _O(e){if("function"!==typeof e.webkitGetAsEntry)return IO(e);var n=e.webkitGetAsEntry();return n&&n.isDirectory?xO(n):IO(e)}function kO(e){return e.reduce((function(e,n){return fO(fO([],dO(e),!1),dO(Array.isArray(n)?kO(n):[n]),!1)}),[])}function IO(e){var n=e.getAsFile();if(!n)return Promise.reject("".concat(e," is not a File"));var t=gO(n);return Promise.resolve(t)}function TO(e){return uO(this,void 0,void 0,(function(){return cO(this,(function(n){return[2,e.isDirectory?xO(e):OO(e)]}))}))}function xO(e){var n=e.createReader();return new Promise((function(e,t){var r=[];!function a(){var s=this;n.readEntries((function(n){return uO(s,void 0,void 0,(function(){var s,o,i;return cO(this,(function(l){switch(l.label){case 0:if(n.length)return[3,5];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return s=l.sent(),e(s),[3,4];case 3:return o=l.sent(),t(o),[3,4];case 4:return[3,6];case 5:i=Promise.all(n.map(TO)),r.push(i),a(),l.label=6;case 6:return[2]}}))}))}),(function(e){t(e)}))}()}))}function OO(e){return uO(this,void 0,void 0,(function(){return cO(this,(function(n){return[2,new Promise((function(n,t){e.file((function(t){var r=gO(t,e.fullPath);n(r)}),(function(e){t(e)}))}))]}))}))}var CO=t(998);function MO(e){return function(e){if(Array.isArray(e))return RO(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||NO(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EO(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function AO(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?EO(Object(t),!0).forEach((function(n){FO(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):EO(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function FO(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function PO(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var r,a,s=[],o=!0,i=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(s.push(r.value),!n||s.length!==n);o=!0);}catch(l){i=!0,a=l}finally{try{o||null==t.return||t.return()}finally{if(i)throw a}}return s}(e,n)||NO(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function NO(e,n){if(e){if("string"===typeof e)return RO(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?RO(e,n):void 0}}function RO(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var LO="file-invalid-type",DO="file-too-large",UO="file-too-small",jO="too-many-files",zO=function(e){e=Array.isArray(e)&&1===e.length?e[0]:e;var n=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:LO,message:"File type must be ".concat(n)}},BO=function(e){return{code:DO,message:"File is larger than ".concat(e," ").concat(1===e?"byte":"bytes")}},VO=function(e){return{code:UO,message:"File is smaller than ".concat(e," ").concat(1===e?"byte":"bytes")}},GO={code:jO,message:"Too many files"};function WO(e,n){var t="application/x-moz-file"===e.type||(0,CO.Z)(e,n);return[t,t?null:zO(n)]}function $O(e,n,t){if(HO(e.size))if(HO(n)&&HO(t)){if(e.size>t)return[!1,BO(t)];if(e.size<n)return[!1,VO(n)]}else{if(HO(n)&&e.size<n)return[!1,VO(n)];if(HO(t)&&e.size>t)return[!1,BO(t)]}return[!0,null]}function HO(e){return void 0!==e&&null!==e}function KO(e){return"function"===typeof e.isPropagationStopped?e.isPropagationStopped():"undefined"!==typeof e.cancelBubble&&e.cancelBubble}function qO(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,(function(e){return"Files"===e||"application/x-moz-file"===e})):!!e.target&&!!e.target.files}function YO(e){e.preventDefault()}function XO(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return n.some((function(n){return!KO(e)&&n&&n.apply(void 0,[e].concat(r)),KO(e)}))}}function JO(e){return"audio/*"===e||"video/*"===e||"image/*"===e||"text/*"===e||/\w+\/[-+.\w]+/g.test(e)}function QO(e){return/^.*\.[\w]+$/.test(e)}var ZO=["children"],eC=["open"],nC=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],tC=["refKey","onChange","onClick"];function rC(e){return function(e){if(Array.isArray(e))return oC(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||sC(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aC(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var r,a,s=[],o=!0,i=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(s.push(r.value),!n||s.length!==n);o=!0);}catch(l){i=!0,a=l}finally{try{o||null==t.return||t.return()}finally{if(i)throw a}}return s}(e,n)||sC(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sC(e,n){if(e){if("string"===typeof e)return oC(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?oC(e,n):void 0}}function oC(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function iC(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function lC(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?iC(Object(t),!0).forEach((function(n){uC(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):iC(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function uC(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function cC(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var dC=(0,e.forwardRef)((function(n,t){var r=n.children,a=hC(cC(n,ZO)),s=a.open,o=cC(a,eC);return(0,e.useImperativeHandle)(t,(function(){return{open:s}}),[s]),e.createElement(e.Fragment,null,r(lC(lC({},o),{},{open:s})))}));dC.displayName="Dropzone";var fC={disabled:!1,getFilesFromEvent:function(e){return uO(this,void 0,void 0,(function(){return cO(this,(function(n){return hO(e)&&hO(e.dataTransfer)?[2,vO(e.dataTransfer,e.type)]:function(e){return hO(e)&&hO(e.target)}(e)?[2,yO(e)]:Array.isArray(e)&&e.every((function(e){return"getFile"in e&&"function"===typeof e.getFile}))?[2,bO(e)]:[2,[]]}))}))},maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};dC.defaultProps=fC,dC.propTypes={children:lO().func,accept:lO().objectOf(lO().arrayOf(lO().string)),multiple:lO().bool,preventDropOnDocument:lO().bool,noClick:lO().bool,noKeyboard:lO().bool,noDrag:lO().bool,noDragEventsBubbling:lO().bool,minSize:lO().number,maxSize:lO().number,maxFiles:lO().number,disabled:lO().bool,getFilesFromEvent:lO().func,onFileDialogCancel:lO().func,onFileDialogOpen:lO().func,useFsAccessApi:lO().bool,autoFocus:lO().bool,onDragEnter:lO().func,onDragLeave:lO().func,onDragOver:lO().func,onDrop:lO().func,onDropAccepted:lO().func,onDropRejected:lO().func,onError:lO().func,validator:lO().func};var pC,gC,mC={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function hC(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=lC(lC({},fC),n),r=t.accept,a=t.disabled,s=t.getFilesFromEvent,o=t.maxSize,i=t.minSize,l=t.multiple,u=t.maxFiles,c=t.onDragEnter,d=t.onDragLeave,f=t.onDragOver,p=t.onDrop,g=t.onDropAccepted,m=t.onDropRejected,h=t.onFileDialogCancel,y=t.onFileDialogOpen,b=t.useFsAccessApi,v=t.autoFocus,S=t.preventDropOnDocument,w=t.noClick,_=t.noKeyboard,k=t.noDrag,I=t.noDragEventsBubbling,T=t.onError,x=t.validator,O=(0,e.useMemo)((function(){return function(e){if(HO(e))return Object.entries(e).reduce((function(e,n){var t=PO(n,2),r=t[0],a=t[1];return[].concat(MO(e),[r],MO(a))}),[]).filter((function(e){return JO(e)||QO(e)})).join(",")}(r)}),[r]),C=(0,e.useMemo)((function(){return function(e){return HO(e)?[{description:"Files",accept:Object.entries(e).filter((function(e){var n=PO(e,2),t=n[0],r=n[1],a=!0;return JO(t)||(console.warn('Skipped "'.concat(t,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),a=!1),Array.isArray(r)&&r.every(QO)||(console.warn('Skipped "'.concat(t,'" because an invalid file extension was provided.')),a=!1),a})).reduce((function(e,n){var t=PO(n,2),r=t[0],a=t[1];return AO(AO({},e),{},FO({},r,a))}),{})}]:e}(r)}),[r]),M=(0,e.useMemo)((function(){return"function"===typeof y?y:bC}),[y]),E=(0,e.useMemo)((function(){return"function"===typeof h?h:bC}),[h]),A=(0,e.useRef)(null),F=(0,e.useRef)(null),P=aC((0,e.useReducer)(yC,mC),2),N=P[0],R=P[1],L=N.isFocused,D=N.isFileDialogActive,U=(0,e.useRef)("undefined"!==typeof window&&window.isSecureContext&&b&&"showOpenFilePicker"in window),j=function(){!U.current&&D&&setTimeout((function(){F.current&&(F.current.files.length||(R({type:"closeDialog"}),E()))}),300)};(0,e.useEffect)((function(){return window.addEventListener("focus",j,!1),function(){window.removeEventListener("focus",j,!1)}}),[F,D,E,U]);var z=(0,e.useRef)([]),B=function(e){A.current&&A.current.contains(e.target)||(e.preventDefault(),z.current=[])};(0,e.useEffect)((function(){return S&&(document.addEventListener("dragover",YO,!1),document.addEventListener("drop",B,!1)),function(){S&&(document.removeEventListener("dragover",YO),document.removeEventListener("drop",B))}}),[A,S]),(0,e.useEffect)((function(){return!a&&v&&A.current&&A.current.focus(),function(){}}),[A,v,a]);var V=(0,e.useCallback)((function(e){T?T(e):console.error(e)}),[T]),G=(0,e.useCallback)((function(e){e.preventDefault(),e.persist(),te(e),z.current=[].concat(rC(z.current),[e.target]),qO(e)&&Promise.resolve(s(e)).then((function(n){if(!KO(e)||I){var t=n.length,r=t>0&&function(e){var n=e.files,t=e.accept,r=e.minSize,a=e.maxSize,s=e.multiple,o=e.maxFiles,i=e.validator;return!(!s&&n.length>1||s&&o>=1&&n.length>o)&&n.every((function(e){var n=PO(WO(e,t),1)[0],s=PO($O(e,r,a),1)[0],o=i?i(e):null;return n&&s&&!o}))}({files:n,accept:O,minSize:i,maxSize:o,multiple:l,maxFiles:u,validator:x});R({isDragAccept:r,isDragReject:t>0&&!r,isDragActive:!0,type:"setDraggedFiles"}),c&&c(e)}})).catch((function(e){return V(e)}))}),[s,c,V,I,O,i,o,l,u,x]),W=(0,e.useCallback)((function(e){e.preventDefault(),e.persist(),te(e);var n=qO(e);if(n&&e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(t){}return n&&f&&f(e),!1}),[f,I]),$=(0,e.useCallback)((function(e){e.preventDefault(),e.persist(),te(e);var n=z.current.filter((function(e){return A.current&&A.current.contains(e)})),t=n.indexOf(e.target);-1!==t&&n.splice(t,1),z.current=n,n.length>0||(R({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),qO(e)&&d&&d(e))}),[A,d,I]),H=(0,e.useCallback)((function(e,n){var t=[],r=[];e.forEach((function(e){var n=aC(WO(e,O),2),a=n[0],s=n[1],l=aC($O(e,i,o),2),u=l[0],c=l[1],d=x?x(e):null;if(a&&u&&!d)t.push(e);else{var f=[s,c];d&&(f=f.concat(d)),r.push({file:e,errors:f.filter((function(e){return e}))})}})),(!l&&t.length>1||l&&u>=1&&t.length>u)&&(t.forEach((function(e){r.push({file:e,errors:[GO]})})),t.splice(0)),R({acceptedFiles:t,fileRejections:r,type:"setFiles"}),p&&p(t,r,n),r.length>0&&m&&m(r,n),t.length>0&&g&&g(t,n)}),[R,l,O,i,o,u,p,g,m,x]),K=(0,e.useCallback)((function(e){e.preventDefault(),e.persist(),te(e),z.current=[],qO(e)&&Promise.resolve(s(e)).then((function(n){KO(e)&&!I||H(n,e)})).catch((function(e){return V(e)})),R({type:"reset"})}),[s,H,V,I]),q=(0,e.useCallback)((function(){if(U.current){R({type:"openDialog"}),M();var e={multiple:l,types:C};window.showOpenFilePicker(e).then((function(e){return s(e)})).then((function(e){H(e,null),R({type:"closeDialog"})})).catch((function(e){!function(e){return e instanceof DOMException&&("AbortError"===e.name||e.code===e.ABORT_ERR)}(e)?!function(e){return e instanceof DOMException&&("SecurityError"===e.name||e.code===e.SECURITY_ERR)}(e)?V(e):(U.current=!1,F.current?(F.current.value=null,F.current.click()):V(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):(E(e),R({type:"closeDialog"}))}))}else F.current&&(R({type:"openDialog"}),M(),F.current.value=null,F.current.click())}),[R,M,E,b,H,V,C,l]),Y=(0,e.useCallback)((function(e){A.current&&A.current.isEqualNode(e.target)&&(" "!==e.key&&"Enter"!==e.key&&32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),q()))}),[A,q]),X=(0,e.useCallback)((function(){R({type:"focus"})}),[]),J=(0,e.useCallback)((function(){R({type:"blur"})}),[]),Q=(0,e.useCallback)((function(){w||(!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return function(e){return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")}(e)||function(e){return-1!==e.indexOf("Edge/")}(e)}()?q():setTimeout(q,0))}),[w,q]),Z=function(e){return a?null:e},ee=function(e){return _?null:Z(e)},ne=function(e){return k?null:Z(e)},te=function(e){I&&e.stopPropagation()},re=(0,e.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.refKey,t=void 0===n?"ref":n,r=e.role,s=e.onKeyDown,o=e.onFocus,i=e.onBlur,l=e.onClick,u=e.onDragEnter,c=e.onDragOver,d=e.onDragLeave,f=e.onDrop,p=cC(e,nC);return lC(lC(uC({onKeyDown:ee(XO(s,Y)),onFocus:ee(XO(o,X)),onBlur:ee(XO(i,J)),onClick:Z(XO(l,Q)),onDragEnter:ne(XO(u,G)),onDragOver:ne(XO(c,W)),onDragLeave:ne(XO(d,$)),onDrop:ne(XO(f,K)),role:"string"===typeof r&&""!==r?r:"presentation"},t,A),a||_?{}:{tabIndex:0}),p)}}),[A,Y,X,J,Q,G,W,$,K,_,k,a]),ae=(0,e.useCallback)((function(e){e.stopPropagation()}),[]),se=(0,e.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.refKey,t=void 0===n?"ref":n,r=e.onChange,a=e.onClick,s=cC(e,tC);return lC(lC({},uC({accept:O,multiple:l,type:"file",style:{display:"none"},onChange:Z(XO(r,K)),onClick:Z(XO(a,ae)),tabIndex:-1},t,F)),s)}}),[F,r,l,K,a]);return lC(lC({},N),{},{isFocused:L&&!a,getRootProps:re,getInputProps:se,rootRef:A,inputRef:F,open:Z(q)})}function yC(e,n){switch(n.type){case"focus":return lC(lC({},e),{},{isFocused:!0});case"blur":return lC(lC({},e),{},{isFocused:!1});case"openDialog":return lC(lC({},mC),{},{isFileDialogActive:!0});case"closeDialog":return lC(lC({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return lC(lC({},e),{},{isDragActive:n.isDragActive,isDragAccept:n.isDragAccept,isDragReject:n.isDragReject});case"setFiles":return lC(lC({},e),{},{acceptedFiles:n.acceptedFiles,fileRejections:n.fileRejections});case"reset":return lC({},mC);default:return e}}function bC(){}const vC=Re.span(pC||(pC=r(["\n    padding: "," 0;\n    cursor: pointer;\n"])),De.spacings.space0p1),SC=Re.span(gC||(gC=r(["\n    color: ",";\n"])),De.colors.fg1),wC=()=>{const n=Qx(Fk),t=Jx(),r=(0,e.useCallback)((e=>{const n=e[0],r=new FileReader;r.onabort=()=>console.log("file reading was aborted"),r.onerror=()=>console.log("file reading has failed"),r.onload=()=>{t(Wa.actions.setLocalFile({arrayBuffer:r.result,filepath:n.name}))},r.readAsArrayBuffer(n)}),[]),{getRootProps:a,getInputProps:s,isDragActive:o}=hC({onDrop:r});return(0,Ze.jsxs)(vC,{...a(),children:[(0,Ze.jsx)("input",{...s()}),o?(0,Ze.jsx)(SC,{children:"Drop the file here ..."}):(0,Ze.jsx)(SC,{children:n?"Choose a different file":"Upload a file from your device"})]})};var _C,kC,IC;const TC=Re.form(_C||(_C=r(["\n    display: inline;\n"]))),xC=Re.input(kC||(kC=r(["\n    padding: "," 0;\n    color: ",";\n    ::placeholder,\n    ::-webkit-input-placeholder {\n        color: ",";\n        opacity: 1;\n    }\n    :-ms-input-placeholder {\n        color: ",";\n        opacity: 1;\n    }\n    @media (max-width: ","px) {\n        background-color: transparent;\n        text-align: center;\n    }\n"])),De.spacings.space0p1,De.colors.fg1,De.colors.fg1,De.colors.fg1,De.devices.mobile.maxWidth),OC=Re(sn)(IC||(IC=r(["\n    margin-left: ",";\n"])),De.spacings.space1),CC=()=>{const n=Jx(),t=Qx(Ak),[r,a]=(0,e.useState)(t||"");return(0,Ze.jsxs)(TC,{onSubmit:e=>{e.preventDefault(),n(Wa.actions.setUrl(r))},children:[(0,Ze.jsx)(xC,{value:r,onChange:e=>{a(e.target.value),n(Wa.actions.setFocusOn("url"))},placeholder:"Load a file from a URL"}),r.length?(0,Ze.jsx)(OC,{children:"Load"}):null]})};var MC,EC;const AC=Re(mn)(MC||(MC=r(["\n    position: relative;\n"]))),FC=Re.div(EC||(EC=r(["\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    flex: auto;\n    & > * {\n        display: inline-block;\n        @media (max-width: ","px) {\n            /* Match all objects except Or */\n            &:nth-child(2n+1) {\n                width: 100%;\n                text-align: center;\n                background-color: ",";\n            }\n        }\n    }\n"])),De.devices.mobile.maxWidth,De.colors.bg1),PC=()=>{const e=Jx(),n=Qx(Fk),t=Qx(Ak),r=Qx(Nk),a=Qx(Rk);return(0,Ze.jsxs)(AC,{children:[(0,Ze.jsx)(hn,{children:(0,Ze.jsx)(nn,{children:"\u2192 input"})}),(0,Ze.jsx)(yn,{children:r&&a?(0,Ze.jsx)(Ze.Fragment,{children:(0,Ze.jsx)(_t,{format:r,artefacts:a,filename:n||t||void 0,extraButtons:[(0,Ze.jsx)(sn,{onClick:()=>{e(Wa.actions.clear())},children:"clear"},"clear")]})}):(0,Ze.jsxs)(FC,{children:[(0,Ze.jsx)(wC,{})," ",(0,Ze.jsx)(pn,{children:"OR"})," ",(0,Ze.jsx)(CC,{})," ",(0,Ze.jsx)(pn,{children:"OR"})," ",(0,Ze.jsx)(oO,{})]})})]})},NC={...sp,patchPlayer:{description:"Patch player"}},RC={pd:{info:"A Pure Data file (.pd) in text format."},pdJson:{info:"Will compile a JSON representation of a pure data file."},dspGraph:{info:"Will compile a DSP graph that is used internally by the WebPd compiler to generate the audio output."},javascript:{info:"Will compile a JavaScript function for generating audio."},assemblyscript:{info:"Will compile an AssemblyScript function which can then be compiled to Web Assembly."},wasm:{info:"Will generate a Web Assembly module from your patch. This module can be loaded again here at a later time to play your patch."},wav:{info:"Will generate an audio preview of your patch."},patchPlayer:{info:"Will render a interactive interface allowing to play your patch online."},app:{info:"Will generate a bare bones web page embedding your patch. A good starter to build an audio web site of your own."}},LC=Re.div.withConfig({displayName:"OutputSelector__Container",componentId:"sc-1qpzo58-0"})([""]),DC=Re.div.withConfig({displayName:"OutputSelector__FormatSelector",componentId:"sc-1qpzo58-1"})(["width:100%;display:flex;flex-direction:row;justify-content:space-between;@media (max-width:","px){flex-direction:column;align-items:initial;","{text-align:center;}}"],De.devices.mobile.maxWidth,pn),UC=Re(gn).withConfig({displayName:"OutputSelector__FormatHint",componentId:"sc-1qpzo58-2"})(["margin-top:",";"],De.spacings.space0p1),jC=Re(sn).withConfig({displayName:"OutputSelector__ButtonInit",componentId:"sc-1qpzo58-3"})([""]),zC=Re(sn).withConfig({displayName:"OutputSelector__ButtonActive",componentId:"sc-1qpzo58-4"})(["color:",";background-color:",";"],De.colors.colorScheme.next(),De.colors.bg1p5),BC=Re(sn).withConfig({displayName:"OutputSelector__ButtonInactive",componentId:"sc-1qpzo58-5"})(["color:",";background-color:",";"],De.colors.fg1,De.colors.bg1p5),VC=()=>{const e=Jx(),n=Qx(Lk),t=Array.from(Qx(jk));return(0,Ze.jsxs)(LC,{children:[(0,Ze.jsx)(DC,{children:t.flatMap(((r,a)=>{const s=r===n?zC:n?BC:jC;return[(0,Ze.jsx)(s,{onClick:()=>e(Ka.actions.setFormat(r)),children:NC[r].description},r),a<t.length-1?(0,Ze.jsx)(pn,{children:"OR"},r+"OR"):null]}))}),n?(0,Ze.jsx)(UC,{children:RC[n].info}):null]})};var GC,WC,$C;const HC=Re.div(GC||(GC=r(["\n    margin-top: ",";\n"])),De.spacings.space2),KC=Re(ln)(WC||(WC=r(["\n    min-width: 8em;\n    margin-left: ",";\n"])),De.spacings.space0p1),qC=Re(gn)($C||($C=r(["\n    margin-top: ",";\n"])),De.spacings.space0p1),YC=()=>{const e=Qx(Dk),n=Jx();return(0,Ze.jsxs)(HC,{children:[(0,Ze.jsx)("label",{children:"Compilation target"}),(0,Ze.jsx)(KC,{value:e,onChange:e=>n(Ka.actions.setCodeTarget(e.currentTarget.value)),children:Object.entries(Nx).map((e=>{let[n,{display:t}]=e;return(0,Ze.jsx)("option",{value:n,children:t},n)}))}),(0,Ze.jsx)(qC,{children:Nx[e].info})]})},XC=()=>vk.artefacts,JC=e=>e.artefacts.buildStatus,QC=e=>e.artefacts.step,ZC=e=>e.console.errors,eM=e=>e.console.warnings;var nM,tM;const rM=Re.div(nM||(nM=r(["\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    background-color: ",";\n"])),De.colors.bg1),aM=Re(sn)(tM||(tM=r(["\n    position: fixed;\n    right: ",";\n    top: ",";\n    z-index: ",";\n"])),De.spacings.space1,De.spacings.space1,De.zIndexes.closeButton),sM=n=>{let{artefacts:t}=n;const r=(0,e.useRef)(null),a=Jx(),s=Qx(qx),o=Qx(Kx);(0,e.useEffect)((()=>{if(!s)return;const e=Mx(t,s,{container:r.current,colorScheme:De.colors.colorScheme,showCredits:!1,initialValues:o,valuesUpdatedCallback:e=>{a(Hx.actions.valuesChanged(e))}});return()=>{console.log("DESTROY"),e.then((e=>(e=>{e.rootElem&&(e.rootElem.innerHTML="",e.rootElem.remove(),console.log("DESTROY PATCH PLAYER",e.rootElem)),e.webpdNode.disconnect(),e.audioContext.suspend()})(e)))}}),[t,s]);return(0,Ze.jsx)(rM,{id:"PatchPlayer",ref:r,children:(0,Ze.jsx)(aM,{onClick:()=>{a(gk())},children:"Close"})})};var oM;const iM=Re.div(oM||(oM=r([""]))),lM=()=>{const e=Jx(),n=Qx(Lk),t=Qx(XC),r=Qx(ZC),a=Qx(QC),s=Qx(JC);return!n||r||s!==yk?null:(0,Ze.jsxs)(iM,{children:[s===hk&&(0,Ze.jsxs)(nn,{children:["Building ",a," ..."]}),s===yk?"patchPlayer"!==n?(0,Ze.jsx)(_t,{artefacts:t,format:n,filename:"output."+n,showDownloadButton:!0,extraButtons:[(0,Ze.jsx)(sn,{onClick:()=>{e(Ka.actions.clear())},children:"clear"},"clear")]}):(0,Ze.jsx)(sM,{artefacts:t}):null]})};var uM,cM;const dM=Re.div(uM||(uM=r(["\n    margin-top: ",";\n"])),De.spacings.space2),fM=Re.input(cM||(cM=r(["\n    margin-left: ",";\n    background-color: ",";\n    width: 2em;\n"])),De.spacings.space0p1,De.colors.bg1p5),pM=()=>{const e=Qx(Uk),n=Jx();return(0,Ze.jsxs)(dM,{children:[(0,Ze.jsx)("label",{children:"Duration of preview in seconds"}),(0,Ze.jsx)(fM,{value:e||"",onChange:e=>{if(""===e.currentTarget.value)return void n(Ka.actions.setPreviewDurationSeconds(null));const t=Number.parseInt(e.currentTarget.value);isNaN(t)||n(Ka.actions.setPreviewDurationSeconds(t))}})]})};var gM,mM,hM,yM;const bM=Re(mn)(gM||(gM=r([""]))),vM=Re(gn)(mM||(mM=r(["\n    margin-top: ",";\n"])),De.spacings.space2),SM=Re.div(hM||(hM=r(["\n    margin-top: ",";\n"])),De.spacings.space2),wM=Re(on)(yM||(yM=r(["\n    font-size: 150%;\n    padding: 0.1em 0.5em;\n"]))),_M=()=>{const e=Jx(),n=Qx(Rk),t=Qx(Nk),r=Qx(Lk),a=Qx(JC),s=t&&r&&["pd","pdJson","dspGraph"].includes(t)&&["wav","patchPlayer"].includes(r),o=Qx(ZC);return n?(0,Ze.jsxs)(bM,{children:[(0,Ze.jsx)(hn,{children:(0,Ze.jsx)(nn,{children:"\u2190 output"})}),(0,Ze.jsx)(yn,{children:r&&!o&&a===yk?(0,Ze.jsx)(lM,{}):(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)(VC,{}),r&&s?(0,Ze.jsx)(YC,{}):null,"wav"===r?(0,Ze.jsx)(pM,{}):null,r?(0,Ze.jsx)(SM,{children:(0,Ze.jsx)(wM,{onClick:()=>{e(wk.actions.startBuild())},children:"Go !"})}):null,(0,Ze.jsxs)(vM,{children:["For more compilation options"," ",(0,Ze.jsx)("a",{href:"https://github.com/sebpiq/WebPd/#using-the-cli",target:"_blank",rel:"noreferrer",children:"you can use the CLI"}),"."]})]})})]}):null};var kM=t(481),IM=t.n(kM),TM=new URL(t(494),t.b);const xM='<p align="center">\n  <img src="'+IM()(TM)+'" />\n</p>\n\n\x3c!-- intro start --\x3e\n\n<p><strong>WebPd</strong> is a compiler for the <a href="https://puredata.info/">Pure Data</a> audio programming language allowing to run <strong>.pd</strong> patches in web pages.</p>\n<p><strong>WebPd is highly modular and takes a white-box approach to audio programming</strong>. It converts the audio graph and processing objects from a patch into plain human-readable JavaScript or <a href="https://www.assemblyscript.org/">AssemblyScript</a> (*). The pure audio generated code can be then integrated directly in any web application without using WebPd or Pure Data ever again \ud83c\udf08.</p>\n\x3c!-- intro end --\x3e\n\n<p><a href="https://github.com/sponsors/sebpiq"><img src="https://img.shields.io/static/v1?label=Sponsor&message=%E2%9D%A4&logo=GitHub&color=%23ed00d9" alt=""></a></p>\n<p><em>(*) AssemblyScript is a TypeScript-style language which compiles to WebAssembly.</em></p>\n<h2 id="usecase-examples">Usecase examples</h2>\n<ul>\n<li>Publish generative musical works on the web</li>\n<li>Execute, tweak and share patches collectively on any machine</li>\n<li>Produce, filter and playback sound and music data in realtime from web based applications and games</li>\n</ul>\n<h2 id="integration-and-scope">Integration and scope</h2>\n<p>There are plenty of good JavaScript libraries to build interactive visual interfaces such as <a href="https://threejs.org/">Three.js</a>, <a href="https://p5js.org/">p5.js</a>, good old JavaScript / HTML / CSS, etc. Integrating them with a WebPd patch should be fairly easy. An example of such integration is the <em>patch player</em> demo, available through <a href="#using-the-web-compiler">the web compiler</a>.</p>\n<p>WebPd is <strong>not</strong>, in itself, a complete editor and a live performance platform like Pure Data. The Pure Data graphical interface, as well as GEM, are out of the scope of WebPd. WebPd isn&#39;t either a simple executor like libpd. It is rather a lean audio compiler, which generates high-performance, human-readable and easily integrable audio code with no bloat.</p>\n<h2 id="usage">Usage</h2>\n<p><span id="using-the-web-compiler"><span></p>\n<h3 id="web-compiler-and-player">Web compiler and player</h3>\n<p><strong>The web compiler and a patch player are live at the following address: <a href="https://sebpiq.github.io/WebPd_website">https://sebpiq.github.io/WebPd_website</a></strong></p>\n<p>Just upload or give a URL(*) of a patch, compile it just in time and generate an interface allowing to play that patch in realtime in your browser. Once the compilation succeeds, you can copy and share with others the resulting URL from the player(**). This URL contains all the modified parameters of the patch you have played with, so that it is shared completely in its <em>current</em> state.</p>\n<p><em>(*)You can use any public URL of a patch found in the wild (on github, Pure Data forums, etc.).</em></p>\n<p><em>(**)Sharing a compiled patch doesn&#39;t work if you used local files for compilation.</em></p>\n<p><span id="using-the-cli"><span></p>\n<h3 id="command-line-interface">Command line interface</h3>\n<p><em>NOTE : Running the CLI requires node.js version 18 or higher.</em></p>\n<p>The command-line interface (CLI) offers more customization options, including the ability to generate a fully-functional (but bare bones) web page embedding your patch.</p>\n<p>Open a terminal and install the CLI with <a href="https://nodejs.org/">node / npm</a> by running the following command:</p>\n<pre><code>npm install -g webpd\n</code></pre>\n<p>Verify that installation worked by running:</p>\n<pre><code>webpd --help\n</code></pre>\n<p>This should output help for the CLI and will hopefully get you started.</p>\n<h3 id="getting-help">Getting help</h3>\n<p>If you feel stuck, there&#39;s <a href="https://puredata.info/community">plenty of places</a> where you can ask for help. I recommend in particular <a href="https://discord.gg/AZ43djV">the discord server</a> where you can get help quickly and find support from the community.</p>\n<p>If you feel you might have stumbled upon a bug, please report it following <a href="#reporting-a-bug">these simple guidelines</a>.</p>\n<h3 id="you-are-using-webpd">You are using WebPd?</h3>\n<p>Great \ud83c\udf31 ! It helps a lot with motivation to hear that people are using it. Don&#39;t hesitate to let me know by pinging me on twitter <a href="https://twitter.com/sebpiq">@sebpiq</a>, or <a href="https://second-hander.com/">writing me directly by email</a>.</p>\n<p>If you can afford it, you can also <a href="https://opencollective.com/webpd">donate</a> to help move development forward.</p>\n<h2 id="development">Development</h2>\n<h3 id="status--roadmap">Status &amp; roadmap</h3>\n<p>WebPd is currently under heavy development, but it is still a work in progress. A list of implemented objects, features and the roadmap are <a href="https://github.com/sebpiq/WebPd/blob/main/ROADMAP.md">here</a>.</p>\n<p>The project is currently in <em>alpha release state</em> which means that many of your patches will <em>not</em> work out of the box. Many objects and features are indeed still missing. If you feel there is a bug, thanks for reporting it following <a href="#reporting-a-bug">these simple guidelines</a>. If you feel you could develop an object that is missing in WebPd to play a specific patch, see <a href="#contributing">contributing</a>.</p>\n<p><span id="reporting-a-bug"><span></p>\n<h3 id="reporting-a-bug">Reporting a bug</h3>\n<p>If you wish to report a bug:</p>\n<ul>\n<li>First narrow it down. Remove all objects in your patch that are not related with the bug. Try to find the simplest patch with which this bug can be reproduced.</li>\n<li>Then submit a bug report <a href="https://github.com/sebpiq/WebPd/issues">in github</a> with the following template :</li>\n</ul>\n<pre><code>Patch and description -&gt; Upload your minimal patch\n\nCurrent behavior -&gt; Describe shortly how it is working at the moment\n\nExpected behavior -&gt; Describe shortly how it should work instead\n</code></pre>\n<p><span id="contributing"><span></p>\n<h3 id="contributing">Contributing</h3>\n<p>One-time contributions or regular work on the library are more than welcome! Contribution guidelines are coming, meanwhile if you have time and would really like to get involved please get in touch on the issue tracker on GitHub. I would be pleased to help you getting started for contributing.</p>\n<p>In case you would like to try developping a new object, here are some good examples to start with:</p>\n<ul>\n<li><a href="https://github.com/sebpiq/WebPd/blob/develop/src/nodes/nodes/clip.ts">clip.ts</a></li>\n<li><a href="https://github.com/sebpiq/WebPd/blob/develop/src/nodes/nodes/clip~.ts">clip~.ts</a></li>\n</ul>\n<p>If you want to dig deeper into the code, WebPd is built in several sub-packages in addition to this one which combines them all : </p>\n<ul>\n<li>Pd file parser : <a href="https://github.com/sebpiq/WebPd_pd-parser">https://github.com/sebpiq/WebPd_pd-parser</a></li>\n<li>WebPd compiler : <a href="https://github.com/sebpiq/WebPd_compiler">https://github.com/sebpiq/WebPd_compiler</a></li>\n<li>WebPd runtime : <a href="https://github.com/sebpiq/WebPd_runtime">https://github.com/sebpiq/WebPd_runtime</a></li>\n</ul>\n<h2 id="license">License</h2>\n<p>WebPd is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License version 3 as published by the Free Software Foundation.</p>\n<p>WebPd is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\nGNU Lesser General Public License or read the <a href="https://github.com/sebpiq/WebPd/blob/main/COPYING.LESSER">COPYING.LESSER</a> file for more details.</p>\n<h2 id="authors">Authors</h2>\n<ul>\n<li>S\xe9bastien Piquemal <a href="mailto:&#115;&#x65;&#98;&#112;&#105;&#113;&#x40;&#112;&#114;&#111;&#116;&#x6f;&#x6e;&#109;&#x61;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;">&#115;&#x65;&#98;&#112;&#105;&#113;&#x40;&#112;&#114;&#111;&#116;&#x6f;&#x6e;&#109;&#x61;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;</a></li>\n<li>Chris McCormick</li>\n<li>Brandon James</li>\n<li>mgsx-dev</li>\n<li>Atul Varma</li>\n<li>Ulric Wilfred</li>\n<li>Paul Money</li>\n</ul>\n<h2 id="acknowledgment-and-sponsors">Acknowledgment and sponsors</h2>\n<p>This project has been sponsored by the <a href="https://dafneplus.eu/">DAFNE+</a> european research project funded by the European Union within the &quot;Horizon Europe&quot; program (Grant Agreement 101061548) and <a href="https://www.ircam.fr">IRCAM</a> within the WAM team from december 2022 to march 2023.</p>\n';var OM;function CM(){return CM=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},CM.apply(this,arguments)}function MM(n,t){let{title:r,titleId:a,...s}=n;return e.createElement("svg",CM({width:98,height:96,xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},s),r?e.createElement("title",{id:a},r):null,OM||(OM=e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z",fill:"#24292f"})))}const EM=e.forwardRef(MM);t.p;function AM(){return AM=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},AM.apply(this,arguments)}function FM(n,t){let{title:r,titleId:a,...s}=n;return e.createElement("svg",AM({width:700,height:736,viewBox:"0 0 525 552",id:"svg2647",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},s),r?e.createElement("title",{id:a},r):null,e.createElement("path",{d:"M 110.52407,0.01240603 V 27.644204 H 55.25943 V 55.276003 L 27.631798,55.27194 V 82.903738 H 0 V 193.433 h 27.631798 v 55.26464 l 27.627632,-0.008 v 27.6318 h 27.631798 v 27.6318 h 27.631802 v 27.63179 h 27.63179 v 27.6318 h 27.6318 v 27.6318 h 27.6318 v 55.26464 h 27.6318 v 55.26464 h 27.6318 v 55.26463 h 27.6318 v -55.26463 h 27.63179 v -55.26464 h 27.6318 V 386.8483 h 27.6318 v -27.6318 h 27.6318 v -27.6318 h 27.6318 v -27.63179 h 27.6318 v -27.6318 h 27.63179 v -27.6318 h 27.6318 V 193.42467 H 525 V 82.895395 H 497.3682 V 55.263596 H 469.7364 V 27.631798 H 414.47177 V 0 h -55.26464 v 27.631798 h -55.26464 v 27.631798 h -27.6318 v 27.631799 h -27.6318 V 55.263596 h -27.6318 V 27.631798 l -27.63596,0.01221 h -27.6318 V 0.01220812 Z",id:"path2645",style:{strokeWidth:1.04165}}))}const PM=e.forwardRef(FM);t.p;var NM,RM,LM,DM,UM,jM;const zM="\x3c!-- intro start --\x3e",BM=xM.slice(xM.indexOf(zM)+20,xM.indexOf("\x3c!-- intro end --\x3e")),VM=Re(tn)(NM||(NM=r(["\n    background: linear-gradient(\n        180deg,\n        rgba(0, 0, 0, 0) 10%,\n        "," 50%,\n        "," 67%\n    );\n"])),De.colors.bg2,De.colors.bg2),GM=Re.h1(RM||(RM=r(["\n    position: relative;\n    bottom: 0.15em;\n    font-size: 600%;\n    font-family: ",";\n    color: ",";\n    margin: 0;\n    padding: 0;\n    margin-bottom: ",";\n    line-height: 100%;\n    letter-spacing: 0.3em;\n    text-align: center;\n    @media (max-width: 700px) {\n        font-size: 450%;\n    }\n    @media (max-width: 400px) {\n        font-size: 350%;\n    }\n"])),De.fonts.title,De.colors.colorScheme.next(),De.spacings.space2),WM=Re.div(LM||(LM=r(["\n    & > *:last-child {\n        margin-bottom: 0;\n    }\n"]))),$M=Re.div(DM||(DM=r(["\n    margin-top: ",";\n    display: flex;\n    flex-direction: row;\n"])),De.spacings.space1),HM="\n    font-family: ".concat(De.fonts.title,";\n    font-size: 85%;\n    text-decoration: underline;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    width: fit-content;\n\n    svg {\n        height: 1em;\n        width: 1em;\n        display: inline;\n        margin-left: 0.5em;\n        path {\n            fill: ").concat(De.colors.fg1,";\n        }\n    }\n"),KM=Re.a(UM||(UM=r(["\n    ","\n"])),HM),qM=Re.a(jM||(jM=r(["\n    ","\n    margin-left: ",";\n"])),HM,De.spacings.space1),YM=()=>(0,Ze.jsxs)(VM,{children:[(0,Ze.jsx)(GM,{children:"WebPd"}),(0,Ze.jsx)(WM,{dangerouslySetInnerHTML:{__html:BM}}),(0,Ze.jsxs)($M,{children:[(0,Ze.jsxs)(KM,{href:"https://github.com/sebpiq/WebPd",target:"_blank",rel:"noopener",children:["Read more",(0,Ze.jsx)(EM,{viewBox:"0 0 97.627 96"})]}),(0,Ze.jsxs)(qM,{href:"https://opencollective.com/webpd",target:"_blank",rel:"noopener",children:["Donate",(0,Ze.jsx)(PM,{})]})]})]});var XM,JM,QM,ZM,eE;const nE=Re(tn)(XM||(XM=r([""]))),tE=Re.pre(JM||(JM=r(["\n    overflow: auto;\n    margin: 0;\n"]))),rE=Re.pre(QM||(QM=r(["\n    overflow: auto;\n    margin: 0;\n    color: ",";\n"])),De.colors.colorScheme.next()),aE=Re.div(ZM||(ZM=r(["\n    margin-top: ",";\n"])),De.spacings.space1),sE=Re(gn)(eE||(eE=r(["\n    margin-top: ",";\n"])),De.spacings.space2),oE=()=>{const e=Qx(ZC),n=Qx(eM),t=e&&e.length,r=n&&n.length;if(!t&&!r)return null;const a=(0,Ze.jsxs)(Ze.Fragment,{children:["WebPd is still in alpha release and many patches will likely not work (for now). You can find the list of implemented objects ",(0,Ze.jsx)("a",{href:"https://github.com/sebpiq/WebPd/blob/main/ROADMAP.md",target:"_blank",rel:"noreferrer",children:"here"}),". If failure was caused by a missing feature, you can either"," ",(0,Ze.jsx)("a",{href:"https://opencollective.com/webpd",target:"_blank",rel:"noreferrer",children:"donate"})," ","to speed up its implementation, or you can directly"," ",(0,Ze.jsx)("a",{href:"https://github.com/sebpiq/WebPd/#contributing",target:"_blank",rel:"noreferrer",children:"contribute to development"}),". If, on the other hand, this looks like a bug, thanks for"," ",(0,Ze.jsx)("a",{href:"https://github.com/sebpiq/WebPd/#reporting-a-bug",target:"_blank",rel:"noreferrer",children:"reporting it here."})]});return(0,Ze.jsxs)(nE,{children:[(0,Ze.jsx)(nn,{children:"Compilation output :"}),(0,Ze.jsxs)(aE,{children:[r?n.map(((e,n)=>(0,Ze.jsxs)(tE,{children:["WARNING : ",e]},n))):null,t?e.map(((e,n)=>(0,Ze.jsxs)(rE,{children:["ERROR : ",e]},n))):null]}),t||r?(0,Ze.jsxs)(sE,{children:[t?"It seems like your compilation failed \ud83d\ude22.":"It seems like your compilation succeeded but with warnings \ud83d\ude05.",(0,Ze.jsx)("br",{}),a]}):null]})};var iE;const lE=Re(tn)(iE||(iE=r(["\n    text-align: center;\n"]))),uE=()=>(0,Ze.jsx)(lE,{children:(0,Ze.jsx)(en,{children:"\u2193 Online compiler \u2193"})});var cE,dE,fE,pE;const gE=Re(tn)(cE||(cE=r(["\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    & * {\n        font-size: 90%;\n    }\n    background: linear-gradient(\n        180deg,\n        "," 33%,\n        "," 60%,\n        rgba(0, 0, 0, 0) 100%\n    );\n    padding-bottom: calc("," * 2);\n"])),De.colors.bg2,De.colors.bg2,De.spacings.space2),mE=Re.div(dE||(dE=r(["\n    color: ",";\n    margin-right: 1em;\n"])),De.colors.fg2),hE=Re.div(fE||(fE=r(["\n    display: flex;\n    flex-direction: row;\n    @media (min-width: ","px) {\n        min-width: 10em;\n    }\n    @media (max-width: ","px) {\n        flex-direction: column;\n        min-width: 5em;\n    }\n"])),De.devices.mobile.maxWidth,De.devices.mobile.maxWidth),yE=Re.a(pE||(pE=r(["\n    text-align: right;\n    color: ",";\n\n    svg {\n        height: 1em;\n        width: 1em;\n        display: inline;\n        position: relative;\n        top: 0.2em;\n        margin-left: 0.5em;\n        path {\n            fill: ",";\n        }\n    }\n\n    @media (min-width: ","px) {\n        width: 10em;\n    }\n\n    @media (max-width: ","px) {\n        margin-bottom: ",";\n        &:last-child {\n            margin-bottom: 0;\n        }\n    }\n"])),De.colors.fg2,De.colors.fg2,De.devices.mobile.maxWidth,De.devices.mobile.maxWidth,De.spacings.space1),bE=()=>(0,Ze.jsxs)(gE,{children:[(0,Ze.jsx)(mE,{children:"WebPd is an open-source project released under the LGPL v3.0. Files uploaded on this web site are not stored on any server."}),(0,Ze.jsxs)(hE,{children:[(0,Ze.jsxs)(yE,{href:"https://github.com/sebpiq/WebPd",target:"_blank",rel:"noopener",children:["GitHub",(0,Ze.jsx)(EM,{viewBox:"0 0 97.627 96"})]}),(0,Ze.jsxs)(yE,{href:"https://opencollective.com/webpd",target:"_blank",rel:"noopener",children:["Donate",(0,Ze.jsx)(PM,{})]})]})]});var vE,SE;const wE=Re(tn)(vE||(vE=r([""]))),_E=Re.pre(SE||(SE=r(["\n    max-height: 25vh;\n    overflow: auto;\n"]))),kE=()=>{const e=Qx(XC);return(0,Ze.jsxs)(wE,{children:[(0,Ze.jsx)(en,{children:"Debugging"}),e.pdJson?(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsxs)(nn,{children:["Pd JSON"," ",(0,Ze.jsx)(sn,{onClick:()=>{On("debug.pd.json",JSON.stringify(e.pdJson,null,2),"application/json")},children:"Download"})]}),(0,Ze.jsx)(_E,{children:JSON.stringify(e.pdJson,null,2)})]}):null,e.dspGraph?(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsxs)(nn,{children:["DSP Graph"," ",(0,Ze.jsx)(sn,{onClick:()=>{On("debug.dsp-graph.json",JSON.stringify(e.dspGraph,null,2),"application/json")},children:"Download"})]}),(0,Ze.jsx)(_E,{children:JSON.stringify(e.dspGraph,null,2)})]}):null,e.javascript?(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsxs)(nn,{children:["Compiled JS"," ",(0,Ze.jsx)(sn,{onClick:()=>{On("debug.code.js",e.javascript,"application/javascript")},children:"Download"})]}),(0,Ze.jsx)(_E,{children:e.javascript})]}):null,e.assemblyscript?(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsxs)(nn,{children:["Compiled ASC"," ",(0,Ze.jsx)(sn,{onClick:()=>{On("debug.code.asc",e.assemblyscript,"application/assemblyscript")},children:"Download"})]}),(0,Ze.jsx)(_E,{children:e.assemblyscript})]}):null]})};var IE,TE,xE,OE,CE;const ME=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var s=ve.apply(void 0,[n].concat(r)),o="sc-global-"+Ie(JSON.stringify(s)),i=new Ne(s,o);function l(n){var t=ie(),r=le(),a=(0,e.useContext)(Ee),s=(0,e.useRef)(t.allocateGSInstance(o)).current;return t.server&&u(s,n,t,a,r),(0,e.useLayoutEffect)((function(){if(!t.server)return u(s,n,t,a,r),function(){return i.removeStyles(s,t)}}),[s,n,t,a,r]),null}function u(e,n,t,r,a){if(i.isStatic)i.renderStyles(e,T,t,a);else{var s=g({},n,{theme:Se(n,r,l.defaultProps)});i.renderStyles(e,s,t,a)}}return e.memo(l)}(IE||(IE=r(["\n    @font-face {\n        font-family: 'Rajdhani';\n        src: local('Rajdhani'),\n            url('./fonts/Rajdhani/Rajdhani-Medium.ttf') format('woff');\n    }\n\n    @font-face {\n        font-family: 'Silkscreen';\n        src: local('Silkscreen'),\n            url('./fonts/Silkscreen/Silkscreen-Regular.ttf') format('woff');\n    }\n\n    body, html {\n        padding: 0;\n        margin: 0;\n        background-color: ",";\n    }\n\n    * { \n        box-sizing: border-box;\n        /* To enable flex items shrink : https://stackoverflow.com/questions/36247140/why-dont-flex-items-shrink-past-content-size */\n        min-width: 0; \n        min-height: 0;\n        font-size: ","px;\n        @media (max-width: ","px) {\n            font-size: ","px;\n        }\n        font-family: ",";\n        color: ",";\n        scrollbar-width: thin;\n        &::-webkit-scrollbar {\n            width: calc("," / 4);\n            height: calc("," / 4);\n        }\n        &::-webkit-scrollbar-track {\n            background: transparent;\n        }\n        &::-webkit-scrollbar-thumb {\n            background-color: ",";\n            border-radius: 20px;\n        }\n    }\n\n    input {\n        background-color: ",";\n        border: none;\n        font-size: 100%;\n    }\n\n    textarea:focus, input:focus{\n        outline: "," solid 1px;\n    }\n"])),De.colors.bg1,De.devices.desktop.fontSize,De.devices.mobile.maxWidth,De.devices.mobile.fontSize,De.fonts.default,De.colors.fg1,De.spacings.space1,De.spacings.space1,De.colors.fg2,De.colors.bg2,De.colors.fg2),EE=Re.div(TE||(TE=r(["\n    display: flex;\n    flex-direction: column;\n    min-height: 100vh;\n    & > *:last-child {\n        flex: auto;\n    }\n"]))),AE=Re.div(xE||(xE=r(["\n    position: relative;\n"]))),FE=Re.div(OE||(OE=r(["\n    margin: auto;\n    width: 100%;\n    position: absolute;\n    height: 100%;\n    z-index: 3;\n"]))),PE=Re((e=>{let{text:n,className:t}=e;return(0,Ze.jsx)(bn,{className:t,children:n})}))(CE||(CE=r(["\n    max-width: ",";\n    width: 100%;\n    margin: 0 auto;\n    height: 100%;\n    z-index: ",";\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: ","ee;\n    font-size: 200%;\n"])),De.dimensions.maxContentWidth,De.zIndexes.spinner,De.colors.bg2),NE=()=>{const e=Qx(Rx),n=Qx(JC)===hk,t=Qx(Dx);return e?(0,Ze.jsxs)(EE,{children:[(0,Ze.jsx)(YM,{}),(0,Ze.jsx)(uE,{}),(0,Ze.jsxs)(AE,{children:[n?(0,Ze.jsx)(FE,{children:(0,Ze.jsx)(PE,{text:"building..."})}):null,(0,Ze.jsx)(PC,{}),(0,Ze.jsx)(_M,{}),t?(0,Ze.jsx)(kE,{}):null,(0,Ze.jsx)(oE,{})]}),(0,Ze.jsx)(bE,{})]}):(0,Ze.jsx)(Ze.Fragment,{children:(0,Ze.jsx)(YM,{})})},RE=()=>(0,Ze.jsxs)(La,{store:Xx,children:[(0,Ze.jsx)(ME,{}),(0,Ze.jsx)(NE,{})]}),LE=e=>{e&&e instanceof Function&&t.e(787).then(t.bind(t,787)).then((n=>{let{getCLS:t,getFID:r,getFCP:a,getLCP:s,getTTFB:o}=n;t(e),r(e),a(e),s(e),o(e)}))};n.createRoot(document.getElementById("root")).render((0,Ze.jsx)(RE,{})),LE()})()})();
//# sourceMappingURL=main.8a8cb829.js.map